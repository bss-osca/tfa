<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 14 Data visualization using ggplot | Tools for Analytics (TFA)</title>
  <meta name="description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 14 Data visualization using ggplot | Tools for Analytics (TFA)" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bss-osca.github.io/tfa//assets/logo.png" />
  <meta property="og:description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="github-repo" content="bss-osca/tfa" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 14 Data visualization using ggplot | Tools for Analytics (TFA)" />
  
  <meta name="twitter:description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="twitter:image" content="https://bss-osca.github.io/tfa//assets/logo.png" />

<meta name="author" content="Lars Relund Nielsen" />


<meta name="date" content="2025-08-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon" />
<link rel="prev" href="mod-r-transform.html"/>
<link rel="next" href="mod-r-dist-fit.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.11/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<link href="libs/minichart-0.2.2/minicharts.css" rel="stylesheet" />
<script src="libs/minichart-0.2.2/leaflet.minicharts.min.js"></script>
<link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" />
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<html>
<head>
<script>
  $(document).ready(function() {

  // Section anchors
  $('.section h1, .section h2, .section h3, .section h4, .section h5').each(function() {
    anchor = '#' + $(this).parent().attr('id');
    $(this).addClass("hasAnchor").prepend('<a href="' + anchor + '" class="anchor"></a>');
  });
});
</script>
<script src="https://hypothes.is/embed.js" async></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</head>
</html>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="img/logo.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to the course</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#lo-intro"><i class="fa fa-check"></i><b>1.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.2</b> Purpose for the course</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#r-vs-vba"><i class="fa fa-check"></i><b>1.3</b> R vs Excel/VBA</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#computer"><i class="fa fa-check"></i><b>1.4</b> How a computer works</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i><b>1.5</b> How the notes are organized</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#ack"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#how-to-cite"><i class="fa fa-check"></i><b>1.7</b> How to cite</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#ex-intro"><i class="fa fa-check"></i><b>1.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="index.html"><a href="index.html#ex-annotate"><i class="fa fa-check"></i><b>1.8.1</b> Exercise - How to annotate</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I VBA</b></span></li>
<li class="chapter" data-level="2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html"><i class="fa fa-check"></i><b>2</b> An introduction to VBA</a>
<ul>
<li class="chapter" data-level="2.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#lo-vba-intro"><i class="fa fa-check"></i><b>2.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-what"><i class="fa fa-check"></i><b>2.2</b> What is VBA</a></li>
<li class="chapter" data-level="2.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-setup"><i class="fa fa-check"></i><b>2.3</b> Setup Excel for VBA</a></li>
<li class="chapter" data-level="2.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-hello"><i class="fa fa-check"></i><b>2.4</b> Your first program</a></li>
<li class="chapter" data-level="2.5" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-macro"><i class="fa fa-check"></i><b>2.5</b> The macro recorder</a></li>
<li class="chapter" data-level="2.6" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-overview"><i class="fa fa-check"></i><b>2.6</b> VBA - A short overview</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#variables"><i class="fa fa-check"></i><b>2.6.1</b> Variables</a></li>
<li class="chapter" data-level="2.6.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#procedures"><i class="fa fa-check"></i><b>2.6.2</b> Procedures</a></li>
<li class="chapter" data-level="2.6.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#input-and-output"><i class="fa fa-check"></i><b>2.6.3</b> Input and output</a></li>
<li class="chapter" data-level="2.6.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#conditional-statements"><i class="fa fa-check"></i><b>2.6.4</b> Conditional statements</a></li>
<li class="chapter" data-level="2.6.5" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#loops"><i class="fa fa-check"></i><b>2.6.5</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-coding-practice"><i class="fa fa-check"></i><b>2.7</b> Good coding pratice</a></li>
<li class="chapter" data-level="2.8" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#rc-vba-intro"><i class="fa fa-check"></i><b>2.8</b> Recap</a></li>
<li class="chapter" data-level="2.9" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-intro"><i class="fa fa-check"></i><b>2.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-hello"><i class="fa fa-check"></i><b>2.9.1</b> Exercise - Hello</a></li>
<li class="chapter" data-level="2.9.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-macro"><i class="fa fa-check"></i><b>2.9.2</b> Exercise - Record a macro</a></li>
<li class="chapter" data-level="2.9.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-user-input"><i class="fa fa-check"></i><b>2.9.3</b> Exercise - User input</a></li>
<li class="chapter" data-level="2.9.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-max-min"><i class="fa fa-check"></i><b>2.9.4</b> Exercise - Max and min number</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html"><i class="fa fa-check"></i><b>3</b> Loops and conditional statements</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#lo-vba-loops-cond"><i class="fa fa-check"></i><b>3.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.2" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-operators"><i class="fa fa-check"></i><b>3.2</b> Relational and logical operators</a></li>
<li class="chapter" data-level="3.3" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-loops"><i class="fa fa-check"></i><b>3.3</b> Loops</a></li>
<li class="chapter" data-level="3.4" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-cond"><i class="fa fa-check"></i><b>3.4</b> Conditional statements</a></li>
<li class="chapter" data-level="3.5" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-ex-jen"><i class="fa fa-check"></i><b>3.5</b> Example - Find Jen</a></li>
<li class="chapter" data-level="3.6" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-ex-dist-mat"><i class="fa fa-check"></i><b>3.6</b> Example - A distance matrix</a></li>
<li class="chapter" data-level="3.7" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#recap"><i class="fa fa-check"></i><b>3.7</b> Recap</a></li>
<li class="chapter" data-level="3.8" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-loops-cond"><i class="fa fa-check"></i><b>3.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-loops"><i class="fa fa-check"></i><b>3.8.1</b> Exercise - Loops</a></li>
<li class="chapter" data-level="3.8.2" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-cond"><i class="fa fa-check"></i><b>3.8.2</b> Exercise - Conditional statements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html"><i class="fa fa-check"></i><b>4</b> Procedures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#lo-vba-procedures"><i class="fa fa-check"></i><b>4.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="4.2" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-subs-functions"><i class="fa fa-check"></i><b>4.2</b> Subs and functions - The basics</a></li>
<li class="chapter" data-level="4.3" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-optional-arg"><i class="fa fa-check"></i><b>4.3</b> Optional arguments</a></li>
<li class="chapter" data-level="4.4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-pub-priv"><i class="fa fa-check"></i><b>4.4</b> Public and private procedures</a></li>
<li class="chapter" data-level="4.5" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-byref"><i class="fa fa-check"></i><b>4.5</b> Passing arguments by reference or by value</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#return-values-from-a-sub"><i class="fa fa-check"></i><b>4.5.1</b> Return values from a sub</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-built-in"><i class="fa fa-check"></i><b>4.6</b> Built-in functions</a></li>
<li class="chapter" data-level="4.7" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-test-persons"><i class="fa fa-check"></i><b>4.7</b> Example - Selection of test persons</a></li>
<li class="chapter" data-level="4.8" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#recap-1"><i class="fa fa-check"></i><b>4.8</b> Recap</a></li>
<li class="chapter" data-level="4.9" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-procedures"><i class="fa fa-check"></i><b>4.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-subs"><i class="fa fa-check"></i><b>4.9.1</b> Exercise - Subs</a></li>
<li class="chapter" data-level="4.9.2" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#exercise---temperatures"><i class="fa fa-check"></i><b>4.9.2</b> Exercise - Temperatures</a></li>
<li class="chapter" data-level="4.9.3" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-functions"><i class="fa fa-check"></i><b>4.9.3</b> Exercise - Functions</a></li>
<li class="chapter" data-level="4.9.4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-worksheet-functions"><i class="fa fa-check"></i><b>4.9.4</b> Exercise - Worksheet functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html"><i class="fa fa-check"></i><b>5</b> Advanced data types and usage</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#lo-vba-datatypes"><i class="fa fa-check"></i><b>5.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="5.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-strings"><i class="fa fa-check"></i><b>5.2</b> Strings</a></li>
<li class="chapter" data-level="5.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-objects"><i class="fa fa-check"></i><b>5.3</b> Objects</a></li>
<li class="chapter" data-level="5.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-wst"><i class="fa fa-check"></i><b>5.4</b> The Worksheet object</a></li>
<li class="chapter" data-level="5.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#wst-rng"><i class="fa fa-check"></i><b>5.5</b> The Range object</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#named-ranges-in-excel"><i class="fa fa-check"></i><b>5.5.1</b> Named ranges in Excel</a></li>
<li class="chapter" data-level="5.5.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#current-region-of-a-range"><i class="fa fa-check"></i><b>5.5.2</b> Current region of a range</a></li>
<li class="chapter" data-level="5.5.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#input-and-output-1"><i class="fa fa-check"></i><b>5.5.3</b> Input and output</a></li>
<li class="chapter" data-level="5.5.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#sorting-a-range"><i class="fa fa-check"></i><b>5.5.4</b> Sorting a range</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-ary"><i class="fa fa-check"></i><b>5.6</b> Arrays</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#multi-dimensional-arrays"><i class="fa fa-check"></i><b>5.6.1</b> Multi-dimensional arrays</a></li>
<li class="chapter" data-level="5.6.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#dynamic-arrays"><i class="fa fa-check"></i><b>5.6.2</b> Dynamic arrays</a></li>
<li class="chapter" data-level="5.6.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#input-and-output-2"><i class="fa fa-check"></i><b>5.6.3</b> Input and output</a></li>
<li class="chapter" data-level="5.6.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#sorting-arrays"><i class="fa fa-check"></i><b>5.6.4</b> Sorting arrays</a></li>
<li class="chapter" data-level="5.6.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#use-arrays-instead-of-ranges"><i class="fa fa-check"></i><b>5.6.5</b> Use arrays instead of ranges</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-coll"><i class="fa fa-check"></i><b>5.7</b> Collections</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#accessing-collections-using-keys"><i class="fa fa-check"></i><b>5.7.1</b> Accessing collections using keys</a></li>
<li class="chapter" data-level="5.7.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#collections-containing-objects"><i class="fa fa-check"></i><b>5.7.2</b> Collections containing objects</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-ex-job-seq"><i class="fa fa-check"></i><b>5.8</b> Example - Job sequencing</a></li>
<li class="chapter" data-level="5.9" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#recap-2"><i class="fa fa-check"></i><b>5.9</b> Recap</a></li>
<li class="chapter" data-level="5.10" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-datatypes"><i class="fa fa-check"></i><b>5.10</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-equal"><i class="fa fa-check"></i><b>5.10.1</b> Exercise - Equal entries</a></li>
<li class="chapter" data-level="5.10.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-products"><i class="fa fa-check"></i><b>5.10.2</b> Exercise - Product search</a></li>
<li class="chapter" data-level="5.10.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-read-collections"><i class="fa fa-check"></i><b>5.10.3</b> Exercise - Read collections</a></li>
<li class="chapter" data-level="5.10.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-read-arrays"><i class="fa fa-check"></i><b>5.10.4</b> Exercise - Read arrays</a></li>
<li class="chapter" data-level="5.10.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-process"><i class="fa fa-check"></i><b>5.10.5</b> Exercise - Process numbers</a></li>
<li class="chapter" data-level="5.10.6" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-pay"><i class="fa fa-check"></i><b>5.10.6</b> Exercise - Search payments</a></li>
<li class="chapter" data-level="5.10.7" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-flight"><i class="fa fa-check"></i><b>5.10.7</b> Exercise - Flight search</a></li>
<li class="chapter" data-level="5.10.8" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-table"><i class="fa fa-check"></i><b>5.10.8</b> Exercise - Search table</a></li>
<li class="chapter" data-level="5.10.9" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-next-task"><i class="fa fa-check"></i><b>5.10.9</b> Exercise - Find next task</a></li>
<li class="chapter" data-level="5.10.10" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-seat-reservation"><i class="fa fa-check"></i><b>5.10.10</b> Exercise - Seat reservation</a></li>
<li class="chapter" data-level="5.10.11" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-select"><i class="fa fa-check"></i><b>5.10.11</b> Exercise - Transform data (select and filter)</a></li>
<li class="chapter" data-level="5.10.12" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-mutate"><i class="fa fa-check"></i><b>5.10.12</b> Exercise - Transform data (arrange and mutate)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html"><i class="fa fa-check"></i><b>6</b> Generating random numbers</a>
<ul>
<li class="chapter" data-level="6.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#lo-vba-random-numbers"><i class="fa fa-check"></i><b>6.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="6.2" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#vba-random-numbers"><i class="fa fa-check"></i><b>6.2</b> Generating random numbers</a></li>
<li class="chapter" data-level="6.3" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#vba-simulation"><i class="fa fa-check"></i><b>6.3</b> Simulation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#sec-vba-tsp"><i class="fa fa-check"></i><b>6.3.1</b> Example - Traveling salesman problem</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#recap-3"><i class="fa fa-check"></i><b>6.4</b> Recap</a></li>
<li class="chapter" data-level="6.5" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-random-numbers"><i class="fa fa-check"></i><b>6.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-random-int"><i class="fa fa-check"></i><b>6.5.1</b> Exercise - Two random integers</a></li>
<li class="chapter" data-level="6.5.2" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-swap"><i class="fa fa-check"></i><b>6.5.2</b> Exercise - Swap entries</a></li>
<li class="chapter" data-level="6.5.3" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-bakery"><i class="fa fa-check"></i><b>6.5.3</b> Exercise - Dan’s bakery</a></li>
<li class="chapter" data-level="6.5.4" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-generate"><i class="fa fa-check"></i><b>6.5.4</b> Exercise - Generating random numbers</a></li>
<li class="chapter" data-level="6.5.5" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-stoc-functions"><i class="fa fa-check"></i><b>6.5.5</b> Exercise - Stochastic functions</a></li>
<li class="chapter" data-level="6.5.6" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-customer-demand"><i class="fa fa-check"></i><b>6.5.6</b> Exercise - Customer demand</a></li>
<li class="chapter" data-level="6.5.7" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-simple-game"><i class="fa fa-check"></i><b>6.5.7</b> Exercise - A simple game</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II R</b></span></li>
<li class="chapter" data-level="7" data-path="mod-r-install.html"><a href="mod-r-install.html"><i class="fa fa-check"></i><b>7</b> Setting up R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mod-r-install.html"><a href="mod-r-install.html#lo-r-install"><i class="fa fa-check"></i><b>7.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="7.2" data-path="mod-r-install.html"><a href="mod-r-install.html#r-install"><i class="fa fa-check"></i><b>7.2</b> Install R and RStudio</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="mod-r-install.html"><a href="mod-r-install.html#test-your-installation"><i class="fa fa-check"></i><b>7.2.1</b> Test your installation</a></li>
<li class="chapter" data-level="7.2.2" data-path="mod-r-install.html"><a href="mod-r-install.html#add-on-packages"><i class="fa fa-check"></i><b>7.2.2</b> Add-on packages</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="mod-r-install.html"><a href="mod-r-install.html#r-cloud"><i class="fa fa-check"></i><b>7.3</b> Setup and test Posit Cloud</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html"><i class="fa fa-check"></i><b>8</b> R basics and workflows</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#lo-r-workflow"><i class="fa fa-check"></i><b>8.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="8.2" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#working-with-r-at-the-command-line-in-rstudio"><i class="fa fa-check"></i><b>8.2</b> Working with R at the command line in RStudio</a></li>
<li class="chapter" data-level="8.3" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#your-first-datacamp-course"><i class="fa fa-check"></i><b>8.3</b> Your first DataCamp course</a></li>
<li class="chapter" data-level="8.4" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#pipes"><i class="fa fa-check"></i><b>8.4</b> Pipes</a></li>
<li class="chapter" data-level="8.5" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#rprojs"><i class="fa fa-check"></i><b>8.5</b> RStudio projects</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#storing-your-code-in-a-script-file"><i class="fa fa-check"></i><b>8.5.1</b> Storing your code in a script file</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#rc-r-workflow"><i class="fa fa-check"></i><b>8.6</b> Recap</a></li>
<li class="chapter" data-level="8.7" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#ex-r-workflow"><i class="fa fa-check"></i><b>8.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-group-work"><i class="fa fa-check"></i><b>8.7.1</b> Exercise (group work)</a></li>
<li class="chapter" data-level="8.7.2" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-piping"><i class="fa fa-check"></i><b>8.7.2</b> Exercise (piping)</a></li>
<li class="chapter" data-level="8.7.3" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-working-dir"><i class="fa fa-check"></i><b>8.7.3</b> Exercise (working dir)</a></li>
<li class="chapter" data-level="8.7.4" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-vectors"><i class="fa fa-check"></i><b>8.7.4</b> Exercise (vectors)</a></li>
<li class="chapter" data-level="8.7.5" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-matrices"><i class="fa fa-check"></i><b>8.7.5</b> Exercise (matrices)</a></li>
<li class="chapter" data-level="8.7.6" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-data-frames"><i class="fa fa-check"></i><b>8.7.6</b> Exercise (data frames)</a></li>
<li class="chapter" data-level="8.7.7" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-lists"><i class="fa fa-check"></i><b>8.7.7</b> Exercise (lists)</a></li>
<li class="chapter" data-level="8.7.8" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#ex-strings"><i class="fa fa-check"></i><b>8.7.8</b> Exercise (string management)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html"><i class="fa fa-check"></i><b>9</b> Loops and conditionals</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#lo-loops"><i class="fa fa-check"></i><b>9.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="9.2" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#r-dc-loops-cond"><i class="fa fa-check"></i><b>9.2</b> Conditionals and control flow</a></li>
<li class="chapter" data-level="9.3" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#r-loops"><i class="fa fa-check"></i><b>9.3</b> Loops</a></li>
<li class="chapter" data-level="9.4" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#rc-r-loops-cond"><i class="fa fa-check"></i><b>9.4</b> Recap</a></li>
<li class="chapter" data-level="9.5" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-loops-cond"><i class="fa fa-check"></i><b>9.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-conditional-expressions"><i class="fa fa-check"></i><b>9.5.1</b> Exercise (conditional expressions)</a></li>
<li class="chapter" data-level="9.5.2" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-loops"><i class="fa fa-check"></i><b>9.5.2</b> Exercise (loops)</a></li>
<li class="chapter" data-level="9.5.3" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-search-vector"><i class="fa fa-check"></i><b>9.5.3</b> Exercise (search vector)</a></li>
<li class="chapter" data-level="9.5.4" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-dist"><i class="fa fa-check"></i><b>9.5.4</b> Exercise (calculating distances)</a></li>
<li class="chapter" data-level="9.5.5" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-expand"><i class="fa fa-check"></i><b>9.5.5</b> Exercise (expand_grid)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mod-r-functions.html"><a href="mod-r-functions.html"><i class="fa fa-check"></i><b>10</b> Functions</a>
<ul>
<li class="chapter" data-level="10.1" data-path="mod-r-functions.html"><a href="mod-r-functions.html#lo-r-functions"><i class="fa fa-check"></i><b>10.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="10.2" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-dc-functions"><i class="fa fa-check"></i><b>10.2</b> DataCamp course</a></li>
<li class="chapter" data-level="10.3" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-extra"><i class="fa fa-check"></i><b>10.3</b> Functions returning multiple objects</a></li>
<li class="chapter" data-level="10.4" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-arg"><i class="fa fa-check"></i><b>10.4</b> The <code>...</code> argument</a></li>
<li class="chapter" data-level="10.5" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-doc"><i class="fa fa-check"></i><b>10.5</b> Documenting your functions</a></li>
<li class="chapter" data-level="10.6" data-path="mod-r-functions.html"><a href="mod-r-functions.html#example---job-sequencing"><i class="fa fa-check"></i><b>10.6</b> Example - Job sequencing</a></li>
<li class="chapter" data-level="10.7" data-path="mod-r-functions.html"><a href="mod-r-functions.html#rc-functions"><i class="fa fa-check"></i><b>10.7</b> Recap</a></li>
<li class="chapter" data-level="10.8" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-functions"><i class="fa fa-check"></i><b>10.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-def-func"><i class="fa fa-check"></i><b>10.8.1</b> Exercise (defining functions)</a></li>
<li class="chapter" data-level="10.8.2" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-euclidean-distances"><i class="fa fa-check"></i><b>10.8.2</b> Exercise (euclidean distances)</a></li>
<li class="chapter" data-level="10.8.3" data-path="mod-r-functions.html"><a href="mod-r-functions.html#exercise-scope"><i class="fa fa-check"></i><b>10.8.3</b> Exercise (scope)</a></li>
<li class="chapter" data-level="10.8.4" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-time-conversion"><i class="fa fa-check"></i><b>10.8.4</b> Exercise (time conversion)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html"><i class="fa fa-check"></i><b>11</b> Introduction to tidyverse and RMarkdown</a>
<ul>
<li class="chapter" data-level="11.1" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#lo-tidyverse-intro"><i class="fa fa-check"></i><b>11.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="11.2" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-tidyverse-intro"><i class="fa fa-check"></i><b>11.2</b> The tidyverse package</a></li>
<li class="chapter" data-level="11.3" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-markdown-intro"><i class="fa fa-check"></i><b>11.3</b> Writing reproducible reports</a></li>
<li class="chapter" data-level="11.4" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-tibbles-intro"><i class="fa fa-check"></i><b>11.4</b> Tibbles</a></li>
<li class="chapter" data-level="11.5" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#rc-tidyverse-intro"><i class="fa fa-check"></i><b>11.5</b> Recap</a></li>
<li class="chapter" data-level="11.6" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#ex-tidyverse-intro"><i class="fa fa-check"></i><b>11.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#exercise-your-first-rmarkdown-exercise"><i class="fa fa-check"></i><b>11.6.1</b> Exercise (your first RMarkdown exercise)</a></li>
<li class="chapter" data-level="11.6.2" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#exercise-tibbles"><i class="fa fa-check"></i><b>11.6.2</b> Exercise (tibbles)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mod-r-io.html"><a href="mod-r-io.html"><i class="fa fa-check"></i><b>12</b> Importing and exporting data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="mod-r-io.html"><a href="mod-r-io.html#lo-r-io"><i class="fa fa-check"></i><b>12.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="12.2" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-csv"><i class="fa fa-check"></i><b>12.2</b> CSV files</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="mod-r-io.html"><a href="mod-r-io.html#reading-a-csv-file"><i class="fa fa-check"></i><b>12.2.1</b> Reading a CSV file</a></li>
<li class="chapter" data-level="12.2.2" data-path="mod-r-io.html"><a href="mod-r-io.html#writing-to-csv-files"><i class="fa fa-check"></i><b>12.2.2</b> Writing to CSV files</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-excel"><i class="fa fa-check"></i><b>12.3</b> Excel</a></li>
<li class="chapter" data-level="12.4" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-google"><i class="fa fa-check"></i><b>12.4</b> Google Sheets</a></li>
<li class="chapter" data-level="12.5" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-text"><i class="fa fa-check"></i><b>12.5</b> Text files</a></li>
<li class="chapter" data-level="12.6" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-r"><i class="fa fa-check"></i><b>12.6</b> R’s native binary format</a></li>
<li class="chapter" data-level="12.7" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-json"><i class="fa fa-check"></i><b>12.7</b> Json</a></li>
<li class="chapter" data-level="12.8" data-path="mod-r-io.html"><a href="mod-r-io.html#rc-r-io"><i class="fa fa-check"></i><b>12.8</b> Recap</a></li>
<li class="chapter" data-level="12.9" data-path="mod-r-io.html"><a href="mod-r-io.html#ex-r-io"><i class="fa fa-check"></i><b>12.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="mod-r-io.html"><a href="mod-r-io.html#exercise-statistikbanken"><i class="fa fa-check"></i><b>12.9.1</b> Exercise (Statistikbanken)</a></li>
<li class="chapter" data-level="12.9.2" data-path="mod-r-io.html"><a href="mod-r-io.html#exercise-tuples-in-opl"><i class="fa fa-check"></i><b>12.9.2</b> Exercise (tuples in OPL)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="mod-r-transform.html"><a href="mod-r-transform.html"><i class="fa fa-check"></i><b>13</b> Transforming data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="mod-r-transform.html"><a href="mod-r-transform.html#lo-r-transform"><i class="fa fa-check"></i><b>13.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="13.2" data-path="mod-r-transform.html"><a href="mod-r-transform.html#r-transform-tidyverse"><i class="fa fa-check"></i><b>13.2</b> Working with data in the tidyverse</a></li>
<li class="chapter" data-level="13.3" data-path="mod-r-transform.html"><a href="mod-r-transform.html#r-transform-joins"><i class="fa fa-check"></i><b>13.3</b> Mutating joins</a></li>
<li class="chapter" data-level="13.4" data-path="mod-r-transform.html"><a href="mod-r-transform.html#rc-r-transform"><i class="fa fa-check"></i><b>13.4</b> Recap</a></li>
<li class="chapter" data-level="13.5" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-transform"><i class="fa fa-check"></i><b>13.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-gapminder1"><i class="fa fa-check"></i><b>13.5.1</b> Exercise (gapminder)</a></li>
<li class="chapter" data-level="13.5.2" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-babynames1"><i class="fa fa-check"></i><b>13.5.2</b> Exercise (babynames)</a></li>
<li class="chapter" data-level="13.5.3" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-profit1"><i class="fa fa-check"></i><b>13.5.3</b> Exercise (profit)</a></li>
<li class="chapter" data-level="13.5.4" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-fish"><i class="fa fa-check"></i><b>13.5.4</b> Exercise (fisheries)</a></li>
<li class="chapter" data-level="13.5.5" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-company"><i class="fa fa-check"></i><b>13.5.5</b> Exercise (company ranking)</a></li>
<li class="chapter" data-level="13.5.6" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-titanic"><i class="fa fa-check"></i><b>13.5.6</b> Exercise (Titanic)</a></li>
<li class="chapter" data-level="13.5.7" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-covid"><i class="fa fa-check"></i><b>13.5.7</b> Exercise (covid)</a></li>
<li class="chapter" data-level="13.5.8" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-election"><i class="fa fa-check"></i><b>13.5.8</b> Exercise (election)</a></li>
<li class="chapter" data-level="13.5.9" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-orders"><i class="fa fa-check"></i><b>13.5.9</b> Exercise (orders)</a></li>
<li class="chapter" data-level="13.5.10" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-jobs"><i class="fa fa-check"></i><b>13.5.10</b> Exercise (jobs)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="mod-r-plot.html"><a href="mod-r-plot.html"><i class="fa fa-check"></i><b>14</b> Data visualization using ggplot</a>
<ul>
<li class="chapter" data-level="14.1" data-path="mod-r-plot.html"><a href="mod-r-plot.html#lo-plot"><i class="fa fa-check"></i><b>14.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="14.2" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-intro"><i class="fa fa-check"></i><b>14.2</b> Introduction to data visualization</a></li>
<li class="chapter" data-level="14.3" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-multi"><i class="fa fa-check"></i><b>14.3</b> Combining plots into one using <em>patchwork</em></a></li>
<li class="chapter" data-level="14.4" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-save"><i class="fa fa-check"></i><b>14.4</b> Saving graphics</a></li>
<li class="chapter" data-level="14.5" data-path="mod-r-plot.html"><a href="mod-r-plot.html#rc-r-plot"><i class="fa fa-check"></i><b>14.5</b> Recap</a></li>
<li class="chapter" data-level="14.6" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-plot"><i class="fa fa-check"></i><b>14.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-gapminder2"><i class="fa fa-check"></i><b>14.6.1</b> Exercise (gapminder)</a></li>
<li class="chapter" data-level="14.6.2" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-profit2"><i class="fa fa-check"></i><b>14.6.2</b> Exercise (profit)</a></li>
<li class="chapter" data-level="14.6.3" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-covid19"><i class="fa fa-check"></i><b>14.6.3</b> Exercise (COVID-19)</a></li>
<li class="chapter" data-level="14.6.4" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-lego"><i class="fa fa-check"></i><b>14.6.4</b> Exercise (Lego and sales)</a></li>
<li class="chapter" data-level="14.6.5" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-company-plot"><i class="fa fa-check"></i><b>14.6.5</b> Exercise (company ranking)</a></li>
<li class="chapter" data-level="14.6.6" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-titanic-plot"><i class="fa fa-check"></i><b>14.6.6</b> Exercise (Titanic)</a></li>
<li class="chapter" data-level="14.6.7" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-covid-plot"><i class="fa fa-check"></i><b>14.6.7</b> Exercise (covid)</a></li>
<li class="chapter" data-level="14.6.8" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-election-plot"><i class="fa fa-check"></i><b>14.6.8</b> Exercise (election)</a></li>
<li class="chapter" data-level="14.6.9" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-orders-plot"><i class="fa fa-check"></i><b>14.6.9</b> Exercise (orders)</a></li>
<li class="chapter" data-level="14.6.10" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-nycflights"><i class="fa fa-check"></i><b>14.6.10</b> Exercise (New York flights)</a></li>
<li class="chapter" data-level="14.6.11" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-jobs-plot"><i class="fa fa-check"></i><b>14.6.11</b> Exercise (jobs)</a></li>
<li class="chapter" data-level="14.6.12" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-onecom"><i class="fa fa-check"></i><b>14.6.12</b> Exercise (OneCom)</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Extra R</b></span></li>
<li class="chapter" data-level="15" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html"><i class="fa fa-check"></i><b>15</b> Fitting probability distributions</a>
<ul>
<li class="chapter" data-level="15.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#lo-r-dist-fit"><i class="fa fa-check"></i><b>15.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="15.2" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-intro"><i class="fa fa-check"></i><b>15.2</b> Introduction</a></li>
<li class="chapter" data-level="15.3" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-cont"><i class="fa fa-check"></i><b>15.3</b> Fitting distributions to continuous data</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#example-breakdown-times"><i class="fa fa-check"></i><b>15.3.1</b> Example: breakdown times</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-discrete"><i class="fa fa-check"></i><b>15.4</b> Fitting distributions to discrete data</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#example-sales-of-lottery-tickets"><i class="fa fa-check"></i><b>15.4.1</b> Example: sales of lottery tickets</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-dist-fit-pois"><i class="fa fa-check"></i><b>15.5</b> The Poisson process</a></li>
<li class="chapter" data-level="15.6" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#rc-r-dist-fit"><i class="fa fa-check"></i><b>15.6</b> Recap</a></li>
<li class="chapter" data-level="15.7" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#ex-r-dist-fit"><i class="fa fa-check"></i><b>15.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#exercise---call-center"><i class="fa fa-check"></i><b>15.7.1</b> Exercise - Call center</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="mod-r-maps.html"><a href="mod-r-maps.html"><i class="fa fa-check"></i><b>16</b> Spatial data and maps</a>
<ul>
<li class="chapter" data-level="16.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#lo-maps"><i class="fa fa-check"></i><b>16.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="16.2" data-path="mod-r-maps.html"><a href="mod-r-maps.html#sec-map-api-key"><i class="fa fa-check"></i><b>16.2</b> Services for obtatining spatial data</a></li>
<li class="chapter" data-level="16.3" data-path="mod-r-maps.html"><a href="mod-r-maps.html#calculating-distances"><i class="fa fa-check"></i><b>16.3</b> Calculating distances</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#using-google-maps"><i class="fa fa-check"></i><b>16.3.1</b> Using Google Maps</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="mod-r-maps.html"><a href="mod-r-maps.html#geocoding-and-reverse-geocoding"><i class="fa fa-check"></i><b>16.4</b> Geocoding and reverse geocoding</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#using-google-maps-1"><i class="fa fa-check"></i><b>16.4.1</b> Using Google maps</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="mod-r-maps.html"><a href="mod-r-maps.html#adding-markers-and-routes-to-a-map"><i class="fa fa-check"></i><b>16.5</b> Adding markers and routes to a map</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="groups.html"><a href="groups.html"><i class="fa fa-check"></i><b>A</b> Working in groups</a>
<ul>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#using-git"><i class="fa fa-check"></i>Using Git together with GitHub</a>
<ul>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#register-a-free-github-account"><i class="fa fa-check"></i>Register a free GitHub account</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#install-git"><i class="fa fa-check"></i>Install Git</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#check-your-installation"><i class="fa fa-check"></i>Check your installation</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#setup-projects-using-git-and-github"><i class="fa fa-check"></i>Setup projects using Git and GitHub</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="annotate.html"><a href="annotate.html"><i class="fa fa-check"></i><b>B</b> Annotate the course notes</a></li>
<li class="chapter" data-level="C" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>C</b> Getting help</a></li>
<li class="chapter" data-level="D" data-path="coding-convention.html"><a href="coding-convention.html"><i class="fa fa-check"></i><b>D</b> Coding/naming convention</a>
<ul>
<li class="chapter" data-level="D.1" data-path="coding-convention.html"><a href="coding-convention.html#commenting-your-code"><i class="fa fa-check"></i><b>D.1</b> Commenting your code</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="apdx-vba.html"><a href="apdx-vba.html"><i class="fa fa-check"></i><b>E</b> VBA specific topics</a>
<ul>
<li class="chapter" data-level="E.1" data-path="apdx-vba.html"><a href="apdx-vba.html#vba-debug"><i class="fa fa-check"></i><b>E.1</b> Debugging your code</a></li>
<li class="chapter" data-level="E.2" data-path="apdx-vba.html"><a href="apdx-vba.html#error-handling"><i class="fa fa-check"></i><b>E.2</b> Error handling</a></li>
<li class="chapter" data-level="E.3" data-path="apdx-vba.html"><a href="apdx-vba.html#vba-course-procedures"><i class="fa fa-check"></i><b>E.3</b> Course procedures</a>
<ul>
<li class="chapter" data-level="E.3.1" data-path="apdx-vba.html"><a href="apdx-vba.html#detailed-descriptions-of-course-procedures"><i class="fa fa-check"></i><b>E.3.1</b> Detailed descriptions of course procedures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="F" data-path="lg-course.html"><a href="lg-course.html"><i class="fa fa-check"></i><b>F</b> Learning goals</a></li>
<li class="chapter" data-level="G" data-path="ba.html"><a href="ba.html"><i class="fa fa-check"></i><b>G</b> Business Analytics</a></li>
<li class="chapter" data-level="H" data-path="colophon.html"><a href="colophon.html"><i class="fa fa-check"></i><b>H</b> Colophon</a></li>
<li class="divider"></li>
<li><center>
  <a rel="license" href="./index.html#ack">
    License: CC BY-NC-SA<br>
    <i class = "fab fa-creative-commons fa-2x"></i>
    <i class = "fab fa-creative-commons-by fa-2x"></i>
    <i class = "fab fa-creative-commons-nc fa-2x"></i>
    <i class = "fab fa-creative-commons-sa fa-2x"></i>
  </a>
</li></center>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tools for Analytics (TFA)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod-r-plot" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">Module 14</span> Data visualization using ggplot<a href="mod-r-plot.html#mod-r-plot" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module considers visualization of your data using the <a href="https://ggplot2.tidyverse.org/">ggplot2</a> package which is a part of <a href="https://www.tidyverse.org">tidyverse</a>. R has several systems for making plots, but ggplot2 is one of the most elegant and most versatile. Using ggplot2 you can make plots faster by learning one system and applying it in many different plot types.</p>
<p>A template project for this module is given on <a href="https://posit.cloud/spaces/426101/content/6689208">Posit Cloud</a> (open it and use it while reading the notes).</p>
<div id="learning-path-diagram-13" class="section level4 unnumbered hasAnchor">
<h4>Learning path diagram<a href="mod-r-plot.html#learning-path-diagram-13" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="grViz html-widget html-fill-item" id="htmlwidget-7edbd65d0fb7dd2fe196" style="width:100%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-7edbd65d0fb7dd2fe196">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"💡 Plot intro\", URL = \"#r-plot-intro\", tooltip = \"The interactive DataCamp course Introduction to data visualization with ggplot2.\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", width = \"0.5\", pos = \"0,2!\"] \n  \"2\" [label = \"📖 Multiple plots\", URL = \"#r-plot-multi\", tooltip = \"Multiple plots\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"rect\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", width = \"0.5\", pos = \"2,2!\"] \n  \"3\" [label = \"📖 Saving plots\", URL = \"#r-plot-save\", tooltip = \"Saving plots\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"rect\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", width = \"0.5\", pos = \"4,2!\"] \n  \"4\" [label = \"💻 Exercises\", URL = \"#ex-r-plot\", tooltip = \"Exercises\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", width = \"0.5\", pos = \"6,2!\"] \n  \"5\" [label = \"📖 Plotting\", URL = \"https://stat545.com/\", tooltip = \"A detailed introduction to visualization using ggplot2 is given in Chapters 22-29 in Bryan (2017).\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"rect\", margin = \"0.2\", fillcolor = \"PeachPuff3\", width = \"0.5\", pos = \"0,4!\"] \n  \"6\" [label = \"📖 Plotting\", URL = \"https://r4ds.had.co.nz/data-visualisation.html\", tooltip = \"A short introduction is given in Chapter 3 in Wickham (2017).\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"rect\", margin = \"0.2\", fillcolor = \"DarkOrange4\", width = \"0.5\", pos = \"0,0!\"] \n  \"7\" [label = \"💡 Adv. plotting\", URL = \"https://app.datacamp.com/learn/courses/intermediate-data-visualization-with-ggplot2\", tooltip = \"The interactive DataCamp course Intermediate Data Visualization with ggplot2.\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"PeachPuff3\", width = \"0.5\", pos = \"2,4!\"] \n  \"8\" [label = \"\", URL = \"\", tooltip = \" \", style = \"filled\", fixedsize = \"true\", fontsize = \"9\", fontcolor = \"white\", penwidth = \"0.5\", fontname = \"Helvetica\", shape = \"rect\", fillcolor = \"#F0F8FF\", height = \"1\", width = \"6\", pos = \"4.15,0.21!\"] \n  \"9\" [label = \"Color:\", URL = \"\", tooltip = \" \", style = \"filled\", fixedsize = \"true\", fontsize = \"9\", fontcolor = \"black\", penwidth = \"0\", fontname = \"Helvetica\", shape = \"none\", fillcolor = \"#FFFFFE\", height = \"0\", width = \"0.8\", pos = \"1.52,0.55!\"] \n  \"10\" [label = \"mandatory\", URL = \"\", tooltip = \"Mandatory syllabus.\", style = \"filled\", fixedsize = \"true\", fontsize = \"9\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica\", shape = \"rect\", fillcolor = \"DarkSeaGreen4\", width = \"0.8\", pos = \"1.75,0.15!\"] \n  \"11\" [label = \"alternative\", URL = \"\", tooltip = \"Alternative syllabus if you prefer another learning style.\", style = \"filled\", fixedsize = \"true\", fontsize = \"9\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica\", shape = \"rect\", fillcolor = \"DarkOrange4\", width = \"0.8\", pos = \"2.75,0.15!\"] \n  \"12\" [label = \"extra\", URL = \"\", tooltip = \"Extra learning if you are interested (not part of syllabus).\", style = \"filled\", fixedsize = \"true\", fontsize = \"9\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica\", shape = \"rect\", fillcolor = \"PeachPuff3\", width = \"0.8\", pos = \"3.75,0.15!\"] \n  \"13\" [label = \"Shape:\", URL = \"\", tooltip = \" \", style = \"filled\", fixedsize = \"true\", fontsize = \"9\", fontcolor = \"black\", penwidth = \"0\", fontname = \"Helvetica\", shape = \"none\", fillcolor = \"#FFFFFE\", height = \"0\", width = \"1\", pos = \"4.95,0.55!\"] \n  \"14\" [label = \"non-interactive\", URL = \"\", tooltip = \"Non-interactive learning content (e.g. reading).\", style = \"filled\", fixedsize = \"true\", fontsize = \"9\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica\", shape = \"rect\", fillcolor = \"Grey40\", width = \"1\", pos = \"5.25,0.15!\"] \n  \"15\" [label = \"interactive\", URL = \"\", tooltip = \"Interactive learning content (tutorial, exercises etc.).\", style = \"filled\", fixedsize = \"true\", fontsize = \"9\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica\", shape = \"egg\", fillcolor = \"Grey40\", width = \"1\", pos = \"6.5,0.15!\"] \n\"1\"->\"2\" [color = \"black\", arrowhead = \"vee\"] \n\"1\"->\"5\" [color = \"black\", arrowhead = \"vee\"] \n\"1\"->\"6\" [color = \"black\", arrowhead = \"vee\"] \n\"1\"->\"7\" [color = \"black\", arrowhead = \"vee\"] \n\"2\"->\"3\" [color = \"black\", arrowhead = \"vee\"] \n\"3\"->\"4\" [color = \"black\", arrowhead = \"vee\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<div>It is recommended that you follow the green learning path; however, you may like a different learning style. In the learning path diagram, there are links to alternative online content (video or reading). Note this is an alternative to the standard learning path that you may use instead (you should not do both). The learning path may also have extra content, that is NOT a part of syllabus (only look at it if you want more info)!</div>
<!-- * A detailed introduction to visualization using ggplot2 is given in Chapters 22-29 in @stat545.  -->
<!-- * A short introduction is given in [Chapter 3](https://r4ds.had.co.nz/data-visualisation.html) in @r4ds. -->
<!-- * Further advanded possibilities for ggplot2 are given in the interactive DataCamp course [Intermediate Data Visualization with ggplot2][datacamp-r-ggplot2-intermediate]. -->
</div>
<div id="lo-plot" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> Learning outcomes<a href="mod-r-plot.html#lo-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By the end of this module, you are expected to:</p>
<ul>
<li>Know how to create basic plots using ggplot.</li>
<li>Formulate the ideas behind the grammar of graphics.</li>
<li>Explain the idea behind aesthetics such as color, fill, and line type.</li>
<li>Add geometries to a plot such as a histogram, a boxplot, a barplot, a scatter plot, and a line.</li>
<li>Understand how themes can be used to modify the overall look of a plot.</li>
<li>Combine multiple plots into a single graphic.</li>
<li>Save plots as variables and different image files.</li>
</ul>
<p>The learning outcomes relate to the <a href="lg-course.html#lg-course">overall learning goals</a> number 7, 11-14 and 18 of the course.</p>
<!-- SOLO increasing: identify · memorise · name · do simple procedure · collect data · -->
<!-- enumerate · describe · interpret · formulate · list · paraphrase · combine · do -->
<!-- algorithms · compare · contrast · explain causes · analyse · relate · derive · -->
<!-- evaluate · apply · argue · theorise · generalise · hypothesise · solve · reflect -->
</div>
<div id="r-plot-intro" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> Introduction to data visualization<a href="mod-r-plot.html#r-plot-intro" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The package <a href="https://ggplot2.tidyverse.org/">ggplot2</a> is a plotting package that makes it simple to create complex plots from data in a data frame. It provides an interface for specifying which variables to plot, how they are displayed, and general visual properties. Hence, only minimal changes are needed, if the underlying data change or if we decide to change from a bar plot to a scatterplot.</p>
<p>The package implements the grammar of graphics, a coherent system for describing and building layered plots. A plot is built step by step by adding new layers. Adding layers in this fashion allows for extensive flexibility and customization of plots.</p>
<p>An excellent introduction to data visualization using <a href="https://ggplot2.tidyverse.org/">ggplot2</a> is given in the interactive DataCamp course <a href="https://learn.datacamp.com/courses/introduction-to-data-visualization-with-ggplot2">Introduction to data visualization with ggplot2</a>. Please complete the course before continuing.</p>
<p>Note that there is a difference between using the pipe <code>|&gt;</code> operator which passes the output of the previous line of code as the first input of the next line of code and the <code>+</code> operator used between <strong>ggplot2</strong> functions for “layering”. That is, you create the plot in layers, separated by <code>+</code>.</p>
</div>
<div id="r-plot-multi" class="section level2 hasAnchor" number="14.3">
<h2><span class="header-section-number">14.3</span> Combining plots into one using <em>patchwork</em><a href="mod-r-plot.html#r-plot-multi" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can combine separate ggplots into the same graphic using the <em>patchwork</em> package. You can install <em>patchwork</em> from CRAN using <code>install.packages('patchwork')</code>.</p>
<p>The usage is simple. Plots in two rows:</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="mod-r-plot.html#cb634-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb634-2"><a href="mod-r-plot.html#cb634-2" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb634-3"><a href="mod-r-plot.html#cb634-3" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(mpg, disp))</span>
<span id="cb634-4"><a href="mod-r-plot.html#cb634-4" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(gear, disp, <span class="at">group =</span> gear))</span>
<span id="cb634-5"><a href="mod-r-plot.html#cb634-5" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-517-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The package provides rich support for arbitrarily complex layouts. Code for nesting three
plots on top of a third:</p>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="mod-r-plot.html#cb635-1" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(disp, qsec))</span>
<span id="cb635-2"><a href="mod-r-plot.html#cb635-2" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(carb))</span>
<span id="cb635-3"><a href="mod-r-plot.html#cb635-3" tabindex="-1"></a>(p1 <span class="sc">|</span> p2 <span class="sc">|</span> p3) <span class="sc">/</span></span>
<span id="cb635-4"><a href="mod-r-plot.html#cb635-4" tabindex="-1"></a>      p4</span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-518-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>For further examples see the <a href="https://patchwork.data-imaginist.com/">documentation pages</a>.</p>
</div>
<div id="r-plot-save" class="section level2 hasAnchor" number="14.4">
<h2><span class="header-section-number">14.4</span> Saving graphics<a href="mod-r-plot.html#r-plot-save" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In general, when you do analytics using R Markdown, there is no need to save your graphics. This is done automatically. However, in a few cases you may need to save you graphics in different formats. Let us consider a simple plot:</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="mod-r-plot.html#cb636-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb636-2"><a href="mod-r-plot.html#cb636-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span> </span>
<span id="cb636-3"><a href="mod-r-plot.html#cb636-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb636-4"><a href="mod-r-plot.html#cb636-4" tabindex="-1"></a>p  <span class="co"># print it out</span></span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-519-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>To save the plot as a bitmap image (png, jpeg etc) have a look at the documentation (<code>?png</code>). Let us try to save the plot as a png file.</p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="mod-r-plot.html#cb637-1" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;test1.png&quot;</span>)  <span class="co"># open png device for writing </span></span>
<span id="cb637-2"><a href="mod-r-plot.html#cb637-2" tabindex="-1"></a>p</span>
<span id="cb637-3"><a href="mod-r-plot.html#cb637-3" tabindex="-1"></a><span class="fu">dev.off</span>()        <span class="co"># close device</span></span>
<span id="cb637-4"><a href="mod-r-plot.html#cb637-4" tabindex="-1"></a><span class="co">#&gt; png </span></span>
<span id="cb637-5"><a href="mod-r-plot.html#cb637-5" tabindex="-1"></a><span class="co">#&gt;   2</span></span>
<span id="cb637-6"><a href="mod-r-plot.html#cb637-6" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;test2.png&quot;</span>, <span class="at">width =</span> <span class="dv">1200</span>, <span class="at">height =</span> <span class="dv">600</span>)   <span class="co"># use other output width and height in px</span></span>
<span id="cb637-7"><a href="mod-r-plot.html#cb637-7" tabindex="-1"></a>p</span>
<span id="cb637-8"><a href="mod-r-plot.html#cb637-8" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb637-9"><a href="mod-r-plot.html#cb637-9" tabindex="-1"></a><span class="co">#&gt; png </span></span>
<span id="cb637-10"><a href="mod-r-plot.html#cb637-10" tabindex="-1"></a><span class="co">#&gt;   2</span></span>
<span id="cb637-11"><a href="mod-r-plot.html#cb637-11" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;test3.png&quot;</span>, <span class="at">width =</span> <span class="dv">1200</span>, <span class="at">height =</span> <span class="dv">900</span>)   <span class="co"># save a patchwork plot</span></span>
<span id="cb637-12"><a href="mod-r-plot.html#cb637-12" tabindex="-1"></a>(p1 <span class="sc">|</span> p2 <span class="sc">|</span> p3) <span class="sc">/</span></span>
<span id="cb637-13"><a href="mod-r-plot.html#cb637-13" tabindex="-1"></a>      p4</span>
<span id="cb637-14"><a href="mod-r-plot.html#cb637-14" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</span></span>
<span id="cb637-15"><a href="mod-r-plot.html#cb637-15" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb637-16"><a href="mod-r-plot.html#cb637-16" tabindex="-1"></a><span class="co">#&gt; png </span></span>
<span id="cb637-17"><a href="mod-r-plot.html#cb637-17" tabindex="-1"></a><span class="co">#&gt;   2</span></span>
<span id="cb637-18"><a href="mod-r-plot.html#cb637-18" tabindex="-1"></a><span class="co"># browseURL(&quot;test1.png&quot;)  # to have a look at the file</span></span>
<span id="cb637-19"><a href="mod-r-plot.html#cb637-19" tabindex="-1"></a><span class="co"># browseURL(&quot;test3.png&quot;)  # to have a look at the file</span></span></code></pre></div>
<p>To save the plot as a pdf use</p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="mod-r-plot.html#cb638-1" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;test1.pdf&quot;</span>)  <span class="co"># open pdf device for writing </span></span>
<span id="cb638-2"><a href="mod-r-plot.html#cb638-2" tabindex="-1"></a>p</span>
<span id="cb638-3"><a href="mod-r-plot.html#cb638-3" tabindex="-1"></a><span class="fu">dev.off</span>()        <span class="co"># close device</span></span>
<span id="cb638-4"><a href="mod-r-plot.html#cb638-4" tabindex="-1"></a><span class="co">#&gt; png </span></span>
<span id="cb638-5"><a href="mod-r-plot.html#cb638-5" tabindex="-1"></a><span class="co">#&gt;   2</span></span>
<span id="cb638-6"><a href="mod-r-plot.html#cb638-6" tabindex="-1"></a><span class="co"># browseURL(&quot;test1.pdf&quot;)  # to have a look at the file</span></span></code></pre></div>
<p>If you use LaTeX you may use the <em>tikzDevice</em> package to save plots as TikZ.</p>
</div>
<div id="rc-r-plot" class="section level2 hasAnchor" number="14.5">
<h2><span class="header-section-number">14.5</span> Recap<a href="mod-r-plot.html#rc-r-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>The tidyverse package <a href="https://ggplot2.tidyverse.org/">ggplot2</a> is an R package for producing data visualizations. It is based on the Grammar of Graphics by <span class="citation">Wilkinson (<a href="#ref-gramma">2005</a>)</span>.</li>
<li>The grammar of graphics is a coherent system for describing and building layered plots.
<ul>
<li>Graphics are made by grammatical elements such as data, aesthetics, geometries, scales, facets, and themes.</li>
<li>Plots are made though aesthetic mappings. That is, variables are mapped to x or y position using aesthetics attributes such as color, shape, or size.</li>
<li>A plot is built step by step by adding new layers. Adding layers in this fashion allows for extensive flexibility and customization of plots.</li>
<li>Together, the data, aesthetic mappings, and geometric object form a layer.</li>
<li>A plot may have multiple layers, for example, when we overlay a scatterplot with a smoothed line.</li>
</ul></li>
<li>Aesthetics are add in <code>ggplot</code> using the <code>aes</code> function or alternatively in <code>geom_</code> functions.</li>
<li>Geometries (e.g. a boxplot or line) are added to a plot using the <code>geom_</code> functions.</li>
<li>Themes can be applied to the plot using the <code>theme_</code> functions and control all the non-data ink used to modify the overall look of a plot.</li>
<li>Separate ggplots can be combined into the same graphic using the <em>patchwork</em> package.</li>
<li>Save plots as variables and different image files using the device functions such as <code>png</code> and <code>pdf</code>.</li>
<li>The pipe <code>|&gt;</code> operator is used to “pipe” the output of the previous line of code as the first input of the next line of code.</li>
<li>The <code>+</code> operator in <strong>ggplot2</strong> functions is used for “layering”. This means you create the plot in layers, separated by <code>+</code>.</li>
<li>The ‘Data visualization with ggplot2’ cheatsheet is very useful. Find the newest version in RStudio <strong>Help &gt; Cheatsheets</strong>.</li>
<li>A good place to see examples are on the <a href="https://ggplot2.tidyverse.org/reference/index.html">main reference page</a>. Follow the link to the function of interest and have a look at the examples.</li>
</ul>
<div>
You may also have a look at the
<a href="https://bss-osca.github.io/tfa/slides/14_r-plot-slides.html" target="_blank">slides for this module</a>
.
</div>
</div>
<div id="ex-r-plot" class="section level2 hasAnchor" number="14.6">
<h2><span class="header-section-number">14.6</span> Exercises<a href="mod-r-plot.html#ex-r-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Below you will find a set of exercises. Always have a look at the exercises before you meet in your study group and try to solve them yourself. Are you stuck, see the <a href="help.html#help">help page</a>. Some of the solutions to each exercise can be seen by pressing the button at each question. Beware, you will not learn by giving up too early. Put some effort into finding a solution! Always practice using shortcuts in RStudio (see <strong>Tools &gt; Keyboard Shortcuts Help</strong>).</p>
<p>Go to the <a href="https://posit.cloud/spaces/426101/join?access_code=GVlexpHQRCXUAiqRiC9ux_KgoAXUyilsrVtxjaB8">Tools for Analytics</a> workspace and download/export the TM14 project. Open it on your laptop and have a look at the files in the <code>exercises</code> folder which can be used as a starting point.</p>
<div id="ex-gapminder2" class="section level3 hasAnchor" number="14.6.1">
<h3><span class="header-section-number">14.6.1</span> Exercise (gapminder)<a href="mod-r-plot.html#ex-gapminder2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <em>exercise R Markdown template</em> to solve this exercise (<strong>File &gt; New File &gt; R Markdown…</strong>, select <strong>From template</strong> and then <strong>TFA Exercise</strong>).</p>
<p>In this exercise, we will demonstrate how relatively simple ggplot2 code can create insightful and aesthetically pleasing plots. As motivation we will create plots that help us better understand trends in world health and economics.</p>
<p><a href="https://en.wikipedia.org/wiki/Hans_Rosling">Hans Rosling</a> was the co-founder of the <a href="http://www.gapminder.org/">Gapminder Foundation</a>, an organization dedicated to educating the public by using data to dispel common myths about the so-called developing world. Hans Rosling conveyed actual data-based trends in a dramatic way of his own, using effective data visualization. Here we will try to answer two questions:</p>
<ul>
<li>Is it a fair characterization of today’s world to say it is divided into Western rich nations and the developing world in Africa, Asia, and Latin America?</li>
<li>Has income inequality across countries worsened during the last 40 years?</li>
</ul>
<p>To answer these questions, we will be using the <code>gapminder</code> dataset provided in the dslabs package. This dataset was created using a number of spreadsheets available from the Gapminder Foundation. You can access the table like this:</p>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="mod-r-plot.html#cb639-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb639-2"><a href="mod-r-plot.html#cb639-2" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb639-3"><a href="mod-r-plot.html#cb639-3" tabindex="-1"></a><span class="fu">data</span>(gapminder)</span>
<span id="cb639-4"><a href="mod-r-plot.html#cb639-4" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb639-5"><a href="mod-r-plot.html#cb639-5" tabindex="-1"></a><span class="co">#&gt; # A tibble: 10,545 × 9</span></span>
<span id="cb639-6"><a href="mod-r-plot.html#cb639-6" tabindex="-1"></a><span class="co">#&gt;    country      year infant_mortality life_expectancy fertility population      gdp continent region</span></span>
<span id="cb639-7"><a href="mod-r-plot.html#cb639-7" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;       &lt;int&gt;            &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt; </span></span>
<span id="cb639-8"><a href="mod-r-plot.html#cb639-8" tabindex="-1"></a><span class="co">#&gt;  1 Albania      1960            115.             62.9      6.19    1636054 NA       Europe    South…</span></span>
<span id="cb639-9"><a href="mod-r-plot.html#cb639-9" tabindex="-1"></a><span class="co">#&gt;  2 Algeria      1960            148.             47.5      7.65   11124892  1.38e10 Africa    North…</span></span>
<span id="cb639-10"><a href="mod-r-plot.html#cb639-10" tabindex="-1"></a><span class="co">#&gt;  3 Angola       1960            208              36.0      7.32    5270844 NA       Africa    Middl…</span></span>
<span id="cb639-11"><a href="mod-r-plot.html#cb639-11" tabindex="-1"></a><span class="co">#&gt;  4 Antigua an…  1960             NA              63.0      4.43      54681 NA       Americas  Carib…</span></span>
<span id="cb639-12"><a href="mod-r-plot.html#cb639-12" tabindex="-1"></a><span class="co">#&gt;  5 Argentina    1960             59.9            65.4      3.11   20619075  1.08e11 Americas  South…</span></span>
<span id="cb639-13"><a href="mod-r-plot.html#cb639-13" tabindex="-1"></a><span class="co">#&gt;  6 Armenia      1960             NA              66.9      4.55    1867396 NA       Asia      Weste…</span></span>
<span id="cb639-14"><a href="mod-r-plot.html#cb639-14" tabindex="-1"></a><span class="co">#&gt;  7 Aruba        1960             NA              65.7      4.82      54208 NA       Americas  Carib…</span></span>
<span id="cb639-15"><a href="mod-r-plot.html#cb639-15" tabindex="-1"></a><span class="co">#&gt;  8 Australia    1960             20.3            70.9      3.45   10292328  9.67e10 Oceania   Austr…</span></span>
<span id="cb639-16"><a href="mod-r-plot.html#cb639-16" tabindex="-1"></a><span class="co">#&gt;  9 Austria      1960             37.3            68.8      2.7     7065525  5.24e10 Europe    Weste…</span></span>
<span id="cb639-17"><a href="mod-r-plot.html#cb639-17" tabindex="-1"></a><span class="co">#&gt; 10 Azerbaijan   1960             NA              61.3      5.57    3897889 NA       Asia      Weste…</span></span>
<span id="cb639-18"><a href="mod-r-plot.html#cb639-18" tabindex="-1"></a><span class="co">#&gt; # ℹ 10,535 more rows</span></span></code></pre></div>
<p>We start by testing our knowledge regarding differences in child mortality across different countries. For each of the six pairs of countries below, which country do you think had the highest child mortality rates in 2015? Which pairs do you think are most similar?</p>
<ul>
<li>Sri Lanka or Turkey</li>
<li>Poland or South Korea</li>
<li>Malaysia or Russia</li>
<li>Pakistan or Vietnam</li>
<li>Thailand or South Africa</li>
</ul>
<p>When answering these questions without data, the non-European countries are typically picked as having higher child mortality rates: Sri Lanka over Turkey, South Korea over Poland, and Malaysia over Russia. It is also common to assume that countries considered to be part of the developing world: Pakistan, Vietnam, Thailand, and South Africa, have similarly high mortality rates.</p>
<p>To answer these questions <strong>with data</strong>, we can use <strong>dplyr</strong>. For example, for the first comparison we see that:</p>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="mod-r-plot.html#cb640-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span></span>
<span id="cb640-2"><a href="mod-r-plot.html#cb640-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2015</span> <span class="sc">&amp;</span> country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Sri Lanka&quot;</span>,<span class="st">&quot;Turkey&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb640-3"><a href="mod-r-plot.html#cb640-3" tabindex="-1"></a>  <span class="fu">select</span>(country, infant_mortality)</span>
<span id="cb640-4"><a href="mod-r-plot.html#cb640-4" tabindex="-1"></a><span class="co">#&gt;     country infant_mortality</span></span>
<span id="cb640-5"><a href="mod-r-plot.html#cb640-5" tabindex="-1"></a><span class="co">#&gt; 1 Sri Lanka              8.4</span></span>
<span id="cb640-6"><a href="mod-r-plot.html#cb640-6" tabindex="-1"></a><span class="co">#&gt; 2    Turkey             11.6</span></span></code></pre></div>
<p>Turkey has the higher infant mortality rate.</p>
<p>We can use this code on all comparisons and find the following:</p>
<pre><code>#&gt; New names:
#&gt; • `country` -&gt; `country...1`
#&gt; • `infant_mortality` -&gt; `infant_mortality...2`
#&gt; • `country` -&gt; `country...3`
#&gt; • `infant_mortality` -&gt; `infant_mortality...4`</code></pre>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
country
</th>
<th style="text-align:right;">
infant mortality
</th>
<th style="text-align:left;">
country
</th>
<th style="text-align:right;">
infant mortality
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sri Lanka
</td>
<td style="text-align:right;">
8.4
</td>
<td style="text-align:left;">
Turkey
</td>
<td style="text-align:right;">
11.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Poland
</td>
<td style="text-align:right;">
4.5
</td>
<td style="text-align:left;">
South Korea
</td>
<td style="text-align:right;">
2.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Malaysia
</td>
<td style="text-align:right;">
6.0
</td>
<td style="text-align:left;">
Russia
</td>
<td style="text-align:right;">
8.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Pakistan
</td>
<td style="text-align:right;">
65.8
</td>
<td style="text-align:left;">
Vietnam
</td>
<td style="text-align:right;">
17.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Thailand
</td>
<td style="text-align:right;">
10.5
</td>
<td style="text-align:left;">
South Africa
</td>
<td style="text-align:right;">
33.6
</td>
</tr>
</tbody>
</table>
<p>We see that the European countries on this list have higher child mortality rates: Poland has a higher rate than South Korea, and Russia has a higher rate than Malaysia. We also see that Pakistan has a much higher rate than Vietnam, and South Africa has a much higher rate than Thailand. It turns out that when Hans Rosling gave this quiz to educated groups of people, the average score was less than 2.5 out of 5, worse than what they would have obtained had they guessed randomly. This implies that we are misinformed. We will try to use visualization to help us being more informed.</p>
<div id="the-west-vs.-the-developing-world" class="section level4 unnumbered hasAnchor">
<h4>The west vs. the developing world<a href="mod-r-plot.html#the-west-vs.-the-developing-world" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There is a preconceived notion that the world is divided into two groups: the Western world (Western Europe and North America), characterized by long life spans and small families, versus the developing world (Africa, Asia, and Latin America) characterized by short life spans and large families. But do the data support this dichotomous view?</p>
<div id="solution-awv6Ta9IJUQnHf1yiomTE0fTNlNNjvfcHSE9h195" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-awv6Ta9IJUQnHf1yiomTE0fTNlNNjvfcHSE9h195-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-awv6Ta9IJUQnHf1yiomTE0fTNlNNjvfcHSE9h195-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="mod-r-plot.html#cb642-1" tabindex="-1"></a><span class="fu">filter</span>(gapminder, year <span class="sc">==</span> <span class="dv">1962</span>) <span class="sc">|&gt;</span></span>
<span id="cb642-2"><a href="mod-r-plot.html#cb642-2" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(fertility, life_expectancy, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb642-3"><a href="mod-r-plot.html#cb642-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-526-1.png" width="672" style="display: block; margin: auto;" />
<p>
Most points fall into two distinct categories:
</p>
<ol>
<li>
Life expectancy around 70 years and 3 or fewer children per family.
</li>
<li>
Life expectancy lower than 65 years and more than 5 children per family.
</li>
<li>
Countries are from the regions we expect.
</li>
</ol>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-awv6Ta9IJUQnHf1yiomTE0fTNlNNjvfcHSE9h195">
Solution
</button>
<div id="hint-7elKHuXrsPP5qz7d2hcMskIhOkpZK9" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-7elKHuXrsPP5qz7d2hcMskIhOkpZK9-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-7elKHuXrsPP5qz7d2hcMskIhOkpZK9-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="mod-r-plot.html#cb643-1" tabindex="-1"></a><span class="fu">filter</span>(gapminder, year <span class="sc">==</span> ___) <span class="sc">|&gt;</span></span>
<span id="cb643-2"><a href="mod-r-plot.html#cb643-2" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(___, ___, <span class="at">color =</span> ___)) <span class="sc">+</span></span>
<span id="cb643-3"><a href="mod-r-plot.html#cb643-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-7elKHuXrsPP5qz7d2hcMskIhOkpZK9">
Hint
</button>
<ol style="list-style-type: decimal">
<li>Make a scatterplot of life expectancy versus fertility rates (average number of children per woman) in 1962. Use continent as color aesthetic.</li>
</ol>
<div id="solution-81ChQ83rnCi3nUwipnveMYsR5LjxwQyKcZmA8E3j" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-81ChQ83rnCi3nUwipnveMYsR5LjxwQyKcZmA8E3j-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-81ChQ83rnCi3nUwipnveMYsR5LjxwQyKcZmA8E3j-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="mod-r-plot.html#cb644-1" tabindex="-1"></a><span class="fu">filter</span>(gapminder, year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">2012</span>)) <span class="sc">|&gt;</span></span>
<span id="cb644-2"><a href="mod-r-plot.html#cb644-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(fertility, life_expectancy, <span class="at">col =</span> continent)) <span class="sc">+</span></span>
<span id="cb644-3"><a href="mod-r-plot.html#cb644-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb644-4"><a href="mod-r-plot.html#cb644-4" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(year))</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-528-1.png" width="672" style="display: block; margin: auto;" />
<p>
This plot clearly shows that the majority of countries have moved from the <em>developing world</em> cluster to the <em>western world</em> one. In 2012, the western versus developing world view no longer makes sense. This is particularly clear when comparing Europe to Asia, the latter of which includes several countries that have made great improvements.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-81ChQ83rnCi3nUwipnveMYsR5LjxwQyKcZmA8E3j">
Solution
</button>
<div id="hint-iRUxPVMpyFpjmkUclrlRi1CMIm2152" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-iRUxPVMpyFpjmkUclrlRi1CMIm2152-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-iRUxPVMpyFpjmkUclrlRi1CMIm2152-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="mod-r-plot.html#cb645-1" tabindex="-1"></a><span class="fu">filter</span>(gapminder, ___ <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">2012</span>)) <span class="sc">|&gt;</span></span>
<span id="cb645-2"><a href="mod-r-plot.html#cb645-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(___, ___, <span class="at">col =</span> ___)) <span class="sc">+</span></span>
<span id="cb645-3"><a href="mod-r-plot.html#cb645-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb645-4"><a href="mod-r-plot.html#cb645-4" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(___))</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-iRUxPVMpyFpjmkUclrlRi1CMIm2152">
Hint
</button>
<ol start="2" style="list-style-type: decimal">
<li>In 1962, “the West versus developing world” view was grounded in some reality. Is this still the case 50 years later? We could easily plot the 2012 data in the same way we did for 1962. To make comparisons, side by side plots are preferable. In <strong>ggplot2</strong>, we can achieve this by <em>faceting</em> variables and making a plot for each year. That is, you must filter by years 1962 and 2012 and add the layer <code>facet_grid</code>, which automatically separates the plots.</li>
</ol>
<div id="solution-zVaXNtcT3hAbzlYoY5sF2oo0d05YAV6MInksYq2Q" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-zVaXNtcT3hAbzlYoY5sF2oo0d05YAV6MInksYq2Q-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-zVaXNtcT3hAbzlYoY5sF2oo0d05YAV6MInksYq2Q-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="mod-r-plot.html#cb646-1" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1962</span>, <span class="dv">1970</span>, <span class="dv">1980</span>, <span class="dv">1990</span>, <span class="dv">2000</span>, <span class="dv">2012</span>)</span>
<span id="cb646-2"><a href="mod-r-plot.html#cb646-2" tabindex="-1"></a>continents <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Europe&quot;</span>, <span class="st">&quot;Asia&quot;</span>)</span>
<span id="cb646-3"><a href="mod-r-plot.html#cb646-3" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb646-4"><a href="mod-r-plot.html#cb646-4" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> continent <span class="sc">%in%</span> continents) <span class="sc">|&gt;</span></span>
<span id="cb646-5"><a href="mod-r-plot.html#cb646-5" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(fertility, life_expectancy, <span class="at">col =</span> continent)) <span class="sc">+</span></span>
<span id="cb646-6"><a href="mod-r-plot.html#cb646-6" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb646-7"><a href="mod-r-plot.html#cb646-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(year)) </span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-530-1.png" width="672" style="display: block; margin: auto;" />
<p>
The plot clearly shows how most Asian countries have improved at a much faster rate than European ones.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-zVaXNtcT3hAbzlYoY5sF2oo0d05YAV6MInksYq2Q">
Solution
</button>
<div id="hint-9wmXb35ZtzgtGKVFWcNTQQR1kmqYhj" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-9wmXb35ZtzgtGKVFWcNTQQR1kmqYhj-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-9wmXb35ZtzgtGKVFWcNTQQR1kmqYhj-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="mod-r-plot.html#cb647-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb647-2"><a href="mod-r-plot.html#cb647-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> ___ <span class="sc">&amp;</span> continent <span class="sc">%in%</span> ___) <span class="sc">|&gt;</span></span>
<span id="cb647-3"><a href="mod-r-plot.html#cb647-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(___)) <span class="sc">+</span></span>
<span id="cb647-4"><a href="mod-r-plot.html#cb647-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb647-5"><a href="mod-r-plot.html#cb647-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(___) </span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-9wmXb35ZtzgtGKVFWcNTQQR1kmqYhj">
Hint
</button>
<ol start="3" style="list-style-type: decimal">
<li>To explore the transformation through the years, make a plot for the years 1962, 1970, 1980, 1990, 2000, and 2012 considering Europe and Asia. How has Asia transformed through the years compared to Europe? Since we consider many years, we will not want all the plots on the same row. Instead, we will want to use multiple rows and columns. The function <code>facet_wrap</code> permits us to do this by automatically wrapping the series of plots.</li>
</ol>
</div>
<div id="infobox---scales" class="section level4 unnumbered hasAnchor box">
<h4>Infobox - Scales<a href="mod-r-plot.html#infobox---scales" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The default choice of the range of the axes is important. When not using <code>facet</code>, this range is determined by the data shown in the plot. When using <code>facet</code>, this range is determined by the data shown in all plots and therefore kept fixed across plots. This makes comparisons across plots much easier. For example, in the above plot, we can see that life expectancy has increased and the fertility has decreased across most countries. We see this because the cloud of points moves. This is not the case if we adjust the scales:</p>
<p><img src="TFA_files/figure-html/unnamed-chunk-532-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In the plot above, we have to pay special attention to the range to notice that the plot on the right has a larger life expectancy.</p>
</div>
<div id="solution-xPjdcdnRRWlsyKPyqqVLExssfxNIxi1TTIPpRCXi" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-xPjdcdnRRWlsyKPyqqVLExssfxNIxi1TTIPpRCXi-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-xPjdcdnRRWlsyKPyqqVLExssfxNIxi1TTIPpRCXi-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="mod-r-plot.html#cb648-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb648-2"><a href="mod-r-plot.html#cb648-2" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Asia&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb648-3"><a href="mod-r-plot.html#cb648-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(fertility, life_expectancy, <span class="at">col =</span> year)) <span class="sc">+</span></span>
<span id="cb648-4"><a href="mod-r-plot.html#cb648-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()  </span>
<span id="cb648-5"><a href="mod-r-plot.html#cb648-5" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 47 rows containing missing values or values outside the scale range</span></span>
<span id="cb648-6"><a href="mod-r-plot.html#cb648-6" tabindex="-1"></a><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-533-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-xPjdcdnRRWlsyKPyqqVLExssfxNIxi1TTIPpRCXi">
Solution
</button>
<div id="hint-y71LquD1pOK6nMPDGj6W99MoUKh8TY" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-y71LquD1pOK6nMPDGj6W99MoUKh8TY-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-y71LquD1pOK6nMPDGj6W99MoUKh8TY-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="mod-r-plot.html#cb649-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb649-2"><a href="mod-r-plot.html#cb649-2" tabindex="-1"></a>  <span class="fu">filter</span>(___) <span class="sc">|&gt;</span></span>
<span id="cb649-3"><a href="mod-r-plot.html#cb649-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(___)) <span class="sc">+</span></span>
<span id="cb649-4"><a href="mod-r-plot.html#cb649-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-y71LquD1pOK6nMPDGj6W99MoUKh8TY">
Hint
</button>
<ol start="4" style="list-style-type: decimal">
<li>Illustrate the transformation for Asia using a single plot where year is used as color aesthetic.</li>
</ol>
<div id="time-series-plots" class="section level4 unnumbered hasAnchor">
<h4>Time series plots<a href="mod-r-plot.html#time-series-plots" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The visualizations above effectively illustrate that data no longer supports the Western versus developing world view. Once we see these plots, new questions emerge. For example, which countries are improving more and which ones less? Was the improvement constant during the last 50 years or was it more accelerated during certain periods? For a closer look that may help answer these questions, we introduce <em>time series plots</em>.</p>
<p>Time series plots have time in the x-axis and an outcome or measurement of interest on the y-axis. For example, here is a trend plot of United States fertility rates:</p>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="mod-r-plot.html#cb650-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb650-2"><a href="mod-r-plot.html#cb650-2" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;United States&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb650-3"><a href="mod-r-plot.html#cb650-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, fertility)) <span class="sc">+</span></span>
<span id="cb650-4"><a href="mod-r-plot.html#cb650-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="TFA_files/figure-html/fertility-time-series-plot-points-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We see that the trend is not linear at all. Instead there is sharp drop during the 1960s and 1970s to below 2. Then the trend comes back to 2 and stabilizes during the 1990s.</p>
<p>When the points are regularly and densely spaced, as they are here, we create curves by joining the points with lines, to convey that these data are from a single series, here a country. To do this, we use the <code>geom_line</code> function instead of <code>geom_point</code>.</p>
<div id="solution-t66OiQo4heRVJV4v3qk2N242hRmY0Bx7tS6WD0ap" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-t66OiQo4heRVJV4v3qk2N242hRmY0Bx7tS6WD0ap-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-t66OiQo4heRVJV4v3qk2N242hRmY0Bx7tS6WD0ap-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="mod-r-plot.html#cb651-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb651-2"><a href="mod-r-plot.html#cb651-2" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;United States&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb651-3"><a href="mod-r-plot.html#cb651-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, fertility)) <span class="sc">+</span></span>
<span id="cb651-4"><a href="mod-r-plot.html#cb651-4" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb651-5"><a href="mod-r-plot.html#cb651-5" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1 row containing missing values or values outside the scale range (`geom_line()`).</span></span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-535-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-t66OiQo4heRVJV4v3qk2N242hRmY0Bx7tS6WD0ap">
Solution
</button>
<ol start="5" style="list-style-type: decimal">
<li>Make a lineplot showing the time series of fertility versus year for United States.</li>
</ol>
<div id="solution-dx7dG0zQpGu9DuN35GdjT1zPNPVAAOakDO9RSaBr" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-dx7dG0zQpGu9DuN35GdjT1zPNPVAAOakDO9RSaBr-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-dx7dG0zQpGu9DuN35GdjT1zPNPVAAOakDO9RSaBr-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="mod-r-plot.html#cb652-1" tabindex="-1"></a>countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;South Korea&quot;</span>, <span class="st">&quot;Germany&quot;</span>)</span>
<span id="cb652-2"><a href="mod-r-plot.html#cb652-2" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> <span class="fu">filter</span>(country <span class="sc">%in%</span> countries) <span class="sc">|&gt;</span> </span>
<span id="cb652-3"><a href="mod-r-plot.html#cb652-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, fertility, <span class="at">col =</span> country)) <span class="sc">+</span></span>
<span id="cb652-4"><a href="mod-r-plot.html#cb652-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() </span>
<span id="cb652-5"><a href="mod-r-plot.html#cb652-5" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span id="cb652-6"><a href="mod-r-plot.html#cb652-6" tabindex="-1"></a><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-536-1.png" width="672" style="display: block; margin: auto;" />
<p>
The plot clearly shows how South Korea’s fertility rate dropped drastically during the 1960s and 1970s, and by 1990 had a similar rate to that of Germany.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-dx7dG0zQpGu9DuN35GdjT1zPNPVAAOakDO9RSaBr">
Solution
</button>
<div id="hint-dUmXZDhcCq6AtqIFWfp5CZjuITH3Gw" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-dUmXZDhcCq6AtqIFWfp5CZjuITH3Gw-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-dUmXZDhcCq6AtqIFWfp5CZjuITH3Gw-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="mod-r-plot.html#cb653-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> <span class="fu">filter</span>(country <span class="sc">%in%</span> ___) <span class="sc">|&gt;</span> </span>
<span id="cb653-2"><a href="mod-r-plot.html#cb653-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, fertility, <span class="at">col =</span> ___)) <span class="sc">+</span></span>
<span id="cb653-3"><a href="mod-r-plot.html#cb653-3" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-dUmXZDhcCq6AtqIFWfp5CZjuITH3Gw">
Hint
</button>
<ol start="6" style="list-style-type: decimal">
<li>Lineplots is particularly helpful when we look at more countries. Make a lineplot showing the time series of fertility versus year for South Korea and Germany. Use country as color aesthetic.</li>
</ol>
<div id="solution-tCuAuGi90ZidyMZn1fs6fkH65SNOgD4rPVihBTmB" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-tCuAuGi90ZidyMZn1fs6fkH65SNOgD4rPVihBTmB-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-tCuAuGi90ZidyMZn1fs6fkH65SNOgD4rPVihBTmB-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="mod-r-plot.html#cb654-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb654-2"><a href="mod-r-plot.html#cb654-2" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> countries) <span class="sc">|&gt;</span> </span>
<span id="cb654-3"><a href="mod-r-plot.html#cb654-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, life_expectancy, <span class="at">col =</span> country)) <span class="sc">+</span></span>
<span id="cb654-4"><a href="mod-r-plot.html#cb654-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() </span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-538-1.png" width="672" style="display: block; margin: auto;" />
<p>
The plot clearly shows how an improvement in life expectancy followed the drops in fertility rates. In 1960, Germans lived 15 years longer than South Koreans, although by 2010 the gap is completely closed. It exemplifies the improvement that many non-western countries have achieved in the last 40 years.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-tCuAuGi90ZidyMZn1fs6fkH65SNOgD4rPVihBTmB">
Solution
</button>
<ol start="7" style="list-style-type: decimal">
<li>Make a lineplot showing the time series of life expectancy versus year for South Korea and Germany. Use country as color aesthetic.</li>
</ol>
</div>
<div id="data-transformations" class="section level4 unnumbered hasAnchor">
<h4>Data transformations<a href="mod-r-plot.html#data-transformations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We now shift our attention to the second question related to the commonly held notion that wealth distribution across the world has become worse during the last decades. When general audiences are asked if poor countries have become poorer and rich countries become richer, the majority answers yes. By using stratification, histograms, smooth densities, and boxplots, we will be able to understand if this is in fact the case. First we learn how transformations can sometimes help provide more informative summaries and plots.</p>
<p>The <code>gapminder</code> data table includes a column with the countries’ gross domestic product (GDP). GDP measures the market value of goods and services produced by a country in a year. The GDP per person is often used as a rough summary of a country’s wealth. Here we divide this quantity by 365 to obtain the more interpretable measure <em>dollars per day</em>. Using current U.S. dollars as a unit, a person surviving on an income of less than $2 a day, is defined to be living in <em>absolute poverty</em>. We add this variable to the data table:</p>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="mod-r-plot.html#cb655-1" tabindex="-1"></a>gapminder <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span>  </span>
<span id="cb655-2"><a href="mod-r-plot.html#cb655-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dollars_per_day =</span> gdp<span class="sc">/</span>population<span class="sc">/</span><span class="dv">365</span>)</span></code></pre></div>
<p>The GDP values are adjusted for inflation and represent current U.S. dollar, so these values are meant to be comparable across the years. Of course, these are country averages and within each country there is much variability. All the graphs and insights described below relate to country averages and not to individuals.</p>
<p>Here is a histogram of per day incomes from 1970:</p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="mod-r-plot.html#cb656-1" tabindex="-1"></a>past_year <span class="ot">&lt;-</span> <span class="dv">1970</span></span>
<span id="cb656-2"><a href="mod-r-plot.html#cb656-2" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb656-3"><a href="mod-r-plot.html#cb656-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> past_year <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gdp)) <span class="sc">|&gt;</span></span>
<span id="cb656-4"><a href="mod-r-plot.html#cb656-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dollars_per_day)) <span class="sc">+</span> </span>
<span id="cb656-5"><a href="mod-r-plot.html#cb656-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="TFA_files/figure-html/dollars-per-day-distribution-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We use the <code>color = "black"</code> argument to draw a boundary and clearly distinguish the bins.</p>
<p>In this plot, we see that for the majority of countries, averages are below $10 a day. However, the majority of the x-axis is dedicated to the 35 countries with averages above $10. So the plot is not very informative about countries with values below $10 a day.</p>
<p>It might be more informative to quickly be able to see how many countries have average daily incomes of about $1 (extremely poor), $2 (very poor), $4 (poor), $8 (middle), $16 (well off), $32 (rich), $64 (very rich) per day. These changes are multiplicative and log transformations convert multiplicative changes into additive ones: when using base 2, a doubling of a value turns into an increase by 1.</p>
<div id="solution-yfKtQ6sAwWFTM7L2mJiwIz9nY3TlpI4YhkpwfYAE" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-yfKtQ6sAwWFTM7L2mJiwIz9nY3TlpI4YhkpwfYAE-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-yfKtQ6sAwWFTM7L2mJiwIz9nY3TlpI4YhkpwfYAE-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="mod-r-plot.html#cb657-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb657-2"><a href="mod-r-plot.html#cb657-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> past_year <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gdp)) <span class="sc">|&gt;</span></span>
<span id="cb657-3"><a href="mod-r-plot.html#cb657-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">log2</span>(dollars_per_day))) <span class="sc">+</span> </span>
<span id="cb657-4"><a href="mod-r-plot.html#cb657-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-540-1.png" width="672" style="display: block; margin: auto;" />
<p>
This provides a <em>close-up</em> of the mid to lower income countries.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-yfKtQ6sAwWFTM7L2mJiwIz9nY3TlpI4YhkpwfYAE">
Solution
</button>
<ol start="8" style="list-style-type: decimal">
<li>Make a histogram of <code>log2(dollars_per_day)</code> from 1970.</li>
</ol>
</div>
<div id="infobox---which-base" class="section level4 unnumbered hasAnchor box">
<h4>Infobox - Which base?<a href="mod-r-plot.html#infobox---which-base" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the case above, we used base 2 in the log transformations. Other common choices are base <span class="math inline">\(\mathrm{e}\)</span> (the natural log) and base 10.</p>
<p>In general, we do not recommend using the natural log for data exploration and visualization. This is because while <span class="math inline">\(2^2, 2^3, 2^4, \dots\)</span> or <span class="math inline">\(10^2, 10^3, \dots\)</span> are easy to compute in our heads, the same is not true for <span class="math inline">\(\mathrm{e}^2, \mathrm{e}^3, \dots\)</span>, so the scale is not intuitive or easy to interpret.</p>
<p>In the dollars per day example, we used base 2 instead of base 10 because the resulting range is easier to interpret. The range of the values being plotted is 0.327, 48.885.</p>
<p>In base 10, this turns into a range that includes very few integers: just 0 and 1.
With base two, our range includes -2, -1, 0, 1, 2, 3, 4, and 5. It is easier to compute <span class="math inline">\(2^x\)</span> and <span class="math inline">\(10^x\)</span> when <span class="math inline">\(x\)</span> is an integer and between -10 and 10, so we prefer to have smaller integers in the scale. Another consequence of a limited range is that choosing the binwidth is more challenging. With log base 2, we know that a binwidth of 1 will translate to a bin with range <span class="math inline">\(x\)</span> to <span class="math inline">\(2x\)</span>.</p>
<p>For an example in which base 10 makes more sense, consider population sizes. A log base 10 is preferable since the range for these is:</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="mod-r-plot.html#cb658-1" tabindex="-1"></a><span class="fu">filter</span>(gapminder, year <span class="sc">==</span> past_year) <span class="sc">|&gt;</span></span>
<span id="cb658-2"><a href="mod-r-plot.html#cb658-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">min =</span> <span class="fu">min</span>(population), <span class="at">max =</span> <span class="fu">max</span>(population))</span>
<span id="cb658-3"><a href="mod-r-plot.html#cb658-3" tabindex="-1"></a><span class="co">#&gt;     min      max</span></span>
<span id="cb658-4"><a href="mod-r-plot.html#cb658-4" tabindex="-1"></a><span class="co">#&gt; 1 46075 8.09e+08</span></span></code></pre></div>
<p>Here is the histogram of the transformed values:</p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="mod-r-plot.html#cb659-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb659-2"><a href="mod-r-plot.html#cb659-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> past_year) <span class="sc">|&gt;</span></span>
<span id="cb659-3"><a href="mod-r-plot.html#cb659-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">log10</span>(population))) <span class="sc">+</span></span>
<span id="cb659-4"><a href="mod-r-plot.html#cb659-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="TFA_files/figure-html/population-histogram-log10-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In the above, we quickly see that country populations range between ten thousand and ten billion.</p>
</div>
<p>There are two ways we can use log transformations in plots. We can log the values before plotting them or use log scales on the axes. Both approaches are useful and have different strengths. If we log the data, we can more easily interpret intermediate values in the scale. For example, if we see:</p>
<p><code>----1----x----2--------3----</code></p>
<p>for log transformed data, we know that the value of <span class="math inline">\(x\)</span> is about 1.5. If the scales are logged:</p>
<p><code>----1----x----10------100---</code></p>
<p>then, to determine <code>x</code>, we need to compute <span class="math inline">\(10^{1.5}\)</span>, which is not easy to do in our heads. The advantage of using logged scales is that we see the original values on the axes. However, the advantage of showing logged scales is that the original values are displayed in the plot, which are easier to interpret. For example, we would see “32 dollars a day” instead of “5 log base 2 dollars a day”.</p>
<div id="solution-ec9ABYm29s9gqlJYO0UGGpjOTnUAnbYIfG4QTxNZ" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-ec9ABYm29s9gqlJYO0UGGpjOTnUAnbYIfG4QTxNZ-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-ec9ABYm29s9gqlJYO0UGGpjOTnUAnbYIfG4QTxNZ-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="mod-r-plot.html#cb660-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb660-2"><a href="mod-r-plot.html#cb660-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> past_year <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gdp)) <span class="sc">|&gt;</span></span>
<span id="cb660-3"><a href="mod-r-plot.html#cb660-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dollars_per_day)) <span class="sc">+</span> </span>
<span id="cb660-4"><a href="mod-r-plot.html#cb660-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb660-5"><a href="mod-r-plot.html#cb660-5" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log2&quot;</span>)</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-542-1.png" width="672" style="display: block; margin: auto;" />
<p>
The plot from Q8 is the same except the values on the x-axis.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-ec9ABYm29s9gqlJYO0UGGpjOTnUAnbYIfG4QTxNZ">
Solution
</button>
<ol start="9" style="list-style-type: decimal">
<li>Make a histogram of <code>dollars_per_day</code> from 1970 using a log2 scale on the x-axis. Compare it to the plot from Question 8. <em>Hint: you can use the <code>scale_x_continuous</code> function with <code>trans = "log2"</code>.</em></li>
</ol>
<p>The histograms in Questions 8 and 9 have two <em>bumps</em>: one at about 4 and another at about 32. In statistics these bumps are sometimes referred to as <em>modes</em>. The mode of a distribution is the value with the highest frequency. The mode of the normal distribution is the average. When a distribution, like the one above, does not monotonically decrease from the mode, we call the locations where it goes up and down again <em>local modes</em> and say that the distribution has <em>multiple modes</em> indicating different distributions for different groups.</p>
<p>The histogram above suggests that the 1970 country income distribution has two modes: one at about 2 dollars per day (1 in the log 2 scale) and another at about 32 dollars per day (5 in the log 2 scale). However, the histogram does not show us if the two groups of countries are <em>west</em> versus the <em>rest</em>. Let us create the <code>group</code> column:</p>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="mod-r-plot.html#cb661-1" tabindex="-1"></a>gapminder <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span> </span>
<span id="cb661-2"><a href="mod-r-plot.html#cb661-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">case_when</span>(</span>
<span id="cb661-3"><a href="mod-r-plot.html#cb661-3" tabindex="-1"></a>    region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Western Europe&quot;</span>, <span class="st">&quot;Northern Europe&quot;</span>,<span class="st">&quot;Southern Europe&quot;</span>, </span>
<span id="cb661-4"><a href="mod-r-plot.html#cb661-4" tabindex="-1"></a>                  <span class="st">&quot;Northern America&quot;</span>, <span class="st">&quot;Australia and New Zealand&quot;</span>) <span class="sc">~</span> <span class="st">&quot;West&quot;</span>,</span>
<span id="cb661-5"><a href="mod-r-plot.html#cb661-5" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Rest&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb661-6"><a href="mod-r-plot.html#cb661-6" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code></pre></div>
<div id="solution-2EmnN5OTCrcuuSR0dw4GAlI2pKYwUdJd4oe5qVOg" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-2EmnN5OTCrcuuSR0dw4GAlI2pKYwUdJd4oe5qVOg-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-2EmnN5OTCrcuuSR0dw4GAlI2pKYwUdJd4oe5qVOg-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="mod-r-plot.html#cb662-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb662-2"><a href="mod-r-plot.html#cb662-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> past_year <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gdp)) <span class="sc">|&gt;</span></span>
<span id="cb662-3"><a href="mod-r-plot.html#cb662-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dollars_per_day)) <span class="sc">+</span> </span>
<span id="cb662-4"><a href="mod-r-plot.html#cb662-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb662-5"><a href="mod-r-plot.html#cb662-5" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(group)) <span class="sc">+</span></span>
<span id="cb662-6"><a href="mod-r-plot.html#cb662-6" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log2&quot;</span>)</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-544-1.png" width="672" style="display: block; margin: auto;" />
<p>
The plot confirms the west vs the rest dichotomy.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-2EmnN5OTCrcuuSR0dw4GAlI2pKYwUdJd4oe5qVOg">
Solution
</button>
<div id="hint-alkzz2wr0SVNZYnSFTqzFcSqjBGAXK" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-alkzz2wr0SVNZYnSFTqzFcSqjBGAXK-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-alkzz2wr0SVNZYnSFTqzFcSqjBGAXK-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="mod-r-plot.html#cb663-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb663-2"><a href="mod-r-plot.html#cb663-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> past_year <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gdp)) <span class="sc">|&gt;</span></span>
<span id="cb663-3"><a href="mod-r-plot.html#cb663-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dollars_per_day)) <span class="sc">+</span> </span>
<span id="cb663-4"><a href="mod-r-plot.html#cb663-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb663-5"><a href="mod-r-plot.html#cb663-5" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> ___) <span class="sc">+</span></span>
<span id="cb663-6"><a href="mod-r-plot.html#cb663-6" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log2&quot;</span>)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-alkzz2wr0SVNZYnSFTqzFcSqjBGAXK">
Hint
</button>
<ol start="10" style="list-style-type: decimal">
<li>Make a histogram of <code>dollars_per_day</code> from 1970 using a log2 scale and <em>facet</em> it by group. Is there a <em>west</em> versus the <em>rest</em> dichotomy?</li>
</ol>
<p>The exploratory data analysis above has revealed two characteristics about average income distribution in 1970. Using a histogram, we found a bimodal distribution with the modes relating to poor and rich countries. We will try to visualize these summaries in one plot.</p>
<div id="solution-wxJf7ilKDROZh3gos5FpNZF1QuySTkUohw6mpYT7" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-wxJf7ilKDROZh3gos5FpNZF1QuySTkUohw6mpYT7-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-wxJf7ilKDROZh3gos5FpNZF1QuySTkUohw6mpYT7-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="mod-r-plot.html#cb664-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb664-2"><a href="mod-r-plot.html#cb664-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> past_year <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gdp)) <span class="sc">|&gt;</span></span>
<span id="cb664-3"><a href="mod-r-plot.html#cb664-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(group, dollars_per_day)) <span class="sc">+</span></span>
<span id="cb664-4"><a href="mod-r-plot.html#cb664-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb664-5"><a href="mod-r-plot.html#cb664-5" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="sc">+</span> </span>
<span id="cb664-6"><a href="mod-r-plot.html#cb664-6" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-546-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-wxJf7ilKDROZh3gos5FpNZF1QuySTkUohw6mpYT7">
Solution
</button>
<div id="hint-EoeaQrRNSRwLHMp8ZPOIGwM6ORrVDN" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-EoeaQrRNSRwLHMp8ZPOIGwM6ORrVDN-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-EoeaQrRNSRwLHMp8ZPOIGwM6ORrVDN-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="mod-r-plot.html#cb665-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb665-2"><a href="mod-r-plot.html#cb665-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> past_year <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gdp)) <span class="sc">|&gt;</span></span>
<span id="cb665-3"><a href="mod-r-plot.html#cb665-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(group, dollars_per_day)) <span class="sc">+</span></span>
<span id="cb665-4"><a href="mod-r-plot.html#cb665-4" tabindex="-1"></a>  <span class="fu">geom____</span>() <span class="sc">+</span></span>
<span id="cb665-5"><a href="mod-r-plot.html#cb665-5" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="sc">+</span> </span>
<span id="cb665-6"><a href="mod-r-plot.html#cb665-6" tabindex="-1"></a>  <span class="fu">geom____</span>()</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-EoeaQrRNSRwLHMp8ZPOIGwM6ORrVDN">
Hint
</button>
<ol start="11" style="list-style-type: decimal">
<li>Make a boxplot (<code>geom_boxplot</code>) of <code>dollars_per_day</code> (y-axis) versus <code>group</code> (x-axis) from 1970 using a log2 scale. Also add a the data using <code>geom_point()</code>.</li>
</ol>
<p>Data exploration clearly shows that in 1970 there was a “west versus the rest” dichotomy. But does this dichotomy persist? We first have to be a little careful here since there are more countries represented in 2010 than in 1970: the total counts are larger. One reason for this is that several countries were founded after 1970. For example, the Soviet Union divided into several countries during the 1990s. Another reason is that data was available for more countries in 2010. Hence we only have to consider the countries with data available for both years:</p>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="mod-r-plot.html#cb666-1" tabindex="-1"></a>past_year <span class="ot">&lt;-</span> <span class="dv">1970</span></span>
<span id="cb666-2"><a href="mod-r-plot.html#cb666-2" tabindex="-1"></a>present_year <span class="ot">&lt;-</span> <span class="dv">2010</span></span>
<span id="cb666-3"><a href="mod-r-plot.html#cb666-3" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">c</span>(past_year, present_year)</span>
<span id="cb666-4"><a href="mod-r-plot.html#cb666-4" tabindex="-1"></a>country_list_1 <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span> </span>
<span id="cb666-5"><a href="mod-r-plot.html#cb666-5" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> past_year <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dollars_per_day)) <span class="sc">|&gt;</span> </span>
<span id="cb666-6"><a href="mod-r-plot.html#cb666-6" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb666-7"><a href="mod-r-plot.html#cb666-7" tabindex="-1"></a></span>
<span id="cb666-8"><a href="mod-r-plot.html#cb666-8" tabindex="-1"></a>country_list_2 <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span> </span>
<span id="cb666-9"><a href="mod-r-plot.html#cb666-9" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> present_year <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dollars_per_day)) <span class="sc">|&gt;</span> </span>
<span id="cb666-10"><a href="mod-r-plot.html#cb666-10" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb666-11"><a href="mod-r-plot.html#cb666-11" tabindex="-1"></a>      </span>
<span id="cb666-12"><a href="mod-r-plot.html#cb666-12" tabindex="-1"></a>country_list <span class="ot">&lt;-</span> <span class="fu">intersect</span>(country_list_1, country_list_2)</span></code></pre></div>
<p>We can now filter the rows by <code>years</code> and <code>country_list</code>.</p>
<div id="solution-wBQXFSEYZoxsPjShaSWGEcpB6NAsLTOHqGGiQqMg" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-wBQXFSEYZoxsPjShaSWGEcpB6NAsLTOHqGGiQqMg-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-wBQXFSEYZoxsPjShaSWGEcpB6NAsLTOHqGGiQqMg-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="mod-r-plot.html#cb667-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb667-2"><a href="mod-r-plot.html#cb667-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> country <span class="sc">%in%</span> country_list) <span class="sc">|&gt;</span></span>
<span id="cb667-3"><a href="mod-r-plot.html#cb667-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dollars_per_day)) <span class="sc">+</span></span>
<span id="cb667-4"><a href="mod-r-plot.html#cb667-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb667-5"><a href="mod-r-plot.html#cb667-5" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="sc">+</span> </span>
<span id="cb667-6"><a href="mod-r-plot.html#cb667-6" tabindex="-1"></a>  <span class="fu">facet_grid</span>(year <span class="sc">~</span> group)</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-549-1.png" width="672" style="display: block; margin: auto;" />
<p>
The income gap between rich and poor countries has narrowed considerably during the last 40 years
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-wBQXFSEYZoxsPjShaSWGEcpB6NAsLTOHqGGiQqMg">
Solution
</button>
<div id="hint-SfS6KCvH8CiadNMcktOsj1YOUgdsnH" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-SfS6KCvH8CiadNMcktOsj1YOUgdsnH-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-SfS6KCvH8CiadNMcktOsj1YOUgdsnH-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="mod-r-plot.html#cb668-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb668-2"><a href="mod-r-plot.html#cb668-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> ___ <span class="sc">&amp;</span> country <span class="sc">%in%</span> ___) <span class="sc">|&gt;</span></span>
<span id="cb668-3"><a href="mod-r-plot.html#cb668-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dollars_per_day)) <span class="sc">+</span></span>
<span id="cb668-4"><a href="mod-r-plot.html#cb668-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb668-5"><a href="mod-r-plot.html#cb668-5" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="sc">+</span> </span>
<span id="cb668-6"><a href="mod-r-plot.html#cb668-6" tabindex="-1"></a>  <span class="fu">facet_grid</span>(___)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-SfS6KCvH8CiadNMcktOsj1YOUgdsnH">
Hint
</button>
<ol start="12" style="list-style-type: decimal">
<li>Make a histogram of <code>dollars_per_day</code> from 1970 and 2010 using a log2 scale and <em>facet</em> it by group and year. Does the dichotomy persist?</li>
</ol>
<div id="solution-XYCw9ZCyk0eyA0KsSrtLyMwdeZvaEuwaR1Af0Nmn" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-XYCw9ZCyk0eyA0KsSrtLyMwdeZvaEuwaR1Af0Nmn-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-XYCw9ZCyk0eyA0KsSrtLyMwdeZvaEuwaR1Af0Nmn-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="mod-r-plot.html#cb669-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb669-2"><a href="mod-r-plot.html#cb669-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> country <span class="sc">%in%</span> country_list) <span class="sc">|&gt;</span></span>
<span id="cb669-3"><a href="mod-r-plot.html#cb669-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">factor</span>(year)) <span class="sc">|&gt;</span></span>
<span id="cb669-4"><a href="mod-r-plot.html#cb669-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(group, dollars_per_day, <span class="at">fill =</span> year)) <span class="sc">+</span></span>
<span id="cb669-5"><a href="mod-r-plot.html#cb669-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb669-6"><a href="mod-r-plot.html#cb669-6" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log2&quot;</span>) </span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-551-1.png" width="672" style="display: block; margin: auto;" />
<p>
We now see that the rich countries have become a bit richer, but percentage-wise, the poor countries appear to have improved more. In particular, we see that the proportion of <em>developing</em> countries earning more than $16 a day increased substantially.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-XYCw9ZCyk0eyA0KsSrtLyMwdeZvaEuwaR1Af0Nmn">
Solution
</button>
<div id="hint-VmsCc4fxG46Tj4QaUMC6H60G3Z3OQA" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-VmsCc4fxG46Tj4QaUMC6H60G3Z3OQA-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-VmsCc4fxG46Tj4QaUMC6H60G3Z3OQA-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="mod-r-plot.html#cb670-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb670-2"><a href="mod-r-plot.html#cb670-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> country <span class="sc">%in%</span> country_list) <span class="sc">|&gt;</span></span>
<span id="cb670-3"><a href="mod-r-plot.html#cb670-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">factor</span>(___)) <span class="sc">|&gt;</span></span>
<span id="cb670-4"><a href="mod-r-plot.html#cb670-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(group, dollars_per_day, <span class="at">fill =</span> ___)) <span class="sc">+</span></span>
<span id="cb670-5"><a href="mod-r-plot.html#cb670-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb670-6"><a href="mod-r-plot.html#cb670-6" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log2&quot;</span>) </span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-VmsCc4fxG46Tj4QaUMC6H60G3Z3OQA">
Hint
</button>
<ol start="13" style="list-style-type: decimal">
<li><p>Make a boxplot of <code>dollars_per_day</code> versus <code>group</code> from 1970 and 2010 using a log2 scale. Use year as fill aesthetic.</p>
<p><em>Hint: you must convert year to a factor using <code>mutate(year = factor(year))</code>.</em></p></li>
</ol>
<p>The previous data exploration suggested that the income gap between rich and poor countries has narrowed considerably during the last 40 years.
We used a series of histograms and boxplots to see this. Let us now shift to density plots. Let us start by noting that density plots for income distribution in 1970 and 2010 deliver the message that the gap is closing:</p>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="mod-r-plot.html#cb671-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb671-2"><a href="mod-r-plot.html#cb671-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> country <span class="sc">%in%</span> country_list) <span class="sc">|&gt;</span></span>
<span id="cb671-3"><a href="mod-r-plot.html#cb671-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dollars_per_day)) <span class="sc">+</span></span>
<span id="cb671-4"><a href="mod-r-plot.html#cb671-4" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span> </span>
<span id="cb671-5"><a href="mod-r-plot.html#cb671-5" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="sc">+</span> </span>
<span id="cb671-6"><a href="mod-r-plot.html#cb671-6" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(year))</span></code></pre></div>
<p><img src="TFA_files/figure-html/income-smooth-density-by-year-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In the 1970 plot, we see two clear modes: poor and rich countries. In 2010, it appears that some of the poor countries have shifted towards the right, closing the gap.</p>
<p>The next message we need to convey is that the reason for this change in distribution is that several poor countries became richer, rather than some rich countries becoming poorer. To do this, we can assign a color to the groups we identified during data exploration.</p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="mod-r-plot.html#cb672-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb672-2"><a href="mod-r-plot.html#cb672-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> country <span class="sc">%in%</span> country_list) <span class="sc">|&gt;</span></span>
<span id="cb672-3"><a href="mod-r-plot.html#cb672-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dollars_per_day, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb672-4"><a href="mod-r-plot.html#cb672-4" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log2&quot;</span>) <span class="sc">+</span></span>
<span id="cb672-5"><a href="mod-r-plot.html#cb672-5" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb672-6"><a href="mod-r-plot.html#cb672-6" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(year))</span></code></pre></div>
<p><img src="TFA_files/figure-html/income-smooth-density-by-year-west-v-developing-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Note the default is to have the area represented by each distribution add up to 1, regardless of the size of each group: the number of countries in the ‘west’ group is 21 and in the ‘rest’ group is 87. We may use count on the y-axis instead:</p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="mod-r-plot.html#cb673-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span> </span>
<span id="cb673-2"><a href="mod-r-plot.html#cb673-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> country <span class="sc">%in%</span> country_list) <span class="sc">|&gt;</span></span>
<span id="cb673-3"><a href="mod-r-plot.html#cb673-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dollars_per_day, <span class="at">y =</span> ..count.., <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb673-4"><a href="mod-r-plot.html#cb673-4" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log2&quot;</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="fl">0.125</span>, <span class="dv">300</span>)) <span class="sc">+</span></span>
<span id="cb673-5"><a href="mod-r-plot.html#cb673-5" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(year))</span>
<span id="cb673-6"><a href="mod-r-plot.html#cb673-6" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) </span>
<span id="cb673-7"><a href="mod-r-plot.html#cb673-7" tabindex="-1"></a><span class="co">#&gt; Warning: The dot-dot notation (`..count..`) was deprecated in ggplot2 3.4.0.</span></span>
<span id="cb673-8"><a href="mod-r-plot.html#cb673-8" tabindex="-1"></a><span class="co">#&gt; ℹ Please use `after_stat(count)` instead.</span></span>
<span id="cb673-9"><a href="mod-r-plot.html#cb673-9" tabindex="-1"></a><span class="co">#&gt; This warning is displayed once every 8 hours.</span></span>
<span id="cb673-10"><a href="mod-r-plot.html#cb673-10" tabindex="-1"></a><span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</span></span></code></pre></div>
<p><img src="TFA_files/figure-html/income-smooth-density-counts-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="solution-8ReAVEJ33JF8oigzNo0KJm0lxqVwtKQjyXB4nPUX" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-8ReAVEJ33JF8oigzNo0KJm0lxqVwtKQjyXB4nPUX-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-8ReAVEJ33JF8oigzNo0KJm0lxqVwtKQjyXB4nPUX-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="mod-r-plot.html#cb674-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">bw =</span> <span class="fl">0.75</span>)</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-554-1.png" width="672" style="display: block; margin: auto;" />
<p>
This plot now shows that the developing world distribution is changing.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-8ReAVEJ33JF8oigzNo0KJm0lxqVwtKQjyXB4nPUX">
Solution
</button>
<ol start="14" style="list-style-type: decimal">
<li>To get densities smoother, use <code>bw = 0.75</code> argument so that the same bandwidth is used in each density. Comment on the plot.</li>
</ol>
<p>As a final point, we note that in these distributions the weight of every country is the same. So if most of the population is improving, but living in a very large country, such as China, we might not appreciate this. We can actually weight the smooth densities using the <code>weight</code> mapping argument. We modify the dataset:</p>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="mod-r-plot.html#cb675-1" tabindex="-1"></a>gapminder <span class="ot">&lt;-</span> gapminder <span class="sc">|&gt;</span> </span>
<span id="cb675-2"><a href="mod-r-plot.html#cb675-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years <span class="sc">&amp;</span> country <span class="sc">%in%</span> country_list) <span class="sc">|&gt;</span></span>
<span id="cb675-3"><a href="mod-r-plot.html#cb675-3" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb675-4"><a href="mod-r-plot.html#cb675-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight =</span> population<span class="sc">/</span><span class="fu">sum</span>(population)<span class="sc">*</span><span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb675-5"><a href="mod-r-plot.html#cb675-5" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span></code></pre></div>
<div id="solution-P3U2k2EVxrSdW1EXuvNqXxffw0ujoaM2bRuFaKJg" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-P3U2k2EVxrSdW1EXuvNqXxffw0ujoaM2bRuFaKJg-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-P3U2k2EVxrSdW1EXuvNqXxffw0ujoaM2bRuFaKJg-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="mod-r-plot.html#cb676-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb676-2"><a href="mod-r-plot.html#cb676-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dollars_per_day, <span class="at">fill =</span> group, <span class="at">weight =</span> weight)) <span class="sc">+</span></span>
<span id="cb676-3"><a href="mod-r-plot.html#cb676-3" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log2&quot;</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="fl">0.125</span>, <span class="dv">300</span>)) <span class="sc">+</span> </span>
<span id="cb676-4"><a href="mod-r-plot.html#cb676-4" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">bw =</span> <span class="fl">0.75</span>) <span class="sc">+</span> </span>
<span id="cb676-5"><a href="mod-r-plot.html#cb676-5" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(year))</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-556-1.png" width="672" style="display: block; margin: auto;" />
<p>
We now see that the rich countries have become a bit richer, but percentage-wise, the poor countries appear to have improved more. In particular, we see that the proportion of <em>developing</em> countries earning more than $16 a day increased substantially.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-P3U2k2EVxrSdW1EXuvNqXxffw0ujoaM2bRuFaKJg">
Solution
</button>
<div id="hint-0OVF55jEWV8ILwvIIF29rospG5w6Qo" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-0OVF55jEWV8ILwvIIF29rospG5w6Qo-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-0OVF55jEWV8ILwvIIF29rospG5w6Qo-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="mod-r-plot.html#cb677-1" tabindex="-1"></a>gapminder <span class="sc">|&gt;</span> </span>
<span id="cb677-2"><a href="mod-r-plot.html#cb677-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dollars_per_day, <span class="at">fill =</span> group, <span class="at">weight =</span> ___)) <span class="sc">+</span></span>
<span id="cb677-3"><a href="mod-r-plot.html#cb677-3" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;log2&quot;</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="fl">0.125</span>, <span class="dv">300</span>)) <span class="sc">+</span> </span>
<span id="cb677-4"><a href="mod-r-plot.html#cb677-4" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">bw =</span> <span class="fl">0.75</span>) <span class="sc">+</span> </span>
<span id="cb677-5"><a href="mod-r-plot.html#cb677-5" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(year))</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-0OVF55jEWV8ILwvIIF29rospG5w6Qo">
Hint
</button>
<ol start="15" style="list-style-type: decimal">
<li>Modify the ggplot function with a weight argument and plot the density (with area equal 1).</li>
</ol>
</div>
<div id="ex-profit2" class="section level3 hasAnchor" number="14.6.2">
<h3><span class="header-section-number">14.6.2</span> Exercise (profit)<a href="mod-r-plot.html#ex-profit2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <em>exercise R Markdown template</em> to solve this exercise (<strong>File &gt; New File &gt; R Markdown…</strong>, select <strong>From template</strong> and then <strong>TFA Exercise</strong>).</p>
<p>Consider the dataset profit (provided by the tfa package) containing quarterly financial records for each costumer, product, etc.:</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="mod-r-plot.html#cb678-1" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;bss-osca/tfa-package&quot;, upgrade = FALSE)   # upgrade first</span></span>
<span id="cb678-2"><a href="mod-r-plot.html#cb678-2" tabindex="-1"></a><span class="fu">library</span>(tfa)</span>
<span id="cb678-3"><a href="mod-r-plot.html#cb678-3" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb678-4"><a href="mod-r-plot.html#cb678-4" tabindex="-1"></a><span class="fu">glimpse</span>(profit)</span>
<span id="cb678-5"><a href="mod-r-plot.html#cb678-5" tabindex="-1"></a><span class="co">#&gt; Rows: 24,546</span></span>
<span id="cb678-6"><a href="mod-r-plot.html#cb678-6" tabindex="-1"></a><span class="co">#&gt; Columns: 9</span></span>
<span id="cb678-7"><a href="mod-r-plot.html#cb678-7" tabindex="-1"></a><span class="co">#&gt; $ Quarter                 &lt;dbl&gt; 3, 1, 4, 1, 4, 3, 4, 3, 4, 1, 1, 3, 3, 3, 2, 2, 1, 2, 3, 2, 2, 2, …</span></span>
<span id="cb678-8"><a href="mod-r-plot.html#cb678-8" tabindex="-1"></a><span class="co">#&gt; $ Channel                 &lt;chr&gt; &quot;ATM&quot;, &quot;ATM&quot;, &quot;ATM&quot;, &quot;ATM&quot;, &quot;ATM&quot;, &quot;BRH&quot;, &quot;BRH&quot;, &quot;ATM&quot;, &quot;BRH&quot;, &quot;BR…</span></span>
<span id="cb678-9"><a href="mod-r-plot.html#cb678-9" tabindex="-1"></a><span class="co">#&gt; $ `Customer ID`           &lt;chr&gt; &quot;FRT&quot;, &quot;MRT&quot;, &quot;PBI&quot;, &quot;PBI&quot;, &quot;MRT&quot;, &quot;MAM&quot;, &quot;PBI&quot;, &quot;FRT&quot;, &quot;PBI&quot;, &quot;PB…</span></span>
<span id="cb678-10"><a href="mod-r-plot.html#cb678-10" tabindex="-1"></a><span class="co">#&gt; $ Country                 &lt;chr&gt; &quot;USA&quot;, &quot;USA&quot;, &quot;USA&quot;, &quot;USA&quot;, &quot;USA&quot;, &quot;USA&quot;, &quot;USA&quot;, &quot;USA&quot;, &quot;USA&quot;, &quot;US…</span></span>
<span id="cb678-11"><a href="mod-r-plot.html#cb678-11" tabindex="-1"></a><span class="co">#&gt; $ `Product Line`          &lt;chr&gt; &quot;Credit Products&quot;, &quot;Credit Products&quot;, &quot;Deposit Products&quot;, &quot;Deposit…</span></span>
<span id="cb678-12"><a href="mod-r-plot.html#cb678-12" tabindex="-1"></a><span class="co">#&gt; $ Revenue                 &lt;dbl&gt; 6044, 4686, 6063, 4682, 6320, 2993, 3355, 5716, 3347, 2624, 3629, …</span></span>
<span id="cb678-13"><a href="mod-r-plot.html#cb678-13" tabindex="-1"></a><span class="co">#&gt; $ `Product Cost`          &lt;dbl&gt; 3998, 3229, 7440, 6127, 7913, 1034, 4355, 5617, 4229, 1960, 4650, …</span></span>
<span id="cb678-14"><a href="mod-r-plot.html#cb678-14" tabindex="-1"></a><span class="co">#&gt; $ `Customer Service Cost` &lt;dbl&gt; 413, 643, 1842, 1118, 1854, 242, 1027, 876, 425, 264, 700, 1482, 4…</span></span>
<span id="cb678-15"><a href="mod-r-plot.html#cb678-15" tabindex="-1"></a><span class="co">#&gt; $ Profit                  &lt;dbl&gt; 1633, 815, -3219, -2563, -3447, 1718, -2027, -777, -1307, 401, -17…</span></span>
<span id="cb678-16"><a href="mod-r-plot.html#cb678-16" tabindex="-1"></a><span class="fu">skim</span>(profit)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-558">Table 14.1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">profit</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">24546</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">9</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">4</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<colgroup>
<col width="19%" />
<col width="13%" />
<col width="19%" />
<col width="5%" />
<col width="5%" />
<col width="8%" />
<col width="12%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Channel</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Customer ID</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">18</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Country</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">14</td>
<td align="right">0</td>
<td align="right">47</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Product Line</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">14</td>
<td align="right">25</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table style="width:100%;">
<colgroup>
<col width="24%" />
<col width="11%" />
<col width="15%" />
<col width="7%" />
<col width="7%" />
<col width="6%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="5%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Quarter</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2.50</td>
<td align="right">1.12</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">▇▇▁▇▇</td>
</tr>
<tr class="even">
<td align="left">Revenue</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">120.22</td>
<td align="right">420.96</td>
<td align="right">1</td>
<td align="right">12</td>
<td align="right">41</td>
<td align="right">74</td>
<td align="right">7540</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">Product Cost</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">100.07</td>
<td align="right">375.51</td>
<td align="right">0</td>
<td align="right">9</td>
<td align="right">29</td>
<td align="right">68</td>
<td align="right">9256</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">Customer Service Cost</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">17.42</td>
<td align="right">67.43</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">12</td>
<td align="right">1865</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">Profit</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2.71</td>
<td align="right">154.89</td>
<td align="right">-4139</td>
<td align="right">-7</td>
<td align="right">0</td>
<td align="right">9</td>
<td align="right">3664</td>
<td align="left">▁▁▇▁▁</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li>Make a barplot that shows the total profitability of the product lines. Use the following steps:</li>
</ol>
<div id="solution-6xNDb3iYeutDa7hvqJQGDVOQ5gWsgB93Bt8zTMvp" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-6xNDb3iYeutDa7hvqJQGDVOQ5gWsgB93Bt8zTMvp-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-6xNDb3iYeutDa7hvqJQGDVOQ5gWsgB93Bt8zTMvp-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="mod-r-plot.html#cb679-1" tabindex="-1"></a>profit <span class="ot">&lt;-</span> profit <span class="sc">|&gt;</span></span>
<span id="cb679-2"><a href="mod-r-plot.html#cb679-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), as.factor))</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-6xNDb3iYeutDa7hvqJQGDVOQ5gWsgB93Bt8zTMvp">
Solution
</button>
<div id="hint-GTG7UTAqqnNfsZjgmY4K2mWfMyMbSZ" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-GTG7UTAqqnNfsZjgmY4K2mWfMyMbSZ-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-GTG7UTAqqnNfsZjgmY4K2mWfMyMbSZ-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="mod-r-plot.html#cb680-1" tabindex="-1"></a>profit <span class="ot">&lt;-</span> profit <span class="sc">|&gt;</span></span>
<span id="cb680-2"><a href="mod-r-plot.html#cb680-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.___), as.___))</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-GTG7UTAqqnNfsZjgmY4K2mWfMyMbSZ">
Hint
</button>
<p>      
a) Convert all character columns to factor columns.</p>
<div id="solution-wuJ6Gpw6aqah6gl2s7ly7Uv2NQxMgxfVyysdg7Db" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-wuJ6Gpw6aqah6gl2s7ly7Uv2NQxMgxfVyysdg7Db-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-wuJ6Gpw6aqah6gl2s7ly7Uv2NQxMgxfVyysdg7Db-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="mod-r-plot.html#cb681-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb681-2"><a href="mod-r-plot.html#cb681-2" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb681-3"><a href="mod-r-plot.html#cb681-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Profit =</span> <span class="fu">sum</span>(Profit)) <span class="sc">|&gt;</span> </span>
<span id="cb681-4"><a href="mod-r-plot.html#cb681-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>, <span class="at">y =</span> Profit)) <span class="sc">+</span></span>
<span id="cb681-5"><a href="mod-r-plot.html#cb681-5" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-561-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-wuJ6Gpw6aqah6gl2s7ly7Uv2NQxMgxfVyysdg7Db">
Solution
</button>
<div id="hint-oKmmIaPNOy37k64EdN37plnFyP7Dpk" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-oKmmIaPNOy37k64EdN37plnFyP7Dpk-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-oKmmIaPNOy37k64EdN37plnFyP7Dpk-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="mod-r-plot.html#cb682-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb682-2"><a href="mod-r-plot.html#cb682-2" tabindex="-1"></a>  <span class="fu">group_by</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb682-3"><a href="mod-r-plot.html#cb682-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Profit =</span> <span class="fu">sum</span>(___)) <span class="sc">|&gt;</span> </span>
<span id="cb682-4"><a href="mod-r-plot.html#cb682-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___)) <span class="sc">+</span></span>
<span id="cb682-5"><a href="mod-r-plot.html#cb682-5" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-oKmmIaPNOy37k64EdN37plnFyP7Dpk">
Hint
</button>
<p>      
b) Group by product line, calculate the total profit and plot profit for each product line.</p>
<div id="solution-PqaYLneH8MBfnj03OsKGlPfU56vlqQvWAKygsesq" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-PqaYLneH8MBfnj03OsKGlPfU56vlqQvWAKygsesq-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-PqaYLneH8MBfnj03OsKGlPfU56vlqQvWAKygsesq-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="mod-r-plot.html#cb683-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb683-2"><a href="mod-r-plot.html#cb683-2" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb683-3"><a href="mod-r-plot.html#cb683-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Profit =</span> <span class="fu">sum</span>(Profit)) <span class="sc">|&gt;</span> </span>
<span id="cb683-4"><a href="mod-r-plot.html#cb683-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>, Profit), <span class="at">y =</span> Profit)) <span class="sc">+</span></span>
<span id="cb683-5"><a href="mod-r-plot.html#cb683-5" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span>
<span id="cb683-6"><a href="mod-r-plot.html#cb683-6" tabindex="-1"></a></span>
<span id="cb683-7"><a href="mod-r-plot.html#cb683-7" tabindex="-1"></a><span class="co"># Alternatively you can reorder the data frame before calling ggplot</span></span>
<span id="cb683-8"><a href="mod-r-plot.html#cb683-8" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb683-9"><a href="mod-r-plot.html#cb683-9" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb683-10"><a href="mod-r-plot.html#cb683-10" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Profit =</span> <span class="fu">sum</span>(Profit)) <span class="sc">|&gt;</span> </span>
<span id="cb683-11"><a href="mod-r-plot.html#cb683-11" tabindex="-1"></a>  <span class="fu">arrange</span>(Profit) <span class="sc">|&gt;</span> </span>
<span id="cb683-12"><a href="mod-r-plot.html#cb683-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">factor</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>, <span class="at">levels =</span> <span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb683-13"><a href="mod-r-plot.html#cb683-13" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>, Profit), <span class="at">y =</span> Profit)) <span class="sc">+</span></span>
<span id="cb683-14"><a href="mod-r-plot.html#cb683-14" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb683-15"><a href="mod-r-plot.html#cb683-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total profit for each product line&quot;</span>) </span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-563-1.png" width="672" style="display: block; margin: auto;" /><img src="TFA_files/figure-html/unnamed-chunk-563-2.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-PqaYLneH8MBfnj03OsKGlPfU56vlqQvWAKygsesq">
Solution
</button>
<div id="hint-7FTtZV54QEmic8a1vODhmpr35k1IpB" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-7FTtZV54QEmic8a1vODhmpr35k1IpB-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-7FTtZV54QEmic8a1vODhmpr35k1IpB-title1">
Hint 2
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="mod-r-plot.html#cb684-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb684-2"><a href="mod-r-plot.html#cb684-2" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb684-3"><a href="mod-r-plot.html#cb684-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Profit =</span> <span class="fu">sum</span>(Profit)) <span class="sc">|&gt;</span> </span>
<span id="cb684-4"><a href="mod-r-plot.html#cb684-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(___), <span class="at">y =</span> Profit)) <span class="sc">+</span></span>
<span id="cb684-5"><a href="mod-r-plot.html#cb684-5" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-7FTtZV54QEmic8a1vODhmpr35k1IpB">
Hint 2
</button>
<div id="hint-OIzRcVUR2CCb5bza6NjYu4NFY38BUM" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-OIzRcVUR2CCb5bza6NjYu4NFY38BUM-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-OIzRcVUR2CCb5bza6NjYu4NFY38BUM-title1">
Hint 1
</h4>
</div>
<div class="modal-body">
<p>
See the last section on this <a href="https://sebastiansauer.github.io/ordering-bars/">webpage</a>.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-OIzRcVUR2CCb5bza6NjYu4NFY38BUM">
Hint 1
</button>
<p>      
c) Plot profit for each product line where product line is reordered based on total profit.</p>
<div id="solution-3CnKZs3sENnX9amLNR4Vgr0XGmSxbIblXHu1x5xU" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-3CnKZs3sENnX9amLNR4Vgr0XGmSxbIblXHu1x5xU-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-3CnKZs3sENnX9amLNR4Vgr0XGmSxbIblXHu1x5xU-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="mod-r-plot.html#cb685-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb685-2"><a href="mod-r-plot.html#cb685-2" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb685-3"><a href="mod-r-plot.html#cb685-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Profit =</span> <span class="fu">sum</span>(Profit)) <span class="sc">|&gt;</span> </span>
<span id="cb685-4"><a href="mod-r-plot.html#cb685-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>, Profit), <span class="at">y =</span> Profit)) <span class="sc">+</span></span>
<span id="cb685-5"><a href="mod-r-plot.html#cb685-5" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb685-6"><a href="mod-r-plot.html#cb685-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total profit for each product line&quot;</span>) </span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-566-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-3CnKZs3sENnX9amLNR4Vgr0XGmSxbIblXHu1x5xU">
Solution
</button>
<div id="hint-5nDY6iKyc3ZxPmRhKRCfEwCbIw5gtQ" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-5nDY6iKyc3ZxPmRhKRCfEwCbIw5gtQ-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-5nDY6iKyc3ZxPmRhKRCfEwCbIw5gtQ-title1">
Hint
</h4>
</div>
<div class="modal-body">
<p>
Try to google ‘ggplot add title’.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-5nDY6iKyc3ZxPmRhKRCfEwCbIw5gtQ">
Hint
</button>
<p>      
d) Add a title to the plot using <code>labs</code>.</p>
<div id="solution-VeWpf4XMCjY5ovPA6P3sjrT3HraCFGSeb91AA95v" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-VeWpf4XMCjY5ovPA6P3sjrT3HraCFGSeb91AA95v-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-VeWpf4XMCjY5ovPA6P3sjrT3HraCFGSeb91AA95v-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="mod-r-plot.html#cb686-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb686-2"><a href="mod-r-plot.html#cb686-2" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb686-3"><a href="mod-r-plot.html#cb686-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Profit =</span> <span class="fu">sum</span>(Profit)) <span class="sc">|&gt;</span> </span>
<span id="cb686-4"><a href="mod-r-plot.html#cb686-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>, Profit), <span class="at">y =</span> Profit)) <span class="sc">+</span></span>
<span id="cb686-5"><a href="mod-r-plot.html#cb686-5" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb686-6"><a href="mod-r-plot.html#cb686-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total profit for each product line&quot;</span>) <span class="sc">+</span> </span>
<span id="cb686-7"><a href="mod-r-plot.html#cb686-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Product line&quot;</span>) <span class="sc">+</span></span>
<span id="cb686-8"><a href="mod-r-plot.html#cb686-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-568-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-VeWpf4XMCjY5ovPA6P3sjrT3HraCFGSeb91AA95v">
Solution
</button>
<div id="hint-6Gw5s1mDMEsA6v1x0lapVYDwglWwNT" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-6Gw5s1mDMEsA6v1x0lapVYDwglWwNT-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-6Gw5s1mDMEsA6v1x0lapVYDwglWwNT-title1">
Hint
</h4>
</div>
<div class="modal-body">
<p>
Try to google ‘ggplot2 rotate axis labels’.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-6Gw5s1mDMEsA6v1x0lapVYDwglWwNT">
Hint
</button>
<p>      
e) Rotate the x-axis labels 90 degrees.</p>
<div id="solution-9hOKT8YNrk4L5BTU4YrLQH0SPjaxDI6GVCtlJfrX" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-9hOKT8YNrk4L5BTU4YrLQH0SPjaxDI6GVCtlJfrX-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-9hOKT8YNrk4L5BTU4YrLQH0SPjaxDI6GVCtlJfrX-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="mod-r-plot.html#cb687-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> profit <span class="sc">|&gt;</span> </span>
<span id="cb687-2"><a href="mod-r-plot.html#cb687-2" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb687-3"><a href="mod-r-plot.html#cb687-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Profit =</span> <span class="fu">sum</span>(Profit)) </span>
<span id="cb687-4"><a href="mod-r-plot.html#cb687-4" tabindex="-1"></a>dat <span class="sc">|&gt;</span> <span class="fu">slice_min</span>(Profit)</span>
<span id="cb687-5"><a href="mod-r-plot.html#cb687-5" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb687-6"><a href="mod-r-plot.html#cb687-6" tabindex="-1"></a><span class="co">#&gt;   `Product Line`       Profit</span></span>
<span id="cb687-7"><a href="mod-r-plot.html#cb687-7" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;                 &lt;dbl&gt;</span></span>
<span id="cb687-8"><a href="mod-r-plot.html#cb687-8" tabindex="-1"></a><span class="co">#&gt; 1 Third Party Products   2209</span></span>
<span id="cb687-9"><a href="mod-r-plot.html#cb687-9" tabindex="-1"></a>dat <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(Profit)</span>
<span id="cb687-10"><a href="mod-r-plot.html#cb687-10" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb687-11"><a href="mod-r-plot.html#cb687-11" tabindex="-1"></a><span class="co">#&gt;   `Product Line`  Profit</span></span>
<span id="cb687-12"><a href="mod-r-plot.html#cb687-12" tabindex="-1"></a><span class="co">#&gt;   &lt;fct&gt;            &lt;dbl&gt;</span></span>
<span id="cb687-13"><a href="mod-r-plot.html#cb687-13" tabindex="-1"></a><span class="co">#&gt; 1 Credit Products  31016</span></span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-9hOKT8YNrk4L5BTU4YrLQH0SPjaxDI6GVCtlJfrX">
Solution
</button>
<div id="hint-vy6NoDSCbKxJp7JX4GdahPtPvjafZJ" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-vy6NoDSCbKxJp7JX4GdahPtPvjafZJ-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-vy6NoDSCbKxJp7JX4GdahPtPvjafZJ-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="mod-r-plot.html#cb688-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> profit <span class="sc">|&gt;</span> </span>
<span id="cb688-2"><a href="mod-r-plot.html#cb688-2" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb688-3"><a href="mod-r-plot.html#cb688-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Profit =</span> <span class="fu">sum</span>(Profit)) </span>
<span id="cb688-4"><a href="mod-r-plot.html#cb688-4" tabindex="-1"></a>dat <span class="sc">|&gt;</span> <span class="fu">slice_min</span>(___)</span>
<span id="cb688-5"><a href="mod-r-plot.html#cb688-5" tabindex="-1"></a>dat <span class="sc">|&gt;</span> ___</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-vy6NoDSCbKxJp7JX4GdahPtPvjafZJ">
Hint
</button>
<p>      
f) Which product line is best and worst?</p>
<div id="solution-ftrBZYL29tVnUpVdLGHnpTRowmDI2BRBo2Rv36Hv" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-ftrBZYL29tVnUpVdLGHnpTRowmDI2BRBo2Rv36Hv-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-ftrBZYL29tVnUpVdLGHnpTRowmDI2BRBo2Rv36Hv-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="mod-r-plot.html#cb689-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb689-2"><a href="mod-r-plot.html#cb689-2" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>, Quarter) <span class="sc">|&gt;</span> </span>
<span id="cb689-3"><a href="mod-r-plot.html#cb689-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Profit =</span> <span class="fu">sum</span>(Profit)) <span class="sc">|&gt;</span> </span>
<span id="cb689-4"><a href="mod-r-plot.html#cb689-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>, Profit), <span class="at">y =</span> Profit)) <span class="sc">+</span></span>
<span id="cb689-5"><a href="mod-r-plot.html#cb689-5" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb689-6"><a href="mod-r-plot.html#cb689-6" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(Quarter)) <span class="sc">+</span></span>
<span id="cb689-7"><a href="mod-r-plot.html#cb689-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total profit for each product line&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb689-8"><a href="mod-r-plot.html#cb689-8" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Product Line&quot;</span>) <span class="sc">+</span> </span>
<span id="cb689-9"><a href="mod-r-plot.html#cb689-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-572-1.png" width="672" style="display: block; margin: auto;" />
<p>
Some product lines have quite different earnings in different quarters.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-ftrBZYL29tVnUpVdLGHnpTRowmDI2BRBo2Rv36Hv">
Solution
</button>
<div id="hint-ygNC4ndtollsJciquv6AWwMm8l4W7A" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-ygNC4ndtollsJciquv6AWwMm8l4W7A-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-ygNC4ndtollsJciquv6AWwMm8l4W7A-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="mod-r-plot.html#cb690-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb690-2"><a href="mod-r-plot.html#cb690-2" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>, ___) <span class="sc">|&gt;</span> </span>
<span id="cb690-3"><a href="mod-r-plot.html#cb690-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Profit =</span> <span class="fu">sum</span>(Profit)) <span class="sc">|&gt;</span> </span>
<span id="cb690-4"><a href="mod-r-plot.html#cb690-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>, Profit), <span class="at">y =</span> Profit)) <span class="sc">+</span></span>
<span id="cb690-5"><a href="mod-r-plot.html#cb690-5" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb690-6"><a href="mod-r-plot.html#cb690-6" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(___)) <span class="sc">+</span></span>
<span id="cb690-7"><a href="mod-r-plot.html#cb690-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total profit for each product line&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb690-8"><a href="mod-r-plot.html#cb690-8" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Product Line&quot;</span>) <span class="sc">+</span> </span>
<span id="cb690-9"><a href="mod-r-plot.html#cb690-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-ygNC4ndtollsJciquv6AWwMm8l4W7A">
Hint
</button>
<ol start="2" style="list-style-type: decimal">
<li>Make a barplot that shows the total profitability of the product lines in each quarter. Are there details we have missed in Question 1?</li>
</ol>
<div id="solution-O6Ac4RgrMUdMnvCOhF9kFv3AmO3MBVJdplLqIEuU" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-O6Ac4RgrMUdMnvCOhF9kFv3AmO3MBVJdplLqIEuU-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-O6Ac4RgrMUdMnvCOhF9kFv3AmO3MBVJdplLqIEuU-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="mod-r-plot.html#cb691-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb691-2"><a href="mod-r-plot.html#cb691-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> Profit, <span class="at">x =</span> <span class="st">`</span><span class="at">Product Line</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb691-3"><a href="mod-r-plot.html#cb691-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb691-4"><a href="mod-r-plot.html#cb691-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Profit for each product line&quot;</span>) <span class="sc">+</span> </span>
<span id="cb691-5"><a href="mod-r-plot.html#cb691-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-574-1.png" width="672" style="display: block; margin: auto;" />
<p>
The profit varies more for three of the product lines.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-O6Ac4RgrMUdMnvCOhF9kFv3AmO3MBVJdplLqIEuU">
Solution
</button>
<div id="hint-T79EbQTb9AVIiBQdxZw5ECuCtUGUwu" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-T79EbQTb9AVIiBQdxZw5ECuCtUGUwu-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-T79EbQTb9AVIiBQdxZw5ECuCtUGUwu-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="mod-r-plot.html#cb692-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb692-2"><a href="mod-r-plot.html#cb692-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ___, <span class="at">x =</span> ___)) <span class="sc">+</span></span>
<span id="cb692-3"><a href="mod-r-plot.html#cb692-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb692-4"><a href="mod-r-plot.html#cb692-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Profit for each product line&quot;</span>) <span class="sc">+</span> </span>
<span id="cb692-5"><a href="mod-r-plot.html#cb692-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-T79EbQTb9AVIiBQdxZw5ECuCtUGUwu">
Hint
</button>
<ol start="3" style="list-style-type: decimal">
<li>Make a boxplot of profitability of the product lines. Any insight?</li>
</ol>
<div id="solution-xrjMoR9MyRHSMnhPXFxnEKISbYiqzS6RrdoDrU6j" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-xrjMoR9MyRHSMnhPXFxnEKISbYiqzS6RrdoDrU6j-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-xrjMoR9MyRHSMnhPXFxnEKISbYiqzS6RrdoDrU6j-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="mod-r-plot.html#cb693-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb693-2"><a href="mod-r-plot.html#cb693-2" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb693-3"><a href="mod-r-plot.html#cb693-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Profit =</span> <span class="fu">sum</span>(Profit)) <span class="sc">|&gt;</span> </span>
<span id="cb693-4"><a href="mod-r-plot.html#cb693-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>, Profit), <span class="at">y =</span> Profit)) <span class="sc">+</span></span>
<span id="cb693-5"><a href="mod-r-plot.html#cb693-5" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb693-6"><a href="mod-r-plot.html#cb693-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total profit for each customer&quot;</span>) <span class="sc">+</span> </span>
<span id="cb693-7"><a href="mod-r-plot.html#cb693-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-576-1.png" width="672" style="display: block; margin: auto;" />
<p>
Lowest and highest total profit is for PBI and WEM, respectively.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-xrjMoR9MyRHSMnhPXFxnEKISbYiqzS6RrdoDrU6j">
Solution
</button>
<div id="hint-Euoij5DhhSiM7nlXUIPQBJQd85UfRp" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-Euoij5DhhSiM7nlXUIPQBJQd85UfRp-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-Euoij5DhhSiM7nlXUIPQBJQd85UfRp-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="mod-r-plot.html#cb694-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb694-2"><a href="mod-r-plot.html#cb694-2" tabindex="-1"></a>  <span class="fu">group_by</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb694-3"><a href="mod-r-plot.html#cb694-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Profit =</span> <span class="fu">sum</span>(___)) <span class="sc">|&gt;</span> </span>
<span id="cb694-4"><a href="mod-r-plot.html#cb694-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(___, ___), <span class="at">y =</span> Profit)) <span class="sc">+</span></span>
<span id="cb694-5"><a href="mod-r-plot.html#cb694-5" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb694-6"><a href="mod-r-plot.html#cb694-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total profit for each customer&quot;</span>) <span class="sc">+</span> </span>
<span id="cb694-7"><a href="mod-r-plot.html#cb694-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-Euoij5DhhSiM7nlXUIPQBJQd85UfRp">
Hint
</button>
<ol start="4" style="list-style-type: decimal">
<li>Make a barplot that shows the total profitability of the customers. Which customer is best and worst?</li>
</ol>
<div id="solution-OHr9GARjn9urS1WEr8cUdAOlXwViipRRN2TYKuwm" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-OHr9GARjn9urS1WEr8cUdAOlXwViipRRN2TYKuwm-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-OHr9GARjn9urS1WEr8cUdAOlXwViipRRN2TYKuwm-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="mod-r-plot.html#cb695-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb695-2"><a href="mod-r-plot.html#cb695-2" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb695-3"><a href="mod-r-plot.html#cb695-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Profit =</span> <span class="fu">mean</span>(Profit)) <span class="sc">|&gt;</span> </span>
<span id="cb695-4"><a href="mod-r-plot.html#cb695-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>, Profit), <span class="at">y =</span> Profit)) <span class="sc">+</span></span>
<span id="cb695-5"><a href="mod-r-plot.html#cb695-5" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb695-6"><a href="mod-r-plot.html#cb695-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Mean profit for each customer&quot;</span>) <span class="sc">+</span> </span>
<span id="cb695-7"><a href="mod-r-plot.html#cb695-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-578-1.png" width="672" style="display: block; margin: auto;" />
<p>
Since the number of transactions are not the same, the order of customers will not be the same.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-OHr9GARjn9urS1WEr8cUdAOlXwViipRRN2TYKuwm">
Solution
</button>
<div id="hint-I2st6dYu6ZXFqjPPpZl6s6uCqrezWM" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-I2st6dYu6ZXFqjPPpZl6s6uCqrezWM-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-I2st6dYu6ZXFqjPPpZl6s6uCqrezWM-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="mod-r-plot.html#cb696-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb696-2"><a href="mod-r-plot.html#cb696-2" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb696-3"><a href="mod-r-plot.html#cb696-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Profit =</span> ___) <span class="sc">|&gt;</span> </span>
<span id="cb696-4"><a href="mod-r-plot.html#cb696-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>, Profit), <span class="at">y =</span> Profit)) <span class="sc">+</span></span>
<span id="cb696-5"><a href="mod-r-plot.html#cb696-5" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb696-6"><a href="mod-r-plot.html#cb696-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Mean profit for each customer&quot;</span>) <span class="sc">+</span> </span>
<span id="cb696-7"><a href="mod-r-plot.html#cb696-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-I2st6dYu6ZXFqjPPpZl6s6uCqrezWM">
Hint
</button>
<ol start="5" style="list-style-type: decimal">
<li>Make a barplot that shows the mean profitability of the customers. Which customer is best and worst? Compare against Question 4 and discuss.</li>
</ol>
<div id="solution-Yrd0BGHLJQIfOET4Dp0Xy4CTqAGwguR0jw1CaURS" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-Yrd0BGHLJQIfOET4Dp0Xy4CTqAGwguR0jw1CaURS-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-Yrd0BGHLJQIfOET4Dp0Xy4CTqAGwguR0jw1CaURS-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="mod-r-plot.html#cb697-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb697-2"><a href="mod-r-plot.html#cb697-2" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb697-3"><a href="mod-r-plot.html#cb697-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ctr =</span> <span class="fu">n</span>(), <span class="st">`</span><span class="at">Total Profit</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(Profit)) <span class="sc">|&gt;</span> </span>
<span id="cb697-4"><a href="mod-r-plot.html#cb697-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>, <span class="st">`</span><span class="at">Total Profit</span><span class="st">`</span>), <span class="at">y =</span> ctr, <span class="at">fill =</span> <span class="st">`</span><span class="at">Total Profit</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb697-5"><a href="mod-r-plot.html#cb697-5" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb697-6"><a href="mod-r-plot.html#cb697-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of transactions (rows) for each customer&quot;</span>) <span class="sc">+</span> </span>
<span id="cb697-7"><a href="mod-r-plot.html#cb697-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Customer&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Transactions&quot;</span>) <span class="sc">+</span></span>
<span id="cb697-8"><a href="mod-r-plot.html#cb697-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-Yrd0BGHLJQIfOET4Dp0Xy4CTqAGwguR0jw1CaURS">
Solution
</button>
<div id="hint-uUMoL42wZqjyPoHXdu7ocfq4QkL3Ml" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-uUMoL42wZqjyPoHXdu7ocfq4QkL3Ml-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-uUMoL42wZqjyPoHXdu7ocfq4QkL3Ml-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="mod-r-plot.html#cb698-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb698-2"><a href="mod-r-plot.html#cb698-2" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb698-3"><a href="mod-r-plot.html#cb698-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ctr =</span> ___, <span class="st">`</span><span class="at">Total Profit</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(___)) <span class="sc">|&gt;</span> </span>
<span id="cb698-4"><a href="mod-r-plot.html#cb698-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(___, <span class="st">`</span><span class="at">Total Profit</span><span class="st">`</span>), <span class="at">y =</span> ctr, <span class="at">fill =</span> ___)) <span class="sc">+</span></span>
<span id="cb698-5"><a href="mod-r-plot.html#cb698-5" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb698-6"><a href="mod-r-plot.html#cb698-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of transactions (rows) for each customer&quot;</span>) <span class="sc">+</span> </span>
<span id="cb698-7"><a href="mod-r-plot.html#cb698-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Customer&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Transactions&quot;</span>) <span class="sc">+</span></span>
<span id="cb698-8"><a href="mod-r-plot.html#cb698-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-uUMoL42wZqjyPoHXdu7ocfq4QkL3Ml">
Hint
</button>
<ol start="6" style="list-style-type: decimal">
<li>Make a plot illustrating number of transactions for each customer. Use total profit as fill atheistic.</li>
</ol>
<div id="solution-gj6VC84DOxUEXmQD2S6aNbb0Zp9rqGW7MQbrnEjV" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-gj6VC84DOxUEXmQD2S6aNbb0Zp9rqGW7MQbrnEjV-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-gj6VC84DOxUEXmQD2S6aNbb0Zp9rqGW7MQbrnEjV-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="mod-r-plot.html#cb699-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb699-2"><a href="mod-r-plot.html#cb699-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> Profit, <span class="at">x =</span> <span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb699-3"><a href="mod-r-plot.html#cb699-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb699-4"><a href="mod-r-plot.html#cb699-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Profit for each customer&quot;</span>) <span class="sc">+</span> </span>
<span id="cb699-5"><a href="mod-r-plot.html#cb699-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-582-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-gj6VC84DOxUEXmQD2S6aNbb0Zp9rqGW7MQbrnEjV">
Solution
</button>
<div id="hint-L97nnA9jFUs4IbOMgyuNA7lzUJvupC" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-L97nnA9jFUs4IbOMgyuNA7lzUJvupC-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-L97nnA9jFUs4IbOMgyuNA7lzUJvupC-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="mod-r-plot.html#cb700-1" tabindex="-1"></a>profit <span class="sc">|&gt;</span> </span>
<span id="cb700-2"><a href="mod-r-plot.html#cb700-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ___, <span class="at">x =</span> ___)) <span class="sc">+</span></span>
<span id="cb700-3"><a href="mod-r-plot.html#cb700-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb700-4"><a href="mod-r-plot.html#cb700-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Profit for each customer&quot;</span>) <span class="sc">+</span> </span>
<span id="cb700-5"><a href="mod-r-plot.html#cb700-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-L97nnA9jFUs4IbOMgyuNA7lzUJvupC">
Hint
</button>
<ol start="7" style="list-style-type: decimal">
<li>Make a boxplot illustrating the profit for each customer.</li>
</ol>
</div>
<div id="ex-covid19" class="section level3 hasAnchor" number="14.6.3">
<h3><span class="header-section-number">14.6.3</span> Exercise (COVID-19)<a href="mod-r-plot.html#ex-covid19" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <em>exercise R Markdown template</em> to solve this exercise (<strong>File &gt; New File &gt; R Markdown…</strong>, select <strong>From template</strong> and then <strong>TFA Exercise</strong>).</p>
<p>Countries around the world are responding to an outbreak of respiratory illness caused by a novel corona virus, COVID-19. The outbreak first started in Wuhan, China, but cases have been identified in a growing number of other locations internationally, including the United States. In this report we explore how the trajectory of the cumulative deaths in a number of countries.</p>
<p>The data come from the <a href="https://github.com/RamiKrispin/coronavirus"><strong>coronavirus</strong> package</a>, which pulls data from the Johns Hopkins University Center for Systems Science and Engineering (JHU CCSE) Corona virus repository. The corona virus package provides a tidy format dataset of the 2019 Novel Corona virus COVID-19 (2019-nCoV) epidemic. The package is available on GitHub <a href="https://github.com/RamiKrispin/coronavirus">here</a> and is updated daily.</p>
<p>First load the following packages:</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="mod-r-plot.html#cb701-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb701-2"><a href="mod-r-plot.html#cb701-2" tabindex="-1"></a><span class="fu">library</span>(lubridate)   <span class="co"># package for handling dates</span></span></code></pre></div>
<p>The data frame called <code>coronavirus</code> in the coronavirus package provides a daily summary of the Corona virus (COVID-19) cases by country. Each row in the data frame represents a country (or, where relevant, state/province). Note that the data provided in this package provides daily number of deaths, confirmed cases, and recovered cases. Since we just need the dataset we load it using <code>read_csv</code>:</p>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="mod-r-plot.html#cb702-1" tabindex="-1"></a>coronavirus <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb702-2"><a href="mod-r-plot.html#cb702-2" tabindex="-1"></a>  <span class="st">&quot;https://raw.githubusercontent.com/RamiKrispin/coronavirus/master/csv/coronavirus.csv&quot;</span>, </span>
<span id="cb702-3"><a href="mod-r-plot.html#cb702-3" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb702-4"><a href="mod-r-plot.html#cb702-4" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">col_date</span>(<span class="at">format =</span> <span class="st">&quot;&quot;</span>),</span>
<span id="cb702-5"><a href="mod-r-plot.html#cb702-5" tabindex="-1"></a>    <span class="at">province =</span> <span class="fu">col_character</span>(),</span>
<span id="cb702-6"><a href="mod-r-plot.html#cb702-6" tabindex="-1"></a>    <span class="at">country =</span> <span class="fu">col_character</span>(),</span>
<span id="cb702-7"><a href="mod-r-plot.html#cb702-7" tabindex="-1"></a>    <span class="at">lat =</span> <span class="fu">col_double</span>(),</span>
<span id="cb702-8"><a href="mod-r-plot.html#cb702-8" tabindex="-1"></a>    <span class="at">long =</span> <span class="fu">col_double</span>(),</span>
<span id="cb702-9"><a href="mod-r-plot.html#cb702-9" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">col_character</span>(),</span>
<span id="cb702-10"><a href="mod-r-plot.html#cb702-10" tabindex="-1"></a>    <span class="at">cases =</span> <span class="fu">col_double</span>()</span>
<span id="cb702-11"><a href="mod-r-plot.html#cb702-11" tabindex="-1"></a>  )</span>
<span id="cb702-12"><a href="mod-r-plot.html#cb702-12" tabindex="-1"></a>)</span></code></pre></div>
<p>We calculate the total number of cases per day, cumulative numbers and days since first record:</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="mod-r-plot.html#cb703-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> coronavirus <span class="sc">|&gt;</span></span>
<span id="cb703-2"><a href="mod-r-plot.html#cb703-2" tabindex="-1"></a>  <span class="fu">group_by</span>(country, date, type) <span class="sc">|&gt;</span> </span>
<span id="cb703-3"><a href="mod-r-plot.html#cb703-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tot_cases =</span> <span class="fu">sum</span>(cases)) <span class="sc">|&gt;</span></span>
<span id="cb703-4"><a href="mod-r-plot.html#cb703-4" tabindex="-1"></a>  <span class="fu">group_by</span>(country, type) <span class="sc">|&gt;</span> </span>
<span id="cb703-5"><a href="mod-r-plot.html#cb703-5" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">|&gt;</span></span>
<span id="cb703-6"><a href="mod-r-plot.html#cb703-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cumulative_cases =</span> <span class="fu">cumsum</span>(tot_cases)) <span class="sc">|&gt;</span></span>
<span id="cb703-7"><a href="mod-r-plot.html#cb703-7" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb703-8"><a href="mod-r-plot.html#cb703-8" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb703-9"><a href="mod-r-plot.html#cb703-9" tabindex="-1"></a>    <span class="at">days_elapsed =</span> <span class="fu">as.numeric</span>(date <span class="sc">-</span> <span class="fu">min</span>(date)),</span>
<span id="cb703-10"><a href="mod-r-plot.html#cb703-10" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">year</span>(date)</span>
<span id="cb703-11"><a href="mod-r-plot.html#cb703-11" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span>
<span id="cb703-12"><a href="mod-r-plot.html#cb703-12" tabindex="-1"></a><span class="co">#&gt; # A tibble: 650,637 × 7</span></span>
<span id="cb703-13"><a href="mod-r-plot.html#cb703-13" tabindex="-1"></a><span class="co">#&gt;    country     date       type      tot_cases cumulative_cases days_elapsed  year</span></span>
<span id="cb703-14"><a href="mod-r-plot.html#cb703-14" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;       &lt;date&gt;     &lt;chr&gt;         &lt;dbl&gt;            &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb703-15"><a href="mod-r-plot.html#cb703-15" tabindex="-1"></a><span class="co">#&gt;  1 Afghanistan 2020-01-22 confirmed         0                0            0  2020</span></span>
<span id="cb703-16"><a href="mod-r-plot.html#cb703-16" tabindex="-1"></a><span class="co">#&gt;  2 Afghanistan 2020-01-22 death             0                0            0  2020</span></span>
<span id="cb703-17"><a href="mod-r-plot.html#cb703-17" tabindex="-1"></a><span class="co">#&gt;  3 Afghanistan 2020-01-22 recovery          0                0            0  2020</span></span>
<span id="cb703-18"><a href="mod-r-plot.html#cb703-18" tabindex="-1"></a><span class="co">#&gt;  4 Albania     2020-01-22 confirmed         0                0            0  2020</span></span>
<span id="cb703-19"><a href="mod-r-plot.html#cb703-19" tabindex="-1"></a><span class="co">#&gt;  5 Albania     2020-01-22 death             0                0            0  2020</span></span>
<span id="cb703-20"><a href="mod-r-plot.html#cb703-20" tabindex="-1"></a><span class="co">#&gt;  6 Albania     2020-01-22 recovery          0                0            0  2020</span></span>
<span id="cb703-21"><a href="mod-r-plot.html#cb703-21" tabindex="-1"></a><span class="co">#&gt;  7 Algeria     2020-01-22 confirmed         0                0            0  2020</span></span>
<span id="cb703-22"><a href="mod-r-plot.html#cb703-22" tabindex="-1"></a><span class="co">#&gt;  8 Algeria     2020-01-22 death             0                0            0  2020</span></span>
<span id="cb703-23"><a href="mod-r-plot.html#cb703-23" tabindex="-1"></a><span class="co">#&gt;  9 Algeria     2020-01-22 recovery          0                0            0  2020</span></span>
<span id="cb703-24"><a href="mod-r-plot.html#cb703-24" tabindex="-1"></a><span class="co">#&gt; 10 Andorra     2020-01-22 confirmed         0                0            0  2020</span></span>
<span id="cb703-25"><a href="mod-r-plot.html#cb703-25" tabindex="-1"></a><span class="co">#&gt; # ℹ 650,627 more rows</span></span></code></pre></div>
<div id="solution-TZDD6B9eKc7FRYIMydrZhIHvymOsUR1LruTN9AUk" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-TZDD6B9eKc7FRYIMydrZhIHvymOsUR1LruTN9AUk-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-TZDD6B9eKc7FRYIMydrZhIHvymOsUR1LruTN9AUk-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="mod-r-plot.html#cb704-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb704-2"><a href="mod-r-plot.html#cb704-2" tabindex="-1"></a>  <span class="fu">group_by</span>(date, type) <span class="sc">|&gt;</span> </span>
<span id="cb704-3"><a href="mod-r-plot.html#cb704-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tot_cases =</span> <span class="fu">sum</span>(tot_cases)) <span class="sc">|&gt;</span> <span class="fu">print</span>() <span class="sc">|&gt;</span> </span>
<span id="cb704-4"><a href="mod-r-plot.html#cb704-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> tot_cases)) <span class="sc">+</span></span>
<span id="cb704-5"><a href="mod-r-plot.html#cb704-5" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb704-6"><a href="mod-r-plot.html#cb704-6" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(type), <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb704-7"><a href="mod-r-plot.html#cb704-7" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb704-8"><a href="mod-r-plot.html#cb704-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Number of Covid 19 cases per day&quot;</span>,</span>
<span id="cb704-9"><a href="mod-r-plot.html#cb704-9" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;cases&quot;</span></span>
<span id="cb704-10"><a href="mod-r-plot.html#cb704-10" tabindex="-1"></a>  )</span>
<span id="cb704-11"><a href="mod-r-plot.html#cb704-11" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3,237 × 3</span></span>
<span id="cb704-12"><a href="mod-r-plot.html#cb704-12" tabindex="-1"></a><span class="co">#&gt; # Groups:   date [1,079]</span></span>
<span id="cb704-13"><a href="mod-r-plot.html#cb704-13" tabindex="-1"></a><span class="co">#&gt;    date       type      tot_cases</span></span>
<span id="cb704-14"><a href="mod-r-plot.html#cb704-14" tabindex="-1"></a><span class="co">#&gt;    &lt;date&gt;     &lt;chr&gt;         &lt;dbl&gt;</span></span>
<span id="cb704-15"><a href="mod-r-plot.html#cb704-15" tabindex="-1"></a><span class="co">#&gt;  1 2020-01-22 confirmed       557</span></span>
<span id="cb704-16"><a href="mod-r-plot.html#cb704-16" tabindex="-1"></a><span class="co">#&gt;  2 2020-01-22 death            17</span></span>
<span id="cb704-17"><a href="mod-r-plot.html#cb704-17" tabindex="-1"></a><span class="co">#&gt;  3 2020-01-22 recovery         30</span></span>
<span id="cb704-18"><a href="mod-r-plot.html#cb704-18" tabindex="-1"></a><span class="co">#&gt;  4 2020-01-23 confirmed       100</span></span>
<span id="cb704-19"><a href="mod-r-plot.html#cb704-19" tabindex="-1"></a><span class="co">#&gt;  5 2020-01-23 death             1</span></span>
<span id="cb704-20"><a href="mod-r-plot.html#cb704-20" tabindex="-1"></a><span class="co">#&gt;  6 2020-01-23 recovery          2</span></span>
<span id="cb704-21"><a href="mod-r-plot.html#cb704-21" tabindex="-1"></a><span class="co">#&gt;  7 2020-01-24 confirmed       287</span></span>
<span id="cb704-22"><a href="mod-r-plot.html#cb704-22" tabindex="-1"></a><span class="co">#&gt;  8 2020-01-24 death             8</span></span>
<span id="cb704-23"><a href="mod-r-plot.html#cb704-23" tabindex="-1"></a><span class="co">#&gt;  9 2020-01-24 recovery          7</span></span>
<span id="cb704-24"><a href="mod-r-plot.html#cb704-24" tabindex="-1"></a><span class="co">#&gt; 10 2020-01-25 confirmed       493</span></span>
<span id="cb704-25"><a href="mod-r-plot.html#cb704-25" tabindex="-1"></a><span class="co">#&gt; # ℹ 3,227 more rows</span></span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-587-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-TZDD6B9eKc7FRYIMydrZhIHvymOsUR1LruTN9AUk">
Solution
</button>
<div id="hint-rUXBcDraB5O5kU5vsu87bFZKHIalQ5" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-rUXBcDraB5O5kU5vsu87bFZKHIalQ5-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-rUXBcDraB5O5kU5vsu87bFZKHIalQ5-title1">
Hint 2
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="mod-r-plot.html#cb705-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb705-2"><a href="mod-r-plot.html#cb705-2" tabindex="-1"></a>  <span class="fu">group_by</span>(date, type) <span class="sc">|&gt;</span> </span>
<span id="cb705-3"><a href="mod-r-plot.html#cb705-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tot_cases =</span> <span class="fu">sum</span>(tot_cases)) <span class="sc">|&gt;</span> <span class="fu">print</span>() <span class="sc">|&gt;</span> </span>
<span id="cb705-4"><a href="mod-r-plot.html#cb705-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___)) <span class="sc">+</span></span>
<span id="cb705-5"><a href="mod-r-plot.html#cb705-5" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb705-6"><a href="mod-r-plot.html#cb705-6" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(___), <span class="at">scales =</span> <span class="st">&quot;___&quot;</span>) <span class="sc">+</span></span>
<span id="cb705-7"><a href="mod-r-plot.html#cb705-7" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb705-8"><a href="mod-r-plot.html#cb705-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;___&quot;</span>,</span>
<span id="cb705-9"><a href="mod-r-plot.html#cb705-9" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;___&quot;</span></span>
<span id="cb705-10"><a href="mod-r-plot.html#cb705-10" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-rUXBcDraB5O5kU5vsu87bFZKHIalQ5">
Hint 2
</button>
<div id="hint-o65EtsOcEg8arN3rYzHRDMRfWiMTEs" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-o65EtsOcEg8arN3rYzHRDMRfWiMTEs-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-o65EtsOcEg8arN3rYzHRDMRfWiMTEs-title1">
Hint 1
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="mod-r-plot.html#cb706-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb706-2"><a href="mod-r-plot.html#cb706-2" tabindex="-1"></a>  <span class="fu">group_by</span>(date, ___) <span class="sc">|&gt;</span> </span>
<span id="cb706-3"><a href="mod-r-plot.html#cb706-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tot_cases =</span> <span class="fu">sum</span>(___)) </span></code></pre></div>
<p>
Note you must aggegrate the numbers for the countries.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-o65EtsOcEg8arN3rYzHRDMRfWiMTEs">
Hint 1
</button>
<ol style="list-style-type: decimal">
<li>Calculate and plot the number of confirmed, death and recovered cases per day given date using <code>facet_grid</code> and <code>geom_col</code>.</li>
</ol>
<p>Consider the following set of countries:</p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="mod-r-plot.html#cb707-1" tabindex="-1"></a>countries <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb707-2"><a href="mod-r-plot.html#cb707-2" tabindex="-1"></a>  <span class="st">&quot;China&quot;</span>,</span>
<span id="cb707-3"><a href="mod-r-plot.html#cb707-3" tabindex="-1"></a>  <span class="st">&quot;France&quot;</span>,</span>
<span id="cb707-4"><a href="mod-r-plot.html#cb707-4" tabindex="-1"></a>  <span class="st">&quot;Denmark&quot;</span>,</span>
<span id="cb707-5"><a href="mod-r-plot.html#cb707-5" tabindex="-1"></a>  <span class="st">&quot;US&quot;</span>,</span>
<span id="cb707-6"><a href="mod-r-plot.html#cb707-6" tabindex="-1"></a>  <span class="st">&quot;Italy&quot;</span></span>
<span id="cb707-7"><a href="mod-r-plot.html#cb707-7" tabindex="-1"></a>)</span></code></pre></div>
<div id="solution-J7HyB0U46D2PURBq5tJ9GaS24opBJfv9yVUUX8ye" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-J7HyB0U46D2PURBq5tJ9GaS24opBJfv9yVUUX8ye-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-J7HyB0U46D2PURBq5tJ9GaS24opBJfv9yVUUX8ye-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="mod-r-plot.html#cb708-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb708-2"><a href="mod-r-plot.html#cb708-2" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;death&quot;</span>, country <span class="sc">%in%</span> countries) <span class="sc">|&gt;</span> </span>
<span id="cb708-3"><a href="mod-r-plot.html#cb708-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> days_elapsed, </span>
<span id="cb708-4"><a href="mod-r-plot.html#cb708-4" tabindex="-1"></a>             <span class="at">y =</span> cumulative_cases, </span>
<span id="cb708-5"><a href="mod-r-plot.html#cb708-5" tabindex="-1"></a>             <span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb708-6"><a href="mod-r-plot.html#cb708-6" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb708-7"><a href="mod-r-plot.html#cb708-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb708-8"><a href="mod-r-plot.html#cb708-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb708-9"><a href="mod-r-plot.html#cb708-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">str_c</span>(<span class="st">&quot;Days since &quot;</span>, <span class="fu">min</span>(dat<span class="sc">$</span>date)),</span>
<span id="cb708-10"><a href="mod-r-plot.html#cb708-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Cumulative number of deaths&quot;</span>,</span>
<span id="cb708-11"><a href="mod-r-plot.html#cb708-11" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Cumulative deaths from COVID-19, selected countries&quot;</span></span>
<span id="cb708-12"><a href="mod-r-plot.html#cb708-12" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-591-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-J7HyB0U46D2PURBq5tJ9GaS24opBJfv9yVUUX8ye">
Solution
</button>
<div id="hint-Cz6VxK3IFMEZGBGwvjfo8uZ86AccCJ" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-Cz6VxK3IFMEZGBGwvjfo8uZ86AccCJ-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-Cz6VxK3IFMEZGBGwvjfo8uZ86AccCJ-title1">
Hint 2
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="mod-r-plot.html#cb709-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb709-2"><a href="mod-r-plot.html#cb709-2" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;death&quot;</span>, country <span class="sc">%in%</span> countries) <span class="sc">|&gt;</span> </span>
<span id="cb709-3"><a href="mod-r-plot.html#cb709-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, </span>
<span id="cb709-4"><a href="mod-r-plot.html#cb709-4" tabindex="-1"></a>             <span class="at">y =</span> ___, </span>
<span id="cb709-5"><a href="mod-r-plot.html#cb709-5" tabindex="-1"></a>             <span class="at">color =</span> ___)) <span class="sc">+</span></span>
<span id="cb709-6"><a href="mod-r-plot.html#cb709-6" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb709-7"><a href="mod-r-plot.html#cb709-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb709-8"><a href="mod-r-plot.html#cb709-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb709-9"><a href="mod-r-plot.html#cb709-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">str_c</span>(<span class="st">&quot;Days since &quot;</span>, <span class="fu">min</span>(dat<span class="sc">$</span>date)),</span>
<span id="cb709-10"><a href="mod-r-plot.html#cb709-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;___&quot;</span>,</span>
<span id="cb709-11"><a href="mod-r-plot.html#cb709-11" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Cumulative deaths from COVID-19, selected countries&quot;</span></span>
<span id="cb709-12"><a href="mod-r-plot.html#cb709-12" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-Cz6VxK3IFMEZGBGwvjfo8uZ86AccCJ">
Hint 2
</button>
<div id="hint-Eh0TBl33BlY2eUEg3Dlvaaq3SwVcOO" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-Eh0TBl33BlY2eUEg3Dlvaaq3SwVcOO-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-Eh0TBl33BlY2eUEg3Dlvaaq3SwVcOO-title1">
Hint 1
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="mod-r-plot.html#cb710-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb710-2"><a href="mod-r-plot.html#cb710-2" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;___&quot;</span>, country <span class="sc">%in%</span> ___) <span class="sc">|&gt;</span> </span></code></pre></div>
<p>
First you have to filter type and country
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-Eh0TBl33BlY2eUEg3Dlvaaq3SwVcOO">
Hint 1
</button>
<ol start="2" style="list-style-type: decimal">
<li>Plot a lineplot of the cumulative number of deaths as a function of days elapsed for the selected countries. Use country as color aesthetic.</li>
</ol>
<p>Since the countries have different population sizes, we would like to calculate some numbers relative to the population size. First we need population sizes for each country. They are given in the dataset <code>world_pop</code> in the <em>tfa</em> package:</p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="mod-r-plot.html#cb711-1" tabindex="-1"></a>world_pop <span class="ot">&lt;-</span> tfa<span class="sc">::</span>world_pop <span class="sc">|&gt;</span></span>
<span id="cb711-2"><a href="mod-r-plot.html#cb711-2" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> countries) <span class="sc">|&gt;</span> </span>
<span id="cb711-3"><a href="mod-r-plot.html#cb711-3" tabindex="-1"></a>  <span class="fu">print</span>()</span>
<span id="cb711-4"><a href="mod-r-plot.html#cb711-4" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1,505 × 3</span></span>
<span id="cb711-5"><a href="mod-r-plot.html#cb711-5" tabindex="-1"></a><span class="co">#&gt;    country  year       pop</span></span>
<span id="cb711-6"><a href="mod-r-plot.html#cb711-6" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb711-7"><a href="mod-r-plot.html#cb711-7" tabindex="-1"></a><span class="co">#&gt;  1 China    1800 321675013</span></span>
<span id="cb711-8"><a href="mod-r-plot.html#cb711-8" tabindex="-1"></a><span class="co">#&gt;  2 China    1801 324408862</span></span>
<span id="cb711-9"><a href="mod-r-plot.html#cb711-9" tabindex="-1"></a><span class="co">#&gt;  3 China    1802 327165946</span></span>
<span id="cb711-10"><a href="mod-r-plot.html#cb711-10" tabindex="-1"></a><span class="co">#&gt;  4 China    1803 329946461</span></span>
<span id="cb711-11"><a href="mod-r-plot.html#cb711-11" tabindex="-1"></a><span class="co">#&gt;  5 China    1804 332750607</span></span>
<span id="cb711-12"><a href="mod-r-plot.html#cb711-12" tabindex="-1"></a><span class="co">#&gt;  6 China    1805 335578586</span></span>
<span id="cb711-13"><a href="mod-r-plot.html#cb711-13" tabindex="-1"></a><span class="co">#&gt;  7 China    1806 338430598</span></span>
<span id="cb711-14"><a href="mod-r-plot.html#cb711-14" tabindex="-1"></a><span class="co">#&gt;  8 China    1807 341306850</span></span>
<span id="cb711-15"><a href="mod-r-plot.html#cb711-15" tabindex="-1"></a><span class="co">#&gt;  9 China    1808 344207546</span></span>
<span id="cb711-16"><a href="mod-r-plot.html#cb711-16" tabindex="-1"></a><span class="co">#&gt; 10 China    1809 347132894</span></span>
<span id="cb711-17"><a href="mod-r-plot.html#cb711-17" tabindex="-1"></a><span class="co">#&gt; # ℹ 1,495 more rows</span></span></code></pre></div>
<p>We can join the datasets using:</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="mod-r-plot.html#cb712-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb712-2"><a href="mod-r-plot.html#cb712-2" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> countries) <span class="sc">|&gt;</span> </span>
<span id="cb712-3"><a href="mod-r-plot.html#cb712-3" tabindex="-1"></a>  <span class="fu">left_join</span>(world_pop) <span class="sc">|&gt;</span> </span>
<span id="cb712-4"><a href="mod-r-plot.html#cb712-4" tabindex="-1"></a>  <span class="fu">print</span>()</span>
<span id="cb712-5"><a href="mod-r-plot.html#cb712-5" tabindex="-1"></a><span class="co">#&gt; Joining with `by = join_by(country, year)`</span></span>
<span id="cb712-6"><a href="mod-r-plot.html#cb712-6" tabindex="-1"></a><span class="co">#&gt; # A tibble: 16,185 × 8</span></span>
<span id="cb712-7"><a href="mod-r-plot.html#cb712-7" tabindex="-1"></a><span class="co">#&gt;    country date       type      tot_cases cumulative_cases days_elapsed  year        pop</span></span>
<span id="cb712-8"><a href="mod-r-plot.html#cb712-8" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt;         &lt;dbl&gt;            &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb712-9"><a href="mod-r-plot.html#cb712-9" tabindex="-1"></a><span class="co">#&gt;  1 China   2020-01-22 confirmed       548              548            0  2020 1424548266</span></span>
<span id="cb712-10"><a href="mod-r-plot.html#cb712-10" tabindex="-1"></a><span class="co">#&gt;  2 China   2020-01-22 death            17               17            0  2020 1424548266</span></span>
<span id="cb712-11"><a href="mod-r-plot.html#cb712-11" tabindex="-1"></a><span class="co">#&gt;  3 China   2020-01-22 recovery         28               28            0  2020 1424548266</span></span>
<span id="cb712-12"><a href="mod-r-plot.html#cb712-12" tabindex="-1"></a><span class="co">#&gt;  4 Denmark 2020-01-22 confirmed         0                0            0  2020    5796800</span></span>
<span id="cb712-13"><a href="mod-r-plot.html#cb712-13" tabindex="-1"></a><span class="co">#&gt;  5 Denmark 2020-01-22 death             0                0            0  2020    5796800</span></span>
<span id="cb712-14"><a href="mod-r-plot.html#cb712-14" tabindex="-1"></a><span class="co">#&gt;  6 Denmark 2020-01-22 recovery          0                0            0  2020    5796800</span></span>
<span id="cb712-15"><a href="mod-r-plot.html#cb712-15" tabindex="-1"></a><span class="co">#&gt;  7 France  2020-01-22 confirmed         0                0            0  2020   65721165</span></span>
<span id="cb712-16"><a href="mod-r-plot.html#cb712-16" tabindex="-1"></a><span class="co">#&gt;  8 France  2020-01-22 death             0                0            0  2020   65721165</span></span>
<span id="cb712-17"><a href="mod-r-plot.html#cb712-17" tabindex="-1"></a><span class="co">#&gt;  9 France  2020-01-22 recovery          0                0            0  2020   65721165</span></span>
<span id="cb712-18"><a href="mod-r-plot.html#cb712-18" tabindex="-1"></a><span class="co">#&gt; 10 Italy   2020-01-22 confirmed         0                0            0  2020   59132073</span></span>
<span id="cb712-19"><a href="mod-r-plot.html#cb712-19" tabindex="-1"></a><span class="co">#&gt; # ℹ 16,175 more rows</span></span>
<span id="cb712-20"><a href="mod-r-plot.html#cb712-20" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(dat))  <span class="co"># check if any missing values</span></span>
<span id="cb712-21"><a href="mod-r-plot.html#cb712-21" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<div id="solution-jby02LsFSdPrQY0DwTr9b9h02OHiFbR9bJBroldh" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-jby02LsFSdPrQY0DwTr9b9h02OHiFbR9bJBroldh-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-jby02LsFSdPrQY0DwTr9b9h02OHiFbR9bJBroldh-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="mod-r-plot.html#cb713-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb713-2"><a href="mod-r-plot.html#cb713-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tot_cases_pop =</span> <span class="dv">100000</span> <span class="sc">*</span> tot_cases<span class="sc">/</span>pop)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-jby02LsFSdPrQY0DwTr9b9h02OHiFbR9bJBroldh">
Solution
</button>
<ol start="3" style="list-style-type: decimal">
<li>Calculate <code>tot_cases_pop</code> as number of cases per 100000 inhabitants. That is, total cases divided by population and multiplied by 100000.</li>
</ol>
<div id="solution-bNuTQ8SV7eHWRad07blNi68NPZiAMVe7V86xFmo3" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-bNuTQ8SV7eHWRad07blNi68NPZiAMVe7V86xFmo3-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-bNuTQ8SV7eHWRad07blNi68NPZiAMVe7V86xFmo3-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="mod-r-plot.html#cb714-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb714-2"><a href="mod-r-plot.html#cb714-2" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="fu">today</span>() <span class="sc">-</span> <span class="fu">days</span>(<span class="dv">21</span>), type <span class="sc">==</span> <span class="st">&quot;confirmed&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb714-3"><a href="mod-r-plot.html#cb714-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> tot_cases_pop, <span class="at">fill =</span> country)) <span class="sc">+</span></span>
<span id="cb714-4"><a href="mod-r-plot.html#cb714-4" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge2</span>())</span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-597-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-bNuTQ8SV7eHWRad07blNi68NPZiAMVe7V86xFmo3">
Solution
</button>
<div id="hint-sP1YyNarXzpHenlrkeRgVtpXT1QfX6" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-sP1YyNarXzpHenlrkeRgVtpXT1QfX6-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-sP1YyNarXzpHenlrkeRgVtpXT1QfX6-title1">
Hint 2
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="mod-r-plot.html#cb715-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb715-2"><a href="mod-r-plot.html#cb715-2" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="fu">today</span>() <span class="sc">-</span> <span class="fu">days</span>(<span class="dv">21</span>), type <span class="sc">==</span> ___) <span class="sc">|&gt;</span> </span>
<span id="cb715-3"><a href="mod-r-plot.html#cb715-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> ___, <span class="at">fill =</span> ___)) <span class="sc">+</span></span>
<span id="cb715-4"><a href="mod-r-plot.html#cb715-4" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge2</span>())</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-sP1YyNarXzpHenlrkeRgVtpXT1QfX6">
Hint 2
</button>
<div id="solution-ZGbPG1UQJo2GX4pNEHocHGrENdFgqs9r8FPoA5nY" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-ZGbPG1UQJo2GX4pNEHocHGrENdFgqs9r8FPoA5nY-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-ZGbPG1UQJo2GX4pNEHocHGrENdFgqs9r8FPoA5nY-title1">
Hint 1
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="mod-r-plot.html#cb716-1" tabindex="-1"></a><span class="co"># Use this to find date 21 days ago</span></span>
<span id="cb716-2"><a href="mod-r-plot.html#cb716-2" tabindex="-1"></a><span class="fu">today</span>() <span class="sc">-</span> <span class="fu">days</span>(<span class="dv">21</span>)</span>
<span id="cb716-3"><a href="mod-r-plot.html#cb716-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;2025-07-14&quot;</span></span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-ZGbPG1UQJo2GX4pNEHocHGrENdFgqs9r8FPoA5nY">
Hint 1
</button>
<ol start="4" style="list-style-type: decimal">
<li>Plot the number of confirmed cases per 100000 inhabitants for the last 21 days. Use country as fill aesthetic.</li>
</ol>
<div id="solution-O10ed8MTEbb4poorRbl6E464vKuSRdtmgIwrUMb4" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-O10ed8MTEbb4poorRbl6E464vKuSRdtmgIwrUMb4-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-O10ed8MTEbb4poorRbl6E464vKuSRdtmgIwrUMb4-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="mod-r-plot.html#cb717-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb717-2"><a href="mod-r-plot.html#cb717-2" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="fu">today</span>() <span class="sc">-</span> <span class="fu">days</span>(<span class="dv">14</span>), country <span class="sc">==</span> <span class="st">&quot;Denmark&quot;</span>, type <span class="sc">==</span> <span class="st">&quot;confirmed&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb717-3"><a href="mod-r-plot.html#cb717-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> tot_cases_pop)) <span class="sc">+</span></span>
<span id="cb717-4"><a href="mod-r-plot.html#cb717-4" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-600-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-O10ed8MTEbb4poorRbl6E464vKuSRdtmgIwrUMb4">
Solution
</button>
<div id="hint-ZlaitX2gxv6MJqTIAupQcPNjGjZvZg" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-ZlaitX2gxv6MJqTIAupQcPNjGjZvZg-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-ZlaitX2gxv6MJqTIAupQcPNjGjZvZg-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="mod-r-plot.html#cb718-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb718-2"><a href="mod-r-plot.html#cb718-2" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> ___, country <span class="sc">==</span> ___, type <span class="sc">==</span> ___) <span class="sc">|&gt;</span> </span>
<span id="cb718-3"><a href="mod-r-plot.html#cb718-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> tot_cases_pop)) <span class="sc">+</span></span>
<span id="cb718-4"><a href="mod-r-plot.html#cb718-4" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-ZlaitX2gxv6MJqTIAupQcPNjGjZvZg">
Hint
</button>
<ol start="5" style="list-style-type: decimal">
<li>Plot the number of confirmed cases per 100000 inhabitants in Denmark for the last 14 days.</li>
</ol>
</div>
<div id="ex-lego" class="section level3 hasAnchor" number="14.6.4">
<h3><span class="header-section-number">14.6.4</span> Exercise (Lego and sales)<a href="mod-r-plot.html#ex-lego" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the <em>exercise R Markdown template</em> to solve this exercise (<strong>File &gt; New File &gt; R Markdown…</strong>, select <strong>From template</strong> and then <strong>TFA Exercise</strong>).</p>
<p>Consider (simulated) data of Lego sales in 2018 for a sample of customers who bought Legos in the U.S. The dataset is called <code>lego_sales</code>. You can find descriptions of each of the variables in the help file for the dataset, which you can access by running <code>?lego_sales</code> in your Console.</p>
<p>You need the <em>tidyverse</em> package as usual and the <em>dsbox</em> package for the data.</p>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="mod-r-plot.html#cb719-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb719-2"><a href="mod-r-plot.html#cb719-2" tabindex="-1"></a><span class="fu">library</span>(dsbox)   <span class="co"># install using devtools::install_github(&quot;rstudio-education/dsbox&quot;)</span></span></code></pre></div>
<p>Answer the following questions using a table with numbers and try to visualize it. For each question, state your answer in a sentence, e.g. “The first three common names of purchasers are …”.</p>
<ol style="list-style-type: decimal">
<li><p>What are the three most common first names of purchasers?</p></li>
<li><p>What are the three most common themes of Lego sets purchased?</p></li>
<li><p>Among the most common theme of Lego sets purchased, what is the most common subtheme?</p></li>
</ol>
<div id="hint-sqzksJwt0ATqPBtpsSbV1ylDNqmF5V" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-sqzksJwt0ATqPBtpsSbV1ylDNqmF5V-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-sqzksJwt0ATqPBtpsSbV1ylDNqmF5V-title1">
Hint
</h4>
</div>
<div class="modal-body">
<p>
Use the <code>case_when()</code> function.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-sqzksJwt0ATqPBtpsSbV1ylDNqmF5V">
Hint
</button>
<ol start="4" style="list-style-type: decimal">
<li>Create a new variable called <code>age_group</code> and group the ages into the
following categories: “18 and under”, “19 - 25”, “26 - 35”, “36 - 50”, “51 and over”.</li>
</ol>
<div id="hint-DXI5J2pQKPMEBBiT9xgMqrpOHcrz1c" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-DXI5J2pQKPMEBBiT9xgMqrpOHcrz1c-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-DXI5J2pQKPMEBBiT9xgMqrpOHcrz1c-title1">
Hint
</h4>
</div>
<div class="modal-body">
<p>
You may need to consider quantity of purchases.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-DXI5J2pQKPMEBBiT9xgMqrpOHcrz1c">
Hint
</button>
<ol start="5" style="list-style-type: decimal">
<li>Which age group has purchased the highest number of Lego sets.</li>
</ol>
<div id="hint-UnzPq4o1v93VPJ8DNXL8qpVH7Q7B8h" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-UnzPq4o1v93VPJ8DNXL8qpVH7Q7B8h-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-UnzPq4o1v93VPJ8DNXL8qpVH7Q7B8h-title1">
Hint
</h4>
</div>
<div class="modal-body">
<p>
<em>Hint:</em> You will need to consider quantity of purchases as well as price of Lego sets.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-UnzPq4o1v93VPJ8DNXL8qpVH7Q7B8h">
Hint
</button>
<ol start="6" style="list-style-type: decimal">
<li><p>Which age group has spent the most money on Legos?</p></li>
<li><p>Come up with a question you want to answer using these data, and write it down.
Then, create a data visualization that answers the question, and explain how
your visualization answers the question.</p></li>
</ol>
</div>
<div id="ex-company-plot" class="section level3 hasAnchor" number="14.6.5">
<h3><span class="header-section-number">14.6.5</span> Exercise (company ranking)<a href="mod-r-plot.html#ex-company-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a slightly modified version an exam assignment (exam 2021-A3).</em></p>
<p>Use the <em>exercise R markdown template</em> to solve this exercise (<strong>File &gt; New File &gt; R Markdown…</strong>, select <strong>From template</strong> and then <strong>TFA Exercise</strong>).</p>
<p>The dataset <code>companies</code>, in the <code>tfa</code> package, lists approx. 1000 of the world’s biggest companies, measured by sales, profits, assets and market value. The column/variables are:</p>
<ul>
<li><code>name</code>: the name of the company.</li>
<li><code>country</code>: the country the company is situated in.</li>
<li><code>category</code>: the products the company produces.</li>
<li><code>sales</code>: the amount of sales of the company in billion USD.</li>
<li><code>profits</code>: the profit of the company in billion USD.</li>
<li><code>assets</code>: the assets of the company in billion USD.</li>
<li><code>marketvalue</code>: the market value of the company in billion USD.</li>
</ul>
<p>You can load the dataset using:</p>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="mod-r-plot.html#cb720-1" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;bss-osca/tfa-package&quot;, build = FALSE)  # run if tfa not installed</span></span>
<span id="cb720-2"><a href="mod-r-plot.html#cb720-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb720-3"><a href="mod-r-plot.html#cb720-3" tabindex="-1"></a>companies <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/companies.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;tfa&quot;</span>))</span></code></pre></div>
<p>Answer this assignment using the <em>ggplot2</em> package in <em>tidyverse</em> (you might need dplyr for preparing the datasets you want to plot).</p>
<!-- Q1 -->
<div id="solution-YAfcg4qVCuEB6an1KhDlTqQhGyyaETsKiTxhXiVP" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-YAfcg4qVCuEB6an1KhDlTqQhGyyaETsKiTxhXiVP-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-YAfcg4qVCuEB6an1KhDlTqQhGyyaETsKiTxhXiVP-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="mod-r-plot.html#cb721-1" tabindex="-1"></a>companies <span class="sc">|&gt;</span> </span>
<span id="cb721-2"><a href="mod-r-plot.html#cb721-2" tabindex="-1"></a>  <span class="fu">count</span>(category) <span class="sc">|&gt;</span> </span>
<span id="cb721-3"><a href="mod-r-plot.html#cb721-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(category, <span class="sc">-</span>n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb721-4"><a href="mod-r-plot.html#cb721-4" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb721-5"><a href="mod-r-plot.html#cb721-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of companies in each product category&quot;</span>,</span>
<span id="cb721-6"><a href="mod-r-plot.html#cb721-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Product category&quot;</span>,</span>
<span id="cb721-7"><a href="mod-r-plot.html#cb721-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb721-8"><a href="mod-r-plot.html#cb721-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-607-1.png" width="672" style="display: block; margin: auto;" />
<p>
Based on the plot, the lowest number of companies are in the <em>Trading companies</em> category.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-YAfcg4qVCuEB6an1KhDlTqQhGyyaETsKiTxhXiVP">
Solution
</button>
<div id="hint-0EPWZiTHZpKnpuMBKBotsQKQRFEPYO" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-0EPWZiTHZpKnpuMBKBotsQKQRFEPYO-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-0EPWZiTHZpKnpuMBKBotsQKQRFEPYO-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="mod-r-plot.html#cb722-1" tabindex="-1"></a>companies <span class="sc">|&gt;</span> </span>
<span id="cb722-2"><a href="mod-r-plot.html#cb722-2" tabindex="-1"></a>  <span class="fu">count</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb722-3"><a href="mod-r-plot.html#cb722-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(___, <span class="sc">-</span>n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb722-4"><a href="mod-r-plot.html#cb722-4" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb722-5"><a href="mod-r-plot.html#cb722-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of companies in each product category&quot;</span>,</span>
<span id="cb722-6"><a href="mod-r-plot.html#cb722-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Product category&quot;</span>,</span>
<span id="cb722-7"><a href="mod-r-plot.html#cb722-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb722-8"><a href="mod-r-plot.html#cb722-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-0EPWZiTHZpKnpuMBKBotsQKQRFEPYO">
Hint
</button>
<ol style="list-style-type: decimal">
<li><p>Create a visualization showing the number of companies for each product category with the following features:</p>
<ul>
<li>Number of companies is represented using bars and sorted increasingly or decreasingly.</li>
<li>Informative figure title and axis titles are given.</li>
<li>The labels on the x-axis are rotated 90 degrees.</li>
</ul>
<p>What product category has the lowest number of companies?</p></li>
</ol>
<!-- Q2 -->
<div id="solution-xJoTjigmPu2AlZYuIFunn3selGDCOl1MQ92PXCY1" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-xJoTjigmPu2AlZYuIFunn3selGDCOl1MQ92PXCY1-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-xJoTjigmPu2AlZYuIFunn3selGDCOl1MQ92PXCY1-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="mod-r-plot.html#cb723-1" tabindex="-1"></a>companies <span class="sc">|&gt;</span> </span>
<span id="cb723-2"><a href="mod-r-plot.html#cb723-2" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Drugs &amp; biotechnology&quot;</span>, <span class="st">&quot;Media&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb723-3"><a href="mod-r-plot.html#cb723-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sales, <span class="at">y =</span> profits, <span class="at">color =</span> category)) <span class="sc">+</span></span>
<span id="cb723-4"><a href="mod-r-plot.html#cb723-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb723-5"><a href="mod-r-plot.html#cb723-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb723-6"><a href="mod-r-plot.html#cb723-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Profit given sales&quot;</span>,</span>
<span id="cb723-7"><a href="mod-r-plot.html#cb723-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Sales (billion USD)&quot;</span>,</span>
<span id="cb723-8"><a href="mod-r-plot.html#cb723-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Profit (billion USD)&quot;</span>,</span>
<span id="cb723-9"><a href="mod-r-plot.html#cb723-9" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Product Category&quot;</span>) <span class="sc">+</span></span>
<span id="cb723-10"><a href="mod-r-plot.html#cb723-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb723-11"><a href="mod-r-plot.html#cb723-11" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</span></span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-609-1.png" width="672" style="display: block; margin: auto;" />
<p>
Based on the plot the <em>Drugs &amp; biotechnology</em> product category gives the best profit.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-xJoTjigmPu2AlZYuIFunn3selGDCOl1MQ92PXCY1">
Solution
</button>
<div id="hint-njPxyRQOnsug0mpR9TCbaWrm2MsB5v" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-njPxyRQOnsug0mpR9TCbaWrm2MsB5v-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-njPxyRQOnsug0mpR9TCbaWrm2MsB5v-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="mod-r-plot.html#cb724-1" tabindex="-1"></a>companies <span class="sc">|&gt;</span> </span>
<span id="cb724-2"><a href="mod-r-plot.html#cb724-2" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">%in%</span> <span class="fu">c</span>(___)) <span class="sc">|&gt;</span> </span>
<span id="cb724-3"><a href="mod-r-plot.html#cb724-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___, <span class="at">color =</span> ___)) <span class="sc">+</span></span>
<span id="cb724-4"><a href="mod-r-plot.html#cb724-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb724-5"><a href="mod-r-plot.html#cb724-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb724-6"><a href="mod-r-plot.html#cb724-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Profit given sales&quot;</span>,</span>
<span id="cb724-7"><a href="mod-r-plot.html#cb724-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Sales (billion USD)&quot;</span>,</span>
<span id="cb724-8"><a href="mod-r-plot.html#cb724-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Profit (billion USD)&quot;</span>,</span>
<span id="cb724-9"><a href="mod-r-plot.html#cb724-9" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Product Category&quot;</span>) <span class="sc">+</span></span>
<span id="cb724-10"><a href="mod-r-plot.html#cb724-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-njPxyRQOnsug0mpR9TCbaWrm2MsB5v">
Hint
</button>
<ol start="2" style="list-style-type: decimal">
<li><p>Consider product categories <code>Drugs &amp; biotechnology</code> and <code>Media</code>. Create a visualization showing the profit given sales of each company with the following features:</p>
<ul>
<li>Different colors are used for each product category.</li>
<li>Informative figure title and axis titles are given.</li>
<li>A trend line for each category is added using <code>geom_smooth</code>.</li>
</ul>
<p>Based on the trend lines which product category gives the best profit?</p></li>
</ol>
<!-- Q3 -->
<div id="solution-7ErcH1mGpzrXNndhV4mnR9ylw7sUthzNdRIi5lkv" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-7ErcH1mGpzrXNndhV4mnR9ylw7sUthzNdRIi5lkv-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-7ErcH1mGpzrXNndhV4mnR9ylw7sUthzNdRIi5lkv-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="mod-r-plot.html#cb725-1" tabindex="-1"></a>companies <span class="ot">&lt;-</span> companies <span class="sc">|&gt;</span> </span>
<span id="cb725-2"><a href="mod-r-plot.html#cb725-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ratio =</span> profits<span class="sc">/</span>sales) </span>
<span id="cb725-3"><a href="mod-r-plot.html#cb725-3" tabindex="-1"></a></span>
<span id="cb725-4"><a href="mod-r-plot.html#cb725-4" tabindex="-1"></a><span class="co"># Option 1 - Use a boxplot</span></span>
<span id="cb725-5"><a href="mod-r-plot.html#cb725-5" tabindex="-1"></a>companies <span class="sc">|&gt;</span> </span>
<span id="cb725-6"><a href="mod-r-plot.html#cb725-6" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Banking&quot;</span>, <span class="st">&quot;Aerospace &amp; defense&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb725-7"><a href="mod-r-plot.html#cb725-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ratio, <span class="at">color =</span> category)) <span class="sc">+</span></span>
<span id="cb725-8"><a href="mod-r-plot.html#cb725-8" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb725-9"><a href="mod-r-plot.html#cb725-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Ratio of profit/sales&quot;</span>,</span>
<span id="cb725-10"><a href="mod-r-plot.html#cb725-10" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb725-11"><a href="mod-r-plot.html#cb725-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Profit/sales ratio&quot;</span>,</span>
<span id="cb725-12"><a href="mod-r-plot.html#cb725-12" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Product Category&quot;</span>) <span class="sc">+</span></span>
<span id="cb725-13"><a href="mod-r-plot.html#cb725-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb725-14"><a href="mod-r-plot.html#cb725-14" tabindex="-1"></a></span>
<span id="cb725-15"><a href="mod-r-plot.html#cb725-15" tabindex="-1"></a><span class="co"># Option 2 - Use a density plot</span></span>
<span id="cb725-16"><a href="mod-r-plot.html#cb725-16" tabindex="-1"></a>companies <span class="sc">|&gt;</span> </span>
<span id="cb725-17"><a href="mod-r-plot.html#cb725-17" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Banking&quot;</span>, <span class="st">&quot;Aerospace &amp; defense&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb725-18"><a href="mod-r-plot.html#cb725-18" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ratio, <span class="at">fill =</span> category)) <span class="sc">+</span></span>
<span id="cb725-19"><a href="mod-r-plot.html#cb725-19" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb725-20"><a href="mod-r-plot.html#cb725-20" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Ratio of profit/sales&quot;</span>,</span>
<span id="cb725-21"><a href="mod-r-plot.html#cb725-21" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>,</span>
<span id="cb725-22"><a href="mod-r-plot.html#cb725-22" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Profit/sales ratio&quot;</span>,</span>
<span id="cb725-23"><a href="mod-r-plot.html#cb725-23" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Product Category&quot;</span>) <span class="sc">+</span></span>
<span id="cb725-24"><a href="mod-r-plot.html#cb725-24" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-611-1.png" width="672" style="display: block; margin: auto;" /><img src="TFA_files/figure-html/unnamed-chunk-611-2.png" width="672" style="display: block; margin: auto;" />
<p>
Given the plot above, it can be seen that the highest ratio with respect to the mean and the median is for <em>Banking</em>. However, the variation is also highest here.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-7ErcH1mGpzrXNndhV4mnR9ylw7sUthzNdRIi5lkv">
Solution
</button>
<div id="hint-q9bqNqWJs7JVjrGxzHsSOxqLC9jd1z" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-q9bqNqWJs7JVjrGxzHsSOxqLC9jd1z-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-q9bqNqWJs7JVjrGxzHsSOxqLC9jd1z-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="mod-r-plot.html#cb726-1" tabindex="-1"></a>companies <span class="ot">&lt;-</span> companies <span class="sc">|&gt;</span> </span>
<span id="cb726-2"><a href="mod-r-plot.html#cb726-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ratio =</span> ___) </span>
<span id="cb726-3"><a href="mod-r-plot.html#cb726-3" tabindex="-1"></a></span>
<span id="cb726-4"><a href="mod-r-plot.html#cb726-4" tabindex="-1"></a>companies <span class="sc">|&gt;</span> </span>
<span id="cb726-5"><a href="mod-r-plot.html#cb726-5" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">%in%</span> <span class="fu">c</span>(___)) <span class="sc">|&gt;</span> </span>
<span id="cb726-6"><a href="mod-r-plot.html#cb726-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ___, <span class="at">color =</span> ___)) <span class="sc">+</span></span>
<span id="cb726-7"><a href="mod-r-plot.html#cb726-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb726-8"><a href="mod-r-plot.html#cb726-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Ratio of profit/sales&quot;</span>,</span>
<span id="cb726-9"><a href="mod-r-plot.html#cb726-9" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb726-10"><a href="mod-r-plot.html#cb726-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Profit/sales ratio&quot;</span>,</span>
<span id="cb726-11"><a href="mod-r-plot.html#cb726-11" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Product Category&quot;</span>) <span class="sc">+</span></span>
<span id="cb726-12"><a href="mod-r-plot.html#cb726-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-q9bqNqWJs7JVjrGxzHsSOxqLC9jd1z">
Hint
</button>
<ol start="3" style="list-style-type: decimal">
<li><p>Consider product categories <code>Banking</code> and <code>Aerospace &amp; defense</code>. Let <code>ratio</code> denote a variable/column that equals profit divided by sales. Create a visualization showing the variation in <code>ratio</code> with the following features:</p>
<ul>
<li>Different colors are used for each product category.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<p>Based on the visualization comment on the variation and median. Which product category gives the highest ratio?</p></li>
</ol>
<!-- Q4 -->
<div id="solution-9EgJySqWcLogBFiR0khYYkU5KCORh32ZOomR63CO" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-9EgJySqWcLogBFiR0khYYkU5KCORh32ZOomR63CO-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-9EgJySqWcLogBFiR0khYYkU5KCORh32ZOomR63CO-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="mod-r-plot.html#cb727-1" tabindex="-1"></a>continents <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/continents.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;tfa&quot;</span>))</span>
<span id="cb727-2"><a href="mod-r-plot.html#cb727-2" tabindex="-1"></a>companies <span class="sc">|&gt;</span> </span>
<span id="cb727-3"><a href="mod-r-plot.html#cb727-3" tabindex="-1"></a>  <span class="fu">left_join</span>(continents) <span class="sc">|&gt;</span> </span>
<span id="cb727-4"><a href="mod-r-plot.html#cb727-4" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Americas&quot;</span>, <span class="st">&quot;Europe&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb727-5"><a href="mod-r-plot.html#cb727-5" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Banking&quot;</span>, <span class="st">&quot;Aerospace &amp; defense&quot;</span>, </span>
<span id="cb727-6"><a href="mod-r-plot.html#cb727-6" tabindex="-1"></a>                         <span class="st">&quot;Telecommunications services&quot;</span>, <span class="st">&quot;Semiconductors&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb727-7"><a href="mod-r-plot.html#cb727-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> marketvalue, <span class="at">y =</span> assets, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb727-8"><a href="mod-r-plot.html#cb727-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb727-9"><a href="mod-r-plot.html#cb727-9" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm) <span class="sc">+</span></span>
<span id="cb727-10"><a href="mod-r-plot.html#cb727-10" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(category), <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb727-11"><a href="mod-r-plot.html#cb727-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Assets given market value&quot;</span>,</span>
<span id="cb727-12"><a href="mod-r-plot.html#cb727-12" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Market value (billion USD)&quot;</span>,</span>
<span id="cb727-13"><a href="mod-r-plot.html#cb727-13" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Assets (billion USD)&quot;</span>,</span>
<span id="cb727-14"><a href="mod-r-plot.html#cb727-14" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Continent&quot;</span>) <span class="sc">+</span></span>
<span id="cb727-15"><a href="mod-r-plot.html#cb727-15" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb727-16"><a href="mod-r-plot.html#cb727-16" tabindex="-1"></a><span class="co">#&gt; Joining with `by = join_by(country)`</span></span>
<span id="cb727-17"><a href="mod-r-plot.html#cb727-17" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using formula = &#39;y ~ x&#39;</span></span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-613-1.png" width="672" style="display: block; margin: auto;" />
<p>
By considering the trend lines for <em>Banking</em>, it seems that if compare companies with the same marketvalue, then companies in Europe have more assets.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-9EgJySqWcLogBFiR0khYYkU5KCORh32ZOomR63CO">
Solution
</button>
<div id="hint-1Yn7bU7V4P6vIRsSeoAgpy5Rx5O4vd" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-1Yn7bU7V4P6vIRsSeoAgpy5Rx5O4vd-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-1Yn7bU7V4P6vIRsSeoAgpy5Rx5O4vd-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="mod-r-plot.html#cb728-1" tabindex="-1"></a>continents <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/continents.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;tfa&quot;</span>))</span>
<span id="cb728-2"><a href="mod-r-plot.html#cb728-2" tabindex="-1"></a>companies <span class="sc">|&gt;</span> </span>
<span id="cb728-3"><a href="mod-r-plot.html#cb728-3" tabindex="-1"></a>  <span class="fu">left_join</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb728-4"><a href="mod-r-plot.html#cb728-4" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">%in%</span> <span class="fu">c</span>(___)) <span class="sc">|&gt;</span> </span>
<span id="cb728-5"><a href="mod-r-plot.html#cb728-5" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">%in%</span> <span class="fu">c</span>(___)) <span class="sc">|&gt;</span> </span>
<span id="cb728-6"><a href="mod-r-plot.html#cb728-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___, <span class="at">color =</span> ___)) <span class="sc">+</span></span>
<span id="cb728-7"><a href="mod-r-plot.html#cb728-7" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb728-8"><a href="mod-r-plot.html#cb728-8" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm) <span class="sc">+</span></span>
<span id="cb728-9"><a href="mod-r-plot.html#cb728-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(___), <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb728-10"><a href="mod-r-plot.html#cb728-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Assets given market value&quot;</span>,</span>
<span id="cb728-11"><a href="mod-r-plot.html#cb728-11" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Market value (billion USD)&quot;</span>,</span>
<span id="cb728-12"><a href="mod-r-plot.html#cb728-12" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Assets (billion USD)&quot;</span>,</span>
<span id="cb728-13"><a href="mod-r-plot.html#cb728-13" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Continent&quot;</span>) <span class="sc">+</span></span>
<span id="cb728-14"><a href="mod-r-plot.html#cb728-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-1Yn7bU7V4P6vIRsSeoAgpy5Rx5O4vd">
Hint
</button>
<ol start="4" style="list-style-type: decimal">
<li><p>The <code>continents</code> dataset matches countries to continents and contains two columns:</p>
<ul>
<li><code>country</code>: the country.</li>
<li><code>continent</code>: the corresponding continent.</li>
</ul>
<p>You can load the dataset using:</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="mod-r-plot.html#cb729-1" tabindex="-1"></a>continents <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/continents.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;tfa&quot;</span>))</span></code></pre></div>
<p>Consider product categories <code>Banking</code>, <code>Aerospace &amp; defense</code>, <code>Telecommunications services</code> and <code>Semiconductors</code>. Create a visualization showing assets given market value for each company with the following features (hint: you may need to do a mutating join):</p>
<ul>
<li>Two continents <code>Americas</code> and <code>Europe</code> are considered.</li>
<li>Different colors are used for each continent.</li>
<li>A plot is given for each product category (facet).</li>
<li>Informative figure title and axis titles are given.</li>
<li>A trend line for each category is added using <code>geom_smooth(method = lm)</code>.</li>
</ul>
<p>Based on the visualization consider the trend lines for <em>Banking</em> and comment.</p></li>
</ol>
</div>
<div id="ex-titanic-plot" class="section level3 hasAnchor" number="14.6.6">
<h3><span class="header-section-number">14.6.6</span> Exercise (Titanic)<a href="mod-r-plot.html#ex-titanic-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a slightly modified version an exam assignment (reexam 2021-A3).</em></p>
<p>Use the <em>exercise R markdown template</em> to solve this exercise (<strong>File &gt; New File &gt; R Markdown…</strong>, select <strong>From template</strong> and then <strong>TFA Exercise</strong>).</p>
<p>The dataset <code>titanic</code>, given in the appendix, lists approx. 1300 passengers on Titanic. The column/variables are:</p>
<ul>
<li><code>pclass</code>: Passenger class (1 = 1st; 2 = 2nd; 3 = 3rd).</li>
<li><code>survived</code>: Survival (0 = No; 1 = Yes).</li>
<li><code>name</code>: Name.</li>
<li><code>sex</code>: Sex.</li>
<li><code>age</code>: Age.</li>
<li><code>fare</code>: Passenger Fare.</li>
<li><code>cabin</code>: Cabin number.</li>
<li><code>embarked</code>: Port of embarkation (C = Cherbourg; Q = Queenstown; S = Southampton).</li>
<li><code>boat</code>: Lifeboat number.</li>
</ul>
<p>You can read the dataset file <code>titanic.csv</code> into the dataset <code>dat</code> using</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="mod-r-plot.html#cb730-1" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;bss-osca/tfa-package&quot;, build = FALSE)  # run if tfa not installed</span></span>
<span id="cb730-2"><a href="mod-r-plot.html#cb730-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb730-3"><a href="mod-r-plot.html#cb730-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/titanic.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;tfa&quot;</span>))</span></code></pre></div>
<p>Answer this assignment using the <em>ggplot2</em> package in <em>tidyverse</em> (you might need dplyr for preparing the datasets you want to plot).</p>
<!-- Q1 -->
<div id="solution-9xU8IPdPAt69Ayx8aGqLDpSOS2OsRVcjDvmOx6T1" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-9xU8IPdPAt69Ayx8aGqLDpSOS2OsRVcjDvmOx6T1-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-9xU8IPdPAt69Ayx8aGqLDpSOS2OsRVcjDvmOx6T1-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="mod-r-plot.html#cb731-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">harbor =</span> <span class="fu">case_when</span>(</span>
<span id="cb731-2"><a href="mod-r-plot.html#cb731-2" tabindex="-1"></a>  embarked <span class="sc">==</span> <span class="st">&quot;C&quot;</span> <span class="sc">~</span> <span class="st">&quot;Cherbourg&quot;</span>,</span>
<span id="cb731-3"><a href="mod-r-plot.html#cb731-3" tabindex="-1"></a>  embarked <span class="sc">==</span> <span class="st">&quot;Q&quot;</span> <span class="sc">~</span> <span class="st">&quot;Queenstown&quot;</span>,</span>
<span id="cb731-4"><a href="mod-r-plot.html#cb731-4" tabindex="-1"></a>  embarked <span class="sc">==</span> <span class="st">&quot;S&quot;</span> <span class="sc">~</span> <span class="st">&quot;Southampton&quot;</span>,</span>
<span id="cb731-5"><a href="mod-r-plot.html#cb731-5" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb731-6"><a href="mod-r-plot.html#cb731-6" tabindex="-1"></a>))</span>
<span id="cb731-7"><a href="mod-r-plot.html#cb731-7" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb731-8"><a href="mod-r-plot.html#cb731-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> harbor)) <span class="sc">+</span></span>
<span id="cb731-9"><a href="mod-r-plot.html#cb731-9" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb731-10"><a href="mod-r-plot.html#cb731-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of persons embarking each departure harbor&quot;</span>,</span>
<span id="cb731-11"><a href="mod-r-plot.html#cb731-11" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Harbor&quot;</span>,</span>
<span id="cb731-12"><a href="mod-r-plot.html#cb731-12" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Persons&quot;</span>) </span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-617-1.png" width="672" style="display: block; margin: auto;" />
<p>
The main harbor was Southampton.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-9xU8IPdPAt69Ayx8aGqLDpSOS2OsRVcjDvmOx6T1">
Solution
</button>
<div id="hint-8T5BrSStwiReDSWih1ZTb4ALA5StCF" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-8T5BrSStwiReDSWih1ZTb4ALA5StCF-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-8T5BrSStwiReDSWih1ZTb4ALA5StCF-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="mod-r-plot.html#cb732-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">harbor =</span> <span class="fu">case_when</span>(</span>
<span id="cb732-2"><a href="mod-r-plot.html#cb732-2" tabindex="-1"></a>  embarked <span class="sc">==</span> <span class="st">&quot;C&quot;</span> <span class="sc">~</span> <span class="st">&quot;Cherbourg&quot;</span>,</span>
<span id="cb732-3"><a href="mod-r-plot.html#cb732-3" tabindex="-1"></a>  embarked <span class="sc">==</span> <span class="st">&quot;Q&quot;</span> <span class="sc">~</span> <span class="st">&quot;Queenstown&quot;</span>,</span>
<span id="cb732-4"><a href="mod-r-plot.html#cb732-4" tabindex="-1"></a>  embarked <span class="sc">==</span> <span class="st">&quot;S&quot;</span> <span class="sc">~</span> <span class="st">&quot;Southampton&quot;</span>,</span>
<span id="cb732-5"><a href="mod-r-plot.html#cb732-5" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb732-6"><a href="mod-r-plot.html#cb732-6" tabindex="-1"></a>))</span>
<span id="cb732-7"><a href="mod-r-plot.html#cb732-7" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb732-8"><a href="mod-r-plot.html#cb732-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___)) <span class="sc">+</span></span>
<span id="cb732-9"><a href="mod-r-plot.html#cb732-9" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb732-10"><a href="mod-r-plot.html#cb732-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of persons embarking each departure harbor&quot;</span>,</span>
<span id="cb732-11"><a href="mod-r-plot.html#cb732-11" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Harbor&quot;</span>,</span>
<span id="cb732-12"><a href="mod-r-plot.html#cb732-12" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Persons&quot;</span>) </span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-8T5BrSStwiReDSWih1ZTb4ALA5StCF">
Hint
</button>
<ol style="list-style-type: decimal">
<li><p>Create a visualization showing the number of persons embarking the different harbors with the following features:</p>
<ul>
<li>Number of persons is represented using bars.</li>
<li>Informative figure title and axis titles are given.</li>
<li>The labels on the x-axis are the harbor names (not abbreviations).</li>
</ul>
<p>What harbor was the main departure harbor?</p></li>
</ol>
<!-- Q2 -->
<div id="solution-gJStRnSMC1qnWLNEqIZ8v4198rg9INkhefF1xvnZ" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-gJStRnSMC1qnWLNEqIZ8v4198rg9INkhefF1xvnZ-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-gJStRnSMC1qnWLNEqIZ8v4198rg9INkhefF1xvnZ-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="mod-r-plot.html#cb733-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb733-2"><a href="mod-r-plot.html#cb733-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb733-3"><a href="mod-r-plot.html#cb733-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb733-4"><a href="mod-r-plot.html#cb733-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Age distribution&quot;</span>,</span>
<span id="cb733-5"><a href="mod-r-plot.html#cb733-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Age&quot;</span>,</span>
<span id="cb733-6"><a href="mod-r-plot.html#cb733-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Persons&quot;</span>) </span>
<span id="cb733-7"><a href="mod-r-plot.html#cb733-7" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 263 rows containing non-finite outside the scale range (`stat_bin()`).</span></span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-619-1.png" width="672" style="display: block; margin: auto;" />
<p>
There where most people in their twenties.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-gJStRnSMC1qnWLNEqIZ8v4198rg9INkhefF1xvnZ">
Solution
</button>
<div id="hint-L6OJzjLroB3v3RtQUkNoGDLnCAJngI" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-L6OJzjLroB3v3RtQUkNoGDLnCAJngI-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-L6OJzjLroB3v3RtQUkNoGDLnCAJngI-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="mod-r-plot.html#cb734-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb734-2"><a href="mod-r-plot.html#cb734-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___)) <span class="sc">+</span></span>
<span id="cb734-3"><a href="mod-r-plot.html#cb734-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb734-4"><a href="mod-r-plot.html#cb734-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Age distribution&quot;</span>,</span>
<span id="cb734-5"><a href="mod-r-plot.html#cb734-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Age&quot;</span>,</span>
<span id="cb734-6"><a href="mod-r-plot.html#cb734-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Persons&quot;</span>) </span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-L6OJzjLroB3v3RtQUkNoGDLnCAJngI">
Hint
</button>
<ol start="2" style="list-style-type: decimal">
<li><p>Create a visualization showing the age distribution of the persons with the following features:</p>
<ul>
<li>Number of persons is represented using a histogram.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<p>Where there most people on board in their twenties or thirties?</p></li>
</ol>
<!-- Q3 -->
<div id="solution-DDtrJg26SogOni2fLAsSnUlKJ1EIXghpMsRlpQlM" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-DDtrJg26SogOni2fLAsSnUlKJ1EIXghpMsRlpQlM-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-DDtrJg26SogOni2fLAsSnUlKJ1EIXghpMsRlpQlM-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="mod-r-plot.html#cb735-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> fare, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb735-2"><a href="mod-r-plot.html#cb735-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb735-3"><a href="mod-r-plot.html#cb735-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb735-4"><a href="mod-r-plot.html#cb735-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Fare prices given age&quot;</span>,</span>
<span id="cb735-5"><a href="mod-r-plot.html#cb735-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Age&quot;</span>,</span>
<span id="cb735-6"><a href="mod-r-plot.html#cb735-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Price&quot;</span>,</span>
<span id="cb735-7"><a href="mod-r-plot.html#cb735-7" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Sex&quot;</span>) <span class="sc">+</span> </span>
<span id="cb735-8"><a href="mod-r-plot.html#cb735-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb735-9"><a href="mod-r-plot.html#cb735-9" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</span></span>
<span id="cb735-10"><a href="mod-r-plot.html#cb735-10" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 264 rows containing non-finite outside the scale range (`stat_smooth()`).</span></span>
<span id="cb735-11"><a href="mod-r-plot.html#cb735-11" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 264 rows containing missing values or values outside the scale range</span></span>
<span id="cb735-12"><a href="mod-r-plot.html#cb735-12" tabindex="-1"></a><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-621-1.png" width="672" style="display: block; margin: auto;" />
<p>
Based on the trend lines females in general pays more than males.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-DDtrJg26SogOni2fLAsSnUlKJ1EIXghpMsRlpQlM">
Solution
</button>
<div id="hint-K675O5CxYJVdM5iFvbWmhw9KSXVof6" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-K675O5CxYJVdM5iFvbWmhw9KSXVof6-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-K675O5CxYJVdM5iFvbWmhw9KSXVof6-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="mod-r-plot.html#cb736-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___, <span class="at">color =</span> ___)) <span class="sc">+</span></span>
<span id="cb736-2"><a href="mod-r-plot.html#cb736-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb736-3"><a href="mod-r-plot.html#cb736-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb736-4"><a href="mod-r-plot.html#cb736-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Fare prices given age&quot;</span>,</span>
<span id="cb736-5"><a href="mod-r-plot.html#cb736-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Age&quot;</span>,</span>
<span id="cb736-6"><a href="mod-r-plot.html#cb736-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Price&quot;</span>,</span>
<span id="cb736-7"><a href="mod-r-plot.html#cb736-7" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Sex&quot;</span>) <span class="sc">+</span> </span>
<span id="cb736-8"><a href="mod-r-plot.html#cb736-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-K675O5CxYJVdM5iFvbWmhw9KSXVof6">
Hint
</button>
<ol start="3" style="list-style-type: decimal">
<li><p>Create a visualization showing the fare as a function of age with the following features:</p>
<ul>
<li>Different colors are used for each sex.</li>
<li>Informative figure title and axis titles are given.</li>
<li>A trend line for each sex is added using <code>geom_smooth</code>.</li>
</ul>
<p>Based on the trend lines, do females in general pay more for a ticket?</p></li>
</ol>
<!-- Q4 -->
<div id="solution-eRZTezBQZb3moDkeTWx8IOtmlgzotMm7ilh2nBmF" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-eRZTezBQZb3moDkeTWx8IOtmlgzotMm7ilh2nBmF-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-eRZTezBQZb3moDkeTWx8IOtmlgzotMm7ilh2nBmF-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="mod-r-plot.html#cb737-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb737-2"><a href="mod-r-plot.html#cb737-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pclass, <span class="at">fill =</span> <span class="fu">as.logical</span>(survived))) <span class="sc">+</span></span>
<span id="cb737-3"><a href="mod-r-plot.html#cb737-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;fill&quot;</span>) <span class="sc">+</span></span>
<span id="cb737-4"><a href="mod-r-plot.html#cb737-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Survival rate given passenger class&quot;</span>,</span>
<span id="cb737-5"><a href="mod-r-plot.html#cb737-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Class&quot;</span>,</span>
<span id="cb737-6"><a href="mod-r-plot.html#cb737-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb737-7"><a href="mod-r-plot.html#cb737-7" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Survived&quot;</span>) <span class="sc">+</span> </span>
<span id="cb737-8"><a href="mod-r-plot.html#cb737-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-623-1.png" width="672" style="display: block; margin: auto;" />
<p>
Based on the plot most people survived at first classs.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-eRZTezBQZb3moDkeTWx8IOtmlgzotMm7ilh2nBmF">
Solution
</button>
<div id="hint-5tM40VACVuKkWF8rfaXkeoPImbm0mM" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-5tM40VACVuKkWF8rfaXkeoPImbm0mM-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-5tM40VACVuKkWF8rfaXkeoPImbm0mM-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="mod-r-plot.html#cb738-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb738-2"><a href="mod-r-plot.html#cb738-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">fill =</span> <span class="fu">as.logical</span>(___))) <span class="sc">+</span></span>
<span id="cb738-3"><a href="mod-r-plot.html#cb738-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;fill&quot;</span>) <span class="sc">+</span></span>
<span id="cb738-4"><a href="mod-r-plot.html#cb738-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Survival rate given passenger class&quot;</span>,</span>
<span id="cb738-5"><a href="mod-r-plot.html#cb738-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Class&quot;</span>,</span>
<span id="cb738-6"><a href="mod-r-plot.html#cb738-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb738-7"><a href="mod-r-plot.html#cb738-7" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Survived&quot;</span>) <span class="sc">+</span> </span>
<span id="cb738-8"><a href="mod-r-plot.html#cb738-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-5tM40VACVuKkWF8rfaXkeoPImbm0mM">
Hint
</button>
<ol start="4" style="list-style-type: decimal">
<li><p>Create a visualization showing the survival rate for each passenger class with the following features:</p>
<ul>
<li>Bars are used for each passenger class.</li>
<li>All bars have same height (100 %).</li>
<li>Colors are used to identify who survived and did not survived.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<p>Is the survival rate different on first and third class?</p></li>
</ol>
<!-- Q5 -->
<div id="solution-QnSq6iSbtlZAjFVBNdYWTeAeSs8x15rfuGwvAkcs" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-QnSq6iSbtlZAjFVBNdYWTeAeSs8x15rfuGwvAkcs-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-QnSq6iSbtlZAjFVBNdYWTeAeSs8x15rfuGwvAkcs-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="mod-r-plot.html#cb739-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb739-2"><a href="mod-r-plot.html#cb739-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">level =</span> <span class="fu">str_sub</span>(cabin, <span class="dv">1</span>, <span class="dv">1</span>)) </span>
<span id="cb739-3"><a href="mod-r-plot.html#cb739-3" tabindex="-1"></a></span>
<span id="cb739-4"><a href="mod-r-plot.html#cb739-4" tabindex="-1"></a>  dat <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(level)) <span class="sc">|&gt;</span> </span>
<span id="cb739-5"><a href="mod-r-plot.html#cb739-5" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> level, <span class="at">y =</span> fare)) <span class="sc">+</span></span>
<span id="cb739-6"><a href="mod-r-plot.html#cb739-6" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() </span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-625-1.png" width="672" style="display: block; margin: auto;" />
<p>
Based on the plot the fare prices at B and C level are more or less the same.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-QnSq6iSbtlZAjFVBNdYWTeAeSs8x15rfuGwvAkcs">
Solution
</button>
<div id="hint-RwFCn6K4Pc5IdHk16CvSA3f6Z5BfIk" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-RwFCn6K4Pc5IdHk16CvSA3f6Z5BfIk-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-RwFCn6K4Pc5IdHk16CvSA3f6Z5BfIk-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="mod-r-plot.html#cb740-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb740-2"><a href="mod-r-plot.html#cb740-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">level =</span> <span class="fu">str_sub</span>(cabin, <span class="dv">1</span>, <span class="dv">1</span>)) </span>
<span id="cb740-3"><a href="mod-r-plot.html#cb740-3" tabindex="-1"></a></span>
<span id="cb740-4"><a href="mod-r-plot.html#cb740-4" tabindex="-1"></a>  dat <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(___)) <span class="sc">|&gt;</span> </span>
<span id="cb740-5"><a href="mod-r-plot.html#cb740-5" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___)) <span class="sc">+</span></span>
<span id="cb740-6"><a href="mod-r-plot.html#cb740-6" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() </span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-RwFCn6K4Pc5IdHk16CvSA3f6Z5BfIk">
Hint
</button>
<ol start="5" style="list-style-type: decimal">
<li><p>Let column <code>level</code> denote the the first letter in <code>cabin</code>. Create a visualization showing the variance in fare prices with the following features:</p>
<ul>
<li>Ignore rows with missing <code>level</code>.</li>
<li>Variation is shown using a boxplot.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<p>Is the fare price different at the B and C level?</p></li>
</ol>
</div>
<div id="ex-r-covid-plot" class="section level3 hasAnchor" number="14.6.7">
<h3><span class="header-section-number">14.6.7</span> Exercise (covid)<a href="mod-r-plot.html#ex-r-covid-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a slightly modified version an exam assignment (reexam 2022-A3).</em></p>
<p>Use the <em>exercise R markdown template</em> to solve this exercise (<strong>File &gt; New File &gt; R Markdown…</strong>, select <strong>From template</strong> and then <strong>TFA Exercise</strong>).</p>
<p>Consider COVID-19 data obtained from Our World in Data in the file <code>covid.csv</code>. The dataset contains data from different countries. Some of the columns/variables are:</p>
<ul>
<li><code>cases</code>: New confirmed cases of COVID-19.</li>
<li><code>deaths</code>: New deaths attributed to COVID-19.</li>
<li><code>icu_patients</code>: Number of COVID-19 patients in intensive care units (ICUs) on a given day.</li>
<li><code>hosp_patients</code>: Number of COVID-19 patients in hospital on a given day.</li>
<li><code>tests</code>: Total tests for COVID-19.</li>
<li><code>positive_rate</code>: The share of COVID-19 tests that are positive, given as a rolling 7-day average.</li>
<li><code>vac</code>: Total number of people who received at least one vaccine dose.</li>
<li><code>fully_vac</code>: Total number of people who received all doses prescribed by the vaccination protocol.</li>
<li><code>population</code>: Country population.</li>
</ul>
<p>Other columns are <code>date</code>, <code>country</code>, <code>month</code> and <code>year</code>. You can read the dataset file using</p>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="mod-r-plot.html#cb741-1" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;bss-osca/tfa-package&quot;, build = FALSE)  # run if tfa not installed</span></span>
<span id="cb741-2"><a href="mod-r-plot.html#cb741-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb741-3"><a href="mod-r-plot.html#cb741-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/covid.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;tfa&quot;</span>))</span></code></pre></div>
<p>Answer this assignment using the <em>ggplot2</em> package in <em>tidyverse</em> (you may need <em>dplyr</em> for preparing the datasets you want to plot).</p>
<!-- Q1 -->
<div id="solution-p5TiQ7ppeMPmZj5XbDzwPsHougn4v0iAeekQC3bC" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-p5TiQ7ppeMPmZj5XbDzwPsHougn4v0iAeekQC3bC-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-p5TiQ7ppeMPmZj5XbDzwPsHougn4v0iAeekQC3bC-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="mod-r-plot.html#cb742-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb742-2"><a href="mod-r-plot.html#cb742-2" tabindex="-1"></a>   <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;Denmark&quot;</span>, <span class="sc">!</span><span class="fu">is.na</span>(cases)) <span class="sc">|&gt;</span> </span>
<span id="cb742-3"><a href="mod-r-plot.html#cb742-3" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> cases, <span class="at">x =</span> date)) <span class="sc">+</span></span>
<span id="cb742-4"><a href="mod-r-plot.html#cb742-4" tabindex="-1"></a>   <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb742-5"><a href="mod-r-plot.html#cb742-5" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of cases in Denmark&quot;</span>,</span>
<span id="cb742-6"><a href="mod-r-plot.html#cb742-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb742-7"><a href="mod-r-plot.html#cb742-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Cases&quot;</span></span>
<span id="cb742-8"><a href="mod-r-plot.html#cb742-8" tabindex="-1"></a>    )</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-628-1.png" width="672" style="display: block; margin: auto;" />
<p>
The number of cases in July 2020 are low.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-p5TiQ7ppeMPmZj5XbDzwPsHougn4v0iAeekQC3bC">
Solution
</button>
<div id="hint-WSC4Cp6y2dLUJzvP3EYYKoknmRCkQE" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-WSC4Cp6y2dLUJzvP3EYYKoknmRCkQE-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-WSC4Cp6y2dLUJzvP3EYYKoknmRCkQE-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="mod-r-plot.html#cb743-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb743-2"><a href="mod-r-plot.html#cb743-2" tabindex="-1"></a>   <span class="fu">filter</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb743-3"><a href="mod-r-plot.html#cb743-3" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ___, <span class="at">x =</span> ___)) <span class="sc">+</span></span>
<span id="cb743-4"><a href="mod-r-plot.html#cb743-4" tabindex="-1"></a>   <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb743-5"><a href="mod-r-plot.html#cb743-5" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of cases in Denmark&quot;</span>,</span>
<span id="cb743-6"><a href="mod-r-plot.html#cb743-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb743-7"><a href="mod-r-plot.html#cb743-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Cases&quot;</span></span>
<span id="cb743-8"><a href="mod-r-plot.html#cb743-8" tabindex="-1"></a>    )</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-WSC4Cp6y2dLUJzvP3EYYKoknmRCkQE">
Hint
</button>
<ol style="list-style-type: decimal">
<li><p>Create a visualization showing the number of cases for each date in Denmark with the following features:</p>
<ul>
<li>A blue line is used to visualize the data.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<p>Is the number of cases low or high in July 2020 in the plot?</p></li>
</ol>
<!-- Q2 -->
<div id="solution-Pk9GXkMVFD9XW2WUGKwK7GQsE6nIr50HH91DxFYE" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-Pk9GXkMVFD9XW2WUGKwK7GQsE6nIr50HH91DxFYE-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-Pk9GXkMVFD9XW2WUGKwK7GQsE6nIr50HH91DxFYE-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="mod-r-plot.html#cb744-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb744-2"><a href="mod-r-plot.html#cb744-2" tabindex="-1"></a>   <span class="fu">group_by</span>(country) <span class="sc">|&gt;</span></span>
<span id="cb744-3"><a href="mod-r-plot.html#cb744-3" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">total_deaths =</span> <span class="fu">cumsum</span>(<span class="fu">replace_na</span>(deaths, <span class="dv">0</span>))) <span class="sc">|&gt;</span></span>
<span id="cb744-4"><a href="mod-r-plot.html#cb744-4" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">total_deaths_cap =</span> total_deaths<span class="sc">/</span>(population<span class="sc">/</span><span class="dv">100000</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb744-5"><a href="mod-r-plot.html#cb744-5" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> total_deaths_cap, <span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb744-6"><a href="mod-r-plot.html#cb744-6" tabindex="-1"></a>   <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb744-7"><a href="mod-r-plot.html#cb744-7" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total number of deaths per 100000&quot;</span>,</span>
<span id="cb744-8"><a href="mod-r-plot.html#cb744-8" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb744-9"><a href="mod-r-plot.html#cb744-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Deaths per 100000 capita&quot;</span>,</span>
<span id="cb744-10"><a href="mod-r-plot.html#cb744-10" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Country&quot;</span></span>
<span id="cb744-11"><a href="mod-r-plot.html#cb744-11" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb744-12"><a href="mod-r-plot.html#cb744-12" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-630-1.png" width="672" style="display: block; margin: auto;" />
<p>
The highest relative number of deaths are for the United Kingdom.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-Pk9GXkMVFD9XW2WUGKwK7GQsE6nIr50HH91DxFYE">
Solution
</button>
<div id="hint-YdPEI4nkABuNXmTB95ny3IIxcJ3fGh" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-YdPEI4nkABuNXmTB95ny3IIxcJ3fGh-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-YdPEI4nkABuNXmTB95ny3IIxcJ3fGh-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="mod-r-plot.html#cb745-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb745-2"><a href="mod-r-plot.html#cb745-2" tabindex="-1"></a>   <span class="fu">group_by</span>(___) <span class="sc">|&gt;</span></span>
<span id="cb745-3"><a href="mod-r-plot.html#cb745-3" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">total_deaths =</span> <span class="fu">cumsum</span>(<span class="fu">replace_na</span>(deaths, <span class="dv">0</span>))) <span class="sc">|&gt;</span></span>
<span id="cb745-4"><a href="mod-r-plot.html#cb745-4" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">total_deaths_cap =</span> ___) <span class="sc">|&gt;</span> </span>
<span id="cb745-5"><a href="mod-r-plot.html#cb745-5" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___, <span class="at">color =</span> ___)) <span class="sc">+</span></span>
<span id="cb745-6"><a href="mod-r-plot.html#cb745-6" tabindex="-1"></a>   <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb745-7"><a href="mod-r-plot.html#cb745-7" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total number of deaths per 100000&quot;</span>,</span>
<span id="cb745-8"><a href="mod-r-plot.html#cb745-8" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb745-9"><a href="mod-r-plot.html#cb745-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Deaths per 100000 capita&quot;</span>,</span>
<span id="cb745-10"><a href="mod-r-plot.html#cb745-10" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Country&quot;</span></span>
<span id="cb745-11"><a href="mod-r-plot.html#cb745-11" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb745-12"><a href="mod-r-plot.html#cb745-12" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-YdPEI4nkABuNXmTB95ny3IIxcJ3fGh">
Hint
</button>
<ol start="2" style="list-style-type: decimal">
<li><p>Create a visualization showing the total number of deaths per 100000 capita as a function of date with the following features:</p>
<ul>
<li>Different colours are used for each country.</li>
<li>Lines are used to visualize the data.</li>
<li>Legends are put at the bottom of the plot.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<p>Hint: you may use the <code>cumsum</code> function to add all deaths up until a given date. You may here consider <code>NA</code> values in the <code>deaths</code> column as equal to zero (e.g. using <code>replace_na(deaths, 0)</code>).</p>
<p>Which country has the highest relative number of deaths in general?</p></li>
</ol>
<!-- Q3 -->
<div id="solution-s7vECyuUFrv3Kp7NzQIIYTqZg2QDCf1RkXQNNtXV" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-s7vECyuUFrv3Kp7NzQIIYTqZg2QDCf1RkXQNNtXV-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-s7vECyuUFrv3Kp7NzQIIYTqZg2QDCf1RkXQNNtXV-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="mod-r-plot.html#cb746-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb746-2"><a href="mod-r-plot.html#cb746-2" tabindex="-1"></a>   <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2021</span>) <span class="sc">|&gt;</span> </span>
<span id="cb746-3"><a href="mod-r-plot.html#cb746-3" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">partly =</span> vac<span class="sc">/</span>population, </span>
<span id="cb746-4"><a href="mod-r-plot.html#cb746-4" tabindex="-1"></a>          <span class="at">full =</span> fully_vac<span class="sc">/</span>population) <span class="sc">|&gt;</span></span>
<span id="cb746-5"><a href="mod-r-plot.html#cb746-5" tabindex="-1"></a>   <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(partly, full)) <span class="sc">|&gt;</span> </span>
<span id="cb746-6"><a href="mod-r-plot.html#cb746-6" tabindex="-1"></a>   <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb746-7"><a href="mod-r-plot.html#cb746-7" tabindex="-1"></a>   <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span> </span>
<span id="cb746-8"><a href="mod-r-plot.html#cb746-8" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(country)) <span class="sc">+</span></span>
<span id="cb746-9"><a href="mod-r-plot.html#cb746-9" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Percentage of vaccinated people&quot;</span>,</span>
<span id="cb746-10"><a href="mod-r-plot.html#cb746-10" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb746-11"><a href="mod-r-plot.html#cb746-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;%&quot;</span>,</span>
<span id="cb746-12"><a href="mod-r-plot.html#cb746-12" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Vac. type&quot;</span>) <span class="sc">+</span></span>
<span id="cb746-13"><a href="mod-r-plot.html#cb746-13" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span>
<span id="cb746-14"><a href="mod-r-plot.html#cb746-14" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 2 rows containing missing values or values outside the scale range</span></span>
<span id="cb746-15"><a href="mod-r-plot.html#cb746-15" tabindex="-1"></a><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-632-1.png" width="672" style="display: block; margin: auto;" />
<p>
The plot showes that Denmark has the highest percentage of vaccinated people and the lowest gap between partly and full vaccinated.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-s7vECyuUFrv3Kp7NzQIIYTqZg2QDCf1RkXQNNtXV">
Solution
</button>
<div id="hint-kJGowYnjXzTFAiK9FEkrUS5dBEVR8A" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-kJGowYnjXzTFAiK9FEkrUS5dBEVR8A-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-kJGowYnjXzTFAiK9FEkrUS5dBEVR8A-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="mod-r-plot.html#cb747-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb747-2"><a href="mod-r-plot.html#cb747-2" tabindex="-1"></a>   <span class="fu">filter</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb747-3"><a href="mod-r-plot.html#cb747-3" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">partly =</span> ___, </span>
<span id="cb747-4"><a href="mod-r-plot.html#cb747-4" tabindex="-1"></a>          <span class="at">full =</span> ___) <span class="sc">|&gt;</span></span>
<span id="cb747-5"><a href="mod-r-plot.html#cb747-5" tabindex="-1"></a>   <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(partly, full)) <span class="sc">|&gt;</span> </span>
<span id="cb747-6"><a href="mod-r-plot.html#cb747-6" tabindex="-1"></a>   <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb747-7"><a href="mod-r-plot.html#cb747-7" tabindex="-1"></a>   <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___, <span class="at">color =</span> ___)) <span class="sc">+</span> </span>
<span id="cb747-8"><a href="mod-r-plot.html#cb747-8" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(___)) <span class="sc">+</span></span>
<span id="cb747-9"><a href="mod-r-plot.html#cb747-9" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Percentage of vaccinated people&quot;</span>,</span>
<span id="cb747-10"><a href="mod-r-plot.html#cb747-10" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb747-11"><a href="mod-r-plot.html#cb747-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;%&quot;</span>,</span>
<span id="cb747-12"><a href="mod-r-plot.html#cb747-12" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Vac. type&quot;</span>) <span class="sc">+</span></span>
<span id="cb747-13"><a href="mod-r-plot.html#cb747-13" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-kJGowYnjXzTFAiK9FEkrUS5dBEVR8A">
Hint
</button>
<ol start="3" style="list-style-type: decimal">
<li><p>Create a visualization showing the percentage of persons vaccinated as a function of date with the following features:</p>
<ul>
<li>We consider 2021.</li>
<li>Different colours are used to differ between vaccinated and fully vaccinated.</li>
<li>The plot is divided using <code>country</code> (facet).</li>
<li>Lines are used to visualize the data.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<p>Hint: If you calculated the two percentages in two new columns <code>partly</code> and <code>full</code>, then the values can be joined to one column using</p>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="mod-r-plot.html#cb748-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb748-2"><a href="mod-r-plot.html#cb748-2" tabindex="-1"></a>   <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(partly, full))</span></code></pre></div>
<p>Which country has the highest percentage of vaccinated people and the lowest gap between partly and fully vaccinated?</p></li>
</ol>
<!-- Q4 -->
<div id="solution-IiEBbNyKYYEL566bumTxs4svv93Q07Vw5YmTffXz" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-IiEBbNyKYYEL566bumTxs4svv93Q07Vw5YmTffXz-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-IiEBbNyKYYEL566bumTxs4svv93Q07Vw5YmTffXz-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="mod-r-plot.html#cb749-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb749-2"><a href="mod-r-plot.html#cb749-2" tabindex="-1"></a>   <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&quot;Germany&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb749-3"><a href="mod-r-plot.html#cb749-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> icu_patients)) <span class="sc">+</span></span>
<span id="cb749-4"><a href="mod-r-plot.html#cb749-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb749-5"><a href="mod-r-plot.html#cb749-5" tabindex="-1"></a>  <span class="fu">facet_grid</span>(month <span class="sc">~</span> year, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb749-6"><a href="mod-r-plot.html#cb749-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ICU patients given year and month&quot;</span>,</span>
<span id="cb749-7"><a href="mod-r-plot.html#cb749-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb749-8"><a href="mod-r-plot.html#cb749-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Patients&quot;</span>) <span class="sc">+</span></span>
<span id="cb749-9"><a href="mod-r-plot.html#cb749-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb749-10"><a href="mod-r-plot.html#cb749-10" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb749-11"><a href="mod-r-plot.html#cb749-11" tabindex="-1"></a>        <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>(), </span>
<span id="cb749-12"><a href="mod-r-plot.html#cb749-12" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb749-13"><a href="mod-r-plot.html#cb749-13" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 63 rows containing non-finite outside the scale range (`stat_boxplot()`).</span></span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-635-1.png" width="672" style="display: block; margin: auto;" />
<p>
In 2021 the mean value of the ICU patients was highest when considering October.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-IiEBbNyKYYEL566bumTxs4svv93Q07Vw5YmTffXz">
Solution
</button>
<div id="hint-ZUr7ZWTmcPEJyVyTDF1Lyhgp4pCI9C" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-ZUr7ZWTmcPEJyVyTDF1Lyhgp4pCI9C-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-ZUr7ZWTmcPEJyVyTDF1Lyhgp4pCI9C-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="mod-r-plot.html#cb750-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb750-2"><a href="mod-r-plot.html#cb750-2" tabindex="-1"></a>   <span class="fu">filter</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb750-3"><a href="mod-r-plot.html#cb750-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ___)) <span class="sc">+</span></span>
<span id="cb750-4"><a href="mod-r-plot.html#cb750-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb750-5"><a href="mod-r-plot.html#cb750-5" tabindex="-1"></a>  <span class="fu">facet_grid</span>(___ <span class="sc">~</span> ___, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb750-6"><a href="mod-r-plot.html#cb750-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;ICU patients given year and month&quot;</span>,</span>
<span id="cb750-7"><a href="mod-r-plot.html#cb750-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb750-8"><a href="mod-r-plot.html#cb750-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Patients&quot;</span>) <span class="sc">+</span></span>
<span id="cb750-9"><a href="mod-r-plot.html#cb750-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb750-10"><a href="mod-r-plot.html#cb750-10" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb750-11"><a href="mod-r-plot.html#cb750-11" tabindex="-1"></a>        <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>(), </span>
<span id="cb750-12"><a href="mod-r-plot.html#cb750-12" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-ZUr7ZWTmcPEJyVyTDF1Lyhgp4pCI9C">
Hint
</button>
<ol start="4" style="list-style-type: decimal">
<li><p>Consider Germany. Create a visualization showing the variation in ICU patients with the following features:</p>
<ul>
<li>A sub-plot is given for each month and year (facet).</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<p>In which year did the ICU have the most patients when considering October?</p></li>
</ol>
<!-- Q5 -->
<div id="solution-Y1O4uFyso6UBr2EfF0VsQ2Dmd5GQs7MWMRTfuGjI" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-Y1O4uFyso6UBr2EfF0VsQ2Dmd5GQs7MWMRTfuGjI-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-Y1O4uFyso6UBr2EfF0VsQ2Dmd5GQs7MWMRTfuGjI-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="mod-r-plot.html#cb751-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb751-2"><a href="mod-r-plot.html#cb751-2" tabindex="-1"></a>   <span class="fu">group_by</span>(country, year) <span class="sc">|&gt;</span> </span>
<span id="cb751-3"><a href="mod-r-plot.html#cb751-3" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">deaths =</span> <span class="fu">sum</span>(deaths<span class="sc">/</span>(population<span class="sc">/</span><span class="dv">100000</span>) , <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb751-4"><a href="mod-r-plot.html#cb751-4" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> deaths, <span class="at">x =</span> country, <span class="at">fill =</span> <span class="fu">factor</span>(year))) <span class="sc">+</span></span>
<span id="cb751-5"><a href="mod-r-plot.html#cb751-5" tabindex="-1"></a>   <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb751-6"><a href="mod-r-plot.html#cb751-6" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total number of deaths&quot;</span>,</span>
<span id="cb751-7"><a href="mod-r-plot.html#cb751-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb751-8"><a href="mod-r-plot.html#cb751-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Deaths&quot;</span>,</span>
<span id="cb751-9"><a href="mod-r-plot.html#cb751-9" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Year&quot;</span>) <span class="sc">+</span></span>
<span id="cb751-10"><a href="mod-r-plot.html#cb751-10" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-637-1.png" width="672" style="display: block; margin: auto;" />
<p>
Norway had the lowest number of deaths in 2021.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-Y1O4uFyso6UBr2EfF0VsQ2Dmd5GQs7MWMRTfuGjI">
Solution
</button>
<div id="hint-THlMNw71OMrA8bsVkqWqZlpxE8aJ4p" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-THlMNw71OMrA8bsVkqWqZlpxE8aJ4p-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-THlMNw71OMrA8bsVkqWqZlpxE8aJ4p-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="mod-r-plot.html#cb752-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb752-2"><a href="mod-r-plot.html#cb752-2" tabindex="-1"></a>   <span class="fu">group_by</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb752-3"><a href="mod-r-plot.html#cb752-3" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">deaths =</span> <span class="fu">sum</span>(___ , <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb752-4"><a href="mod-r-plot.html#cb752-4" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ___, <span class="at">x =</span> ___, <span class="at">fill =</span> <span class="fu">factor</span>(___))) <span class="sc">+</span></span>
<span id="cb752-5"><a href="mod-r-plot.html#cb752-5" tabindex="-1"></a>   <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb752-6"><a href="mod-r-plot.html#cb752-6" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total number of deaths&quot;</span>,</span>
<span id="cb752-7"><a href="mod-r-plot.html#cb752-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb752-8"><a href="mod-r-plot.html#cb752-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Deaths&quot;</span>,</span>
<span id="cb752-9"><a href="mod-r-plot.html#cb752-9" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Year&quot;</span>) <span class="sc">+</span></span>
<span id="cb752-10"><a href="mod-r-plot.html#cb752-10" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-THlMNw71OMrA8bsVkqWqZlpxE8aJ4p">
Hint
</button>
<ol start="5" style="list-style-type: decimal">
<li><p>Create a visualization showing the total number of deaths per 100000 capita for each country and year with the following features:</p>
<ul>
<li>The numbers are shown using columns for each country</li>
<li>Different fill colours are used for year. Hint: columns for each year can be shown beside each other using <code>position = position_dodge()</code>.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<p>Which country had the lowest number of deaths in 2021?</p></li>
</ol>
</div>
<div id="ex-r-election-plot" class="section level3 hasAnchor" number="14.6.8">
<h3><span class="header-section-number">14.6.8</span> Exercise (election)<a href="mod-r-plot.html#ex-r-election-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a slightly modified version an exam assignment (reexam 2022-A3).</em></p>
<p>Use the <em>exercise R markdown template</em> to solve this exercise (<strong>File &gt; New File &gt; R Markdown…</strong>, select <strong>From template</strong> and then <strong>TFA Exercise</strong>).</p>
<p>Answer this assignment using the <em>ggplot2</em> package in <em>tidyverse</em> (you might need dplyr for preparing the datasets you want to plot). We work with the dataset from Assignment 2 which can be read using:</p>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="mod-r-plot.html#cb753-1" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;bss-osca/tfa-package&quot;, build = FALSE)  # run if tfa not installed</span></span>
<span id="cb753-2"><a href="mod-r-plot.html#cb753-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb753-3"><a href="mod-r-plot.html#cb753-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/elections.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;tfa&quot;</span>))</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Create a visualization showing the total number of votes for each election year with the following features:</li>
</ol>
<ul>
<li>Number of votes is represented using columns.</li>
<li>Columns are filled with colours for each party.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<div id="solution-HHI67d5nwIY0b8n6QGmLOqk44GBEOvT483WqcVTH" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-HHI67d5nwIY0b8n6QGmLOqk44GBEOvT483WqcVTH-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-HHI67d5nwIY0b8n6QGmLOqk44GBEOvT483WqcVTH-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="mod-r-plot.html#cb754-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb754-2"><a href="mod-r-plot.html#cb754-2" tabindex="-1"></a>  <span class="fu">group_by</span>(year, party) <span class="sc">|&gt;</span> </span>
<span id="cb754-3"><a href="mod-r-plot.html#cb754-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">votes =</span> <span class="fu">sum</span>(validVotes)) <span class="sc">|&gt;</span> </span>
<span id="cb754-4"><a href="mod-r-plot.html#cb754-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> votes, <span class="at">x =</span> <span class="fu">factor</span>(year), <span class="at">fill =</span> party)) <span class="sc">+</span></span>
<span id="cb754-5"><a href="mod-r-plot.html#cb754-5" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb754-6"><a href="mod-r-plot.html#cb754-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total number of votes&quot;</span>,</span>
<span id="cb754-7"><a href="mod-r-plot.html#cb754-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb754-8"><a href="mod-r-plot.html#cb754-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Votes&quot;</span></span>
<span id="cb754-9"><a href="mod-r-plot.html#cb754-9" tabindex="-1"></a>    )</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-640-1.png" width="672" style="display: block; margin: auto;" />
<p>
The lowest number of votes was in 2009.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-HHI67d5nwIY0b8n6QGmLOqk44GBEOvT483WqcVTH">
Solution
</button>
<div id="hint-5rXJqqAbAlP2cqRmuuCTp8FRKmMoWu" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-5rXJqqAbAlP2cqRmuuCTp8FRKmMoWu-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-5rXJqqAbAlP2cqRmuuCTp8FRKmMoWu-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="mod-r-plot.html#cb755-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb755-2"><a href="mod-r-plot.html#cb755-2" tabindex="-1"></a>  <span class="fu">group_by</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb755-3"><a href="mod-r-plot.html#cb755-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">votes =</span> ___) <span class="sc">|&gt;</span> </span>
<span id="cb755-4"><a href="mod-r-plot.html#cb755-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ___, <span class="at">x =</span> <span class="fu">factor</span>(year), <span class="at">fill =</span> ___)) <span class="sc">+</span></span>
<span id="cb755-5"><a href="mod-r-plot.html#cb755-5" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb755-6"><a href="mod-r-plot.html#cb755-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total number of votes&quot;</span>,</span>
<span id="cb755-7"><a href="mod-r-plot.html#cb755-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb755-8"><a href="mod-r-plot.html#cb755-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Votes&quot;</span></span>
<span id="cb755-9"><a href="mod-r-plot.html#cb755-9" tabindex="-1"></a>    )</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-5rXJqqAbAlP2cqRmuuCTp8FRKmMoWu">
Hint
</button>
<p>Which year had the lowest number of votes?</p>
<ol start="2" style="list-style-type: decimal">
<li>Create a visualization showing the relative number of elected women in each municipality with the following features:</li>
</ol>
<ul>
<li>The relative number of elected women is shown using columns.</li>
<li>Municipalities are rotated 90 degrees on the x-axis.</li>
<li>The columns are sorted increasing.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<div id="solution-QT8wIDP0XagUl5FYb69C9ut0RcEKkGeYmJkId53w" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-QT8wIDP0XagUl5FYb69C9ut0RcEKkGeYmJkId53w-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-QT8wIDP0XagUl5FYb69C9ut0RcEKkGeYmJkId53w-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="mod-r-plot.html#cb756-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb756-2"><a href="mod-r-plot.html#cb756-2" tabindex="-1"></a>  <span class="fu">group_by</span>(area) <span class="sc">|&gt;</span> </span>
<span id="cb756-3"><a href="mod-r-plot.html#cb756-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">electedWomen =</span> <span class="fu">sum</span>(electedWomen), <span class="at">electedMen =</span> <span class="fu">sum</span>(electedMen)) <span class="sc">|&gt;</span> </span>
<span id="cb756-4"><a href="mod-r-plot.html#cb756-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">electedWomenPct =</span> electedWomen<span class="sc">/</span>(electedMen <span class="sc">+</span> electedWomen)) <span class="sc">|&gt;</span> </span>
<span id="cb756-5"><a href="mod-r-plot.html#cb756-5" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(electedWomenPct)) <span class="sc">|&gt;</span> </span>
<span id="cb756-6"><a href="mod-r-plot.html#cb756-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(area, electedWomenPct), <span class="at">y =</span> electedWomenPct)) <span class="sc">+</span></span>
<span id="cb756-7"><a href="mod-r-plot.html#cb756-7" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb756-8"><a href="mod-r-plot.html#cb756-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Relative number of elected women&quot;</span>,</span>
<span id="cb756-9"><a href="mod-r-plot.html#cb756-9" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Municipality&quot;</span>,</span>
<span id="cb756-10"><a href="mod-r-plot.html#cb756-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;%&quot;</span></span>
<span id="cb756-11"><a href="mod-r-plot.html#cb756-11" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb756-12"><a href="mod-r-plot.html#cb756-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-642-1.png" width="672" style="display: block; margin: auto;" />
<p>
The lowest number elected is in Ærø and the highest is in Gentofte.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-QT8wIDP0XagUl5FYb69C9ut0RcEKkGeYmJkId53w">
Solution
</button>
<div id="hint-NPkpHlWbXBw7DjmNHyOfTQcuXJJdUm" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-NPkpHlWbXBw7DjmNHyOfTQcuXJJdUm-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-NPkpHlWbXBw7DjmNHyOfTQcuXJJdUm-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="mod-r-plot.html#cb757-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb757-2"><a href="mod-r-plot.html#cb757-2" tabindex="-1"></a>  <span class="fu">group_by</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb757-3"><a href="mod-r-plot.html#cb757-3" tabindex="-1"></a>  <span class="fu">summarize</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb757-4"><a href="mod-r-plot.html#cb757-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">electedWomenPct =</span> ___) <span class="sc">|&gt;</span> </span>
<span id="cb757-5"><a href="mod-r-plot.html#cb757-5" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(electedWomenPct)) <span class="sc">|&gt;</span> </span>
<span id="cb757-6"><a href="mod-r-plot.html#cb757-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(___), <span class="at">y =</span> ___)) <span class="sc">+</span></span>
<span id="cb757-7"><a href="mod-r-plot.html#cb757-7" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb757-8"><a href="mod-r-plot.html#cb757-8" tabindex="-1"></a>  <span class="fu">labs</span>(___) <span class="sc">+</span></span>
<span id="cb757-9"><a href="mod-r-plot.html#cb757-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-NPkpHlWbXBw7DjmNHyOfTQcuXJJdUm">
Hint
</button>
<p>Which municipality has the lowest/highest percentage of women elected?</p>
<ol start="3" style="list-style-type: decimal">
<li>Create a visualization showing the elected number of candidates as a function of election year with the following features:</li>
</ol>
<ul>
<li>We consider only municipalities Herning, Copenhagen and Aarhus.</li>
<li>We consider only the Social Democratic Party, Conservative Peoples Party and Liberal Democratic Party.</li>
<li>The plot is divided using <code>area</code> (facet).</li>
<li>Different colours are used for each party.</li>
<li>Informative figure title and axis titles are given.</li>
<li>Data points are given in the plot.</li>
<li>A line for each party is added.</li>
</ul>
<div id="solution-bJfv5cPzx1HRWJqL6t5Psdjp82v0qDxn7BqHXK19" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-bJfv5cPzx1HRWJqL6t5Psdjp82v0qDxn7BqHXK19-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-bJfv5cPzx1HRWJqL6t5Psdjp82v0qDxn7BqHXK19-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="mod-r-plot.html#cb758-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb758-2"><a href="mod-r-plot.html#cb758-2" tabindex="-1"></a>  <span class="fu">filter</span>(area <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Herning&quot;</span>, <span class="st">&quot;Copenhagen&quot;</span>, <span class="st">&quot;Aarhus&quot;</span>), party <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Social Democratic Party&quot;</span>, <span class="st">&quot;Conservative Peoples Party&quot;</span>, <span class="st">&quot;Liberal Democratic Party&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb758-3"><a href="mod-r-plot.html#cb758-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">elected =</span> electedMen <span class="sc">+</span> electedWomen) <span class="sc">|&gt;</span> </span>
<span id="cb758-4"><a href="mod-r-plot.html#cb758-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> elected, <span class="at">color =</span> party)) <span class="sc">+</span></span>
<span id="cb758-5"><a href="mod-r-plot.html#cb758-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb758-6"><a href="mod-r-plot.html#cb758-6" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb758-7"><a href="mod-r-plot.html#cb758-7" tabindex="-1"></a>  <span class="fu">scale_x_binned</span>(<span class="at">n.breaks =</span> <span class="dv">4</span>, <span class="at">nice.breaks =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb758-8"><a href="mod-r-plot.html#cb758-8" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> area) <span class="sc">+</span></span>
<span id="cb758-9"><a href="mod-r-plot.html#cb758-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Elected persons&quot;</span>,</span>
<span id="cb758-10"><a href="mod-r-plot.html#cb758-10" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb758-11"><a href="mod-r-plot.html#cb758-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Elected&quot;</span>,</span>
<span id="cb758-12"><a href="mod-r-plot.html#cb758-12" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Party&quot;</span>) <span class="sc">+</span></span>
<span id="cb758-13"><a href="mod-r-plot.html#cb758-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-644-1.png" width="672" style="display: block; margin: auto;" />
<p>
The trend for the Social Democratic Party in Copenhagen is decreasing over the years.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-bJfv5cPzx1HRWJqL6t5Psdjp82v0qDxn7BqHXK19">
Solution
</button>
<div id="hint-o2gPxJOjgqFCAKpxoKdMfOcfeRZm5B" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-o2gPxJOjgqFCAKpxoKdMfOcfeRZm5B-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-o2gPxJOjgqFCAKpxoKdMfOcfeRZm5B-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="mod-r-plot.html#cb759-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb759-2"><a href="mod-r-plot.html#cb759-2" tabindex="-1"></a>  <span class="fu">filter</span>(area <span class="sc">%in%</span> <span class="fu">c</span>(___), party <span class="sc">%in%</span> <span class="fu">c</span>(___)) <span class="sc">|&gt;</span> </span>
<span id="cb759-3"><a href="mod-r-plot.html#cb759-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">elected =</span> electedMen <span class="sc">+</span> electedWomen) <span class="sc">|&gt;</span> </span>
<span id="cb759-4"><a href="mod-r-plot.html#cb759-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(___)) <span class="sc">+</span></span>
<span id="cb759-5"><a href="mod-r-plot.html#cb759-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb759-6"><a href="mod-r-plot.html#cb759-6" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb759-7"><a href="mod-r-plot.html#cb759-7" tabindex="-1"></a>  <span class="fu">scale_x_binned</span>(<span class="at">n.breaks =</span> <span class="dv">4</span>, <span class="at">nice.breaks =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb759-8"><a href="mod-r-plot.html#cb759-8" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> ___) <span class="sc">+</span></span>
<span id="cb759-9"><a href="mod-r-plot.html#cb759-9" tabindex="-1"></a>  <span class="fu">labs</span>(___) <span class="sc">+</span></span>
<span id="cb759-10"><a href="mod-r-plot.html#cb759-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-o2gPxJOjgqFCAKpxoKdMfOcfeRZm5B">
Hint
</button>
<p>Consider the Social Democratic Party in Copenhagen. Based on the plot do the elected number of candidates increase or decrease over the election years?</p>
<ol start="4" style="list-style-type: decimal">
<li>Create a visualization showing the relative number of women elected compared to listed (e.g. if listed is 12 and elected is 4 then the number is 4/12) with the following features:</li>
</ol>
<ul>
<li>Columns are used for each party.</li>
<li>Colours are used to identify the party.</li>
<li>A sub-plot is given for each year.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<div id="solution-1E5KtN83ihmSZ2cBk0wRUoNAGGpDXerF5zKDOlgl" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-1E5KtN83ihmSZ2cBk0wRUoNAGGpDXerF5zKDOlgl-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-1E5KtN83ihmSZ2cBk0wRUoNAGGpDXerF5zKDOlgl-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="mod-r-plot.html#cb760-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb760-2"><a href="mod-r-plot.html#cb760-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">electedW =</span> electedWomen<span class="sc">/</span>listedWomen) <span class="sc">|&gt;</span> </span>
<span id="cb760-3"><a href="mod-r-plot.html#cb760-3" tabindex="-1"></a>  <span class="fu">group_by</span>(party, year) <span class="sc">|&gt;</span> </span>
<span id="cb760-4"><a href="mod-r-plot.html#cb760-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">electedW =</span> <span class="fu">mean</span>(electedW, <span class="at">na.rm =</span> T)) <span class="sc">|&gt;</span> </span>
<span id="cb760-5"><a href="mod-r-plot.html#cb760-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(party, electedW), <span class="at">y =</span> electedW, <span class="at">fill =</span> party)) <span class="sc">+</span></span>
<span id="cb760-6"><a href="mod-r-plot.html#cb760-6" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb760-7"><a href="mod-r-plot.html#cb760-7" tabindex="-1"></a>  <span class="fu">facet_grid</span>(year <span class="sc">~</span> .) <span class="sc">+</span></span>
<span id="cb760-8"><a href="mod-r-plot.html#cb760-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Releative number of women elected compared to listed.&quot;</span>,</span>
<span id="cb760-9"><a href="mod-r-plot.html#cb760-9" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Party&quot;</span>,</span>
<span id="cb760-10"><a href="mod-r-plot.html#cb760-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Percentage&quot;</span>,</span>
<span id="cb760-11"><a href="mod-r-plot.html#cb760-11" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Party&quot;</span>) <span class="sc">+</span></span>
<span id="cb760-12"><a href="mod-r-plot.html#cb760-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb760-13"><a href="mod-r-plot.html#cb760-13" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb760-14"><a href="mod-r-plot.html#cb760-14" tabindex="-1"></a>        <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>(), <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb760-15"><a href="mod-r-plot.html#cb760-15" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 7 rows containing missing values or values outside the scale range (`geom_col()`).</span></span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-646-1.png" width="672" style="display: block; margin: auto;" />
<p>
For all years the Social Democratic Party has the highest number of the listed women elected.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-1E5KtN83ihmSZ2cBk0wRUoNAGGpDXerF5zKDOlgl">
Solution
</button>
<div id="hint-ZOkSSM59loG2XNxYb4mrrJ2k72SOnW" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-ZOkSSM59loG2XNxYb4mrrJ2k72SOnW-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-ZOkSSM59loG2XNxYb4mrrJ2k72SOnW-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="mod-r-plot.html#cb761-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb761-2"><a href="mod-r-plot.html#cb761-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">electedW =</span> ___) <span class="sc">|&gt;</span> </span>
<span id="cb761-3"><a href="mod-r-plot.html#cb761-3" tabindex="-1"></a>  <span class="fu">group_by</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb761-4"><a href="mod-r-plot.html#cb761-4" tabindex="-1"></a>  <span class="fu">summarize</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb761-5"><a href="mod-r-plot.html#cb761-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(___), <span class="at">y =</span> ___, <span class="at">fill =</span> ___)) <span class="sc">+</span></span>
<span id="cb761-6"><a href="mod-r-plot.html#cb761-6" tabindex="-1"></a>  ___ <span class="sc">+</span></span>
<span id="cb761-7"><a href="mod-r-plot.html#cb761-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb761-8"><a href="mod-r-plot.html#cb761-8" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb761-9"><a href="mod-r-plot.html#cb761-9" tabindex="-1"></a>        <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>(), <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-ZOkSSM59loG2XNxYb4mrrJ2k72SOnW">
Hint
</button>
<p>Which party seems to get the highest number of the listed women elected?</p>
<ol start="5" style="list-style-type: decimal">
<li>Create a visualization showing the variance in the relative number of personal votes compared to valid votes (i.e. divide the two numbers) with the following features:</li>
</ol>
<ul>
<li>We consider only municipalities Herning, Copenhagen and Aarhus.</li>
<li>Variation is shown using a box-plot for each municipality.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<div id="solution-I5jo9bhSlZkTskIZTwXKLonYRzJVQYCMz121BR5X" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-I5jo9bhSlZkTskIZTwXKLonYRzJVQYCMz121BR5X-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-I5jo9bhSlZkTskIZTwXKLonYRzJVQYCMz121BR5X-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="mod-r-plot.html#cb762-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb762-2"><a href="mod-r-plot.html#cb762-2" tabindex="-1"></a>  <span class="fu">filter</span>(area <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Herning&quot;</span>, <span class="st">&quot;Copenhagen&quot;</span>, <span class="st">&quot;Aarhus&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb762-3"><a href="mod-r-plot.html#cb762-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">personal =</span> personalVotes<span class="sc">/</span>validVotes) <span class="sc">|&gt;</span> </span>
<span id="cb762-4"><a href="mod-r-plot.html#cb762-4" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> area, <span class="at">y =</span> personal, <span class="at">fill =</span> area)) <span class="sc">+</span></span>
<span id="cb762-5"><a href="mod-r-plot.html#cb762-5" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb762-6"><a href="mod-r-plot.html#cb762-6" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Releative number of personal votes over all the election years.&quot;</span>,</span>
<span id="cb762-7"><a href="mod-r-plot.html#cb762-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Municipality&quot;</span>,</span>
<span id="cb762-8"><a href="mod-r-plot.html#cb762-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Personal votes (pct)&quot;</span>,</span>
<span id="cb762-9"><a href="mod-r-plot.html#cb762-9" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Municipality&quot;</span>) <span class="sc">+</span></span>
<span id="cb762-10"><a href="mod-r-plot.html#cb762-10" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb762-11"><a href="mod-r-plot.html#cb762-11" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 34 rows containing non-finite outside the scale range (`stat_boxplot()`).</span></span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-648-1.png" width="672" style="display: block; margin: auto;" />
<p>
Based on the plot Herning has the highest median of personal votes.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-I5jo9bhSlZkTskIZTwXKLonYRzJVQYCMz121BR5X">
Solution
</button>
<div id="hint-0nnupZk6rIRCNbqtFZoIDaHPFRonTx" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-0nnupZk6rIRCNbqtFZoIDaHPFRonTx-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-0nnupZk6rIRCNbqtFZoIDaHPFRonTx-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="mod-r-plot.html#cb763-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb763-2"><a href="mod-r-plot.html#cb763-2" tabindex="-1"></a>  <span class="fu">filter</span>(area <span class="sc">%in%</span> <span class="fu">c</span>(___)) <span class="sc">|&gt;</span> </span>
<span id="cb763-3"><a href="mod-r-plot.html#cb763-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">personal =</span> ___) <span class="sc">|&gt;</span> </span>
<span id="cb763-4"><a href="mod-r-plot.html#cb763-4" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(___)) <span class="sc">+</span></span>
<span id="cb763-5"><a href="mod-r-plot.html#cb763-5" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb763-6"><a href="mod-r-plot.html#cb763-6" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Releative number of personal votes over all the election years.&quot;</span>,</span>
<span id="cb763-7"><a href="mod-r-plot.html#cb763-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Municipality&quot;</span>,</span>
<span id="cb763-8"><a href="mod-r-plot.html#cb763-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Personal votes (pct)&quot;</span>,</span>
<span id="cb763-9"><a href="mod-r-plot.html#cb763-9" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Municipality&quot;</span>) <span class="sc">+</span></span>
<span id="cb763-10"><a href="mod-r-plot.html#cb763-10" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-0nnupZk6rIRCNbqtFZoIDaHPFRonTx">
Hint
</button>
<p>Which municipality has the highest median?</p>
</div>
<div id="ex-r-orders-plot" class="section level3 hasAnchor" number="14.6.9">
<h3><span class="header-section-number">14.6.9</span> Exercise (orders)<a href="mod-r-plot.html#ex-r-orders-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a slightly modified version an exam assignment (reexam 2023-A2).</em></p>
<p>Use the <em>exercise R markdown template</em> to solve this exercise (<strong>File &gt; New File &gt; R Markdown…</strong>, select <strong>From template</strong> and then <strong>TFA Exercise</strong>).</p>
<p>Answer this assignment using the <em>ggplot2</em> package in <em>tidyverse</em> (you may need <em>dplyr</em> for preparing the datasets you want to plot).</p>
<p>Consider the dataset in the file <code>orders.csv</code> with purchase orders for a group of ships.</p>
<p>The dataset contains a row for each item used in an order. The columns/variables are:</p>
<ul>
<li><code>ship</code>: The ship considered.</li>
<li><code>order_id</code>: Order id. An order is a group of items purchased in one batch from a single supplier.</li>
<li><code>item_id</code>: Item id.</li>
<li><code>item_desc</code>: Item description.</li>
<li><code>quantity</code>: Number of items ordered.</li>
<li><code>price</code>: Price per unit.</li>
<li><code>order_date</code>: Order date.</li>
<li><code>delivery_date</code>: Expected delivery date when order is made.</li>
<li><code>delivery_place</code>: Delivery place.</li>
<li><code>recieved_date</code>: Actual date the order is recieved.</li>
<li><code>supplier</code>: Supplier for the order.</li>
<li><code>delivery_cost</code>: Delivery cost.</li>
<li><code>order_year</code>: Year the order was placed.</li>
</ul>
<p>You can read the dataset file into the dataset <code>dat</code> using</p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="mod-r-plot.html#cb764-1" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;bss-osca/tfa-package&quot;, build = FALSE)  # run if tfa not installed</span></span>
<span id="cb764-2"><a href="mod-r-plot.html#cb764-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb764-3"><a href="mod-r-plot.html#cb764-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/orders.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;tfa&quot;</span>))</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Create a visualization showing the number of purchase orders for each year with the following features:</li>
</ol>
<ul>
<li>Bars are used for each year.</li>
<li>Fill colors are used to identify the ship.</li>
<li>Legends are put at the bottom of the plot.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<div id="solution-hPzI9juPj6V678zr3bDRrq3Tfs3LfQzxZ3gdlTDZ" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-hPzI9juPj6V678zr3bDRrq3Tfs3LfQzxZ3gdlTDZ-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-hPzI9juPj6V678zr3bDRrq3Tfs3LfQzxZ3gdlTDZ-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="mod-r-plot.html#cb765-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb765-2"><a href="mod-r-plot.html#cb765-2" tabindex="-1"></a>   <span class="fu">group_by</span>(order_year, order_id) <span class="sc">|&gt;</span> </span>
<span id="cb765-3"><a href="mod-r-plot.html#cb765-3" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">ship =</span> <span class="fu">first</span>(ship)) <span class="sc">|&gt;</span> </span>
<span id="cb765-4"><a href="mod-r-plot.html#cb765-4" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> order_year, <span class="at">fill =</span> ship)) <span class="sc">+</span></span>
<span id="cb765-5"><a href="mod-r-plot.html#cb765-5" tabindex="-1"></a>   <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb765-6"><a href="mod-r-plot.html#cb765-6" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of orders&quot;</span>,</span>
<span id="cb765-7"><a href="mod-r-plot.html#cb765-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb765-8"><a href="mod-r-plot.html#cb765-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Orders&quot;</span>,</span>
<span id="cb765-9"><a href="mod-r-plot.html#cb765-9" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Ship&quot;</span>) <span class="sc">+</span></span>
<span id="cb765-10"><a href="mod-r-plot.html#cb765-10" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb765-11"><a href="mod-r-plot.html#cb765-11" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb765-12"><a href="mod-r-plot.html#cb765-12" tabindex="-1"></a><span class="co"># dat |&gt;</span></span>
<span id="cb765-13"><a href="mod-r-plot.html#cb765-13" tabindex="-1"></a><span class="co">#    count(order_year, order_id, ship) |&gt;</span></span>
<span id="cb765-14"><a href="mod-r-plot.html#cb765-14" tabindex="-1"></a><span class="co">#    ggplot(aes(x = order_year, fill = ship)) +</span></span>
<span id="cb765-15"><a href="mod-r-plot.html#cb765-15" tabindex="-1"></a><span class="co">#    geom_bar()</span></span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-651-1.png" width="672" style="display: block; margin: auto;" />
<p>
Most orders are in 2018.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-hPzI9juPj6V678zr3bDRrq3Tfs3LfQzxZ3gdlTDZ">
Solution
</button>
<div id="hint-W8tTImbIJT4ZV3kQV76OLhXjoB67wx" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-W8tTImbIJT4ZV3kQV76OLhXjoB67wx-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-W8tTImbIJT4ZV3kQV76OLhXjoB67wx-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="mod-r-plot.html#cb766-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb766-2"><a href="mod-r-plot.html#cb766-2" tabindex="-1"></a>   <span class="fu">group_by</span>(order_year, order_id) <span class="sc">|&gt;</span> </span>
<span id="cb766-3"><a href="mod-r-plot.html#cb766-3" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">ship =</span> <span class="fu">first</span>(___)) <span class="sc">|&gt;</span> </span>
<span id="cb766-4"><a href="mod-r-plot.html#cb766-4" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">fill =</span> ___)) <span class="sc">+</span></span>
<span id="cb766-5"><a href="mod-r-plot.html#cb766-5" tabindex="-1"></a>   <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb766-6"><a href="mod-r-plot.html#cb766-6" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> ___,</span>
<span id="cb766-7"><a href="mod-r-plot.html#cb766-7" tabindex="-1"></a>    <span class="at">x =</span> ___,</span>
<span id="cb766-8"><a href="mod-r-plot.html#cb766-8" tabindex="-1"></a>    <span class="at">y =</span> ___,</span>
<span id="cb766-9"><a href="mod-r-plot.html#cb766-9" tabindex="-1"></a>    <span class="at">fill =</span> ___) <span class="sc">+</span></span>
<span id="cb766-10"><a href="mod-r-plot.html#cb766-10" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-W8tTImbIJT4ZV3kQV76OLhXjoB67wx">
Hint
</button>
<p>Which year had the most orders?</p>
<ol start="2" style="list-style-type: decimal">
<li>Create a visualization showing the total number of items ordered for each ship with the following features:</li>
</ol>
<ul>
<li>The numbers are shown using columns.</li>
<li>Reorder the columns so they increase along the x-axis.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<div id="solution-51G8QNhTXG05iSQ6NJbfxqmrOoQOU263XkH0NlgV" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-51G8QNhTXG05iSQ6NJbfxqmrOoQOU263XkH0NlgV-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-51G8QNhTXG05iSQ6NJbfxqmrOoQOU263XkH0NlgV-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="mod-r-plot.html#cb767-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb767-2"><a href="mod-r-plot.html#cb767-2" tabindex="-1"></a>   <span class="fu">group_by</span>(ship) <span class="sc">|&gt;</span> </span>
<span id="cb767-3"><a href="mod-r-plot.html#cb767-3" tabindex="-1"></a>   <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">sum</span>(quantity)) <span class="sc">|&gt;</span> </span>
<span id="cb767-4"><a href="mod-r-plot.html#cb767-4" tabindex="-1"></a>   <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) </span>
<span id="cb767-5"><a href="mod-r-plot.html#cb767-5" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb767-6"><a href="mod-r-plot.html#cb767-6" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ship, n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb767-7"><a href="mod-r-plot.html#cb767-7" tabindex="-1"></a>   <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb767-8"><a href="mod-r-plot.html#cb767-8" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total number of items used&quot;</span>,</span>
<span id="cb767-9"><a href="mod-r-plot.html#cb767-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Ship&quot;</span>,</span>
<span id="cb767-10"><a href="mod-r-plot.html#cb767-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Items&quot;</span>) <span class="sc">+</span></span>
<span id="cb767-11"><a href="mod-r-plot.html#cb767-11" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-653-1.png" width="672" style="display: block; margin: auto;" />
<p>
Most items are used for Ship-13.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-51G8QNhTXG05iSQ6NJbfxqmrOoQOU263XkH0NlgV">
Solution
</button>
<div id="hint-rrLJN4eibvUgWNypr5ymLfLJNclMxt" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-rrLJN4eibvUgWNypr5ymLfLJNclMxt-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-rrLJN4eibvUgWNypr5ymLfLJNclMxt-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="mod-r-plot.html#cb768-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb768-2"><a href="mod-r-plot.html#cb768-2" tabindex="-1"></a>   <span class="fu">group_by</span>(ship) <span class="sc">|&gt;</span> </span>
<span id="cb768-3"><a href="mod-r-plot.html#cb768-3" tabindex="-1"></a>   <span class="fu">summarize</span>(<span class="at">n =</span> ___) <span class="sc">|&gt;</span> </span>
<span id="cb768-4"><a href="mod-r-plot.html#cb768-4" tabindex="-1"></a>   <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) </span>
<span id="cb768-5"><a href="mod-r-plot.html#cb768-5" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb768-6"><a href="mod-r-plot.html#cb768-6" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(___)) <span class="sc">+</span></span>
<span id="cb768-7"><a href="mod-r-plot.html#cb768-7" tabindex="-1"></a>   <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb768-8"><a href="mod-r-plot.html#cb768-8" tabindex="-1"></a>   <span class="fu">labs</span>(___) <span class="sc">+</span></span>
<span id="cb768-9"><a href="mod-r-plot.html#cb768-9" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-rrLJN4eibvUgWNypr5ymLfLJNclMxt">
Hint
</button>
<p>Which ship uses most items?</p>
<ol start="3" style="list-style-type: decimal">
<li>For each ship, create a visualization showing the number of items used as a function of done date with the following features:</li>
</ol>
<ul>
<li>The numbers are shown using columns with a fixed line width of 1 and a blue color.</li>
<li>The plot is divided using <code>ship</code> (facet). Hint: You may use <code>scales = "free_y"</code>.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<div id="solution-flNdczMmQPAVYgKU99VngeReOTP4pIlFUtBkWy6a" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-flNdczMmQPAVYgKU99VngeReOTP4pIlFUtBkWy6a-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-flNdczMmQPAVYgKU99VngeReOTP4pIlFUtBkWy6a-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="mod-r-plot.html#cb769-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb769-2"><a href="mod-r-plot.html#cb769-2" tabindex="-1"></a>   <span class="fu">group_by</span>(ship, order_date) <span class="sc">|&gt;</span> </span>
<span id="cb769-3"><a href="mod-r-plot.html#cb769-3" tabindex="-1"></a>   <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">sum</span>(quantity)) </span>
<span id="cb769-4"><a href="mod-r-plot.html#cb769-4" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb769-5"><a href="mod-r-plot.html#cb769-5" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> order_date, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb769-6"><a href="mod-r-plot.html#cb769-6" tabindex="-1"></a>   <span class="fu">geom_col</span>(<span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb769-7"><a href="mod-r-plot.html#cb769-7" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> ship, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb769-8"><a href="mod-r-plot.html#cb769-8" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of items used&quot;</span>,</span>
<span id="cb769-9"><a href="mod-r-plot.html#cb769-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb769-10"><a href="mod-r-plot.html#cb769-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Items used&quot;</span>) </span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-655-1.png" width="672" style="display: block; margin: auto;" />
<p>
On a specific date must items are used for Ship-13.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-flNdczMmQPAVYgKU99VngeReOTP4pIlFUtBkWy6a">
Solution
</button>
<div id="hint-ESG74QIsGZEYjK9uvhUC7cGrvOeVfM" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-ESG74QIsGZEYjK9uvhUC7cGrvOeVfM-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-ESG74QIsGZEYjK9uvhUC7cGrvOeVfM-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="mod-r-plot.html#cb770-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb770-2"><a href="mod-r-plot.html#cb770-2" tabindex="-1"></a>   <span class="fu">group_by</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb770-3"><a href="mod-r-plot.html#cb770-3" tabindex="-1"></a>   <span class="fu">summarize</span>(<span class="at">n =</span> ___) </span>
<span id="cb770-4"><a href="mod-r-plot.html#cb770-4" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb770-5"><a href="mod-r-plot.html#cb770-5" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(___)) <span class="sc">+</span></span>
<span id="cb770-6"><a href="mod-r-plot.html#cb770-6" tabindex="-1"></a>   <span class="fu">geom_col</span>(<span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb770-7"><a href="mod-r-plot.html#cb770-7" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> ___, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb770-8"><a href="mod-r-plot.html#cb770-8" tabindex="-1"></a>   <span class="fu">labs</span>(___) </span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-ESG74QIsGZEYjK9uvhUC7cGrvOeVfM">
Hint
</button>
<p>Which ship has most items used at a specific date?</p>
<ol start="4" style="list-style-type: decimal">
<li>Consider items with id:</li>
</ol>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="mod-r-plot.html#cb771-1" tabindex="-1"></a>items <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;601.003.004&quot;</span> ,<span class="st">&quot;601.004.006&quot;</span>, <span class="st">&quot;601.026.128&quot;</span>, <span class="st">&quot;601.026.052&quot;</span>)</span></code></pre></div>
<p>For each row in the dataset, calculate an index variable as price divided with the maximum item id price. Hint: Group by item id and use <code>mutate</code> to add the column. Create a visualization showing the index as a function of order year with the following features:</p>
<ul>
<li>The numbers are shown using points.</li>
<li>The plot is divided using item id (facet).</li>
<li>A trend line is added.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<div id="solution-3tUXzzR18TaobOCybUM9yK6PdX8Y6vDFFJjU17Na" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-3tUXzzR18TaobOCybUM9yK6PdX8Y6vDFFJjU17Na-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-3tUXzzR18TaobOCybUM9yK6PdX8Y6vDFFJjU17Na-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="mod-r-plot.html#cb772-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb772-2"><a href="mod-r-plot.html#cb772-2" tabindex="-1"></a>   <span class="fu">filter</span>(item_id <span class="sc">%in%</span> items) <span class="sc">|&gt;</span> </span>
<span id="cb772-3"><a href="mod-r-plot.html#cb772-3" tabindex="-1"></a>   <span class="fu">group_by</span>(item_id) <span class="sc">|&gt;</span> </span>
<span id="cb772-4"><a href="mod-r-plot.html#cb772-4" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">idx =</span> price<span class="sc">/</span><span class="fu">max</span>(price))</span>
<span id="cb772-5"><a href="mod-r-plot.html#cb772-5" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb772-6"><a href="mod-r-plot.html#cb772-6" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> idx, <span class="at">x =</span> order_year)) <span class="sc">+</span> </span>
<span id="cb772-7"><a href="mod-r-plot.html#cb772-7" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb772-8"><a href="mod-r-plot.html#cb772-8" tabindex="-1"></a>   <span class="fu">geom_smooth</span>(<span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb772-9"><a href="mod-r-plot.html#cb772-9" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> item_id) <span class="sc">+</span></span>
<span id="cb772-10"><a href="mod-r-plot.html#cb772-10" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Price index (index 1 = max price)&quot;</span>,</span>
<span id="cb772-11"><a href="mod-r-plot.html#cb772-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Order year&quot;</span>,</span>
<span id="cb772-12"><a href="mod-r-plot.html#cb772-12" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Index&quot;</span>) </span>
<span id="cb772-13"><a href="mod-r-plot.html#cb772-13" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</span></span>
<span id="cb772-14"><a href="mod-r-plot.html#cb772-14" tabindex="-1"></a><span class="co">#&gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, : pseudoinverse</span></span>
<span id="cb772-15"><a href="mod-r-plot.html#cb772-15" tabindex="-1"></a><span class="co">#&gt; used at 2019</span></span>
<span id="cb772-16"><a href="mod-r-plot.html#cb772-16" tabindex="-1"></a><span class="co">#&gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, : neighborhood</span></span>
<span id="cb772-17"><a href="mod-r-plot.html#cb772-17" tabindex="-1"></a><span class="co">#&gt; radius 2.02</span></span>
<span id="cb772-18"><a href="mod-r-plot.html#cb772-18" tabindex="-1"></a><span class="co">#&gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, : reciprocal</span></span>
<span id="cb772-19"><a href="mod-r-plot.html#cb772-19" tabindex="-1"></a><span class="co">#&gt; condition number 2.4348e-17</span></span>
<span id="cb772-20"><a href="mod-r-plot.html#cb772-20" tabindex="-1"></a><span class="co">#&gt; Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, : There are other</span></span>
<span id="cb772-21"><a href="mod-r-plot.html#cb772-21" tabindex="-1"></a><span class="co">#&gt; near singularities as well. 1</span></span>
<span id="cb772-22"><a href="mod-r-plot.html#cb772-22" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb772-23"><a href="mod-r-plot.html#cb772-23" tabindex="-1"></a>   <span class="fu">filter</span>(item_id <span class="sc">%in%</span> <span class="st">&quot;601.026.128&quot;</span>)  </span>
<span id="cb772-24"><a href="mod-r-plot.html#cb772-24" tabindex="-1"></a><span class="co">#&gt; # A tibble: 34 × 13</span></span>
<span id="cb772-25"><a href="mod-r-plot.html#cb772-25" tabindex="-1"></a><span class="co">#&gt;    ship        order_id item_id    item_desc quantity  price order_date delivery_date delivery_place</span></span>
<span id="cb772-26"><a href="mod-r-plot.html#cb772-26" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt; &lt;date&gt;     &lt;date&gt;        &lt;chr&gt;         </span></span>
<span id="cb772-27"><a href="mod-r-plot.html#cb772-27" tabindex="-1"></a><span class="co">#&gt;  1 Ship-19 376315607101 601.026.1… Fuel val…       10 35083. 2015-05-12 2015-07-01    Delivery Plac…</span></span>
<span id="cb772-28"><a href="mod-r-plot.html#cb772-28" tabindex="-1"></a><span class="co">#&gt;  2 Ship-13 367515617501 601.026.1… O-ring, …       30   321. 2015-06-17 2015-06-23    Delivery Plac…</span></span>
<span id="cb772-29"><a href="mod-r-plot.html#cb772-29" tabindex="-1"></a><span class="co">#&gt;  3 Ship-20 376415614601 601.026.1… Spindle …       14 98589. 2015-06-26 2015-08-19    Delivery Plac…</span></span>
<span id="cb772-30"><a href="mod-r-plot.html#cb772-30" tabindex="-1"></a><span class="co">#&gt;  4 Ship-21 376515613801 601.026.1… Spindle …        4 98589. 2015-09-02 2015-09-20    Delivery Plac…</span></span>
<span id="cb772-31"><a href="mod-r-plot.html#cb772-31" tabindex="-1"></a><span class="co">#&gt;  5 Ship-14 367615627201 601.026.1… O-ring, …       12   321. 2016-01-07 2016-01-18    Delivery Plac…</span></span>
<span id="cb772-32"><a href="mod-r-plot.html#cb772-32" tabindex="-1"></a><span class="co">#&gt;  6 Ship-14 367616606902 601.026.1… O-Ring          12   321. 2016-03-30 2016-04-06    Delivery Plac…</span></span>
<span id="cb772-33"><a href="mod-r-plot.html#cb772-33" tabindex="-1"></a><span class="co">#&gt;  7 Ship-21 376516607201 601.026.1… Spindle …        7 98589. 2016-05-02 2016-07-07    Delivery Plac…</span></span>
<span id="cb772-34"><a href="mod-r-plot.html#cb772-34" tabindex="-1"></a><span class="co">#&gt;  8 Ship-20 376416611001 601.026.1… Spindle …       12 98589. 2016-05-06 2016-05-10    Delivery Plac…</span></span>
<span id="cb772-35"><a href="mod-r-plot.html#cb772-35" tabindex="-1"></a><span class="co">#&gt;  9 Ship-10 356516611701 601.026.1… O-Ring          20   321. 2016-05-17 2016-05-24    Delivery Plac…</span></span>
<span id="cb772-36"><a href="mod-r-plot.html#cb772-36" tabindex="-1"></a><span class="co">#&gt; 10 Ship-19 376316620601 601.026.1… Fuel val…        7 35083. 2016-09-09 2016-10-07    Delivery Plac…</span></span>
<span id="cb772-37"><a href="mod-r-plot.html#cb772-37" tabindex="-1"></a><span class="co">#&gt; # ℹ 24 more rows</span></span>
<span id="cb772-38"><a href="mod-r-plot.html#cb772-38" tabindex="-1"></a><span class="co">#&gt; # ℹ 4 more variables: received_date &lt;date&gt;, supplier &lt;chr&gt;, delivery_cost &lt;dbl&gt;, order_year &lt;dbl&gt;</span></span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-658-1.png" width="672" style="display: block; margin: auto;" />
<p>
If consider item 601.026.128 it can be seen that prices are very different. By considering item description it can be seen that the item is in fact not a single product, i.e we have a misclassification of item id!
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-3tUXzzR18TaobOCybUM9yK6PdX8Y6vDFFJjU17Na">
Solution
</button>
<div id="hint-FClqH7TWfoDmoecoz7NG1YsIVqwYAy" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-FClqH7TWfoDmoecoz7NG1YsIVqwYAy-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-FClqH7TWfoDmoecoz7NG1YsIVqwYAy-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="mod-r-plot.html#cb773-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb773-2"><a href="mod-r-plot.html#cb773-2" tabindex="-1"></a>   <span class="fu">filter</span>(item_id <span class="sc">%in%</span> items) <span class="sc">|&gt;</span> </span>
<span id="cb773-3"><a href="mod-r-plot.html#cb773-3" tabindex="-1"></a>   <span class="fu">group_by</span>(item_id) <span class="sc">|&gt;</span> </span>
<span id="cb773-4"><a href="mod-r-plot.html#cb773-4" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">idx =</span> price<span class="sc">/</span><span class="fu">max</span>(price))</span>
<span id="cb773-5"><a href="mod-r-plot.html#cb773-5" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb773-6"><a href="mod-r-plot.html#cb773-6" tabindex="-1"></a>   <span class="fu">ggplot</span>(___) <span class="sc">+</span> </span>
<span id="cb773-7"><a href="mod-r-plot.html#cb773-7" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb773-8"><a href="mod-r-plot.html#cb773-8" tabindex="-1"></a>   <span class="fu">geom_smooth</span>(<span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb773-9"><a href="mod-r-plot.html#cb773-9" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> ___) <span class="sc">+</span></span>
<span id="cb773-10"><a href="mod-r-plot.html#cb773-10" tabindex="-1"></a>   <span class="fu">labs</span>(___) </span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-FClqH7TWfoDmoecoz7NG1YsIVqwYAy">
Hint
</button>
<p>Take a closer look at the item with most price fluctuations. Are the prices reasonable for a singe product?</p>
<ol start="5" style="list-style-type: decimal">
<li>Make a summary table in the following way:</li>
</ol>
<ul>
<li>Add a column <code>val</code> with the value of an item in a row equaling the price times quantity.</li>
<li>Group each item id and set the total value <code>total_value</code> to the sum of <code>val</code> and calculate the total quantity purchased.</li>
<li>Arrange the total value in descending order.</li>
<li>Add columns:
<ul>
<li>Relative total value equals <code>total_val/sum(total_val)</code>.</li>
<li>Relative item number equals <code>row_number()/n()</code>.</li>
<li>Cumulative relative total value (<code>cum_pct_val</code>). Hint: You can use the <code>cumsum</code> function here.</li>
<li>Class equals <code>class = case_when(cum_pct_val &lt;= 0.8 ~ "A", cum_pct_val &lt;= 0.95  ~ "B", TRUE ~ "C")</code> classifying items in A (high value items), B (middle), and C (low value items).</li>
</ul></li>
</ul>
<p>Create a visualization showing the cumulative relative total value as a function of relative item number with the following features:</p>
<ul>
<li>Data points are given in the plot.</li>
<li>Different colors are used for each class.</li>
<li>Different sizes are used for each quantity.</li>
<li>A line is added with black color and fixed size 0.3.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<div id="solution-zmv8QorRT1yRHUZW9zSRBOx9N3HJrV27qlESZO5E" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-zmv8QorRT1yRHUZW9zSRBOx9N3HJrV27qlESZO5E-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-zmv8QorRT1yRHUZW9zSRBOx9N3HJrV27qlESZO5E-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="mod-r-plot.html#cb774-1" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb774-2"><a href="mod-r-plot.html#cb774-2" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">val =</span> price <span class="sc">*</span> quantity) <span class="sc">|&gt;</span> </span>
<span id="cb774-3"><a href="mod-r-plot.html#cb774-3" tabindex="-1"></a>   <span class="fu">group_by</span>(item_id) <span class="sc">|&gt;</span> </span>
<span id="cb774-4"><a href="mod-r-plot.html#cb774-4" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">total_val =</span> <span class="fu">sum</span>(val), <span class="at">item_desc =</span> <span class="fu">first</span>(item_desc), <span class="at">quantity =</span> <span class="fu">sum</span>(quantity)) <span class="sc">|&gt;</span> </span>
<span id="cb774-5"><a href="mod-r-plot.html#cb774-5" tabindex="-1"></a>   <span class="fu">arrange</span>(<span class="fu">desc</span>(total_val)) <span class="sc">|&gt;</span> </span>
<span id="cb774-6"><a href="mod-r-plot.html#cb774-6" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">pct_val =</span> total_val<span class="sc">/</span><span class="fu">sum</span>(total_val), </span>
<span id="cb774-7"><a href="mod-r-plot.html#cb774-7" tabindex="-1"></a>          <span class="at">pct_item =</span> <span class="fu">row_number</span>()<span class="sc">/</span><span class="fu">n</span>(),</span>
<span id="cb774-8"><a href="mod-r-plot.html#cb774-8" tabindex="-1"></a>          <span class="at">cum_pct_val =</span> <span class="fu">cumsum</span>(pct_val), </span>
<span id="cb774-9"><a href="mod-r-plot.html#cb774-9" tabindex="-1"></a>          <span class="at">class =</span> <span class="fu">case_when</span>(</span>
<span id="cb774-10"><a href="mod-r-plot.html#cb774-10" tabindex="-1"></a>            cum_pct_val <span class="sc">&lt;=</span> <span class="fl">0.8</span> <span class="sc">~</span> <span class="st">&quot;A&quot;</span>,</span>
<span id="cb774-11"><a href="mod-r-plot.html#cb774-11" tabindex="-1"></a>            cum_pct_val <span class="sc">&lt;=</span> <span class="fl">0.95</span>  <span class="sc">~</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb774-12"><a href="mod-r-plot.html#cb774-12" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;C&quot;</span></span>
<span id="cb774-13"><a href="mod-r-plot.html#cb774-13" tabindex="-1"></a>         )) <span class="sc">|&gt;</span> </span>
<span id="cb774-14"><a href="mod-r-plot.html#cb774-14" tabindex="-1"></a>   <span class="co"># tail() |&gt; </span></span>
<span id="cb774-15"><a href="mod-r-plot.html#cb774-15" tabindex="-1"></a>   <span class="fu">print</span>() </span>
<span id="cb774-16"><a href="mod-r-plot.html#cb774-16" tabindex="-1"></a><span class="co">#&gt; # A tibble: 550 × 8</span></span>
<span id="cb774-17"><a href="mod-r-plot.html#cb774-17" tabindex="-1"></a><span class="co">#&gt;    item_id     total_val item_desc                       quantity pct_val pct_item cum_pct_val class</span></span>
<span id="cb774-18"><a href="mod-r-plot.html#cb774-18" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;                              &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;</span></span>
<span id="cb774-19"><a href="mod-r-plot.html#cb774-19" tabindex="-1"></a><span class="co">#&gt;  1 601.003.004 20301030  Cylinder Liner IMO Number 1848…       42  0.104   0.00182       0.104 A    </span></span>
<span id="cb774-20"><a href="mod-r-plot.html#cb774-20" tabindex="-1"></a><span class="co">#&gt;  2 601.026.139 16083341. Spindle Guide, Compl                 169  0.0822  0.00364       0.186 A    </span></span>
<span id="cb774-21"><a href="mod-r-plot.html#cb774-21" tabindex="-1"></a><span class="co">#&gt;  3 601.004.008 15029349. Piston Crown IMO Number 184826…       56  0.0768  0.00545       0.263 A    </span></span>
<span id="cb774-22"><a href="mod-r-plot.html#cb774-22" tabindex="-1"></a><span class="co">#&gt;  4 601.002.078 12592313. DuraSpindle                           62  0.0643  0.00727       0.327 A    </span></span>
<span id="cb774-23"><a href="mod-r-plot.html#cb774-23" tabindex="-1"></a><span class="co">#&gt;  5 601.026.128 11675816. Fuel valve head                      486  0.0596  0.00909       0.387 A    </span></span>
<span id="cb774-24"><a href="mod-r-plot.html#cb774-24" tabindex="-1"></a><span class="co">#&gt;  6 601.004.010  8046002. Piston Rod IMO Effective Lengt…       11  0.0411  0.0109        0.428 A    </span></span>
<span id="cb774-25"><a href="mod-r-plot.html#cb774-25" tabindex="-1"></a><span class="co">#&gt;  7 601.026.049  7654587. Pump barrel with plunger, comp…       46  0.0391  0.0127        0.467 A    </span></span>
<span id="cb774-26"><a href="mod-r-plot.html#cb774-26" tabindex="-1"></a><span class="co">#&gt;  8 601.004.005  6631292. Piston ring, CPR-POP, H=9.5mm,…      154  0.0339  0.0145        0.501 A    </span></span>
<span id="cb774-27"><a href="mod-r-plot.html#cb774-27" tabindex="-1"></a><span class="co">#&gt;  9 601.004.006  5946707. Piston Ring No. 2 &amp; 4                271  0.0304  0.0164        0.531 A    </span></span>
<span id="cb774-28"><a href="mod-r-plot.html#cb774-28" tabindex="-1"></a><span class="co">#&gt; 10 601.026.052  5436342. Suction valve                        135  0.0278  0.0182        0.559 A    </span></span>
<span id="cb774-29"><a href="mod-r-plot.html#cb774-29" tabindex="-1"></a><span class="co">#&gt; # ℹ 540 more rows</span></span>
<span id="cb774-30"><a href="mod-r-plot.html#cb774-30" tabindex="-1"></a></span>
<span id="cb774-31"><a href="mod-r-plot.html#cb774-31" tabindex="-1"></a>res1 <span class="sc">|&gt;</span> </span>
<span id="cb774-32"><a href="mod-r-plot.html#cb774-32" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pct_item, <span class="at">y =</span> cum_pct_val, <span class="at">col =</span> class, <span class="at">size =</span> quantity)) <span class="sc">+</span></span>
<span id="cb774-33"><a href="mod-r-plot.html#cb774-33" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb774-34"><a href="mod-r-plot.html#cb774-34" tabindex="-1"></a>   <span class="fu">geom_line</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb774-35"><a href="mod-r-plot.html#cb774-35" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Usage of items (one point per item)&quot;</span>,</span>
<span id="cb774-36"><a href="mod-r-plot.html#cb774-36" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Item percentage&quot;</span>,</span>
<span id="cb774-37"><a href="mod-r-plot.html#cb774-37" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Cumulative value&quot;</span>,</span>
<span id="cb774-38"><a href="mod-r-plot.html#cb774-38" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;Class&quot;</span>,</span>
<span id="cb774-39"><a href="mod-r-plot.html#cb774-39" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">&quot;Purchased&quot;</span>) </span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-660-1.png" width="672" style="display: block; margin: auto;" />
<p>
Items in the A class (80% of value) are approx. 7% of the total items.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-zmv8QorRT1yRHUZW9zSRBOx9N3HJrV27qlESZO5E">
Solution
</button>
<div id="hint-2ZBKDzR27jxyZCM2y64XYvyk1Zs9zD" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-2ZBKDzR27jxyZCM2y64XYvyk1Zs9zD-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-2ZBKDzR27jxyZCM2y64XYvyk1Zs9zD-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="mod-r-plot.html#cb775-1" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb775-2"><a href="mod-r-plot.html#cb775-2" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">val =</span> ___) <span class="sc">|&gt;</span> </span>
<span id="cb775-3"><a href="mod-r-plot.html#cb775-3" tabindex="-1"></a>   <span class="fu">group_by</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb775-4"><a href="mod-r-plot.html#cb775-4" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">total_val =</span> ___, <span class="at">item_desc =</span> <span class="fu">first</span>(___), <span class="at">quantity =</span> ___) <span class="sc">|&gt;</span> </span>
<span id="cb775-5"><a href="mod-r-plot.html#cb775-5" tabindex="-1"></a>   <span class="fu">arrange</span>(<span class="fu">desc</span>(total_val)) <span class="sc">|&gt;</span> </span>
<span id="cb775-6"><a href="mod-r-plot.html#cb775-6" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">pct_val =</span> total_val<span class="sc">/</span><span class="fu">sum</span>(total_val), </span>
<span id="cb775-7"><a href="mod-r-plot.html#cb775-7" tabindex="-1"></a>          <span class="at">pct_item =</span> <span class="fu">row_number</span>()<span class="sc">/</span><span class="fu">n</span>(),</span>
<span id="cb775-8"><a href="mod-r-plot.html#cb775-8" tabindex="-1"></a>          <span class="at">cum_pct_val =</span> <span class="fu">cumsum</span>(pct_val), </span>
<span id="cb775-9"><a href="mod-r-plot.html#cb775-9" tabindex="-1"></a>          <span class="at">class =</span> <span class="fu">case_when</span>(</span>
<span id="cb775-10"><a href="mod-r-plot.html#cb775-10" tabindex="-1"></a>            cum_pct_val <span class="sc">&lt;=</span> <span class="fl">0.8</span> <span class="sc">~</span> <span class="st">&quot;A&quot;</span>,</span>
<span id="cb775-11"><a href="mod-r-plot.html#cb775-11" tabindex="-1"></a>            cum_pct_val <span class="sc">&lt;=</span> <span class="fl">0.95</span>  <span class="sc">~</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb775-12"><a href="mod-r-plot.html#cb775-12" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;C&quot;</span></span>
<span id="cb775-13"><a href="mod-r-plot.html#cb775-13" tabindex="-1"></a>         )) <span class="sc">|&gt;</span> </span>
<span id="cb775-14"><a href="mod-r-plot.html#cb775-14" tabindex="-1"></a>   <span class="fu">print</span>() </span>
<span id="cb775-15"><a href="mod-r-plot.html#cb775-15" tabindex="-1"></a></span>
<span id="cb775-16"><a href="mod-r-plot.html#cb775-16" tabindex="-1"></a>res1 <span class="sc">|&gt;</span> </span>
<span id="cb775-17"><a href="mod-r-plot.html#cb775-17" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___, <span class="at">col =</span> ___, <span class="at">size =</span> ___)) <span class="sc">+</span></span>
<span id="cb775-18"><a href="mod-r-plot.html#cb775-18" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb775-19"><a href="mod-r-plot.html#cb775-19" tabindex="-1"></a>   <span class="fu">geom_line</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb775-20"><a href="mod-r-plot.html#cb775-20" tabindex="-1"></a>   <span class="fu">labs</span>(___) </span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-2ZBKDzR27jxyZCM2y64XYvyk1Zs9zD">
Hint
</button>
<p>How many items contribute to 80% of the total value?</p>
</div>
<div id="ex-r-nycflights" class="section level3 hasAnchor" number="14.6.10">
<h3><span class="header-section-number">14.6.10</span> Exercise (New York flights)<a href="mod-r-plot.html#ex-r-nycflights" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a larger assignment and is more extensive than the exam and is not a mandatory/part of curriculum. Do not expect such a large assignment at the exam. However, by doing this exercise you will improve your R skills which may be beneficial at the exam or when write your master thesis.</em></p>
<p>A template file is given for this exercise, which should be used as a starting point (<strong>File &gt; New File &gt; R Markdown…</strong>, select <strong>From template</strong> and then <strong>TFA - New York flights template</strong>).</p>
<p>You have as an analyst been asked to take over the analysis of the <code>nycflights13</code> datasets from a former college. Your task is to finish the analysis started (see the <em>TFA - New York flights template</em>).</p>
<p>We consider the datasets available from the package <code>nycflights13</code> that contains information about every flight that departed from New York City in 2013.</p>
<p>The datasets in the <code>nycflights13</code> package are:</p>
<pre><code>#&gt; Warning in find.package(package, lib.loc, verbose = verbose): package &#39;nycflights13&#39; found more than once, using the first from
#&gt;   &quot;/home/runner/work/_temp/renv/cache/v5/linux-ubuntu-noble/R-4.5/x86_64-pc-linux-gnu/nycflights13/1.0.2/61eb941328b49a62d7f9816dfed7d959/nycflights13&quot;,
#&gt;   &quot;/home/runner/work/tfa/tfa/renv/library/linux-ubuntu-noble/R-4.5/x86_64-pc-linux-gnu/nycflights13&quot;</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Dataset
</th>
<th style="text-align:left;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
airlines
</td>
<td style="text-align:left;">
Airline names.
</td>
</tr>
<tr>
<td style="text-align:left;">
airports
</td>
<td style="text-align:left;">
Airport metadata
</td>
</tr>
<tr>
<td style="text-align:left;">
flights
</td>
<td style="text-align:left;">
Flights data
</td>
</tr>
<tr>
<td style="text-align:left;">
planes
</td>
<td style="text-align:left;">
Plane metadata.
</td>
</tr>
<tr>
<td style="text-align:left;">
weather
</td>
<td style="text-align:left;">
Hourly weather data
</td>
</tr>
</tbody>
</table>
<p>Let us try to do some descriptive analytics on the different datasets.</p>
<div id="flights" class="section level4 unnumbered hasAnchor">
<h4>Flights<a href="mod-r-plot.html#flights" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider the <code>flights</code> data set, which lists all domestic flights out of the New York area in 2013. The variables are:</p>
<ul>
<li><code>year, month, day</code> Date of departure</li>
<li><code>dep_time,arr_time</code> Actual departure and arrival times.</li>
<li><code>sched_dep_time, sched_arr_time</code> Scheduled departure and arrival times.</li>
<li><code>dep_delay, arr_delay</code> delays in minutes</li>
<li><code>hour, minute</code> Time of scheduled departure</li>
<li><code>carrier</code> carrier abbreviation</li>
<li><code>tailnum</code> Tail number of plane.</li>
<li><code>flight</code> flight number.</li>
<li><code>origin, dest</code> Origin and Destination</li>
<li><code>air_time</code> Time spent in air.</li>
<li><code>distance</code> Distance flown.</li>
<li><code>time_hour</code> scheduled date and hour of flight.</li>
</ul>
<p>For further details about the dataset see <code>?flights</code>.</p>
<p>Looking at the data set indicate that some flights are cancelled. We remove these observations from the dataset:</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="mod-r-plot.html#cb777-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> flights <span class="sc">|&gt;</span></span>
<span id="cb777-2"><a href="mod-r-plot.html#cb777-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dep_time))</span></code></pre></div>
<p>Let us first try to do some <a href="https://bss-osca.github.io/tfa/mod-r-transform.html#r-transform-joins">mutating joins</a> and combine variables from multiple tables. In <code>flights</code> we have flight information with an abbreviation for carrier (<code>carrier</code>), and in <code>airlines</code> we have a mapping between abbreviations and full names (<code>name</code>). You can use a join to add the carrier names to the flight data:</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="mod-r-plot.html#cb778-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb778-2"><a href="mod-r-plot.html#cb778-2" tabindex="-1"></a>  <span class="fu">left_join</span>(airlines) <span class="sc">|&gt;</span> </span>
<span id="cb778-3"><a href="mod-r-plot.html#cb778-3" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">carrier_name =</span> name) <span class="sc">|&gt;</span> </span>
<span id="cb778-4"><a href="mod-r-plot.html#cb778-4" tabindex="-1"></a>  <span class="fu">print</span>()</span>
<span id="cb778-5"><a href="mod-r-plot.html#cb778-5" tabindex="-1"></a><span class="co">#&gt; Joining with `by = join_by(carrier)`</span></span>
<span id="cb778-6"><a href="mod-r-plot.html#cb778-6" tabindex="-1"></a><span class="co">#&gt; # A tibble: 328,521 × 20</span></span>
<span id="cb778-7"><a href="mod-r-plot.html#cb778-7" tabindex="-1"></a><span class="co">#&gt;     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time arr_delay carrier</span></span>
<span id="cb778-8"><a href="mod-r-plot.html#cb778-8" tabindex="-1"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;  </span></span>
<span id="cb778-9"><a href="mod-r-plot.html#cb778-9" tabindex="-1"></a><span class="co">#&gt;  1  2013     1     1      517            515         2      830            819        11 UA     </span></span>
<span id="cb778-10"><a href="mod-r-plot.html#cb778-10" tabindex="-1"></a><span class="co">#&gt;  2  2013     1     1      533            529         4      850            830        20 UA     </span></span>
<span id="cb778-11"><a href="mod-r-plot.html#cb778-11" tabindex="-1"></a><span class="co">#&gt;  3  2013     1     1      542            540         2      923            850        33 AA     </span></span>
<span id="cb778-12"><a href="mod-r-plot.html#cb778-12" tabindex="-1"></a><span class="co">#&gt;  4  2013     1     1      544            545        -1     1004           1022       -18 B6     </span></span>
<span id="cb778-13"><a href="mod-r-plot.html#cb778-13" tabindex="-1"></a><span class="co">#&gt;  5  2013     1     1      554            600        -6      812            837       -25 DL     </span></span>
<span id="cb778-14"><a href="mod-r-plot.html#cb778-14" tabindex="-1"></a><span class="co">#&gt;  6  2013     1     1      554            558        -4      740            728        12 UA     </span></span>
<span id="cb778-15"><a href="mod-r-plot.html#cb778-15" tabindex="-1"></a><span class="co">#&gt;  7  2013     1     1      555            600        -5      913            854        19 B6     </span></span>
<span id="cb778-16"><a href="mod-r-plot.html#cb778-16" tabindex="-1"></a><span class="co">#&gt;  8  2013     1     1      557            600        -3      709            723       -14 EV     </span></span>
<span id="cb778-17"><a href="mod-r-plot.html#cb778-17" tabindex="-1"></a><span class="co">#&gt;  9  2013     1     1      557            600        -3      838            846        -8 B6     </span></span>
<span id="cb778-18"><a href="mod-r-plot.html#cb778-18" tabindex="-1"></a><span class="co">#&gt; 10  2013     1     1      558            600        -2      753            745         8 AA     </span></span>
<span id="cb778-19"><a href="mod-r-plot.html#cb778-19" tabindex="-1"></a><span class="co">#&gt; # ℹ 328,511 more rows</span></span>
<span id="cb778-20"><a href="mod-r-plot.html#cb778-20" tabindex="-1"></a><span class="co">#&gt; # ℹ 10 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;,</span></span>
<span id="cb778-21"><a href="mod-r-plot.html#cb778-21" tabindex="-1"></a><span class="co">#&gt; #   distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, carrier_name &lt;chr&gt;</span></span></code></pre></div>
<p>Note we here join by the column <code>carrier</code> represented in both data frames. That is, the default argument <code>by = c("carrier" = "carrier")</code> is used. If we want the full name of origin airport, we need to specify which one we want to join to since each flight has an origin and destination <code>airport</code>. Afterwards we do the same for the destination airport.</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="mod-r-plot.html#cb779-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb779-2"><a href="mod-r-plot.html#cb779-2" tabindex="-1"></a>  <span class="fu">left_join</span>(airports <span class="sc">|&gt;</span> <span class="fu">select</span>(faa, name), </span>
<span id="cb779-3"><a href="mod-r-plot.html#cb779-3" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;origin&quot;</span> <span class="ot">=</span> <span class="st">&quot;faa&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb779-4"><a href="mod-r-plot.html#cb779-4" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">origin_name =</span> name) <span class="sc">|&gt;</span> </span>
<span id="cb779-5"><a href="mod-r-plot.html#cb779-5" tabindex="-1"></a>  <span class="fu">left_join</span>(airports <span class="sc">|&gt;</span> <span class="fu">select</span>(faa, name), </span>
<span id="cb779-6"><a href="mod-r-plot.html#cb779-6" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;dest&quot;</span> <span class="ot">=</span> <span class="st">&quot;faa&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb779-7"><a href="mod-r-plot.html#cb779-7" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dest_name =</span> name) <span class="sc">|&gt;</span> </span>
<span id="cb779-8"><a href="mod-r-plot.html#cb779-8" tabindex="-1"></a>  <span class="fu">select</span>(month, carrier_name, origin_name, dest_name, sched_dep_time, dep_delay, arr_delay, distance, tailnum) <span class="sc">|&gt;</span> </span>
<span id="cb779-9"><a href="mod-r-plot.html#cb779-9" tabindex="-1"></a>  <span class="fu">print</span>()</span>
<span id="cb779-10"><a href="mod-r-plot.html#cb779-10" tabindex="-1"></a><span class="co">#&gt; # A tibble: 328,521 × 9</span></span>
<span id="cb779-11"><a href="mod-r-plot.html#cb779-11" tabindex="-1"></a><span class="co">#&gt;    month carrier_name      origin_name dest_name sched_dep_time dep_delay arr_delay distance tailnum</span></span>
<span id="cb779-12"><a href="mod-r-plot.html#cb779-12" tabindex="-1"></a><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;       &lt;chr&gt;              &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  </span></span>
<span id="cb779-13"><a href="mod-r-plot.html#cb779-13" tabindex="-1"></a><span class="co">#&gt;  1     1 United Air Lines… Newark Lib… George B…            515         2        11     1400 N14228 </span></span>
<span id="cb779-14"><a href="mod-r-plot.html#cb779-14" tabindex="-1"></a><span class="co">#&gt;  2     1 United Air Lines… La Guardia  George B…            529         4        20     1416 N24211 </span></span>
<span id="cb779-15"><a href="mod-r-plot.html#cb779-15" tabindex="-1"></a><span class="co">#&gt;  3     1 American Airline… John F Ken… Miami In…            540         2        33     1089 N619AA </span></span>
<span id="cb779-16"><a href="mod-r-plot.html#cb779-16" tabindex="-1"></a><span class="co">#&gt;  4     1 JetBlue Airways   John F Ken… &lt;NA&gt;                 545        -1       -18     1576 N804JB </span></span>
<span id="cb779-17"><a href="mod-r-plot.html#cb779-17" tabindex="-1"></a><span class="co">#&gt;  5     1 Delta Air Lines … La Guardia  Hartsfie…            600        -6       -25      762 N668DN </span></span>
<span id="cb779-18"><a href="mod-r-plot.html#cb779-18" tabindex="-1"></a><span class="co">#&gt;  6     1 United Air Lines… Newark Lib… Chicago …            558        -4        12      719 N39463 </span></span>
<span id="cb779-19"><a href="mod-r-plot.html#cb779-19" tabindex="-1"></a><span class="co">#&gt;  7     1 JetBlue Airways   Newark Lib… Fort Lau…            600        -5        19     1065 N516JB </span></span>
<span id="cb779-20"><a href="mod-r-plot.html#cb779-20" tabindex="-1"></a><span class="co">#&gt;  8     1 ExpressJet Airli… La Guardia  Washingt…            600        -3       -14      229 N829AS </span></span>
<span id="cb779-21"><a href="mod-r-plot.html#cb779-21" tabindex="-1"></a><span class="co">#&gt;  9     1 JetBlue Airways   John F Ken… Orlando …            600        -3        -8      944 N593JB </span></span>
<span id="cb779-22"><a href="mod-r-plot.html#cb779-22" tabindex="-1"></a><span class="co">#&gt; 10     1 American Airline… La Guardia  Chicago …            600        -2         8      733 N3ALAA </span></span>
<span id="cb779-23"><a href="mod-r-plot.html#cb779-23" tabindex="-1"></a><span class="co">#&gt; # ℹ 328,511 more rows</span></span></code></pre></div>
<p>We now have the flights data we need stored in the data frame <code>dat</code>. Let us try to answer some questions. The questions are more open to interpretation than previous exercises. That is, you may answer them differently using data transformations and plots.</p>
<ol style="list-style-type: decimal">
<li><p>How many flights leave each New York airport for each carrier?</p></li>
<li><p>How many carrier flights per month?</p></li>
<li><p>Which carriers/airlines have the delays? Consider</p>
<ul>
<li>Average delay</li>
<li>Variation in delays</li>
<li>Median values</li>
<li>Delays of more than an hour</li>
</ul></li>
<li><p>What is the relationship between departure delay and arrival delay?</p></li>
<li><p>Are flight delays worse at different New York airports?</p></li>
<li><p>Are carrier flight delays different at New York airports?</p></li>
<li><p>Does departure time affect flight delays?</p></li>
<li><p>Does travel distance affect departure and arrival delay?</p></li>
</ol>
</div>
<div id="planes" class="section level4 unnumbered hasAnchor">
<h4>Planes<a href="mod-r-plot.html#planes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let us do a mutation join so we have a bit more information about each airplane:</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="mod-r-plot.html#cb780-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb780-2"><a href="mod-r-plot.html#cb780-2" tabindex="-1"></a>  <span class="fu">left_join</span>(planes <span class="sc">|&gt;</span> </span>
<span id="cb780-3"><a href="mod-r-plot.html#cb780-3" tabindex="-1"></a>              <span class="fu">select</span>(tailnum, <span class="at">plane_manufacturer =</span> manufacturer, <span class="at">plane_model =</span> model))</span>
<span id="cb780-4"><a href="mod-r-plot.html#cb780-4" tabindex="-1"></a><span class="co">#&gt; Joining with `by = join_by(tailnum)`</span></span></code></pre></div>
<ol start="9" style="list-style-type: decimal">
<li>What is the monthly usage of all the aircrafts?</li>
</ol>
</div>
<div id="weather" class="section level4 unnumbered hasAnchor">
<h4>Weather<a href="mod-r-plot.html#weather" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider the <code>weather</code> data set, which lists hourly meteorological data for LGA, JFK and EWR. We run <code>skim</code> to get an overview:</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="mod-r-plot.html#cb781-1" tabindex="-1"></a><span class="fu">skim</span>(weather)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-668">Table 14.2: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">weather</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">26115</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">15</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">13</td>
</tr>
<tr class="even">
<td align="left">POSIXct</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<colgroup>
<col width="19%" />
<col width="13%" />
<col width="19%" />
<col width="5%" />
<col width="5%" />
<col width="8%" />
<col width="12%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">origin</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<colgroup>
<col width="14%" />
<col width="10%" />
<col width="14%" />
<col width="8%" />
<col width="7%" />
<col width="8%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="8%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">year</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">2013.00</td>
<td align="right">0.00</td>
<td align="right">2013.00</td>
<td align="right">2013.0</td>
<td align="right">2013.0</td>
<td align="right">2013.0</td>
<td align="right">2013.00</td>
<td align="left">▁▁▇▁▁</td>
</tr>
<tr class="even">
<td align="left">month</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">6.50</td>
<td align="right">3.44</td>
<td align="right">1.00</td>
<td align="right">4.0</td>
<td align="right">7.0</td>
<td align="right">9.0</td>
<td align="right">12.00</td>
<td align="left">▇▆▆▆▇</td>
</tr>
<tr class="odd">
<td align="left">day</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">15.68</td>
<td align="right">8.76</td>
<td align="right">1.00</td>
<td align="right">8.0</td>
<td align="right">16.0</td>
<td align="right">23.0</td>
<td align="right">31.00</td>
<td align="left">▇▇▇▇▆</td>
</tr>
<tr class="even">
<td align="left">hour</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">11.49</td>
<td align="right">6.91</td>
<td align="right">0.00</td>
<td align="right">6.0</td>
<td align="right">11.0</td>
<td align="right">17.0</td>
<td align="right">23.00</td>
<td align="left">▇▇▆▇▇</td>
</tr>
<tr class="odd">
<td align="left">temp</td>
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">55.26</td>
<td align="right">17.79</td>
<td align="right">10.94</td>
<td align="right">39.9</td>
<td align="right">55.4</td>
<td align="right">70.0</td>
<td align="right">100.04</td>
<td align="left">▂▇▇▇▁</td>
</tr>
<tr class="even">
<td align="left">dewp</td>
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">41.44</td>
<td align="right">19.39</td>
<td align="right">-9.94</td>
<td align="right">26.1</td>
<td align="right">42.1</td>
<td align="right">57.9</td>
<td align="right">78.08</td>
<td align="left">▁▆▇▇▆</td>
</tr>
<tr class="odd">
<td align="left">humid</td>
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">62.53</td>
<td align="right">19.40</td>
<td align="right">12.74</td>
<td align="right">47.0</td>
<td align="right">61.8</td>
<td align="right">78.8</td>
<td align="right">100.00</td>
<td align="left">▁▆▇▇▆</td>
</tr>
<tr class="even">
<td align="left">wind_dir</td>
<td align="right">460</td>
<td align="right">0.98</td>
<td align="right">199.76</td>
<td align="right">107.31</td>
<td align="right">0.00</td>
<td align="right">120.0</td>
<td align="right">220.0</td>
<td align="right">290.0</td>
<td align="right">360.00</td>
<td align="left">▆▂▆▇▇</td>
</tr>
<tr class="odd">
<td align="left">wind_speed</td>
<td align="right">4</td>
<td align="right">1.00</td>
<td align="right">10.52</td>
<td align="right">8.54</td>
<td align="right">0.00</td>
<td align="right">6.9</td>
<td align="right">10.4</td>
<td align="right">13.8</td>
<td align="right">1048.36</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">wind_gust</td>
<td align="right">20778</td>
<td align="right">0.20</td>
<td align="right">25.49</td>
<td align="right">5.95</td>
<td align="right">16.11</td>
<td align="right">20.7</td>
<td align="right">24.2</td>
<td align="right">28.8</td>
<td align="right">66.75</td>
<td align="left">▇▅▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">precip</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.00</td>
<td align="right">0.03</td>
<td align="right">0.00</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
<td align="right">1.21</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">pressure</td>
<td align="right">2729</td>
<td align="right">0.90</td>
<td align="right">1017.90</td>
<td align="right">7.42</td>
<td align="right">983.80</td>
<td align="right">1012.9</td>
<td align="right">1017.6</td>
<td align="right">1023.0</td>
<td align="right">1042.10</td>
<td align="left">▁▁▇▆▁</td>
</tr>
<tr class="odd">
<td align="left">visib</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">9.26</td>
<td align="right">2.06</td>
<td align="right">0.00</td>
<td align="right">10.0</td>
<td align="right">10.0</td>
<td align="right">10.0</td>
<td align="right">10.00</td>
<td align="left">▁▁▁▁▇</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: POSIXct</strong></p>
<table>
<colgroup>
<col width="13%" />
<col width="9%" />
<col width="13%" />
<col width="18%" />
<col width="18%" />
<col width="18%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="left">min</th>
<th align="left">max</th>
<th align="left">median</th>
<th align="right">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">time_hour</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2013-01-01 01:00:00</td>
<td align="left">2013-12-30 18:00:00</td>
<td align="left">2013-07-01 14:00:00</td>
<td align="right">8714</td>
</tr>
</tbody>
</table>
<p>For further details see <code>View(weather)</code> or read the associated help file by running <code>?weather</code> to bring up the help file.</p>
<p>Observe that there is a variable called temp of hourly temperature recordings in Fahrenheit at weather stations near all three major airports in New York City: Newark (origin code EWR), John F. Kennedy International (JFK), and LaGuardia (LGA). Let us transform the temperature to Celsius:</p>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="mod-r-plot.html#cb782-1" tabindex="-1"></a>dat_w <span class="ot">&lt;-</span> weather <span class="sc">|&gt;</span> </span>
<span id="cb782-2"><a href="mod-r-plot.html#cb782-2" tabindex="-1"></a>  <span class="fu">left_join</span>(airports <span class="sc">|&gt;</span> <span class="fu">select</span>(faa, name), </span>
<span id="cb782-3"><a href="mod-r-plot.html#cb782-3" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;origin&quot;</span> <span class="ot">=</span> <span class="st">&quot;faa&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb782-4"><a href="mod-r-plot.html#cb782-4" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">origin_name =</span> name) <span class="sc">|&gt;</span> </span>
<span id="cb782-5"><a href="mod-r-plot.html#cb782-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp =</span> (temp <span class="sc">-</span> <span class="dv">32</span>) <span class="sc">*</span> (<span class="dv">5</span><span class="sc">/</span><span class="dv">9</span>) ) <span class="sc">|&gt;</span> </span>
<span id="cb782-6"><a href="mod-r-plot.html#cb782-6" tabindex="-1"></a>  <span class="fu">select</span>(origin_name, time_hour, month, temp)</span></code></pre></div>
<ol start="10" style="list-style-type: decimal">
<li><p>How are the temperature fluctuating over the year?</p></li>
<li><p>Are the temperatures different in the airports?</p></li>
</ol>
</div>
<div id="any-insights-on-canceled-flights" class="section level4 unnumbered hasAnchor">
<h4>Any insights on canceled flights?<a href="mod-r-plot.html#any-insights-on-canceled-flights" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The cancelled flights are:</p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="mod-r-plot.html#cb783-1" tabindex="-1"></a>dat_c <span class="ot">&lt;-</span> flights <span class="sc">|&gt;</span></span>
<span id="cb783-2"><a href="mod-r-plot.html#cb783-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(dep_time))</span></code></pre></div>
<ol start="12" style="list-style-type: decimal">
<li>Do some analysis and add a few plots you think are important.</li>
</ol>
</div>
<div id="other-insights" class="section level4 unnumbered hasAnchor">
<h4>Other insights?<a href="mod-r-plot.html#other-insights" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol start="13" style="list-style-type: decimal">
<li>Include further analysis you think are important.</li>
</ol>
</div>
</div>
<div id="ex-r-jobs-plot" class="section level3 hasAnchor" number="14.6.11">
<h3><span class="header-section-number">14.6.11</span> Exercise (jobs)<a href="mod-r-plot.html#ex-r-jobs-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a slightly modified version an exam assignment (exam 2023-A2).</em></p>
<p>Consider the dataset in the file <code>jobs.csv</code> with engine maintenance jobs for a group of ships.</p>
<p>The dataset contains a row for each item used. The columns/variables are:</p>
<ul>
<li><code>ship</code>: The ship considered.</li>
<li><code>job_id</code>: Maintenance job id. A job is a collection of items replaced.</li>
<li><code>job_desc</code>: Job description.</li>
<li><code>item_id</code>: Item id.</li>
<li><code>item_name</code>: Item name.</li>
<li><code>item_quantity</code>: Number of items used.</li>
<li><code>item_manufaturer</code>: Item manufacturer.</li>
<li><code>component_id</code>: Engine component id.</li>
<li><code>component_desc</code>: Engine component description.</li>
<li><code>done_date</code>: Date the job finished.</li>
<li><code>year</code>: Year of done date.</li>
<li><code>days</code>: Days since the item was last used for maintenance on the ship.</li>
</ul>
<p>You can load the data using</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="mod-r-plot.html#cb784-1" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;bss-osca/tfa-package&quot;, build = FALSE)  # run if tfa not installed</span></span>
<span id="cb784-2"><a href="mod-r-plot.html#cb784-2" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata/jobs.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;tfa&quot;</span>)</span>
<span id="cb784-3"><a href="mod-r-plot.html#cb784-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path)</span></code></pre></div>
<p>Answer this assignment using the <em>ggplot2</em> package in <em>tidyverse</em> (you may need <em>dplyr</em> for preparing the datasets you want to plot).</p>
<div id="solution-sWdWpR22KbbP33f2JZsBX2hSpgTqP98UGrj4csux" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-sWdWpR22KbbP33f2JZsBX2hSpgTqP98UGrj4csux-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-sWdWpR22KbbP33f2JZsBX2hSpgTqP98UGrj4csux-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="mod-r-plot.html#cb785-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb785-2"><a href="mod-r-plot.html#cb785-2" tabindex="-1"></a>   <span class="fu">group_by</span>(year, job_id) <span class="sc">|&gt;</span> </span>
<span id="cb785-3"><a href="mod-r-plot.html#cb785-3" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">ship =</span> <span class="fu">first</span>(ship)) <span class="sc">|&gt;</span> </span>
<span id="cb785-4"><a href="mod-r-plot.html#cb785-4" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">fill =</span> ship)) <span class="sc">+</span></span>
<span id="cb785-5"><a href="mod-r-plot.html#cb785-5" tabindex="-1"></a>   <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb785-6"><a href="mod-r-plot.html#cb785-6" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total number of jobs&quot;</span>,</span>
<span id="cb785-7"><a href="mod-r-plot.html#cb785-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb785-8"><a href="mod-r-plot.html#cb785-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Jobs&quot;</span>,</span>
<span id="cb785-9"><a href="mod-r-plot.html#cb785-9" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Ship&quot;</span>) <span class="sc">+</span></span>
<span id="cb785-10"><a href="mod-r-plot.html#cb785-10" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-672-1.png" width="672" style="display: block; margin: auto;" />
<p>
Most jobs where done in 2018.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-sWdWpR22KbbP33f2JZsBX2hSpgTqP98UGrj4csux">
Solution
</button>
<div id="hint-Z1TuT0AX18XPNGXQaRmfANqr59nTe1" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-Z1TuT0AX18XPNGXQaRmfANqr59nTe1-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-Z1TuT0AX18XPNGXQaRmfANqr59nTe1-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="mod-r-plot.html#cb786-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb786-2"><a href="mod-r-plot.html#cb786-2" tabindex="-1"></a>   <span class="fu">group_by</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb786-3"><a href="mod-r-plot.html#cb786-3" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">ship =</span> <span class="fu">first</span>(___)) <span class="sc">|&gt;</span> </span>
<span id="cb786-4"><a href="mod-r-plot.html#cb786-4" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">fill =</span> ___)) <span class="sc">+</span></span>
<span id="cb786-5"><a href="mod-r-plot.html#cb786-5" tabindex="-1"></a>   <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb786-6"><a href="mod-r-plot.html#cb786-6" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Total number of jobs&quot;</span>,</span>
<span id="cb786-7"><a href="mod-r-plot.html#cb786-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb786-8"><a href="mod-r-plot.html#cb786-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Jobs&quot;</span>,</span>
<span id="cb786-9"><a href="mod-r-plot.html#cb786-9" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Ship&quot;</span>) <span class="sc">+</span></span>
<span id="cb786-10"><a href="mod-r-plot.html#cb786-10" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-Z1TuT0AX18XPNGXQaRmfANqr59nTe1">
Hint
</button>
<ol style="list-style-type: decimal">
<li><p>For each year and job id, identify the ship the job was done on. Hint: The <code>first</code> function may be used to select the first item within a group. Use this to create a visualization showing the number of maintenance jobs for each year with the following features:</p>
<ul>
<li>Bars are used for each year.</li>
<li>Fill colors are used to identify the ship.</li>
<li>Legends are put at the bottom of the plot.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<p>Which year had the most jobs?</p></li>
</ol>
<div id="solution-ggBY5my5hIC7lT2CZN4rAxA1B5ysdW89EkZ7JR2d" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-ggBY5my5hIC7lT2CZN4rAxA1B5ysdW89EkZ7JR2d-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-ggBY5my5hIC7lT2CZN4rAxA1B5ysdW89EkZ7JR2d-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="mod-r-plot.html#cb787-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb787-2"><a href="mod-r-plot.html#cb787-2" tabindex="-1"></a>   <span class="fu">group_by</span>(ship) <span class="sc">|&gt;</span> </span>
<span id="cb787-3"><a href="mod-r-plot.html#cb787-3" tabindex="-1"></a>   <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n_distinct</span>(item_id)) <span class="sc">|&gt;</span> </span>
<span id="cb787-4"><a href="mod-r-plot.html#cb787-4" tabindex="-1"></a>   <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) </span>
<span id="cb787-5"><a href="mod-r-plot.html#cb787-5" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb787-6"><a href="mod-r-plot.html#cb787-6" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(ship, n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb787-7"><a href="mod-r-plot.html#cb787-7" tabindex="-1"></a>   <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb787-8"><a href="mod-r-plot.html#cb787-8" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of unique items used&quot;</span>,</span>
<span id="cb787-9"><a href="mod-r-plot.html#cb787-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Ship&quot;</span>,</span>
<span id="cb787-10"><a href="mod-r-plot.html#cb787-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Items&quot;</span>) <span class="sc">+</span></span>
<span id="cb787-11"><a href="mod-r-plot.html#cb787-11" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-674-1.png" width="672" style="display: block; margin: auto;" />
<p>
Most items are used for Ship-10.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-ggBY5my5hIC7lT2CZN4rAxA1B5ysdW89EkZ7JR2d">
Solution
</button>
<div id="hint-eTpvMM84e5eUqB9kdIKgkisEn898Bs" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-eTpvMM84e5eUqB9kdIKgkisEn898Bs-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-eTpvMM84e5eUqB9kdIKgkisEn898Bs-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="mod-r-plot.html#cb788-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb788-2"><a href="mod-r-plot.html#cb788-2" tabindex="-1"></a>   <span class="fu">group_by</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb788-3"><a href="mod-r-plot.html#cb788-3" tabindex="-1"></a>   <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n_distinct</span>(___)) <span class="sc">|&gt;</span> </span>
<span id="cb788-4"><a href="mod-r-plot.html#cb788-4" tabindex="-1"></a>   <span class="fu">arrange</span>(___) </span>
<span id="cb788-5"><a href="mod-r-plot.html#cb788-5" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb788-6"><a href="mod-r-plot.html#cb788-6" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(___), <span class="at">y =</span> ___)) <span class="sc">+</span></span>
<span id="cb788-7"><a href="mod-r-plot.html#cb788-7" tabindex="-1"></a>   <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb788-8"><a href="mod-r-plot.html#cb788-8" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of unique items used&quot;</span>,</span>
<span id="cb788-9"><a href="mod-r-plot.html#cb788-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Ship&quot;</span>,</span>
<span id="cb788-10"><a href="mod-r-plot.html#cb788-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Items&quot;</span>) <span class="sc">+</span></span>
<span id="cb788-11"><a href="mod-r-plot.html#cb788-11" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-eTpvMM84e5eUqB9kdIKgkisEn898Bs">
Hint
</button>
<ol start="2" style="list-style-type: decimal">
<li><p>Create a visualization showing the number of different items used for each ship with the following features:</p>
<ul>
<li>The numbers are shown using columns.</li>
<li>Reorder the columns so they increase along the x-axis.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<p>Which ship uses most items?</p></li>
</ol>
<div id="solution-GZfVERagrqhntdXNbrAZjK2k5dd2BreR6OVh2wgn" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-GZfVERagrqhntdXNbrAZjK2k5dd2BreR6OVh2wgn-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-GZfVERagrqhntdXNbrAZjK2k5dd2BreR6OVh2wgn-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="mod-r-plot.html#cb789-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb789-2"><a href="mod-r-plot.html#cb789-2" tabindex="-1"></a>   <span class="fu">group_by</span>(ship, done_date) <span class="sc">|&gt;</span> </span>
<span id="cb789-3"><a href="mod-r-plot.html#cb789-3" tabindex="-1"></a>   <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">sum</span>(item_quantity)) </span>
<span id="cb789-4"><a href="mod-r-plot.html#cb789-4" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb789-5"><a href="mod-r-plot.html#cb789-5" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> done_date, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb789-6"><a href="mod-r-plot.html#cb789-6" tabindex="-1"></a>   <span class="fu">geom_col</span>(<span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb789-7"><a href="mod-r-plot.html#cb789-7" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> ship, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb789-8"><a href="mod-r-plot.html#cb789-8" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of items used&quot;</span>,</span>
<span id="cb789-9"><a href="mod-r-plot.html#cb789-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb789-10"><a href="mod-r-plot.html#cb789-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Items used&quot;</span>) </span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-676-1.png" width="672" style="display: block; margin: auto;" />
<p>
On a specific date must items are used for Ship-12.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-GZfVERagrqhntdXNbrAZjK2k5dd2BreR6OVh2wgn">
Solution
</button>
<div id="hint-Wzo2oMiFlFk6mg6azhNxW2fcQOlLTF" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-Wzo2oMiFlFk6mg6azhNxW2fcQOlLTF-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-Wzo2oMiFlFk6mg6azhNxW2fcQOlLTF-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="mod-r-plot.html#cb790-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb790-2"><a href="mod-r-plot.html#cb790-2" tabindex="-1"></a>   <span class="fu">group_by</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb790-3"><a href="mod-r-plot.html#cb790-3" tabindex="-1"></a>   <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">sum</span>(___)) </span>
<span id="cb790-4"><a href="mod-r-plot.html#cb790-4" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb790-5"><a href="mod-r-plot.html#cb790-5" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___)) <span class="sc">+</span></span>
<span id="cb790-6"><a href="mod-r-plot.html#cb790-6" tabindex="-1"></a>   <span class="fu">geom_col</span>(<span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb790-7"><a href="mod-r-plot.html#cb790-7" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> ship, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb790-8"><a href="mod-r-plot.html#cb790-8" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of items used&quot;</span>,</span>
<span id="cb790-9"><a href="mod-r-plot.html#cb790-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb790-10"><a href="mod-r-plot.html#cb790-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Items used&quot;</span>) </span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-Wzo2oMiFlFk6mg6azhNxW2fcQOlLTF">
Hint
</button>
<ol start="3" style="list-style-type: decimal">
<li><p>Create a visualization showing the number of items used as a function of done date with the following features:</p>
<ul>
<li>The numbers are shown using columns with a fixed line width of 1 and a blue color.</li>
<li>The plot is divided using <code>ship</code> (facet). Hint: You may use <code>scales = "free_y"</code>.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<p>Which ship has most items used at a specific date?</p></li>
</ol>
<div id="solution-eQhpmC3N0fzf3x2NtQS2ruSlDqc9OwDFAvUUCimY" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-eQhpmC3N0fzf3x2NtQS2ruSlDqc9OwDFAvUUCimY-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-eQhpmC3N0fzf3x2NtQS2ruSlDqc9OwDFAvUUCimY-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="mod-r-plot.html#cb791-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb791-2"><a href="mod-r-plot.html#cb791-2" tabindex="-1"></a>   <span class="fu">filter</span>(item_id <span class="sc">%in%</span> items)</span>
<span id="cb791-3"><a href="mod-r-plot.html#cb791-3" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb791-4"><a href="mod-r-plot.html#cb791-4" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(item_quantity, <span class="at">fill =</span> item_name)) <span class="sc">+</span> </span>
<span id="cb791-5"><a href="mod-r-plot.html#cb791-5" tabindex="-1"></a>   <span class="fu">geom_density</span>(<span class="at">bw =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb791-6"><a href="mod-r-plot.html#cb791-6" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> year) <span class="sc">+</span></span>
<span id="cb791-7"><a href="mod-r-plot.html#cb791-7" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Demand density&quot;</span>,</span>
<span id="cb791-8"><a href="mod-r-plot.html#cb791-8" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Demand&quot;</span>,</span>
<span id="cb791-9"><a href="mod-r-plot.html#cb791-9" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb791-10"><a href="mod-r-plot.html#cb791-10" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Item&quot;</span>) <span class="sc">+</span></span>
<span id="cb791-11"><a href="mod-r-plot.html#cb791-11" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb791-12"><a href="mod-r-plot.html#cb791-12" tabindex="-1"></a><span class="co">#&gt; Warning: Groups with fewer than two data points have been dropped.</span></span>
<span id="cb791-13"><a href="mod-r-plot.html#cb791-13" tabindex="-1"></a><span class="co">#&gt; Groups with fewer than two data points have been dropped.</span></span>
<span id="cb791-14"><a href="mod-r-plot.html#cb791-14" tabindex="-1"></a><span class="co">#&gt; Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning -Inf</span></span>
<span id="cb791-15"><a href="mod-r-plot.html#cb791-15" tabindex="-1"></a><span class="co">#&gt; Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning -Inf</span></span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-678-1.png" width="672" style="display: block; margin: auto;" />
<p>
It can be seen that over the years, the demand peak of the Piston Ring is higher that for the O-Ring, i.e. it seems to hold.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-eQhpmC3N0fzf3x2NtQS2ruSlDqc9OwDFAvUUCimY">
Solution
</button>
<div id="hint-8BiUuZmlhCDkNVwMnrYbhDC6NdKDpx" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-8BiUuZmlhCDkNVwMnrYbhDC6NdKDpx-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-8BiUuZmlhCDkNVwMnrYbhDC6NdKDpx-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="mod-r-plot.html#cb792-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb792-2"><a href="mod-r-plot.html#cb792-2" tabindex="-1"></a>   <span class="fu">filter</span>(___)</span>
<span id="cb792-3"><a href="mod-r-plot.html#cb792-3" tabindex="-1"></a>res <span class="sc">|&gt;</span> </span>
<span id="cb792-4"><a href="mod-r-plot.html#cb792-4" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(___, <span class="at">fill =</span> ___)) <span class="sc">+</span> </span>
<span id="cb792-5"><a href="mod-r-plot.html#cb792-5" tabindex="-1"></a>   <span class="fu">geom_density</span>(<span class="at">bw =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb792-6"><a href="mod-r-plot.html#cb792-6" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span> ___) <span class="sc">+</span></span>
<span id="cb792-7"><a href="mod-r-plot.html#cb792-7" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Demand density&quot;</span>,</span>
<span id="cb792-8"><a href="mod-r-plot.html#cb792-8" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Demand&quot;</span>,</span>
<span id="cb792-9"><a href="mod-r-plot.html#cb792-9" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb792-10"><a href="mod-r-plot.html#cb792-10" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Item&quot;</span>) <span class="sc">+</span></span>
<span id="cb792-11"><a href="mod-r-plot.html#cb792-11" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-8BiUuZmlhCDkNVwMnrYbhDC6NdKDpx">
Hint
</button>
<ol start="4" style="list-style-type: decimal">
<li><p>Consider two items with id:</p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="mod-r-plot.html#cb793-1" tabindex="-1"></a>items <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;601.004.006&quot;</span>, <span class="st">&quot;601.026.128&quot;</span>)</span></code></pre></div>
<p>Create a visualization showing the variation of demand (item quantity) of each item with the following features:</p>
<ul>
<li>A density is plotted for each item with a fixed bandwidth (<code>bw</code>) of 1 and transparency (<code>alpha</code>) of 0.5.</li>
<li>Item name is used as fill.</li>
<li>The plot is divided using <code>year</code> (facet).</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<p>Over the years, is it consistent that on average the demand of one of the items is higher than the other?</p></li>
</ol>
<div id="solution-Ch70H9W6S9H3IhEemfSrmUCvt8NFZDXLZB6jDRPr" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-Ch70H9W6S9H3IhEemfSrmUCvt8NFZDXLZB6jDRPr-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-Ch70H9W6S9H3IhEemfSrmUCvt8NFZDXLZB6jDRPr-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="mod-r-plot.html#cb794-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb794-2"><a href="mod-r-plot.html#cb794-2" tabindex="-1"></a>   <span class="fu">filter</span>(item_id <span class="sc">%in%</span> items) <span class="sc">|&gt;</span> </span>
<span id="cb794-3"><a href="mod-r-plot.html#cb794-3" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> days, <span class="at">x =</span> item_id, <span class="at">fill =</span> item_name)) <span class="sc">+</span> </span>
<span id="cb794-4"><a href="mod-r-plot.html#cb794-4" tabindex="-1"></a>   <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb794-5"><a href="mod-r-plot.html#cb794-5" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Violin density&quot;</span>,</span>
<span id="cb794-6"><a href="mod-r-plot.html#cb794-6" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Item id&quot;</span>,</span>
<span id="cb794-7"><a href="mod-r-plot.html#cb794-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Days&quot;</span>,</span>
<span id="cb794-8"><a href="mod-r-plot.html#cb794-8" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Item&quot;</span>) <span class="sc">+</span></span>
<span id="cb794-9"><a href="mod-r-plot.html#cb794-9" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb794-10"><a href="mod-r-plot.html#cb794-10" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 16 rows containing non-finite outside the scale range (`stat_ydensity()`).</span></span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-681-1.png" width="672" style="display: block; margin: auto;" />
<p>
Most often there are less than 100 days between a repeated usage of the item, but there can be over 600 days. The Piston Ring have in general a lower number of days in between than the O-Ring on average.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-Ch70H9W6S9H3IhEemfSrmUCvt8NFZDXLZB6jDRPr">
Solution
</button>
<div id="hint-JBo3dePkpuehifnuHLBYxcyzAfcDrg" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-JBo3dePkpuehifnuHLBYxcyzAfcDrg-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-JBo3dePkpuehifnuHLBYxcyzAfcDrg-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="mod-r-plot.html#cb795-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb795-2"><a href="mod-r-plot.html#cb795-2" tabindex="-1"></a>   <span class="fu">filter</span>(___) <span class="sc">|&gt;</span> </span>
<span id="cb795-3"><a href="mod-r-plot.html#cb795-3" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ___, <span class="at">x =</span> ___, <span class="at">fill =</span> ___)) <span class="sc">+</span> </span>
<span id="cb795-4"><a href="mod-r-plot.html#cb795-4" tabindex="-1"></a>   <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb795-5"><a href="mod-r-plot.html#cb795-5" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Violin density&quot;</span>,</span>
<span id="cb795-6"><a href="mod-r-plot.html#cb795-6" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Item id&quot;</span>,</span>
<span id="cb795-7"><a href="mod-r-plot.html#cb795-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Days&quot;</span>,</span>
<span id="cb795-8"><a href="mod-r-plot.html#cb795-8" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Item&quot;</span>) <span class="sc">+</span></span>
<span id="cb795-9"><a href="mod-r-plot.html#cb795-9" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-JBo3dePkpuehifnuHLBYxcyzAfcDrg">
Hint
</button>
<ol start="5" style="list-style-type: decimal">
<li><p>Consider two items with id:</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="mod-r-plot.html#cb796-1" tabindex="-1"></a>items <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;601.004.006&quot;</span>, <span class="st">&quot;601.026.128&quot;</span>)</span></code></pre></div>
<p>Create a visualization showing the variation of days since last used for maintenance given an item with the following features:</p>
<ul>
<li>A violin is used to plot days since last used given an item.</li>
<li>Item name is used as fill.</li>
<li>Informative figure title and axis titles are given.</li>
</ul>
<p>Comment on the plot.</p></li>
</ol>
</div>
<div id="ex-r-onecom" class="section level3 hasAnchor" number="14.6.12">
<h3><span class="header-section-number">14.6.12</span> Exercise (OneCom)<a href="mod-r-plot.html#ex-r-onecom" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider the case <a href="https://bss-osca.github.io/osca/cases/onecom-case.pdf">OneCom</a> and read the introduction, Section 1 and Section 2. Next, read Section 5 and answer the questions. Data can be found at <a href="https://github.com/bss-osca/osca/tree/main/docs/cases/onecom-case-data">GitHub</a> (download the raw files).</p>
<p>When considering Question 4 assume that your forecast of demands for 2024 is found under assumptions:</p>
<ul>
<li>Sales equal demand except for the case mentioned in Question 3.</li>
<li>The merger does not affect sales, i.e we can forecast demand for each company and the sum them.</li>
<li>OneCom can increase sales next year since it has done it over the previous years. As a result, we assume that sales increase the same percentage for each region as from 2022 to 2023.</li>
<li>Since there is no clear pattern for YFon, sales are assumed to be equal sales in 2023.</li>
<li>Demand is rounded to millions.</li>
</ul>
<p>Moreover, give an answer to Question 5:</p>
<ol start="5" style="list-style-type: decimal">
<li>Discuss how assumptions and data validation may affect how the numbers in Table 1 is estimated. May this affect the result in redesigning the supply chain network given the merger in ? How can the challenges be addressed?</li>
</ol>

</div>
</div>
</div>



<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-gramma" class="csl-entry">
Wilkinson, Leland. 2005. <em>The Grammar of Graphics (Statistics and Computing)</em>. Springer-Verlag.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mod-r-transform.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mod-r-dist-fit.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": false,
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/bss-osca/tfa/edit/master/book/14_r-plot.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
