<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 3 Loops and conditional statements | Tools for Analytics (TFA)</title>
  <meta name="description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 3 Loops and conditional statements | Tools for Analytics (TFA)" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bss-osca.github.io/tfa//assets/logo.png" />
  <meta property="og:description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="github-repo" content="bss-osca/tfa" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 3 Loops and conditional statements | Tools for Analytics (TFA)" />
  
  <meta name="twitter:description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="twitter:image" content="https://bss-osca.github.io/tfa//assets/logo.png" />

<meta name="author" content="Lars Relund Nielsen" />


<meta name="date" content="2024-12-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon" />
<link rel="prev" href="mod-vba-intro.html"/>
<link rel="next" href="mod-vba-procedures.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.11/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<link href="libs/minichart-0.2.2/minicharts.css" rel="stylesheet" />
<script src="libs/minichart-0.2.2/leaflet.minicharts.min.js"></script>
<link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" />
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<html>
<head>
<script>
  $(document).ready(function() {

  // Section anchors
  $('.section h1, .section h2, .section h3, .section h4, .section h5').each(function() {
    anchor = '#' + $(this).parent().attr('id');
    $(this).addClass("hasAnchor").prepend('<a href="' + anchor + '" class="anchor"></a>');
  });
});
</script>
<script src="https://hypothes.is/embed.js" async></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</head>
</html>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="img/logo.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to the course</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#lo-intro"><i class="fa fa-check"></i><b>1.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.2</b> Purpose for the course</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#r-vs-vba"><i class="fa fa-check"></i><b>1.3</b> R vs Excel/VBA</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#computer"><i class="fa fa-check"></i><b>1.4</b> How a computer works</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i><b>1.5</b> How the notes are organized</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#ack"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#how-to-cite"><i class="fa fa-check"></i><b>1.7</b> How to cite</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#ex-intro"><i class="fa fa-check"></i><b>1.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="index.html"><a href="index.html#ex-annotate"><i class="fa fa-check"></i><b>1.8.1</b> Exercise - How to annotate</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I VBA</b></span></li>
<li class="chapter" data-level="2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html"><i class="fa fa-check"></i><b>2</b> An introduction to VBA</a>
<ul>
<li class="chapter" data-level="2.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#lo-vba-intro"><i class="fa fa-check"></i><b>2.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-what"><i class="fa fa-check"></i><b>2.2</b> What is VBA</a></li>
<li class="chapter" data-level="2.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-setup"><i class="fa fa-check"></i><b>2.3</b> Setup Excel for VBA</a></li>
<li class="chapter" data-level="2.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-hello"><i class="fa fa-check"></i><b>2.4</b> Your first program</a></li>
<li class="chapter" data-level="2.5" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-macro"><i class="fa fa-check"></i><b>2.5</b> The macro recorder</a></li>
<li class="chapter" data-level="2.6" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-overview"><i class="fa fa-check"></i><b>2.6</b> VBA - A short overview</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#variables"><i class="fa fa-check"></i><b>2.6.1</b> Variables</a></li>
<li class="chapter" data-level="2.6.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#procedures"><i class="fa fa-check"></i><b>2.6.2</b> Procedures</a></li>
<li class="chapter" data-level="2.6.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#input-and-output"><i class="fa fa-check"></i><b>2.6.3</b> Input and output</a></li>
<li class="chapter" data-level="2.6.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#conditional-statements"><i class="fa fa-check"></i><b>2.6.4</b> Conditional statements</a></li>
<li class="chapter" data-level="2.6.5" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#loops"><i class="fa fa-check"></i><b>2.6.5</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-coding-practice"><i class="fa fa-check"></i><b>2.7</b> Good coding pratice</a></li>
<li class="chapter" data-level="2.8" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#rc-vba-intro"><i class="fa fa-check"></i><b>2.8</b> Recap</a></li>
<li class="chapter" data-level="2.9" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-intro"><i class="fa fa-check"></i><b>2.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-hello"><i class="fa fa-check"></i><b>2.9.1</b> Exercise - Hello</a></li>
<li class="chapter" data-level="2.9.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-macro"><i class="fa fa-check"></i><b>2.9.2</b> Exercise - Record a macro</a></li>
<li class="chapter" data-level="2.9.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-user-input"><i class="fa fa-check"></i><b>2.9.3</b> Exercise - User input</a></li>
<li class="chapter" data-level="2.9.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-max-min"><i class="fa fa-check"></i><b>2.9.4</b> Exercise - Max and min number</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html"><i class="fa fa-check"></i><b>3</b> Loops and conditional statements</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#lo-vba-loops-cond"><i class="fa fa-check"></i><b>3.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.2" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-operators"><i class="fa fa-check"></i><b>3.2</b> Relational and logical operators</a></li>
<li class="chapter" data-level="3.3" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-loops"><i class="fa fa-check"></i><b>3.3</b> Loops</a></li>
<li class="chapter" data-level="3.4" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-cond"><i class="fa fa-check"></i><b>3.4</b> Conditional statements</a></li>
<li class="chapter" data-level="3.5" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-ex-jen"><i class="fa fa-check"></i><b>3.5</b> Example - Find Jen</a></li>
<li class="chapter" data-level="3.6" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-ex-dist-mat"><i class="fa fa-check"></i><b>3.6</b> Example - A distance matrix</a></li>
<li class="chapter" data-level="3.7" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#recap"><i class="fa fa-check"></i><b>3.7</b> Recap</a></li>
<li class="chapter" data-level="3.8" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-loops-cond"><i class="fa fa-check"></i><b>3.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-loops"><i class="fa fa-check"></i><b>3.8.1</b> Exercise - Loops</a></li>
<li class="chapter" data-level="3.8.2" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-cond"><i class="fa fa-check"></i><b>3.8.2</b> Exercise - Conditional statements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html"><i class="fa fa-check"></i><b>4</b> Procedures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#lo-vba-procedures"><i class="fa fa-check"></i><b>4.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="4.2" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-subs-functions"><i class="fa fa-check"></i><b>4.2</b> Subs and functions - The basics</a></li>
<li class="chapter" data-level="4.3" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-optional-arg"><i class="fa fa-check"></i><b>4.3</b> Optional arguments</a></li>
<li class="chapter" data-level="4.4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-pub-priv"><i class="fa fa-check"></i><b>4.4</b> Public and private procedures</a></li>
<li class="chapter" data-level="4.5" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-byref"><i class="fa fa-check"></i><b>4.5</b> Passing arguments by reference or by value</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#return-values-from-a-sub"><i class="fa fa-check"></i><b>4.5.1</b> Return values from a sub</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-built-in"><i class="fa fa-check"></i><b>4.6</b> Built-in functions</a></li>
<li class="chapter" data-level="4.7" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-test-persons"><i class="fa fa-check"></i><b>4.7</b> Example - Selection of test persons</a></li>
<li class="chapter" data-level="4.8" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#recap-1"><i class="fa fa-check"></i><b>4.8</b> Recap</a></li>
<li class="chapter" data-level="4.9" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-procedures"><i class="fa fa-check"></i><b>4.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-subs"><i class="fa fa-check"></i><b>4.9.1</b> Exercise - Subs</a></li>
<li class="chapter" data-level="4.9.2" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#exercise---temperatures"><i class="fa fa-check"></i><b>4.9.2</b> Exercise - Temperatures</a></li>
<li class="chapter" data-level="4.9.3" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-functions"><i class="fa fa-check"></i><b>4.9.3</b> Exercise - Functions</a></li>
<li class="chapter" data-level="4.9.4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-worksheet-functions"><i class="fa fa-check"></i><b>4.9.4</b> Exercise - Worksheet functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html"><i class="fa fa-check"></i><b>5</b> Advanced data types and usage</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#lo-vba-datatypes"><i class="fa fa-check"></i><b>5.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="5.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-strings"><i class="fa fa-check"></i><b>5.2</b> Strings</a></li>
<li class="chapter" data-level="5.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-objects"><i class="fa fa-check"></i><b>5.3</b> Objects</a></li>
<li class="chapter" data-level="5.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-wst"><i class="fa fa-check"></i><b>5.4</b> The Worksheet object</a></li>
<li class="chapter" data-level="5.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#wst-rng"><i class="fa fa-check"></i><b>5.5</b> The Range object</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#named-ranges-in-excel"><i class="fa fa-check"></i><b>5.5.1</b> Named ranges in Excel</a></li>
<li class="chapter" data-level="5.5.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#current-region-of-a-range"><i class="fa fa-check"></i><b>5.5.2</b> Current region of a range</a></li>
<li class="chapter" data-level="5.5.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#input-and-output-1"><i class="fa fa-check"></i><b>5.5.3</b> Input and output</a></li>
<li class="chapter" data-level="5.5.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#sorting-a-range"><i class="fa fa-check"></i><b>5.5.4</b> Sorting a range</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-ary"><i class="fa fa-check"></i><b>5.6</b> Arrays</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#multi-dimensional-arrays"><i class="fa fa-check"></i><b>5.6.1</b> Multi-dimensional arrays</a></li>
<li class="chapter" data-level="5.6.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#dynamic-arrays"><i class="fa fa-check"></i><b>5.6.2</b> Dynamic arrays</a></li>
<li class="chapter" data-level="5.6.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#input-and-output-2"><i class="fa fa-check"></i><b>5.6.3</b> Input and output</a></li>
<li class="chapter" data-level="5.6.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#sorting-arrays"><i class="fa fa-check"></i><b>5.6.4</b> Sorting arrays</a></li>
<li class="chapter" data-level="5.6.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#use-arrays-instead-of-ranges"><i class="fa fa-check"></i><b>5.6.5</b> Use arrays instead of ranges</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-coll"><i class="fa fa-check"></i><b>5.7</b> Collections</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#accessing-collections-using-keys"><i class="fa fa-check"></i><b>5.7.1</b> Accessing collections using keys</a></li>
<li class="chapter" data-level="5.7.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#collections-containing-objects"><i class="fa fa-check"></i><b>5.7.2</b> Collections containing objects</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-ex-job-seq"><i class="fa fa-check"></i><b>5.8</b> Example - Job sequencing</a></li>
<li class="chapter" data-level="5.9" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#recap-2"><i class="fa fa-check"></i><b>5.9</b> Recap</a></li>
<li class="chapter" data-level="5.10" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-datatypes"><i class="fa fa-check"></i><b>5.10</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-equal"><i class="fa fa-check"></i><b>5.10.1</b> Exercise - Equal entries</a></li>
<li class="chapter" data-level="5.10.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-products"><i class="fa fa-check"></i><b>5.10.2</b> Exercise - Product search</a></li>
<li class="chapter" data-level="5.10.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-read-collections"><i class="fa fa-check"></i><b>5.10.3</b> Exercise - Read collections</a></li>
<li class="chapter" data-level="5.10.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-read-arrays"><i class="fa fa-check"></i><b>5.10.4</b> Exercise - Read arrays</a></li>
<li class="chapter" data-level="5.10.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-process"><i class="fa fa-check"></i><b>5.10.5</b> Exercise - Process numbers</a></li>
<li class="chapter" data-level="5.10.6" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-pay"><i class="fa fa-check"></i><b>5.10.6</b> Exercise - Search payments</a></li>
<li class="chapter" data-level="5.10.7" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-flight"><i class="fa fa-check"></i><b>5.10.7</b> Exercise - Flight search</a></li>
<li class="chapter" data-level="5.10.8" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-table"><i class="fa fa-check"></i><b>5.10.8</b> Exercise - Search table</a></li>
<li class="chapter" data-level="5.10.9" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-next-task"><i class="fa fa-check"></i><b>5.10.9</b> Exercise - Find next task</a></li>
<li class="chapter" data-level="5.10.10" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-seat-reservation"><i class="fa fa-check"></i><b>5.10.10</b> Exercise - Seat reservation</a></li>
<li class="chapter" data-level="5.10.11" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-select"><i class="fa fa-check"></i><b>5.10.11</b> Exercise - Transform data (select and filter)</a></li>
<li class="chapter" data-level="5.10.12" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-mutate"><i class="fa fa-check"></i><b>5.10.12</b> Exercise - Transform data (arrange and mutate)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html"><i class="fa fa-check"></i><b>6</b> Generating random numbers</a>
<ul>
<li class="chapter" data-level="6.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#lo-vba-random-numbers"><i class="fa fa-check"></i><b>6.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="6.2" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#vba-random-numbers"><i class="fa fa-check"></i><b>6.2</b> Generating random numbers</a></li>
<li class="chapter" data-level="6.3" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#vba-simulation"><i class="fa fa-check"></i><b>6.3</b> Simulation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#sec-vba-tsp"><i class="fa fa-check"></i><b>6.3.1</b> Example - Traveling salesman problem</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#recap-3"><i class="fa fa-check"></i><b>6.4</b> Recap</a></li>
<li class="chapter" data-level="6.5" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-random-numbers"><i class="fa fa-check"></i><b>6.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-random-int"><i class="fa fa-check"></i><b>6.5.1</b> Exercise - Two random integers</a></li>
<li class="chapter" data-level="6.5.2" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-swap"><i class="fa fa-check"></i><b>6.5.2</b> Exercise - Swap entries</a></li>
<li class="chapter" data-level="6.5.3" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-bakery"><i class="fa fa-check"></i><b>6.5.3</b> Exercise - Dan’s bakery</a></li>
<li class="chapter" data-level="6.5.4" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-generate"><i class="fa fa-check"></i><b>6.5.4</b> Exercise - Generating random numbers</a></li>
<li class="chapter" data-level="6.5.5" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-stoc-functions"><i class="fa fa-check"></i><b>6.5.5</b> Exercise - Stochastic functions</a></li>
<li class="chapter" data-level="6.5.6" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-customer-demand"><i class="fa fa-check"></i><b>6.5.6</b> Exercise - Customer demand</a></li>
<li class="chapter" data-level="6.5.7" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-simple-game"><i class="fa fa-check"></i><b>6.5.7</b> Exercise - A simple game</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II R</b></span></li>
<li class="chapter" data-level="7" data-path="mod-r-install.html"><a href="mod-r-install.html"><i class="fa fa-check"></i><b>7</b> Setting up R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mod-r-install.html"><a href="mod-r-install.html#lo-r-install"><i class="fa fa-check"></i><b>7.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="7.2" data-path="mod-r-install.html"><a href="mod-r-install.html#r-install"><i class="fa fa-check"></i><b>7.2</b> Install R and RStudio</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="mod-r-install.html"><a href="mod-r-install.html#test-your-installation"><i class="fa fa-check"></i><b>7.2.1</b> Test your installation</a></li>
<li class="chapter" data-level="7.2.2" data-path="mod-r-install.html"><a href="mod-r-install.html#add-on-packages"><i class="fa fa-check"></i><b>7.2.2</b> Add-on packages</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="mod-r-install.html"><a href="mod-r-install.html#r-cloud"><i class="fa fa-check"></i><b>7.3</b> Setup and test Posit Cloud</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html"><i class="fa fa-check"></i><b>8</b> R basics and workflows</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#lo-r-workflow"><i class="fa fa-check"></i><b>8.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="8.2" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#working-with-r-at-the-command-line-in-rstudio"><i class="fa fa-check"></i><b>8.2</b> Working with R at the command line in RStudio</a></li>
<li class="chapter" data-level="8.3" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#your-first-datacamp-course"><i class="fa fa-check"></i><b>8.3</b> Your first DataCamp course</a></li>
<li class="chapter" data-level="8.4" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#pipes"><i class="fa fa-check"></i><b>8.4</b> Pipes</a></li>
<li class="chapter" data-level="8.5" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#rprojs"><i class="fa fa-check"></i><b>8.5</b> RStudio projects</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#storing-your-code-in-a-script-file"><i class="fa fa-check"></i><b>8.5.1</b> Storing your code in a script file</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#rc-r-workflow"><i class="fa fa-check"></i><b>8.6</b> Recap</a></li>
<li class="chapter" data-level="8.7" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#ex-r-workflow"><i class="fa fa-check"></i><b>8.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-group-work"><i class="fa fa-check"></i><b>8.7.1</b> Exercise (group work)</a></li>
<li class="chapter" data-level="8.7.2" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-piping"><i class="fa fa-check"></i><b>8.7.2</b> Exercise (piping)</a></li>
<li class="chapter" data-level="8.7.3" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-working-dir"><i class="fa fa-check"></i><b>8.7.3</b> Exercise (working dir)</a></li>
<li class="chapter" data-level="8.7.4" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-vectors"><i class="fa fa-check"></i><b>8.7.4</b> Exercise (vectors)</a></li>
<li class="chapter" data-level="8.7.5" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-matrices"><i class="fa fa-check"></i><b>8.7.5</b> Exercise (matrices)</a></li>
<li class="chapter" data-level="8.7.6" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-data-frames"><i class="fa fa-check"></i><b>8.7.6</b> Exercise (data frames)</a></li>
<li class="chapter" data-level="8.7.7" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-lists"><i class="fa fa-check"></i><b>8.7.7</b> Exercise (lists)</a></li>
<li class="chapter" data-level="8.7.8" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#ex-strings"><i class="fa fa-check"></i><b>8.7.8</b> Exercise (string management)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html"><i class="fa fa-check"></i><b>9</b> Loops and conditionals</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#lo-loops"><i class="fa fa-check"></i><b>9.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="9.2" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#r-dc-loops-cond"><i class="fa fa-check"></i><b>9.2</b> Conditionals and control flow</a></li>
<li class="chapter" data-level="9.3" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#r-loops"><i class="fa fa-check"></i><b>9.3</b> Loops</a></li>
<li class="chapter" data-level="9.4" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#rc-r-loops-cond"><i class="fa fa-check"></i><b>9.4</b> Recap</a></li>
<li class="chapter" data-level="9.5" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-loops-cond"><i class="fa fa-check"></i><b>9.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-conditional-expressions"><i class="fa fa-check"></i><b>9.5.1</b> Exercise (conditional expressions)</a></li>
<li class="chapter" data-level="9.5.2" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-loops"><i class="fa fa-check"></i><b>9.5.2</b> Exercise (loops)</a></li>
<li class="chapter" data-level="9.5.3" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-search-vector"><i class="fa fa-check"></i><b>9.5.3</b> Exercise (search vector)</a></li>
<li class="chapter" data-level="9.5.4" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-dist"><i class="fa fa-check"></i><b>9.5.4</b> Exercise (calculating distances)</a></li>
<li class="chapter" data-level="9.5.5" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-expand"><i class="fa fa-check"></i><b>9.5.5</b> Exercise (expand_grid)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mod-r-functions.html"><a href="mod-r-functions.html"><i class="fa fa-check"></i><b>10</b> Functions</a>
<ul>
<li class="chapter" data-level="10.1" data-path="mod-r-functions.html"><a href="mod-r-functions.html#lo-r-functions"><i class="fa fa-check"></i><b>10.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="10.2" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-dc-functions"><i class="fa fa-check"></i><b>10.2</b> DataCamp course</a></li>
<li class="chapter" data-level="10.3" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-extra"><i class="fa fa-check"></i><b>10.3</b> Functions returning multiple objects</a></li>
<li class="chapter" data-level="10.4" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-arg"><i class="fa fa-check"></i><b>10.4</b> The <code>...</code> argument</a></li>
<li class="chapter" data-level="10.5" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-doc"><i class="fa fa-check"></i><b>10.5</b> Documenting your functions</a></li>
<li class="chapter" data-level="10.6" data-path="mod-r-functions.html"><a href="mod-r-functions.html#example---job-sequencing"><i class="fa fa-check"></i><b>10.6</b> Example - Job sequencing</a></li>
<li class="chapter" data-level="10.7" data-path="mod-r-functions.html"><a href="mod-r-functions.html#rc-functions"><i class="fa fa-check"></i><b>10.7</b> Recap</a></li>
<li class="chapter" data-level="10.8" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-functions"><i class="fa fa-check"></i><b>10.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-def-func"><i class="fa fa-check"></i><b>10.8.1</b> Exercise (defining functions)</a></li>
<li class="chapter" data-level="10.8.2" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-euclidean-distances"><i class="fa fa-check"></i><b>10.8.2</b> Exercise (euclidean distances)</a></li>
<li class="chapter" data-level="10.8.3" data-path="mod-r-functions.html"><a href="mod-r-functions.html#exercise-scope"><i class="fa fa-check"></i><b>10.8.3</b> Exercise (scope)</a></li>
<li class="chapter" data-level="10.8.4" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-time-conversion"><i class="fa fa-check"></i><b>10.8.4</b> Exercise (time conversion)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html"><i class="fa fa-check"></i><b>11</b> Introduction to tidyverse and RMarkdown</a>
<ul>
<li class="chapter" data-level="11.1" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#lo-tidyverse-intro"><i class="fa fa-check"></i><b>11.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="11.2" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-tidyverse-intro"><i class="fa fa-check"></i><b>11.2</b> The tidyverse package</a></li>
<li class="chapter" data-level="11.3" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-markdown-intro"><i class="fa fa-check"></i><b>11.3</b> Writing reproducible reports</a></li>
<li class="chapter" data-level="11.4" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-tibbles-intro"><i class="fa fa-check"></i><b>11.4</b> Tibbles</a></li>
<li class="chapter" data-level="11.5" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#rc-tidyverse-intro"><i class="fa fa-check"></i><b>11.5</b> Recap</a></li>
<li class="chapter" data-level="11.6" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#ex-tidyverse-intro"><i class="fa fa-check"></i><b>11.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#exercise-your-first-rmarkdown-exercise"><i class="fa fa-check"></i><b>11.6.1</b> Exercise (your first RMarkdown exercise)</a></li>
<li class="chapter" data-level="11.6.2" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#exercise-tibbles"><i class="fa fa-check"></i><b>11.6.2</b> Exercise (tibbles)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mod-r-io.html"><a href="mod-r-io.html"><i class="fa fa-check"></i><b>12</b> Importing and exporting data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="mod-r-io.html"><a href="mod-r-io.html#lo-r-io"><i class="fa fa-check"></i><b>12.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="12.2" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-csv"><i class="fa fa-check"></i><b>12.2</b> CSV files</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="mod-r-io.html"><a href="mod-r-io.html#reading-a-csv-file"><i class="fa fa-check"></i><b>12.2.1</b> Reading a CSV file</a></li>
<li class="chapter" data-level="12.2.2" data-path="mod-r-io.html"><a href="mod-r-io.html#writing-to-csv-files"><i class="fa fa-check"></i><b>12.2.2</b> Writing to CSV files</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-excel"><i class="fa fa-check"></i><b>12.3</b> Excel</a></li>
<li class="chapter" data-level="12.4" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-google"><i class="fa fa-check"></i><b>12.4</b> Google Sheets</a></li>
<li class="chapter" data-level="12.5" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-text"><i class="fa fa-check"></i><b>12.5</b> Text files</a></li>
<li class="chapter" data-level="12.6" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-r"><i class="fa fa-check"></i><b>12.6</b> R’s native binary format</a></li>
<li class="chapter" data-level="12.7" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-json"><i class="fa fa-check"></i><b>12.7</b> Json</a></li>
<li class="chapter" data-level="12.8" data-path="mod-r-io.html"><a href="mod-r-io.html#rc-r-io"><i class="fa fa-check"></i><b>12.8</b> Recap</a></li>
<li class="chapter" data-level="12.9" data-path="mod-r-io.html"><a href="mod-r-io.html#ex-r-io"><i class="fa fa-check"></i><b>12.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="mod-r-io.html"><a href="mod-r-io.html#exercise-statistikbanken"><i class="fa fa-check"></i><b>12.9.1</b> Exercise (Statistikbanken)</a></li>
<li class="chapter" data-level="12.9.2" data-path="mod-r-io.html"><a href="mod-r-io.html#exercise-tuples-in-opl"><i class="fa fa-check"></i><b>12.9.2</b> Exercise (tuples in OPL)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="mod-r-transform.html"><a href="mod-r-transform.html"><i class="fa fa-check"></i><b>13</b> Transforming data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="mod-r-transform.html"><a href="mod-r-transform.html#lo-r-transform"><i class="fa fa-check"></i><b>13.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="13.2" data-path="mod-r-transform.html"><a href="mod-r-transform.html#r-transform-tidyverse"><i class="fa fa-check"></i><b>13.2</b> Working with data in the tidyverse</a></li>
<li class="chapter" data-level="13.3" data-path="mod-r-transform.html"><a href="mod-r-transform.html#r-transform-joins"><i class="fa fa-check"></i><b>13.3</b> Mutating joins</a></li>
<li class="chapter" data-level="13.4" data-path="mod-r-transform.html"><a href="mod-r-transform.html#rc-r-transform"><i class="fa fa-check"></i><b>13.4</b> Recap</a></li>
<li class="chapter" data-level="13.5" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-transform"><i class="fa fa-check"></i><b>13.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-gapminder1"><i class="fa fa-check"></i><b>13.5.1</b> Exercise (gapminder)</a></li>
<li class="chapter" data-level="13.5.2" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-babynames1"><i class="fa fa-check"></i><b>13.5.2</b> Exercise (babynames)</a></li>
<li class="chapter" data-level="13.5.3" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-profit1"><i class="fa fa-check"></i><b>13.5.3</b> Exercise (profit)</a></li>
<li class="chapter" data-level="13.5.4" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-fish"><i class="fa fa-check"></i><b>13.5.4</b> Exercise (fisheries)</a></li>
<li class="chapter" data-level="13.5.5" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-company"><i class="fa fa-check"></i><b>13.5.5</b> Exercise (company ranking)</a></li>
<li class="chapter" data-level="13.5.6" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-titanic"><i class="fa fa-check"></i><b>13.5.6</b> Exercise (Titanic)</a></li>
<li class="chapter" data-level="13.5.7" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-covid"><i class="fa fa-check"></i><b>13.5.7</b> Exercise (covid)</a></li>
<li class="chapter" data-level="13.5.8" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-election"><i class="fa fa-check"></i><b>13.5.8</b> Exercise (election)</a></li>
<li class="chapter" data-level="13.5.9" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-orders"><i class="fa fa-check"></i><b>13.5.9</b> Exercise (orders)</a></li>
<li class="chapter" data-level="13.5.10" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-jobs"><i class="fa fa-check"></i><b>13.5.10</b> Exercise (jobs)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="mod-r-plot.html"><a href="mod-r-plot.html"><i class="fa fa-check"></i><b>14</b> Data visualization using ggplot</a>
<ul>
<li class="chapter" data-level="14.1" data-path="mod-r-plot.html"><a href="mod-r-plot.html#lo-plot"><i class="fa fa-check"></i><b>14.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="14.2" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-intro"><i class="fa fa-check"></i><b>14.2</b> Introduction to data visualization</a></li>
<li class="chapter" data-level="14.3" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-multi"><i class="fa fa-check"></i><b>14.3</b> Combining plots into one using <em>patchwork</em></a></li>
<li class="chapter" data-level="14.4" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-save"><i class="fa fa-check"></i><b>14.4</b> Saving graphics</a></li>
<li class="chapter" data-level="14.5" data-path="mod-r-plot.html"><a href="mod-r-plot.html#rc-r-plot"><i class="fa fa-check"></i><b>14.5</b> Recap</a></li>
<li class="chapter" data-level="14.6" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-plot"><i class="fa fa-check"></i><b>14.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-gapminder2"><i class="fa fa-check"></i><b>14.6.1</b> Exercise (gapminder)</a></li>
<li class="chapter" data-level="14.6.2" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-profit2"><i class="fa fa-check"></i><b>14.6.2</b> Exercise (profit)</a></li>
<li class="chapter" data-level="14.6.3" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-covid19"><i class="fa fa-check"></i><b>14.6.3</b> Exercise (COVID-19)</a></li>
<li class="chapter" data-level="14.6.4" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-lego"><i class="fa fa-check"></i><b>14.6.4</b> Exercise (Lego and sales)</a></li>
<li class="chapter" data-level="14.6.5" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-company-plot"><i class="fa fa-check"></i><b>14.6.5</b> Exercise (company ranking)</a></li>
<li class="chapter" data-level="14.6.6" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-titanic-plot"><i class="fa fa-check"></i><b>14.6.6</b> Exercise (Titanic)</a></li>
<li class="chapter" data-level="14.6.7" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-covid-plot"><i class="fa fa-check"></i><b>14.6.7</b> Exercise (covid)</a></li>
<li class="chapter" data-level="14.6.8" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-election-plot"><i class="fa fa-check"></i><b>14.6.8</b> Exercise (election)</a></li>
<li class="chapter" data-level="14.6.9" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-orders-plot"><i class="fa fa-check"></i><b>14.6.9</b> Exercise (orders)</a></li>
<li class="chapter" data-level="14.6.10" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-nycflights"><i class="fa fa-check"></i><b>14.6.10</b> Exercise (New York flights)</a></li>
<li class="chapter" data-level="14.6.11" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-jobs-plot"><i class="fa fa-check"></i><b>14.6.11</b> Exercise (jobs)</a></li>
<li class="chapter" data-level="14.6.12" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-onecom"><i class="fa fa-check"></i><b>14.6.12</b> Exercise (OneCom)</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Extra R</b></span></li>
<li class="chapter" data-level="15" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html"><i class="fa fa-check"></i><b>15</b> Fitting probability distributions</a>
<ul>
<li class="chapter" data-level="15.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#lo-r-dist-fit"><i class="fa fa-check"></i><b>15.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="15.2" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-intro"><i class="fa fa-check"></i><b>15.2</b> Introduction</a></li>
<li class="chapter" data-level="15.3" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-cont"><i class="fa fa-check"></i><b>15.3</b> Fitting distributions to continuous data</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#example-breakdown-times"><i class="fa fa-check"></i><b>15.3.1</b> Example: breakdown times</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-discrete"><i class="fa fa-check"></i><b>15.4</b> Fitting distributions to discrete data</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#example-sales-of-lottery-tickets"><i class="fa fa-check"></i><b>15.4.1</b> Example: sales of lottery tickets</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-dist-fit-pois"><i class="fa fa-check"></i><b>15.5</b> The Poisson process</a></li>
<li class="chapter" data-level="15.6" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#rc-r-dist-fit"><i class="fa fa-check"></i><b>15.6</b> Recap</a></li>
<li class="chapter" data-level="15.7" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#ex-r-dist-fit"><i class="fa fa-check"></i><b>15.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#exercise---call-center"><i class="fa fa-check"></i><b>15.7.1</b> Exercise - Call center</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="mod-r-maps.html"><a href="mod-r-maps.html"><i class="fa fa-check"></i><b>16</b> Spatial data and maps</a>
<ul>
<li class="chapter" data-level="16.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#lo-maps"><i class="fa fa-check"></i><b>16.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="16.2" data-path="mod-r-maps.html"><a href="mod-r-maps.html#sec-map-api-key"><i class="fa fa-check"></i><b>16.2</b> Services for obtatining spatial data</a></li>
<li class="chapter" data-level="16.3" data-path="mod-r-maps.html"><a href="mod-r-maps.html#calculating-distances"><i class="fa fa-check"></i><b>16.3</b> Calculating distances</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#using-google-maps"><i class="fa fa-check"></i><b>16.3.1</b> Using Google Maps</a></li>
<li class="chapter" data-level="16.3.2" data-path="mod-r-maps.html"><a href="mod-r-maps.html#using-bing-maps"><i class="fa fa-check"></i><b>16.3.2</b> Using Bing Maps</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="mod-r-maps.html"><a href="mod-r-maps.html#geocoding-and-reverse-geocoding"><i class="fa fa-check"></i><b>16.4</b> Geocoding and reverse geocoding</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#using-google-maps-1"><i class="fa fa-check"></i><b>16.4.1</b> Using Google maps</a></li>
<li class="chapter" data-level="16.4.2" data-path="mod-r-maps.html"><a href="mod-r-maps.html#use-bing-maps"><i class="fa fa-check"></i><b>16.4.2</b> Use Bing Maps</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="mod-r-maps.html"><a href="mod-r-maps.html#adding-markers-and-routes-to-a-map"><i class="fa fa-check"></i><b>16.5</b> Adding markers and routes to a map</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="groups.html"><a href="groups.html"><i class="fa fa-check"></i><b>A</b> Working in groups</a>
<ul>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#using-git"><i class="fa fa-check"></i>Using Git together with GitHub</a>
<ul>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#register-a-free-github-account"><i class="fa fa-check"></i>Register a free GitHub account</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#install-git"><i class="fa fa-check"></i>Install Git</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#check-your-installation"><i class="fa fa-check"></i>Check your installation</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#setup-projects-using-git-and-github"><i class="fa fa-check"></i>Setup projects using Git and GitHub</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="annotate.html"><a href="annotate.html"><i class="fa fa-check"></i><b>B</b> Annotate the course notes</a></li>
<li class="chapter" data-level="C" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>C</b> Getting help</a></li>
<li class="chapter" data-level="D" data-path="coding-convention.html"><a href="coding-convention.html"><i class="fa fa-check"></i><b>D</b> Coding/naming convention</a>
<ul>
<li class="chapter" data-level="D.1" data-path="coding-convention.html"><a href="coding-convention.html#commenting-your-code"><i class="fa fa-check"></i><b>D.1</b> Commenting your code</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="apdx-vba.html"><a href="apdx-vba.html"><i class="fa fa-check"></i><b>E</b> VBA specific topics</a>
<ul>
<li class="chapter" data-level="E.1" data-path="apdx-vba.html"><a href="apdx-vba.html#vba-debug"><i class="fa fa-check"></i><b>E.1</b> Debugging your code</a></li>
<li class="chapter" data-level="E.2" data-path="apdx-vba.html"><a href="apdx-vba.html#error-handling"><i class="fa fa-check"></i><b>E.2</b> Error handling</a></li>
<li class="chapter" data-level="E.3" data-path="apdx-vba.html"><a href="apdx-vba.html#vba-course-procedures"><i class="fa fa-check"></i><b>E.3</b> Course procedures</a>
<ul>
<li class="chapter" data-level="E.3.1" data-path="apdx-vba.html"><a href="apdx-vba.html#detailed-descriptions-of-course-procedures"><i class="fa fa-check"></i><b>E.3.1</b> Detailed descriptions of course procedures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="F" data-path="lg-course.html"><a href="lg-course.html"><i class="fa fa-check"></i><b>F</b> Learning goals</a></li>
<li class="chapter" data-level="G" data-path="ba.html"><a href="ba.html"><i class="fa fa-check"></i><b>G</b> Business Analytics</a></li>
<li class="chapter" data-level="H" data-path="colophon.html"><a href="colophon.html"><i class="fa fa-check"></i><b>H</b> Colophon</a></li>
<li class="divider"></li>
<li><center>
  <a rel="license" href="./index.html#ack">
    License: CC BY-NC-SA<br>
    <i class = "fab fa-creative-commons fa-2x"></i>
    <i class = "fab fa-creative-commons-by fa-2x"></i>
    <i class = "fab fa-creative-commons-nc fa-2x"></i>
    <i class = "fab fa-creative-commons-sa fa-2x"></i>
  </a>
</li></center>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tools for Analytics (TFA)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod-vba-loops-cond" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Module 3</span> Loops and conditional statements<a href="mod-vba-loops-cond.html#mod-vba-loops-cond" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module gives an introduction to loops and conditional statements. Loops are used to repeat code and conditional statements are used to redirect code execution based on the conditions. Both are basic building blocks in programming.</p>
<div>
A template with VBA code is given in the file
<a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-template.xlsm" target="_blank">vba-template.xlsm</a>
(open it and use it while reading the notes). Have a look inside the module
<i>TM3_ex</i>
in the VBA editor for examples used in the notes and during lectures. Have a look at module
<i>TM3_exercises</i>
for exercises. Guiding answers for the exercises can be found in the file
<a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-solution.xlsm" target="_blank">vba-solution.xlsm</a>
.
</div>
<div id="learning-path-diagram-2" class="section level4 unnumbered hasAnchor">
<h4>Learning path diagram<a href="mod-vba-loops-cond.html#learning-path-diagram-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Click/hover the nodes to follow links and see details.</p>
<div id="htmlwidget-35db0360e4ef193965c7" style="width:100%;height:220px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-35db0360e4ef193965c7">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"📖 Relational and\\nlogical operators\", URL = \"#vba-operators\", tooltip = \"\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"rect\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"0,3!\"] \n  \"2\" [label = \"💡 Loops\", URL = \"#vba-loops\", tooltip = \"Loops\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"2,3!\"] \n  \"3\" [label = \"💡 Conditional\\nstatements\", URL = \"#vba-cond\", tooltip = \"Conditional\\nstatements\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"4.5,3!\"] \n  \"4\" [label = \"💡 Example\\nFind Jen\", URL = \"#vba-ex-jen\", tooltip = \"Example using loops and conditinal statements\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"7,3!\"] \n  \"5\" [label = \"💡 Example\\nA distance matrix\", URL = \"#vba-ex-dist-mat\", tooltip = \"Example using loops and conditinal statements\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"10,3!\"] \n  \"6\" [label = \"💻 Exercises\", URL = \"#ex-vba-loops-cond\", tooltip = \"Exercises\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"13,3!\"] \n  \"7\" [label = \"🎬 Relational Operators\", URL = \"https://youtu.be/d1nmq2Huz44\", tooltip = \"Relational Operators\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"rect\", margin = \"0.2\", fillcolor = \"PeachPuff3\", pos = \"0,2!\"] \n  \"8\" [label = \"🎬 Logical Operators\", URL = \"https://youtu.be/IYy9LKyAaCs\", tooltip = \"Logical Operators\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"rect\", margin = \"0.2\", fillcolor = \"PeachPuff3\", pos = \"0,1!\"] \n  \"9\" [label = \"🎬 Do While loop\", URL = \"https://youtu.be/QZd8SPovofU\", tooltip = \"Do While loop\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"rect\", margin = \"0.2\", fillcolor = \"PeachPuff3\", pos = \"2,1!\"] \n  \"10\" [label = \"🎬 For Next loop\", URL = \"https://youtu.be/hfdjZlknAI8\", tooltip = \"For Next loop\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"rect\", margin = \"0.2\", fillcolor = \"PeachPuff3\", pos = \"2,2!\"] \n  \"11\" [label = \"🎬 IF statements\", URL = \"https://youtu.be/bsQbgoSf7Ig\", tooltip = \"IF statements\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"rect\", margin = \"0.2\", fillcolor = \"PeachPuff3\", pos = \"4.5,2!\"] \n\"1\"->\"2\" [color = \"black\", arrowhead = \"vee\"] \n\"1\"->\"7\" [color = \"black\", arrowhead = \"vee\"] \n\"2\"->\"3\" [color = \"black\", arrowhead = \"vee\"] \n\"2\"->\"10\" [color = \"black\", arrowhead = \"vee\"] \n\"3\"->\"4\" [color = \"black\", arrowhead = \"vee\"] \n\"3\"->\"11\" [color = \"black\", arrowhead = \"vee\"] \n\"4\"->\"5\" [color = \"black\", arrowhead = \"vee\"] \n\"5\"->\"6\" [color = \"black\", arrowhead = \"vee\"] \n\"7\"->\"8\" [color = \"black\", arrowhead = \"vee\"] \n\"10\"->\"9\" [color = \"black\", arrowhead = \"vee\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<p>If you like a different learning style there is a lot for videos about VBA online such as course <a href="https://www.youtube.com/playlist?list=PL3A6U40JUYCi4njVx59-vaUxYkG0yRO4m">14-Hour VBA Course</a>. The videos have been pointed out as online supplements in the learning path diagram. However, they are not necessary for the course. Since Excel change as new versions arrive and it work on different operating systems, the look in the screenshots and videos might be a bit different from your version. However, you still should be able to understand it.</p>
</div>
<div id="lo-vba-loops-cond" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Learning outcomes<a href="mod-vba-loops-cond.html#lo-vba-loops-cond" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By the end of this module, you are expected to be able to:</p>
<ul>
<li>Describe what a conditional statement is.</li>
<li>Test a condition built using relational/logical operators.</li>
<li>Declare a conditional statement.</li>
<li>Describe what a loop is.</li>
<li>Declare a loop.</li>
<li>Declare nested loops.</li>
<li>Exit a loop.</li>
</ul>
<p>The learning outcomes relate to the <a href="lg-course.html#lg-course">overall learning goals</a> number 1, 2, 4, 8, 9-12 and 16 of the course.</p>
<!-- SOLO increasing: identify · memorise · name · do simple procedure · collect data · -->
<!-- enumerate · describe · interpret · formulate · list · paraphrase · combine · do -->
<!-- algorithms · compare · contrast · explain causes · analyse · relate · derive · -->
<!-- evaluate · apply · argue · theorise · generalise · hypothesise · solve · reflect -->
</div>
<div id="vba-operators" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Relational and logical operators<a href="mod-vba-loops-cond.html#vba-operators" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Often you will need to compare a variable with another one. For this you need the <em>relational operators</em> given in Table <a href="mod-vba-loops-cond.html#tab:comp-ope">3.1</a> (also called comparison operators).</p>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;border-bottom: 0;">
<caption>
<span id="tab:comp-ope">Table 3.1: </span>Comparison/relational operators.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Operator
</th>
<th style="text-align:left;">
Description
</th>
<th style="text-align:left;">
Example
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
=
</td>
<td style="text-align:left;">
Equal to.
</td>
<td style="text-align:left;">
A = B ’ False
</td>
</tr>
<tr>
<td style="text-align:left;">
&lt;&gt;
</td>
<td style="text-align:left;">
Not equal to
</td>
<td style="text-align:left;">
A &lt;&gt; B ’ True
</td>
</tr>
<tr>
<td style="text-align:left;">
&gt;
</td>
<td style="text-align:left;">
Greater than.
</td>
<td style="text-align:left;">
A &gt; B ’ False
</td>
</tr>
<tr>
<td style="text-align:left;">
&lt;
</td>
<td style="text-align:left;">
Less than.
</td>
<td style="text-align:left;">
A &lt; B ’ True
</td>
</tr>
<tr>
<td style="text-align:left;">
&gt;=
</td>
<td style="text-align:left;">
Greater than or equal to.
</td>
<td style="text-align:left;">
A &gt;= B ’ False
</td>
</tr>
<tr>
<td style="text-align:left;">
&lt;=
</td>
<td style="text-align:left;">
Less than or equal to.
</td>
<td style="text-align:left;">
A &lt;= B ’ True
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> Assume that A = 2 and B=4.
</td>
</tr>
</tfoot>
</table>
<p>Let us consider an example (try to guess the output before running the procedure):</p>
<pre><code>&#39;&#39; Comparison of two variables
Sub TM3_Comparison()
   Dim intA As Integer
   Dim intB As Integer

   intA = 10
   intB = 20
   
   If intA = intB Then
      MsgBox (&quot;A = B is True&quot;)
   Else
      MsgBox (&quot;A = B is False&quot;)
   End If
   
   If intA &lt;&gt; intB Then
      MsgBox (&quot;A not equal B is True&quot;)
   Else
      MsgBox (&quot;A not equal B is False&quot;)
   End If

   If intA &gt; intB Then
      MsgBox (&quot;A greter then B is True&quot;)
   Else
      MsgBox (&quot;A greter then B is False&quot;)
   End If

   If intA &lt;= intB Then
      MsgBox (&quot;A less than or equal to B is True&quot;)
   Else
      MsgBox (&quot;A less than or equal to B is False&quot;)
   End If
End Sub</code></pre>
<p>Given two boolean expressions we use <em>logical operators</em> to compare them (see Table <a href="mod-vba-loops-cond.html#tab:logi-ope">3.2</a>)</p>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;border-bottom: 0;">
<caption>
<span id="tab:logi-ope">Table 3.2: </span>Logical operators.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Operator
</th>
<th style="text-align:left;">
Description
</th>
<th style="text-align:left;">
Example
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
AND
</td>
<td style="text-align:left;">
If both the conditions are True, then the expression is true.
</td>
<td style="text-align:left;">
A&lt;&gt;0 AND B&lt;&gt;0 ’ False
</td>
</tr>
<tr>
<td style="text-align:left;">
OR
</td>
<td style="text-align:left;">
If any of the two conditions are True, then the expression is true.
</td>
<td style="text-align:left;">
A&lt;&gt;0 OR B&lt;&gt;0 ’ True
</td>
</tr>
<tr>
<td style="text-align:left;">
NOT
</td>
<td style="text-align:left;">
Reverse logical: if the expression is true, then the NOT operator returns false.
</td>
<td style="text-align:left;">
NOT(A&lt;&gt;0 OR B&lt;&gt;0) ’ False
</td>
</tr>
<tr>
<td style="text-align:left;">
XOR
</td>
<td style="text-align:left;">
Logical Exclusion. If exactly one condition is True, the result is True.
</td>
<td style="text-align:left;">
A&lt;&gt;0 XOR B&lt;&gt;0 ’ True
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> Assume that A = 0 and B=4.
</td>
</tr>
</tfoot>
</table>
<p>Let us consider an example (try to guess the output before running the procedure):</p>
<pre><code>Sub TM3_Logical()
    If 5 &gt; 4 And 6 &gt; 2 Then
        MsgBox (&quot;5 &gt; 4 And 6 &gt; 2 is True&quot;)
    Else
        MsgBox (&quot;5 &gt; 4 And 6 &gt; 2 is False&quot;)
    End If
    
    If 1 &gt; 4 Or 1 &gt; 2 Then
        MsgBox (&quot;1 &gt; 4 Or 1 &gt; 2 is True&quot;)
    Else
        MsgBox (&quot;1 &gt; 4 Or 1 &gt; 2 is False&quot;)
    End If
    
    If 6 &gt; 4 Or 1 &gt; 2 Then
        MsgBox (&quot;6 &gt; 4 Or 1 &gt; 2 is True&quot;)
    Else
        MsgBox (&quot;6 &gt; 4 Or 1 &gt; 2 is False&quot;)
    End If
    
    If 5 &gt; 4 And Not 6 &gt; 2 Then
        MsgBox (&quot;5 &gt; 4 And Not 6 &gt; 2 is True&quot;)
    Else
        MsgBox (&quot;5 &gt; 4 And Not 6 &gt; 2 is False&quot;)
    End If
    
    &#39; If more than two boolean expressions remember parenthesis
    If (5 &gt; 4 Xor 6 &gt; 2) And 7 &gt; 10 Then   &#39; Xor (exactly one is true)
        MsgBox (&quot;(5 &gt; 4 Xor 6 &gt; 2) And 7 &gt; 10 is True&quot;)
    Else
        MsgBox (&quot;(5 &gt; 4 Xor 6 &gt; 2) And 7 &gt; 10 is False&quot;)
    End If
    
    If 5 &gt; 4 Xor (6 &gt; 2 And 7 &gt; 10) Then
        MsgBox (&quot;5 &gt; 4 Xor (6 &gt; 2 And 7 &gt; 10) is True&quot;)
    Else
        MsgBox (&quot;5 &gt; 4 Xor (6 &gt; 2 And 7 &gt; 10) is False&quot;)
    End If
End Sub</code></pre>
<p>Note parentheses have an impact on the result. Remember to use them correctly.</p>
</div>
<div id="vba-loops" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Loops<a href="mod-vba-loops-cond.html#vba-loops" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Loops are used to repeat pieces of code. There are many types of loops statements but here we will consider <code>For</code> and <code>While</code> loops. The structure of a <code>For</code> loop is:</p>
<pre><code>For i = 1 To 10 
    &lt;code&gt;
Next</code></pre>
<p>Here <code>i</code> is a counter used to repeat the code inside the loop 10 times. In general we do not use a suffix for counter variables (<code>i</code> should have been named <code>intI</code> according to our naming convention). An example on a simple for loop is:</p>
<pre><code>Sub TM3_Loop1()
    Dim i As Integer
    
    For i = 1 To 3
        MsgBox (i) &#39; What will the output be?
    Next
End Sub</code></pre>
<p>You can use the <code>Step</code> keyword to increment the counter by more than one:</p>
<pre><code>Sub TM3_Loop2()
    Dim i As Integer
    
    For i = 2 To 9 Step 2
        If i &lt;&gt; 4 Then
            MsgBox (i) &#39; What will the output be?
        End If
    Next
End Sub</code></pre>
<p>You can use <code>Exit For</code> to end a for loop prematurely (jump to the code after the loop):</p>
<pre><code>&#39;&#39; Write the row number in column A and exit after row 10 even though the loop runs to 20
Sub TM3_WriteNumbers1()
   Dim r As Integer
   
   Worksheets(&quot;TM3&quot;).Activate  &#39; activate the sheet we want to use
   For r = 6 To 20
      If r &gt; 10 Then
         Exit For
      End If
      Cells(r, 1) = r  &#39; write to row r, col 1 (A)
   Next
End Sub</code></pre>
<p>Loops may be nested inside each other. For instance if some action needs to be performed for each day and each employee or for each project and each work package of that project.</p>
<pre><code>Sub TM3_NestedLoops()
    Dim i As Integer
    Dim j As Integer
    
    For i = 1 To 2
        For j = 1 To 3
            MsgBox (&quot;(&quot; &amp; i &amp; &quot;,&quot; &amp; j &amp; &quot;)&quot;)
        Next
    Next
End Sub</code></pre>
<p>The structure of a <code>While</code> loop is:</p>
<pre><code>Do While &lt;condition true&gt;  
    &lt;code&gt;
Loop</code></pre>
<p>Here the loops runs until the condition is not true. While loops are useful when you do not know how many times to do the loop in advance. An example on a simple while loop is:</p>
<pre><code>&#39;&#39; Write the row number in column B and exit after row 10
Sub TM3_WriteNumbers2()
    Dim r As Integer
    
    Worksheets(&quot;TM3&quot;).Activate
    r = 6
    Do While r &lt; 11
        Cells(r, 2) = r &#39; write to row r, col 2 (B)
        r = r + 1
    Loop
End Sub</code></pre>
<p>You can use <code>Exit Do</code> to end a while loop prematurely (jump to the code after the loop):</p>
<pre><code>&#39;&#39; Write 2, 4, ... in column C and exit after 21 or if equals 12
Sub TM3_WriteNumbers3()
    Dim i As Integer, r As Integer
    
    Worksheets(&quot;TM3&quot;).Activate
    r = 6
    i = 2
    Do While i &lt; 21
        Cells(r, 3) = i &#39; write to row r, col 3 (C)
        If i = 12 Then
            Exit Do
        End If
        r = r + 1
        i = i + 2
    Loop
End Sub</code></pre>
<p>Beware of endless loops. If the stopping criteria is NOT reached when using a while loop, the computer will keep going:</p>
<pre><code>&#39; An endless loop. Do not run if you don&#39;t know how to stop
Sub TM3_EndlessLoop()
    Dim i As Integer
    While i &gt;= 0
        i = i + 1
    Wend
End Sub</code></pre>
<p>An endless loop can be hard to stop depending on the operating system you use. Therefore always “save” before you “run” the code. Make sure the stopping criterion will be reached. You may try to stop the program using a shortcut (<svg viewBox="0 0 448 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"> <path d="M0 93.7l183.6-25.3v177.4H0V93.7zm0 324.6l183.6 25.3V268.4H0v149.9zm203.8 28L448 480V268.4H203.8v177.9zm0-380.6v180.1H448V32L203.8 65.7z"></path></svg> try Ctrl + Break or Ctrl + Alt + Delete. <svg viewBox="0 0 384 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"> <path d="M318.7 268.7c-.2-36.7 16.4-64.4 50-84.8-18.8-26.9-47.2-41.7-84.7-44.6-35.5-2.8-74.3 20.7-88.5 20.7-15 0-49.4-19.7-76.4-19.7C63.3 141.2 4 184.8 4 273.5q0 39.3 14.4 81.2c12.8 36.7 59 126.7 107.2 125.2 25.2-.6 43-17.9 75.8-17.9 31.8 0 48.3 17.9 76.4 17.9 48.6-.7 90.4-82.5 102.6-119.3-65.2-30.7-61.7-90-61.7-91.9zm-56.6-164.2c27.3-32.4 24.8-61.9 24-72.5-24.1 1.4-52 16.4-67.9 34.9-17.5 19.8-27.8 44.3-25.6 71.9 26.1 2 49.9-11.4 69.5-34.3z"></path></svg> try ⌘., ⌃ + Esc or ⌘⌥ + Esc.)</p>
<p>Finally, the <code>For Each</code> loop has to be mentioned:</p>
<pre><code>Sub TM3_ForEach()
   Dim rngC As Range
   Dim i As Integer
   
   Worksheets(&quot;TM3&quot;).Activate
   i = 1
   For Each rngC In Range(&quot;D6:E9&quot;)
      rngC = i
      i = i + 1
   Next
End Sub</code></pre>
<p>The loop is used for running trough a set of objects (we will have a closer look at objects in Section <a href="mod-vba-datatypes.html#vba-objects">5.3</a>). Here <code>rngC</code> is used to run through all the cells in the range and set values. Note a range is scanned left-down.</p>
</div>
<div id="vba-cond" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Conditional statements<a href="mod-vba-loops-cond.html#vba-cond" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Conditional statements are used to redirect code execution based on the conditions. If the condition is met then the code is executed. The general layout of an if-then-else conditional statement is:</p>
<pre><code>If &lt;condition&gt; Then
 &lt;code&gt;
ElseIf &lt;condition&gt; Then
 &lt;code&gt;
ElseIf &lt;condition&gt; Then
 &lt;code&gt;
Else
 &lt;code&gt;
End If

If &lt;condition&gt; Then &lt;code&gt; Else &lt;code&gt;  &#39; single line form</code></pre>
<p>You can drop the <code>ElseIf</code> and <code>Else</code> code chunks. Other conditional statements exists but in general you can formulate them using an if-then-else statement. Let us try to use a conditional statement to separate persons in two groups:</p>
<pre><code>&#39;&#39; Seperate persons into two groups (names are written in 2 columns)
Sub TM3_SeparatePersons1()
    Dim r As Integer
    
    Worksheets(&quot;TM3_Separate1&quot;).Activate &#39; activate the correct sheet
    For r = 2 To 12 &#39; scan rows 2-12
        If Cells(r, 2) = &quot;Professor&quot; Then
            Cells(r, 3) = Cells(r, 1)  &#39; output in row C
        Else
            Cells(r, 4) = Cells(r, 1)  &#39; output in row D
        End If
    Next
End Sub</code></pre>
<p>We use variable <code>r</code> to store the row number we want to write to and then an if statement to separate professors from others. The output will be:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sep-2"></span>
<img src="img/sep-persons-1.png" alt="Separate into two groups." width="400px" />
<p class="caption">
Figure 3.1: Separate into two groups.
</p>
</div>
<p>If you want to separate both professors and associate professors from others, you may modify the if statement and use an <code>ElseIf</code>:</p>
<pre><code>&#39;&#39; Seperate persons into 3 groups (names are written in 3 columns)
Sub TM3_SeparatePersons2()
    Dim r As Integer
    
    Worksheets(&quot;TM3_Separate2&quot;).Activate &#39; activate the correct sheet
    For r = 2 To 12
        If Cells(r, 2) = &quot;Professor&quot; Then
            Cells(r, 3) = Cells(r, 1)
        ElseIf Cells(r, 2) = &quot;Associate Professor&quot; Then
            Cells(r, 4) = Cells(r, 1)
        Else
            Cells(r, 5) = Cells(r, 1)
        End If
    Next
End Sub</code></pre>
<p>Finally, let us try to separate into five groups:</p>
<pre><code>&#39;&#39; Seperate persons into 5 groups (names are written in 5 columns)
Sub TM3_SeparatePersons3()
    Dim r As Integer
    
    Worksheets(&quot;TM3_Separate3&quot;).Activate &#39; activate the correct sheet
    For r = 2 To 12
        If Cells(r, 2) = &quot;Professor&quot; Then
            Cells(r, 3) = Cells(r, 1)
        ElseIf Sheet1.Cells(r, 2) = &quot;Associate Professor&quot; Then
            Cells(r, 4) = Cells(r, 1)
        ElseIf Sheet1.Cells(r, 2) = &quot;Post Doc&quot; Then
            Cells(r, 5) = Cells(r, 1)
        ElseIf Sheet1.Cells(r, 2) = &quot;PhD student&quot; Then
            Cells(r, 6) = Cells(r, 1)
        Else
            Cells(r, 7) = Cells(r, 1)
        End If
    Next
End Sub</code></pre>
<p>Here the output will be:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sep-5"></span>
<img src="img/sep-persons-3.png" alt="Separate into five groups." width="600px" />
<p class="caption">
Figure 3.2: Separate into five groups.
</p>
</div>
</div>
<div id="vba-ex-jen" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Example - Find Jen<a href="mod-vba-loops-cond.html#vba-ex-jen" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider column A in Figure <a href="mod-vba-loops-cond.html#fig:sep-5">3.2</a>. Assume we want to check if Jen is in a name and output her position. We can use a for loop for this:</p>
<pre><code>&#39;&#39; Find cell with Jen using a For loop
Sub TM3_FindJen1()
    Dim r As Integer
    
    Worksheets(&quot;TM3_Separate1&quot;).Activate &#39; activate the correct sheet
    For r = 2 To 12
        If InStr(Cells(r, 1), &quot;Jen &quot;) &gt; 0 Then  &#39; InStr returns first char position at which match is found (0 if no match)
            MsgBox &quot;Jen is a &quot; &amp; Cells(r, 2) &amp; &quot; (Row &quot; &amp; r &amp; &quot;)&quot;
            Exit For   &#39; exit the loop
        End If
    Next
End Sub</code></pre>
<p>We scan all rows for Jen and return her position. If we found her, then we exit the for loop (no need to search further). What happens if we search for <code>"Jen"</code> and not <code>"Jen "</code>?</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:jen1"></span>
<img src="img/tm3-jen.png" alt="Search for Jen." width="300px" />
<p class="caption">
Figure 3.3: Search for Jen.
</p>
</div>
<p>The same can be done using a while loop:</p>
<pre><code>&#39;&#39; Find cell with Jen using a While loop
Sub TM3_FindJen2()
    Dim r As Integer
    
    r = 2
    Do While InStr(Cells(r, 1), &quot;Jen &quot;) = 0
        r = r + 1
    Loop
    MsgBox &quot;Jen is a &quot; &amp; Cells(r, 2) &amp; &quot; (Row &quot; &amp; r &amp; &quot;)&quot;
End Sub</code></pre>
<p>Beware of endless looping here. What happens if Jen is not present in column A? A more error safe while loop is:</p>
<pre><code>&#39;&#39; Find cell with Jen using a While loop and better stopping criteria
Sub TM3_FindJen3()
    Dim r As Integer
    
    r = 2
    Do While InStr(Cells(r, 1), &quot;Jen &quot;) = 0 And r &lt; 13
        r = r + 1
    Loop
    If (r = 13) Then
        MsgBox (&quot;Jen not found&quot;)
    Else
        MsgBox &quot;Jen is a &quot; &amp; Cells(r, 2) &amp; &quot; (Cell A&quot; &amp; r &amp; &quot;)&quot;
    End If
End Sub</code></pre>
</div>
<div id="vba-ex-dist-mat" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Example - A distance matrix<a href="mod-vba-loops-cond.html#vba-ex-dist-mat" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Assume that you have a set of <span class="math inline">\(n=10\)</span> locations:</p>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-20">Table 3.3: </span>A set of locations
</caption>
<thead>
<tr>
<th style="text-align:center;">
Location number
</th>
<th style="text-align:center;">
<span class="math inline">\(x\)</span>-coordinate
</th>
<th style="text-align:center;">
<span class="math inline">\(y\)</span>-coordinate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
3
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
4
</td>
</tr>
<tr>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
6
</td>
</tr>
<tr>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
7
</td>
</tr>
<tr>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
</tr>
<tr>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
5
</td>
</tr>
</tbody>
</table>
<p>The euclidean distance <span class="math inline">\(d\)</span> between location <span class="math inline">\(l_1 = (x_1, y_1)\)</span> and <span class="math inline">\(l_2 = (x_2, y_2)\)</span> are: <span class="math display">\[d(1,2)=\sqrt{(x_1-x_2)^2 + (y_1-y_2)^2}.\]</span> In VBA the function becomes:</p>
<pre><code>&#39;&#39; Calculate distance between two points
&#39;
&#39; @param x1 x-coordinate of first point.
&#39; @param y1 y-coordinate of first point.
&#39; @param x2 x-coordinate of second point.
&#39; @param y2 y-coordinate of second point.
Function TM3_Distance(x1 As Double, y1 As Double, x2 As Double, y2 As Double) As Double
    Dim x As Double
    Dim y As Double
    
    x = x1 - x2
    y = y1 - y2
    TM3_Distance = Sqr((x * x) + (y * y))
End Function</code></pre>
<p>Assume that you want to calculate the <em>distance matrix</em> <span class="math inline">\(D\)</span> where entry <span class="math inline">\((i,j)\)</span> contains the distance between location <span class="math inline">\(i\)</span> and location <span class="math inline">\(j\)</span>.</p>
<p>Consider the locations in columns B and C:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dist-mat"></span>
<img src="img/dist-mat.png" alt="Distance matrix worksheet." width="100%" />
<p class="caption">
Figure 3.4: Distance matrix worksheet.
</p>
</div>
<p>We want to fill out the cells F1:P11 with the distances. This have been done using procedure:</p>
<pre><code>&#39;&#39; Create a distance matrix starting in column 6
&#39;
&#39; @pre Assume that coordinates are stored in column B and C starting from row 2
&#39;      and that number of points are stored in E1.
Public Sub TM3_MakeDistanceMatrix()
    Dim n As Integer
    Dim i As Integer
    Dim j As Integer
      
    n = Range(&quot;E1&quot;)
    For i = 1 To n  &#39; add row and column headers
        Cells(i + 1, 6) = Cells(1 + i, 1) &#39; row equals i+1
        Cells(1, 6 + i) = Cells(1 + i, 1) &#39; column equals i+6
    Next
    
    &#39; add distances
    For i = 1 To n
        For j = 1 To n
           Cells(i + 1, j + 6) = TM3_Distance(Cells(i + 1, 2), Cells(i + 1, 3), Cells(j + 1, 2), Cells(j + 1, 3))
        Next
    Next
End Sub</code></pre>
<p>First, row and column headers are written to the cells. Next, we use a nested for loop to calculate the distances and output them to the cells. Note we in fact calculate the same distance two times (the distance from <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> equals the distance from <span class="math inline">\(j\)</span> to <span class="math inline">\(i\)</span>). Since we have symmetric distances there is no need to do this and it can be avoided by letting the inner loop in the nested loops be dependent on the outer loop:</p>
<pre><code>&#39;&#39; Create a symetric distance matrix with only the upper right part filled starting in column 6.
&#39;
&#39; @pre Assume that coordinates are stored in column B and C starting from row 2
&#39;      and that number of points are stored in E1.
Public Sub TM3_MakeSymetricDistanceMatrix()
    Dim n As Integer
    Dim i As Integer
    Dim j As Integer
      
    n = Range(&quot;E1&quot;)
    For i = 1 To n
        Cells(i + 1, 6) = Cells(1 + i, 1)
        Cells(1, 6 + i) = Cells(1 + i, 1)
    Next
    
    For i = 1 To n
        For j = i + 1 To n
           Cells(i + 1, j + 6) = TM3_Distance(Cells(i + 1, 2), Cells(i + 1, 3), Cells(j + 1, 2), Cells(j + 1, 3))
        Next
    Next
End Sub</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dist-mat-sym"></span>
<img src="img/dist-mat-sym.png" alt="Distance matrix worksheet with symmetric distances." width="100%" />
<p class="caption">
Figure 3.5: Distance matrix worksheet with symmetric distances.
</p>
</div>
</div>
<div id="recap" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Recap<a href="mod-vba-loops-cond.html#recap" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Loops are used to repeat pieces of code.</p></li>
<li><p>For loops (repeat a number of times):</p>
<pre><code>For i = 1 To 10 
    &lt;code&gt;
Next</code></pre></li>
<li><p>While loops (repeat until a condition is met):</p>
<pre><code>Do While &lt;condition&gt; &#39; repeat while true     
    &lt;code&gt;
Loop</code></pre></li>
<li><p>Use <code>Exit for</code> and <code>Exit Do</code> to break a <code>For</code> and a <code>Do While</code> loop before it ends (jump to the code after the loop).</p></li>
<li><p>Loops may be nested inside each other:</p>
<pre><code>For i = 1 To 2     
  For j = 1 To 3  
      MsgBox (&quot;(&quot; &amp; i &amp; &quot;,&quot; &amp; j &amp; &quot;)&quot;)
  Next
Next</code></pre></li>
<li><p>Conditional Statements are used to make decisions based on the conditions. If the condition is met then the code is executed.</p></li>
<li><p>An if-then-else statement:</p>
<pre><code>If &lt;condition&gt; Then
 &lt;code&gt;
ElseIf &lt;condition&gt; Then
 &lt;code&gt;
Else
 &lt;code&gt;
End If</code></pre>
<p>You may drop the <code>ElseIf</code> and <code>Else</code> code chunks.</p></li>
</ul>
<div>
You may also have a look at the
<a href="https://bss-osca.github.io/tfa/slides/03_vba-loops-cond-slides.html" target="_blank">slides for this module</a>
.
</div>
</div>
<div id="ex-vba-loops-cond" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> Exercises<a href="mod-vba-loops-cond.html#ex-vba-loops-cond" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Below you will find a set of exercises. Always have a look at the exercises before you meet in your study group and try to solve them yourself. Are you stuck, see the <a href="help.html#help">help page</a>. Some of the solutions to each exercise can be seen by pressing the button at each question. Beware, you will not learn by giving up too early. Put some effort into finding a solution!</p>
<div>
A template with VBA code is given in the file
<a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-template.xlsm" target="_blank">vba-template.xlsm</a>
(open it and use it while reading the notes). Have a look inside the module
<i>TM3_ex</i>
in the VBA editor for examples used in the notes and during lectures. Have a look at module
<i>TM3_exercises</i>
for exercises. Guiding answers for the exercises can be found in the file
<a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-solution.xlsm" target="_blank">vba-solution.xlsm</a>
.
</div>
<div id="ex-vba-loops" class="section level3 hasAnchor" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Exercise - Loops<a href="mod-vba-loops-cond.html#ex-vba-loops" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the sheet <em>TM3</em> for output.</p>
<ol style="list-style-type: decimal">
<li>Create a for loop that writes numbers 1 to 4 in rows 25 to 28 in column A.<br />
</li>
<li>Create a do while loop that writes numbers 1 to 4 in rows 25 to 28 in column B.</li>
<li>Create a loop that writes numbers 1 to 4 in rows 27 to 30 in column C.</li>
<li>Create a loop that writes numbers -1 to -4 in rows 25 to 28 in column D.</li>
<li>Create a loop that writes numbers 1 to 4 in rows 28 to 31 in column E, except if the number is 3 then the output should to a string <code>missing</code>.</li>
<li>Create a do while loop that writes numbers i = 1, 2, … in column F (starting in row 25) until i/5 + 3 = 8. Hint: you may use a <code>Exit Do</code> to quit the loop.</li>
<li>Create a sub that runs all the loops.</li>
</ol>
</div>
<div id="ex-vba-cond" class="section level3 hasAnchor" number="3.8.2">
<h3><span class="header-section-number">3.8.2</span> Exercise - Conditional statements<a href="mod-vba-loops-cond.html#ex-vba-cond" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider worksheet <em>TM3_Numbers</em>, which contains a set of numbers.</p>
<ol style="list-style-type: decimal">
<li>Create a procedure with the following features
<ul>
<li>Make a copy of the numbers with the upper left cell starting in G1.</li>
<li>Scan all the numbers and remove (clear the cell) all the negative numbers (you may use a <code>For Each</code> loop).</li>
<li>Highlight all the numbers above 20 (using e.g. <code>rngC.Interior.ColorIndex = 37</code>).</li>
<li>Add a button to worksheet <em>TM3_Numbers</em> that run the procedure.</li>
</ul></li>
<li>Create a procedure with the following features:
<ul>
<li>Scan the numbers and find
<ul>
<li>the sum of all non-negative numbers,</li>
<li>the mean of all negative numbers.</li>
</ul></li>
<li>Use a message box to display the sum and mean calculated.</li>
<li>Add a button to worksheet <em>TM3_Numbers</em> that run the procedure.</li>
</ul></li>
</ol>
<p><em>This exercise is a slightly modified version an exam assignment (reexam 2022-A5).</em></p>
<script src="//unpkg.com/@highlightjs/cdn-assets@11.5.1/highlight.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/highlightjs-vba/dist/vba.min.js"></script>
<!-- <script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script> -->
<script type="text/javascript">
  hljs.initHighlightingOnLoad();
  // hljs.initLineNumbersOnLoad({singleLine: true}); 
</script>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mod-vba-intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mod-vba-procedures.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/bss-osca/tfa/edit/master/book/03_vba-loops-cond.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
