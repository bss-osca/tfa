<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 15 Fitting probability distributions | Tools for Analytics (TFA)</title>
  <meta name="description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 15 Fitting probability distributions | Tools for Analytics (TFA)" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bss-osca.github.io/tfa//assets/logo.png" />
  <meta property="og:description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="github-repo" content="bss-osca/tfa" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 15 Fitting probability distributions | Tools for Analytics (TFA)" />
  
  <meta name="twitter:description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="twitter:image" content="https://bss-osca.github.io/tfa//assets/logo.png" />

<meta name="author" content="Lars Relund Nielsen" />


<meta name="date" content="2023-12-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon" />
<link rel="prev" href="mod-r-plot.html"/>
<link rel="next" href="mod-r-maps.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.10/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
<link href="libs/minichart-0.2.2/minicharts.css" rel="stylesheet" />
<script src="libs/minichart-0.2.2/leaflet.minicharts.min.js"></script>
<link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" />
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.28/datatables.js"></script>
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<html>
<head>
<script>
  $(document).ready(function() {

  // Section anchors
  $('.section h1, .section h2, .section h3, .section h4, .section h5').each(function() {
    anchor = '#' + $(this).parent().attr('id');
    $(this).addClass("hasAnchor").prepend('<a href="' + anchor + '" class="anchor"></a>');
  });
});
</script>
<script src="https://hypothes.is/embed.js" async></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</head>
</html>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="img/logo.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to the course</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#lo-intro"><i class="fa fa-check"></i><b>1.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.2</b> Purpose for the course</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#r-vs-vba"><i class="fa fa-check"></i><b>1.3</b> R vs Excel/VBA</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#computer"><i class="fa fa-check"></i><b>1.4</b> How a computer works</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i><b>1.5</b> How the notes are organized</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#ack"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#ex-intro"><i class="fa fa-check"></i><b>1.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#ex-annotate"><i class="fa fa-check"></i><b>1.7.1</b> Exercise - How to annotate</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I VBA</b></span></li>
<li class="chapter" data-level="2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html"><i class="fa fa-check"></i><b>2</b> An introduction to VBA</a>
<ul>
<li class="chapter" data-level="2.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#lo-vba-intro"><i class="fa fa-check"></i><b>2.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-what"><i class="fa fa-check"></i><b>2.2</b> What is VBA</a></li>
<li class="chapter" data-level="2.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-setup"><i class="fa fa-check"></i><b>2.3</b> Setup Excel for VBA</a></li>
<li class="chapter" data-level="2.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-hello"><i class="fa fa-check"></i><b>2.4</b> Your first program</a></li>
<li class="chapter" data-level="2.5" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-macro"><i class="fa fa-check"></i><b>2.5</b> The macro recorder</a></li>
<li class="chapter" data-level="2.6" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-overview"><i class="fa fa-check"></i><b>2.6</b> VBA - A short overview</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#variables"><i class="fa fa-check"></i><b>2.6.1</b> Variables</a></li>
<li class="chapter" data-level="2.6.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#procedures"><i class="fa fa-check"></i><b>2.6.2</b> Procedures</a></li>
<li class="chapter" data-level="2.6.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#input-and-output"><i class="fa fa-check"></i><b>2.6.3</b> Input and output</a></li>
<li class="chapter" data-level="2.6.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#conditional-statements"><i class="fa fa-check"></i><b>2.6.4</b> Conditional statements</a></li>
<li class="chapter" data-level="2.6.5" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#loops"><i class="fa fa-check"></i><b>2.6.5</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-coding-practice"><i class="fa fa-check"></i><b>2.7</b> Good coding pratice</a></li>
<li class="chapter" data-level="2.8" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#rc-vba-intro"><i class="fa fa-check"></i><b>2.8</b> Recap</a></li>
<li class="chapter" data-level="2.9" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-intro"><i class="fa fa-check"></i><b>2.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-hello"><i class="fa fa-check"></i><b>2.9.1</b> Exercise - Hello</a></li>
<li class="chapter" data-level="2.9.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-macro"><i class="fa fa-check"></i><b>2.9.2</b> Exercise - Record a macro</a></li>
<li class="chapter" data-level="2.9.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-user-input"><i class="fa fa-check"></i><b>2.9.3</b> Exercise - User input</a></li>
<li class="chapter" data-level="2.9.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-max-min"><i class="fa fa-check"></i><b>2.9.4</b> Exercise - Max and min number</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html"><i class="fa fa-check"></i><b>3</b> Loops and conditional statements</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#lo-vba-loops-cond"><i class="fa fa-check"></i><b>3.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.2" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-operators"><i class="fa fa-check"></i><b>3.2</b> Relational and logical operators</a></li>
<li class="chapter" data-level="3.3" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-loops"><i class="fa fa-check"></i><b>3.3</b> Loops</a></li>
<li class="chapter" data-level="3.4" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-cond"><i class="fa fa-check"></i><b>3.4</b> Conditional statements</a></li>
<li class="chapter" data-level="3.5" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-ex-jen"><i class="fa fa-check"></i><b>3.5</b> Example - Find Jen</a></li>
<li class="chapter" data-level="3.6" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-ex-dist-mat"><i class="fa fa-check"></i><b>3.6</b> Example - A distance matrix</a></li>
<li class="chapter" data-level="3.7" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#recap"><i class="fa fa-check"></i><b>3.7</b> Recap</a></li>
<li class="chapter" data-level="3.8" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-loops-cond"><i class="fa fa-check"></i><b>3.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-loops"><i class="fa fa-check"></i><b>3.8.1</b> Exercise - Loops</a></li>
<li class="chapter" data-level="3.8.2" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-cond"><i class="fa fa-check"></i><b>3.8.2</b> Exercise - Conditional statements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html"><i class="fa fa-check"></i><b>4</b> Procedures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#lo-vba-procedures"><i class="fa fa-check"></i><b>4.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="4.2" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-subs-functions"><i class="fa fa-check"></i><b>4.2</b> Subs and functions - The basics</a></li>
<li class="chapter" data-level="4.3" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-optional-arg"><i class="fa fa-check"></i><b>4.3</b> Optional arguments</a></li>
<li class="chapter" data-level="4.4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-pub-priv"><i class="fa fa-check"></i><b>4.4</b> Public and private procedures</a></li>
<li class="chapter" data-level="4.5" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-byref"><i class="fa fa-check"></i><b>4.5</b> Passing arguments by reference or by value</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#return-values-from-a-sub"><i class="fa fa-check"></i><b>4.5.1</b> Return values from a sub</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-built-in"><i class="fa fa-check"></i><b>4.6</b> Built-in functions</a></li>
<li class="chapter" data-level="4.7" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-test-persons"><i class="fa fa-check"></i><b>4.7</b> Example - Selection of test persons</a></li>
<li class="chapter" data-level="4.8" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#recap-1"><i class="fa fa-check"></i><b>4.8</b> Recap</a></li>
<li class="chapter" data-level="4.9" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-procedures"><i class="fa fa-check"></i><b>4.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-subs"><i class="fa fa-check"></i><b>4.9.1</b> Exercise - Subs</a></li>
<li class="chapter" data-level="4.9.2" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#exercise---temperatures"><i class="fa fa-check"></i><b>4.9.2</b> Exercise - Temperatures</a></li>
<li class="chapter" data-level="4.9.3" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-functions"><i class="fa fa-check"></i><b>4.9.3</b> Exercise - Functions</a></li>
<li class="chapter" data-level="4.9.4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-worksheet-functions"><i class="fa fa-check"></i><b>4.9.4</b> Exercise - Worksheet functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html"><i class="fa fa-check"></i><b>5</b> Advanced data types and usage</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#lo-vba-datatypes"><i class="fa fa-check"></i><b>5.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="5.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-strings"><i class="fa fa-check"></i><b>5.2</b> Strings</a></li>
<li class="chapter" data-level="5.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-objects"><i class="fa fa-check"></i><b>5.3</b> Objects</a></li>
<li class="chapter" data-level="5.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-wst"><i class="fa fa-check"></i><b>5.4</b> The Worksheet object</a></li>
<li class="chapter" data-level="5.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#wst-rng"><i class="fa fa-check"></i><b>5.5</b> The Range object</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#named-ranges-in-excel"><i class="fa fa-check"></i><b>5.5.1</b> Named ranges in Excel</a></li>
<li class="chapter" data-level="5.5.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#current-region-of-a-range"><i class="fa fa-check"></i><b>5.5.2</b> Current region of a range</a></li>
<li class="chapter" data-level="5.5.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#input-and-output-1"><i class="fa fa-check"></i><b>5.5.3</b> Input and output</a></li>
<li class="chapter" data-level="5.5.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#sorting-a-range"><i class="fa fa-check"></i><b>5.5.4</b> Sorting a range</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-ary"><i class="fa fa-check"></i><b>5.6</b> Arrays</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#multi-dimensional-arrays"><i class="fa fa-check"></i><b>5.6.1</b> Multi-dimensional arrays</a></li>
<li class="chapter" data-level="5.6.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#dynamic-arrays"><i class="fa fa-check"></i><b>5.6.2</b> Dynamic arrays</a></li>
<li class="chapter" data-level="5.6.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#input-and-output-2"><i class="fa fa-check"></i><b>5.6.3</b> Input and output</a></li>
<li class="chapter" data-level="5.6.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#sorting-arrays"><i class="fa fa-check"></i><b>5.6.4</b> Sorting arrays</a></li>
<li class="chapter" data-level="5.6.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#use-arrays-instead-of-ranges"><i class="fa fa-check"></i><b>5.6.5</b> Use arrays instead of ranges</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-coll"><i class="fa fa-check"></i><b>5.7</b> Collections</a></li>
<li class="chapter" data-level="5.8" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-ex-job-seq"><i class="fa fa-check"></i><b>5.8</b> Example - Job sequencing</a></li>
<li class="chapter" data-level="5.9" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#recap-2"><i class="fa fa-check"></i><b>5.9</b> Recap</a></li>
<li class="chapter" data-level="5.10" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-datatypes"><i class="fa fa-check"></i><b>5.10</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-equal"><i class="fa fa-check"></i><b>5.10.1</b> Exercise - Equal entries</a></li>
<li class="chapter" data-level="5.10.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-products"><i class="fa fa-check"></i><b>5.10.2</b> Exercise - Product search</a></li>
<li class="chapter" data-level="5.10.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-read-collections"><i class="fa fa-check"></i><b>5.10.3</b> Exercise - Read collections</a></li>
<li class="chapter" data-level="5.10.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-read-arrays"><i class="fa fa-check"></i><b>5.10.4</b> Exercise - Read arrays</a></li>
<li class="chapter" data-level="5.10.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-process"><i class="fa fa-check"></i><b>5.10.5</b> Exercise - Process numbers</a></li>
<li class="chapter" data-level="5.10.6" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-pay"><i class="fa fa-check"></i><b>5.10.6</b> Exercise - Search payments</a></li>
<li class="chapter" data-level="5.10.7" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-flight"><i class="fa fa-check"></i><b>5.10.7</b> Exercise - Flight search</a></li>
<li class="chapter" data-level="5.10.8" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-table"><i class="fa fa-check"></i><b>5.10.8</b> Exercise - Search table</a></li>
<li class="chapter" data-level="5.10.9" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-next-task"><i class="fa fa-check"></i><b>5.10.9</b> Exercise - Find next task</a></li>
<li class="chapter" data-level="5.10.10" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-seat-reservation"><i class="fa fa-check"></i><b>5.10.10</b> Exercise - Seat reservation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html"><i class="fa fa-check"></i><b>6</b> Generating random numbers</a>
<ul>
<li class="chapter" data-level="6.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#lo-vba-random-numbers"><i class="fa fa-check"></i><b>6.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="6.2" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#vba-random-numbers"><i class="fa fa-check"></i><b>6.2</b> Generating random numbers</a></li>
<li class="chapter" data-level="6.3" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#vba-simulation"><i class="fa fa-check"></i><b>6.3</b> Simulation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#sec-vba-tsp"><i class="fa fa-check"></i><b>6.3.1</b> Example - Traveling salesman problem</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#recap-3"><i class="fa fa-check"></i><b>6.4</b> Recap</a></li>
<li class="chapter" data-level="6.5" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-random-numbers"><i class="fa fa-check"></i><b>6.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-random-int"><i class="fa fa-check"></i><b>6.5.1</b> Exercise - Two random integers</a></li>
<li class="chapter" data-level="6.5.2" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-swap"><i class="fa fa-check"></i><b>6.5.2</b> Exercise - Swap entries</a></li>
<li class="chapter" data-level="6.5.3" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-bakery"><i class="fa fa-check"></i><b>6.5.3</b> Exercise - Dan’s bakery</a></li>
<li class="chapter" data-level="6.5.4" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-generate"><i class="fa fa-check"></i><b>6.5.4</b> Exercise - Generating random numbers</a></li>
<li class="chapter" data-level="6.5.5" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-stoc-functions"><i class="fa fa-check"></i><b>6.5.5</b> Exercise - Stochastic functions</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II R</b></span></li>
<li class="chapter" data-level="7" data-path="mod-r-install.html"><a href="mod-r-install.html"><i class="fa fa-check"></i><b>7</b> Setting up R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mod-r-install.html"><a href="mod-r-install.html#lo-r-install"><i class="fa fa-check"></i><b>7.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="7.2" data-path="mod-r-install.html"><a href="mod-r-install.html#r-install"><i class="fa fa-check"></i><b>7.2</b> Install R and RStudio</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="mod-r-install.html"><a href="mod-r-install.html#test-your-installation"><i class="fa fa-check"></i><b>7.2.1</b> Test your installation</a></li>
<li class="chapter" data-level="7.2.2" data-path="mod-r-install.html"><a href="mod-r-install.html#add-on-packages"><i class="fa fa-check"></i><b>7.2.2</b> Add-on packages</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="mod-r-install.html"><a href="mod-r-install.html#r-cloud"><i class="fa fa-check"></i><b>7.3</b> Setup and test Posit Cloud</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html"><i class="fa fa-check"></i><b>8</b> R basics and workflows</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#lo-r-workflow"><i class="fa fa-check"></i><b>8.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="8.2" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#working-with-r-at-the-command-line-in-rstudio"><i class="fa fa-check"></i><b>8.2</b> Working with R at the command line in RStudio</a></li>
<li class="chapter" data-level="8.3" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#your-first-datacamp-course"><i class="fa fa-check"></i><b>8.3</b> Your first DataCamp course</a></li>
<li class="chapter" data-level="8.4" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#pipes"><i class="fa fa-check"></i><b>8.4</b> Pipes</a></li>
<li class="chapter" data-level="8.5" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#rprojs"><i class="fa fa-check"></i><b>8.5</b> RStudio projects</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#storing-your-code-in-a-script-file"><i class="fa fa-check"></i><b>8.5.1</b> Storing your code in a script file</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#rc-r-workflow"><i class="fa fa-check"></i><b>8.6</b> Recap</a></li>
<li class="chapter" data-level="8.7" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#ex-r-workflow"><i class="fa fa-check"></i><b>8.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-group-work"><i class="fa fa-check"></i><b>8.7.1</b> Exercise (group work)</a></li>
<li class="chapter" data-level="8.7.2" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-piping"><i class="fa fa-check"></i><b>8.7.2</b> Exercise (piping)</a></li>
<li class="chapter" data-level="8.7.3" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-working-dir"><i class="fa fa-check"></i><b>8.7.3</b> Exercise (working dir)</a></li>
<li class="chapter" data-level="8.7.4" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-vectors"><i class="fa fa-check"></i><b>8.7.4</b> Exercise (vectors)</a></li>
<li class="chapter" data-level="8.7.5" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-matrices"><i class="fa fa-check"></i><b>8.7.5</b> Exercise (matrices)</a></li>
<li class="chapter" data-level="8.7.6" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-data-frames"><i class="fa fa-check"></i><b>8.7.6</b> Exercise (data frames)</a></li>
<li class="chapter" data-level="8.7.7" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-lists"><i class="fa fa-check"></i><b>8.7.7</b> Exercise (lists)</a></li>
<li class="chapter" data-level="8.7.8" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#ex-strings"><i class="fa fa-check"></i><b>8.7.8</b> Exercise (string management)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html"><i class="fa fa-check"></i><b>9</b> Loops and conditionals</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#lo-loops"><i class="fa fa-check"></i><b>9.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="9.2" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#r-dc-loops-cond"><i class="fa fa-check"></i><b>9.2</b> Conditionals and control flow</a></li>
<li class="chapter" data-level="9.3" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#r-loops"><i class="fa fa-check"></i><b>9.3</b> Loops</a></li>
<li class="chapter" data-level="9.4" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#rc-r-loops-cond"><i class="fa fa-check"></i><b>9.4</b> Recap</a></li>
<li class="chapter" data-level="9.5" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-loops-cond"><i class="fa fa-check"></i><b>9.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-conditional-expressions"><i class="fa fa-check"></i><b>9.5.1</b> Exercise (conditional expressions)</a></li>
<li class="chapter" data-level="9.5.2" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-loops"><i class="fa fa-check"></i><b>9.5.2</b> Exercise (loops)</a></li>
<li class="chapter" data-level="9.5.3" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-search-vector"><i class="fa fa-check"></i><b>9.5.3</b> Exercise (search vector)</a></li>
<li class="chapter" data-level="9.5.4" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-dist"><i class="fa fa-check"></i><b>9.5.4</b> Exercise (calculating distances)</a></li>
<li class="chapter" data-level="9.5.5" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-expand"><i class="fa fa-check"></i><b>9.5.5</b> Exercise (expand_grid)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mod-r-functions.html"><a href="mod-r-functions.html"><i class="fa fa-check"></i><b>10</b> Functions</a>
<ul>
<li class="chapter" data-level="10.1" data-path="mod-r-functions.html"><a href="mod-r-functions.html#lo-r-functions"><i class="fa fa-check"></i><b>10.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="10.2" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-dc-functions"><i class="fa fa-check"></i><b>10.2</b> DataCamp course</a></li>
<li class="chapter" data-level="10.3" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-extra"><i class="fa fa-check"></i><b>10.3</b> Functions returning multiple objects</a></li>
<li class="chapter" data-level="10.4" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-arg"><i class="fa fa-check"></i><b>10.4</b> The <code>...</code> argument</a></li>
<li class="chapter" data-level="10.5" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-doc"><i class="fa fa-check"></i><b>10.5</b> Documenting your functions</a></li>
<li class="chapter" data-level="10.6" data-path="mod-r-functions.html"><a href="mod-r-functions.html#example---job-sequencing"><i class="fa fa-check"></i><b>10.6</b> Example - Job sequencing</a></li>
<li class="chapter" data-level="10.7" data-path="mod-r-functions.html"><a href="mod-r-functions.html#rc-functions"><i class="fa fa-check"></i><b>10.7</b> Recap</a></li>
<li class="chapter" data-level="10.8" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-functions"><i class="fa fa-check"></i><b>10.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-def-func"><i class="fa fa-check"></i><b>10.8.1</b> Exercise (defining functions)</a></li>
<li class="chapter" data-level="10.8.2" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-euclidean-distances"><i class="fa fa-check"></i><b>10.8.2</b> Exercise (euclidean distances)</a></li>
<li class="chapter" data-level="10.8.3" data-path="mod-r-functions.html"><a href="mod-r-functions.html#exercise-scope"><i class="fa fa-check"></i><b>10.8.3</b> Exercise (scope)</a></li>
<li class="chapter" data-level="10.8.4" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-time-conversion"><i class="fa fa-check"></i><b>10.8.4</b> Exercise (time conversion)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html"><i class="fa fa-check"></i><b>11</b> Introduction to tidyverse and RMarkdown</a>
<ul>
<li class="chapter" data-level="11.1" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#lo-tidyverse-intro"><i class="fa fa-check"></i><b>11.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="11.2" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-tidyverse-intro"><i class="fa fa-check"></i><b>11.2</b> The tidyverse package</a></li>
<li class="chapter" data-level="11.3" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-markdown-intro"><i class="fa fa-check"></i><b>11.3</b> Writing reproducible reports</a></li>
<li class="chapter" data-level="11.4" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-tibbles-intro"><i class="fa fa-check"></i><b>11.4</b> Tibbles</a></li>
<li class="chapter" data-level="11.5" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#rc-tidyverse-intro"><i class="fa fa-check"></i><b>11.5</b> Recap</a></li>
<li class="chapter" data-level="11.6" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#ex-tidyverse-intro"><i class="fa fa-check"></i><b>11.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#exercise-your-first-rmarkdown-exercise"><i class="fa fa-check"></i><b>11.6.1</b> Exercise (your first RMarkdown exercise)</a></li>
<li class="chapter" data-level="11.6.2" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#exercise-tibbles"><i class="fa fa-check"></i><b>11.6.2</b> Exercise (tibbles)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mod-r-io.html"><a href="mod-r-io.html"><i class="fa fa-check"></i><b>12</b> Importing and exporting data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="mod-r-io.html"><a href="mod-r-io.html#lo-r-io"><i class="fa fa-check"></i><b>12.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="12.2" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-csv"><i class="fa fa-check"></i><b>12.2</b> CSV files</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="mod-r-io.html"><a href="mod-r-io.html#reading-a-csv-file"><i class="fa fa-check"></i><b>12.2.1</b> Reading a CSV file</a></li>
<li class="chapter" data-level="12.2.2" data-path="mod-r-io.html"><a href="mod-r-io.html#writing-to-csv-files"><i class="fa fa-check"></i><b>12.2.2</b> Writing to CSV files</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-excel"><i class="fa fa-check"></i><b>12.3</b> Excel</a></li>
<li class="chapter" data-level="12.4" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-google"><i class="fa fa-check"></i><b>12.4</b> Google Sheets</a></li>
<li class="chapter" data-level="12.5" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-text"><i class="fa fa-check"></i><b>12.5</b> Text files</a></li>
<li class="chapter" data-level="12.6" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-r"><i class="fa fa-check"></i><b>12.6</b> R’s native binary format</a></li>
<li class="chapter" data-level="12.7" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-json"><i class="fa fa-check"></i><b>12.7</b> Json</a></li>
<li class="chapter" data-level="12.8" data-path="mod-r-io.html"><a href="mod-r-io.html#rc-r-io"><i class="fa fa-check"></i><b>12.8</b> Recap</a></li>
<li class="chapter" data-level="12.9" data-path="mod-r-io.html"><a href="mod-r-io.html#ex-r-io"><i class="fa fa-check"></i><b>12.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="mod-r-io.html"><a href="mod-r-io.html#exercise-statistikbanken"><i class="fa fa-check"></i><b>12.9.1</b> Exercise (Statistikbanken)</a></li>
<li class="chapter" data-level="12.9.2" data-path="mod-r-io.html"><a href="mod-r-io.html#exercise-tuples-in-opl"><i class="fa fa-check"></i><b>12.9.2</b> Exercise (tuples in OPL)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="mod-r-transform.html"><a href="mod-r-transform.html"><i class="fa fa-check"></i><b>13</b> Transforming data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="mod-r-transform.html"><a href="mod-r-transform.html#lo-r-transform"><i class="fa fa-check"></i><b>13.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="13.2" data-path="mod-r-transform.html"><a href="mod-r-transform.html#r-transform-tidyverse"><i class="fa fa-check"></i><b>13.2</b> Working with data in the tidyverse</a></li>
<li class="chapter" data-level="13.3" data-path="mod-r-transform.html"><a href="mod-r-transform.html#r-transform-joins"><i class="fa fa-check"></i><b>13.3</b> Mutating joins</a></li>
<li class="chapter" data-level="13.4" data-path="mod-r-transform.html"><a href="mod-r-transform.html#rc-r-transform"><i class="fa fa-check"></i><b>13.4</b> Recap</a></li>
<li class="chapter" data-level="13.5" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-transform"><i class="fa fa-check"></i><b>13.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-gapminder1"><i class="fa fa-check"></i><b>13.5.1</b> Exercise (gapminder)</a></li>
<li class="chapter" data-level="13.5.2" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-babynames1"><i class="fa fa-check"></i><b>13.5.2</b> Exercise (babynames)</a></li>
<li class="chapter" data-level="13.5.3" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-profit1"><i class="fa fa-check"></i><b>13.5.3</b> Exercise (profit)</a></li>
<li class="chapter" data-level="13.5.4" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-fish"><i class="fa fa-check"></i><b>13.5.4</b> Exercise (fisheries)</a></li>
<li class="chapter" data-level="13.5.5" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-company"><i class="fa fa-check"></i><b>13.5.5</b> Exercise (company ranking)</a></li>
<li class="chapter" data-level="13.5.6" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-titanic"><i class="fa fa-check"></i><b>13.5.6</b> Exercise (Titanic)</a></li>
<li class="chapter" data-level="13.5.7" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-covid"><i class="fa fa-check"></i><b>13.5.7</b> Exercise (covid)</a></li>
<li class="chapter" data-level="13.5.8" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-election"><i class="fa fa-check"></i><b>13.5.8</b> Exercise (election)</a></li>
<li class="chapter" data-level="13.5.9" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-orders"><i class="fa fa-check"></i><b>13.5.9</b> Exercise (orders)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="mod-r-plot.html"><a href="mod-r-plot.html"><i class="fa fa-check"></i><b>14</b> Data visualization using ggplot</a>
<ul>
<li class="chapter" data-level="14.1" data-path="mod-r-plot.html"><a href="mod-r-plot.html#lo-plot"><i class="fa fa-check"></i><b>14.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="14.2" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-intro"><i class="fa fa-check"></i><b>14.2</b> Introduction to data visualization</a></li>
<li class="chapter" data-level="14.3" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-multi"><i class="fa fa-check"></i><b>14.3</b> Combining plots into one using <em>patchwork</em></a></li>
<li class="chapter" data-level="14.4" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-save"><i class="fa fa-check"></i><b>14.4</b> Saving graphics</a></li>
<li class="chapter" data-level="14.5" data-path="mod-r-plot.html"><a href="mod-r-plot.html#rc-r-plot"><i class="fa fa-check"></i><b>14.5</b> Recap</a></li>
<li class="chapter" data-level="14.6" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-plot"><i class="fa fa-check"></i><b>14.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-gapminder2"><i class="fa fa-check"></i><b>14.6.1</b> Exercise (gapminder)</a></li>
<li class="chapter" data-level="14.6.2" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-profit2"><i class="fa fa-check"></i><b>14.6.2</b> Exercise (profit)</a></li>
<li class="chapter" data-level="14.6.3" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-covid19"><i class="fa fa-check"></i><b>14.6.3</b> Exercise (COVID-19)</a></li>
<li class="chapter" data-level="14.6.4" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-lego"><i class="fa fa-check"></i><b>14.6.4</b> Exercise (Lego and sales)</a></li>
<li class="chapter" data-level="14.6.5" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-company-plot"><i class="fa fa-check"></i><b>14.6.5</b> Exercise (company ranking)</a></li>
<li class="chapter" data-level="14.6.6" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-titanic-plot"><i class="fa fa-check"></i><b>14.6.6</b> Exercise (Titanic)</a></li>
<li class="chapter" data-level="14.6.7" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-covid-plot"><i class="fa fa-check"></i><b>14.6.7</b> Exercise (covid)</a></li>
<li class="chapter" data-level="14.6.8" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-election-plot"><i class="fa fa-check"></i><b>14.6.8</b> Exercise (election)</a></li>
<li class="chapter" data-level="14.6.9" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-orders-plot"><i class="fa fa-check"></i><b>14.6.9</b> Exercise (orders)</a></li>
<li class="chapter" data-level="14.6.10" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-nycflights"><i class="fa fa-check"></i><b>14.6.10</b> Exercise (New York flights)</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Extra R</b></span></li>
<li class="chapter" data-level="15" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html"><i class="fa fa-check"></i><b>15</b> Fitting probability distributions</a>
<ul>
<li class="chapter" data-level="15.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#lo-r-dist-fit"><i class="fa fa-check"></i><b>15.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="15.2" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-intro"><i class="fa fa-check"></i><b>15.2</b> Introduction</a></li>
<li class="chapter" data-level="15.3" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-cont"><i class="fa fa-check"></i><b>15.3</b> Fitting distributions to continuous data</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#example-breakdown-times"><i class="fa fa-check"></i><b>15.3.1</b> Example: breakdown times</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-discrete"><i class="fa fa-check"></i><b>15.4</b> Fitting distributions to discrete data</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#example-sales-of-lottery-tickets"><i class="fa fa-check"></i><b>15.4.1</b> Example: sales of lottery tickets</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-dist-fit-pois"><i class="fa fa-check"></i><b>15.5</b> The Poisson process</a></li>
<li class="chapter" data-level="15.6" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#rc-r-dist-fit"><i class="fa fa-check"></i><b>15.6</b> Recap</a></li>
<li class="chapter" data-level="15.7" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#ex-r-dist-fit"><i class="fa fa-check"></i><b>15.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#exercise---call-center"><i class="fa fa-check"></i><b>15.7.1</b> Exercise - Call center</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="mod-r-maps.html"><a href="mod-r-maps.html"><i class="fa fa-check"></i><b>16</b> Spatial data and maps</a>
<ul>
<li class="chapter" data-level="16.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#lo-maps"><i class="fa fa-check"></i><b>16.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="16.2" data-path="mod-r-maps.html"><a href="mod-r-maps.html#sec-map-api-key"><i class="fa fa-check"></i><b>16.2</b> Services for obtatining spatial data</a></li>
<li class="chapter" data-level="16.3" data-path="mod-r-maps.html"><a href="mod-r-maps.html#calculating-distances"><i class="fa fa-check"></i><b>16.3</b> Calculating distances</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#using-google-maps"><i class="fa fa-check"></i><b>16.3.1</b> Using Google Maps</a></li>
<li class="chapter" data-level="16.3.2" data-path="mod-r-maps.html"><a href="mod-r-maps.html#using-bing-maps"><i class="fa fa-check"></i><b>16.3.2</b> Using Bing Maps</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="mod-r-maps.html"><a href="mod-r-maps.html#geocoding-and-reverse-geocoding"><i class="fa fa-check"></i><b>16.4</b> Geocoding and reverse geocoding</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#using-google-maps-1"><i class="fa fa-check"></i><b>16.4.1</b> Using Google maps</a></li>
<li class="chapter" data-level="16.4.2" data-path="mod-r-maps.html"><a href="mod-r-maps.html#use-bing-maps"><i class="fa fa-check"></i><b>16.4.2</b> Use Bing Maps</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="mod-r-maps.html"><a href="mod-r-maps.html#adding-markers-and-routes-to-a-map"><i class="fa fa-check"></i><b>16.5</b> Adding markers and routes to a map</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="groups.html"><a href="groups.html"><i class="fa fa-check"></i><b>A</b> Working in groups</a>
<ul>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#using-git"><i class="fa fa-check"></i>Using Git together with GitHub</a>
<ul>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#register-a-free-github-account"><i class="fa fa-check"></i>Register a free GitHub account</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#install-git"><i class="fa fa-check"></i>Install Git</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#check-your-installation"><i class="fa fa-check"></i>Check your installation</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#setup-projects-using-git-and-github"><i class="fa fa-check"></i>Setup projects using Git and GitHub</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="annotate.html"><a href="annotate.html"><i class="fa fa-check"></i><b>B</b> Annotate the course notes</a></li>
<li class="chapter" data-level="C" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>C</b> Getting help</a></li>
<li class="chapter" data-level="D" data-path="coding-convention.html"><a href="coding-convention.html"><i class="fa fa-check"></i><b>D</b> Coding/naming convention</a>
<ul>
<li class="chapter" data-level="D.1" data-path="coding-convention.html"><a href="coding-convention.html#commenting-your-code"><i class="fa fa-check"></i><b>D.1</b> Commenting your code</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="apdx-vba.html"><a href="apdx-vba.html"><i class="fa fa-check"></i><b>E</b> VBA specific topics</a>
<ul>
<li class="chapter" data-level="E.1" data-path="apdx-vba.html"><a href="apdx-vba.html#vba-debug"><i class="fa fa-check"></i><b>E.1</b> Debugging your code</a></li>
<li class="chapter" data-level="E.2" data-path="apdx-vba.html"><a href="apdx-vba.html#error-handling"><i class="fa fa-check"></i><b>E.2</b> Error handling</a></li>
<li class="chapter" data-level="E.3" data-path="apdx-vba.html"><a href="apdx-vba.html#vba-course-procedures"><i class="fa fa-check"></i><b>E.3</b> Course procedures</a>
<ul>
<li class="chapter" data-level="E.3.1" data-path="apdx-vba.html"><a href="apdx-vba.html#detailed-descriptions-of-course-procedures"><i class="fa fa-check"></i><b>E.3.1</b> Detailed descriptions of course procedures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="F" data-path="lg-course.html"><a href="lg-course.html"><i class="fa fa-check"></i><b>F</b> Learning goals</a></li>
<li class="chapter" data-level="G" data-path="ba.html"><a href="ba.html"><i class="fa fa-check"></i><b>G</b> Business Analytics</a></li>
<li class="chapter" data-level="H" data-path="colophon.html"><a href="colophon.html"><i class="fa fa-check"></i><b>H</b> Colophon</a></li>
<li class="divider"></li>
<li><center>
  <a rel="license" href="./index.html#ack">
    License: CC BY-NC-SA<br>
    <i class = "fab fa-creative-commons fa-2x"></i>
    <i class = "fab fa-creative-commons-by fa-2x"></i>
    <i class = "fab fa-creative-commons-nc fa-2x"></i>
    <i class = "fab fa-creative-commons-sa fa-2x"></i>
  </a>
</li></center>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tools for Analytics (TFA)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod-r-dist-fit" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">Module 15</span> Fitting probability distributions<a href="mod-r-dist-fit.html#mod-r-dist-fit" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Fitting distributions to data is a very common task in statistics and consists in choosing a probability distribution modelling the random variable, as well as finding parameter estimates for that distribution. This requires judgment and expertise and generally needs an iterative process of distribution choice, parameter estimation, and quality of fit assessment. In this module we will limit us to univariate data, i.e. univariate distributions such as normal, uniform, Poisson and exponential distributions. We will use the <a href="https://lbbe.univ-lyon1.fr/fr/fitdistrplus"><code>fitdistrplus</code></a> package for fitting distributions.</p>
<p>A template project for this module is given on <a href="https://posit.cloud/spaces/426101/content/6689209">Posit Cloud</a> (open it and use it while reading the notes).</p>
<!-- #### Learning path diagram {-} -->
<div id="lo-r-dist-fit" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> Learning outcomes<a href="mod-r-dist-fit.html#lo-r-dist-fit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By the end of this module, you are expected to:</p>
<ul>
<li>Have knowledge about different univariate distributions.</li>
<li>Identify continuous and discrete data.</li>
<li>Fit different distributions to data.</li>
</ul>
<p>The learning outcomes relate to the <a href="lg-course.html#lg-course">overall learning goals</a> number 7 and 11-14 of the course.</p>
<!-- SOLO increasing: identify · memorise · name · do simple procedure · collect data · -->
<!-- enumerate · describe · interpret · formulate · list · paraphrase · combine · do -->
<!-- algorithms · compare · contrast · explain causes · analyse · relate · derive · -->
<!-- evaluate · apply · argue · theorise · generalise · hypothesise · solve · reflect -->
</div>
<div id="sec-r-dist-fit-intro" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">15.2</span> Introduction<a href="mod-r-dist-fit.html#sec-r-dist-fit-intro" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Fitting distributions to data is a very common task in statistics and consists in choosing a probability distribution modelling the random variable, as well as finding parameter estimates for that distribution. This requires judgment and expertise and generally needs an iterative process of distribution choice, parameter estimation, and quality of fit assessment. In this module we will limit us to univariate data, i.e. univariate distributions such as a normal, uniform, Poisson and exponential distribution.</p>
<p>Consider a dataset <span class="math inline">\(x = (x_1, \ldots, x_n)\)</span> with <span class="math inline">\(n\)</span> observations which is assumed to be <em>sample</em> observations of a random variable <span class="math inline">\(X\)</span>. Our goal is to find a distribution that fit the data well and estimate the parameters of the distribution. For instance if the distribution is a normal distribution then the mean and variance should be estimated.</p>
<p>Finding the distribution is an iterative process by considering distribution choice, parameter estimation, and quality of fit assessment repeatedly until you are satisfied. The first step is to decide if you data is should fit a discrete or continuous distribution. That is, should the random variable always take discrete values or could/are continuous values possible/okay? Note even though your sample only contain discrete values it is not necessarily samples from a discrete distribution. Consider for instance the dataset <code>groundbeef</code> which contains values of serving sizes in grams of ground beef patties consumed by children under 5 years old:</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="mod-r-dist-fit.html#cb763-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fitdistrplus)</span>
<span id="cb763-2"><a href="mod-r-dist-fit.html#cb763-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb763-3"><a href="mod-r-dist-fit.html#cb763-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;groundbeef&quot;</span>)   <span class="co"># activate the dataset</span></span>
<span id="cb763-4"><a href="mod-r-dist-fit.html#cb763-4" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(groundbeef)</span>
<span id="cb763-5"><a href="mod-r-dist-fit.html#cb763-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dat)</span>
<span id="cb763-6"><a href="mod-r-dist-fit.html#cb763-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tibble [254 × 1] (S3: tbl_df/tbl/data.frame)</span></span>
<span id="cb763-7"><a href="mod-r-dist-fit.html#cb763-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ serving: num [1:254] 30 10 20 24 20 24 40 20 50 30 ...</span></span></code></pre></div>
<p>Serving size in grams is only given using integers; however it is obvious that a continuous distribution should be fitted. We select the <code>serving</code> column so <code>dat</code> becomes a vector with the observations.</p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="mod-r-dist-fit.html#cb764-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat<span class="sc">$</span>serving</span></code></pre></div>
</div>
<div id="sec-r-dist-fit-cont" class="section level2 hasAnchor" number="15.3">
<h2><span class="header-section-number">15.3</span> Fitting distributions to continuous data<a href="mod-r-dist-fit.html#sec-r-dist-fit-cont" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before fitting one or more distributions to a data set, it is generally necessary to choose good
candidates among a predefined set of distributions. This choice may be guided by the knowledge of
stochastic processes governing the modeled variable, or, in the absence of knowledge regarding the
underlying process, by the observation of its empirical distribution. We will use the
<a href="https://lbbe.univ-lyon1.fr/fr/fitdistrplus"><code>fitdistrplus</code></a> package for fitting distributions. Let
us continue with the <code>groundbeef</code> dataset.</p>
<p>First of all, it is common to start with plots of the empirical distribution function and the
histogram (or density plot), which can be obtained with the <code>plotdist</code> function which provides two
plots where the left-hand plot is by default the histogram on a density scale and the
right-hand plot the empirical cumulative distribution function (CDF).</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="mod-r-dist-fit.html#cb765-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotdist</span>(dat, <span class="at">histo =</span> <span class="cn">TRUE</span>, <span class="at">demp =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-663"></span>
<img src="TFA_files/figure-html/unnamed-chunk-663-1.png" alt="Empirical density and distribution." width="672" />
<p class="caption">
Figure 15.1: Empirical density and distribution.
</p>
</div>
<p>The empirical plots of the density and the CDF may give you a hit about the distribution of <span class="math inline">\(X\)</span>. But
often additional descriptive statistics may help to choose candidates to describe a distribution
among a set of parametric distributions. Especially the skewness and kurtosis, linked to the third
and fourth moments, are useful for this purpose. A non-zero skewness reveals a lack of symmetry of
the empirical distribution, while the kurtosis value quantifies the weight of tails in comparison to
the normal distribution for which the kurtosis equals 3.</p>
<p>The skewness and kurtosis and their corresponding estimate are given by
<span class="math display">\[\begin{equation}
    \label{skewness}
    sk(X) = \frac{E[(X-E(X))^3]}{Var(X)^{\frac{3}{2}}}~,~
    \widehat{sk}=\frac{\sqrt{n(n-1)}}{n-2}\times\frac{m_{3}}{m_{2}^{\frac{3}{2}}},
  \end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
    \label{kurtosis}
    kr(X) = \frac{E[(X-E(X))^4]}{Var(X)^{2}}~,~
    \widehat{kr}=\frac{n-1}{(n-2)(n-3)}((n+1) \times \frac{m_{4}}{m_{2}^{2}}-3(n-1)) + 3,
  \end{equation}\]</span>
where <span class="math inline">\(m_{2}\)</span>, <span class="math inline">\(m_{3}\)</span>, <span class="math inline">\(m_{4}\)</span> denote empirical moments defined by
<span class="math inline">\(m_{k}=\frac{1}{n}\sum_{i=1}^n(x_{i}-\overline{x})^{k}\)</span>, with mean value <span class="math inline">\(\overline{x}\)</span>.</p>
<p>The <code>descdist</code> function provides classical descriptive statistics (minimum, maximum, median, mean,
standard deviation), skewness and kurtosis. A skewness-kurtosis plot such as the one proposed by
<span class="citation">Cullen and Frey (<a href="#ref-Cullen99" role="doc-biblioref">1999</a>)</span> is provided by the <code>descdist</code> function for the empirical distribution On this plot, values
for common distributions are displayed in order to help the choice of distributions to fit to
data. For some distributions (normal, uniform, logistic, exponential), there is only one possible
value for the skewness and the kurtosis. Thus, the distribution is represented by a single point
on the plot. For other distributions, areas of possible values are represented, consisting of
lines (as for gamma and lognormal distributions), or areas (as for beta distribution).
Nevertheless, the user needs to know that skewness and kurtosis, like all higher moments, have a
very high variance. Hence the skewness-kurtosis plot should then be regarded as indicative only
and the properties of the random variable should be considered, notably its expected value and its
range, as a complement to the use of the <code>plotdist</code> and <code>descdist</code> functions.</p>
<p>Below is a call to the <code>descdist</code> function to describe the distribution of the serving size from the
<code>groundbeef</code> data set and to draw the corresponding skewness-kurtosis plot. Looking at the results
notice that the observed skewness is positive and the kurtosis is not far from 3. Hence the fit of
three common right-skewed distributions could be considered: Weibull, gamma and lognormal
distributions.</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="mod-r-dist-fit.html#cb766-1" aria-hidden="true" tabindex="-1"></a><span class="fu">descdist</span>(dat)</span>
<span id="cb766-2"><a href="mod-r-dist-fit.html#cb766-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; summary statistics</span></span>
<span id="cb766-3"><a href="mod-r-dist-fit.html#cb766-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb766-4"><a href="mod-r-dist-fit.html#cb766-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; min:  10   max:  200 </span></span>
<span id="cb766-5"><a href="mod-r-dist-fit.html#cb766-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; median:  79 </span></span>
<span id="cb766-6"><a href="mod-r-dist-fit.html#cb766-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean:  73.6 </span></span>
<span id="cb766-7"><a href="mod-r-dist-fit.html#cb766-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated sd:  35.9 </span></span>
<span id="cb766-8"><a href="mod-r-dist-fit.html#cb766-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated skewness:  0.735 </span></span>
<span id="cb766-9"><a href="mod-r-dist-fit.html#cb766-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated kurtosis:  3.55</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-664"></span>
<img src="TFA_files/figure-html/unnamed-chunk-664-1.png" alt="Skewness-kurtosis plot for a continuous variable (`groundbeef`)." width="672" />
<p class="caption">
Figure 15.2: Skewness-kurtosis plot for a continuous variable (<code>groundbeef</code>).
</p>
</div>
<p>Once one or more parametric distributions have been selected they are fitted to the data set using maximum likelihood. This is done using the <code>fitdist</code> function:</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="mod-r-dist-fit.html#cb767-1" aria-hidden="true" tabindex="-1"></a>fitW <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;weibull&quot;</span>)</span>
<span id="cb767-2"><a href="mod-r-dist-fit.html#cb767-2" aria-hidden="true" tabindex="-1"></a>fitG <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb767-3"><a href="mod-r-dist-fit.html#cb767-3" aria-hidden="true" tabindex="-1"></a>fitL <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;lnorm&quot;</span>)</span></code></pre></div>
<p>The function returns a list with information about the fit such as the parameter estimates, the loglikelihood, the Akaike and Bayesian information criteria (the so-called AIC and BIC). An overview can be seen using the <code>summary</code> function:</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="mod-r-dist-fit.html#cb768-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitW)</span>
<span id="cb768-2"><a href="mod-r-dist-fit.html#cb768-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; weibull &#39; by maximum likelihood </span></span>
<span id="cb768-3"><a href="mod-r-dist-fit.html#cb768-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb768-4"><a href="mod-r-dist-fit.html#cb768-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       estimate Std. Error</span></span>
<span id="cb768-5"><a href="mod-r-dist-fit.html#cb768-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; shape     2.19      0.105</span></span>
<span id="cb768-6"><a href="mod-r-dist-fit.html#cb768-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; scale    83.35      2.527</span></span>
<span id="cb768-7"><a href="mod-r-dist-fit.html#cb768-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -1255   AIC:  2514   BIC:  2522 </span></span>
<span id="cb768-8"><a href="mod-r-dist-fit.html#cb768-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation matrix:</span></span>
<span id="cb768-9"><a href="mod-r-dist-fit.html#cb768-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       shape scale</span></span>
<span id="cb768-10"><a href="mod-r-dist-fit.html#cb768-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; shape 1.000 0.322</span></span>
<span id="cb768-11"><a href="mod-r-dist-fit.html#cb768-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; scale 0.322 1.000</span></span>
<span id="cb768-12"><a href="mod-r-dist-fit.html#cb768-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitG)</span>
<span id="cb768-13"><a href="mod-r-dist-fit.html#cb768-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; gamma &#39; by maximum likelihood </span></span>
<span id="cb768-14"><a href="mod-r-dist-fit.html#cb768-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb768-15"><a href="mod-r-dist-fit.html#cb768-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       estimate Std. Error</span></span>
<span id="cb768-16"><a href="mod-r-dist-fit.html#cb768-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; shape   4.0083    0.34134</span></span>
<span id="cb768-17"><a href="mod-r-dist-fit.html#cb768-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rate    0.0544    0.00494</span></span>
<span id="cb768-18"><a href="mod-r-dist-fit.html#cb768-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -1254   AIC:  2511   BIC:  2518 </span></span>
<span id="cb768-19"><a href="mod-r-dist-fit.html#cb768-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation matrix:</span></span>
<span id="cb768-20"><a href="mod-r-dist-fit.html#cb768-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       shape  rate</span></span>
<span id="cb768-21"><a href="mod-r-dist-fit.html#cb768-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; shape 1.000 0.938</span></span>
<span id="cb768-22"><a href="mod-r-dist-fit.html#cb768-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rate  0.938 1.000</span></span>
<span id="cb768-23"><a href="mod-r-dist-fit.html#cb768-23" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitL)</span>
<span id="cb768-24"><a href="mod-r-dist-fit.html#cb768-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; lnorm &#39; by maximum likelihood </span></span>
<span id="cb768-25"><a href="mod-r-dist-fit.html#cb768-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb768-26"><a href="mod-r-dist-fit.html#cb768-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         estimate Std. Error</span></span>
<span id="cb768-27"><a href="mod-r-dist-fit.html#cb768-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; meanlog    4.169     0.0337</span></span>
<span id="cb768-28"><a href="mod-r-dist-fit.html#cb768-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sdlog      0.537     0.0238</span></span>
<span id="cb768-29"><a href="mod-r-dist-fit.html#cb768-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -1261   AIC:  2527   BIC:  2534 </span></span>
<span id="cb768-30"><a href="mod-r-dist-fit.html#cb768-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation matrix:</span></span>
<span id="cb768-31"><a href="mod-r-dist-fit.html#cb768-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         meanlog sdlog</span></span>
<span id="cb768-32"><a href="mod-r-dist-fit.html#cb768-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; meanlog       1     0</span></span>
<span id="cb768-33"><a href="mod-r-dist-fit.html#cb768-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sdlog         0     1</span></span></code></pre></div>
<p>The fit to the data can be plotted using four classical goodness-of-fit plots <span class="citation">(<a href="#ref-Cullen99" role="doc-biblioref">Cullen and Frey 1999</a>)</span>:</p>
<ul>
<li>a density plot representing the density function of the fitted distribution along with the
histogram of the empirical distribution,</li>
<li>a CDF plot of both the empirical distribution and the fitted distribution,</li>
<li>a Q-Q plot representing the empirical quantiles (y-axis) against the theoretical quantiles
(x-axis),</li>
<li>a P-P plot representing the empirical distribution function evaluated at each data point (y-axis)
against the fitted distribution function (x-axis).</li>
</ul>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="mod-r-dist-fit.html#cb769-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))  <span class="co"># 4 plots in one figure</span></span>
<span id="cb769-2"><a href="mod-r-dist-fit.html#cb769-2" aria-hidden="true" tabindex="-1"></a>pLegend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Weibull&quot;</span>, <span class="st">&quot;lognormal&quot;</span>, <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb769-3"><a href="mod-r-dist-fit.html#cb769-3" aria-hidden="true" tabindex="-1"></a>lst <span class="ot">&lt;-</span> <span class="fu">list</span>(fitW, fitL, fitG)</span>
<span id="cb769-4"><a href="mod-r-dist-fit.html#cb769-4" aria-hidden="true" tabindex="-1"></a><span class="fu">denscomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb769-5"><a href="mod-r-dist-fit.html#cb769-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb769-6"><a href="mod-r-dist-fit.html#cb769-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cdfcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb769-7"><a href="mod-r-dist-fit.html#cb769-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ppcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-667"></span>
<img src="TFA_files/figure-html/unnamed-chunk-667-1.png" alt="Four Goodness-of-fit plots for various distributions fitted to the serving size data." width="100%" />
<p class="caption">
Figure 15.3: Four Goodness-of-fit plots for various distributions fitted to the serving size data.
</p>
</div>
<p>The density plot and the CDF plot may be considered as the basic classical goodness-of-fit plots.
The two other plots are complementary and can be very informative in some cases. The Q-Q plot
emphasizes the lack-of-fit at the distribution tails while the P-P plot emphasizes the lack-of-fit
at the distribution center. In the present example, none of the three fitted distributions correctly
describes the center of the distribution, but the Weibull and gamma distributions could be preferred
for their better description of the right tail of the empirical distribution. Moreover, these
distributions also have the lowest AIC values.</p>
<p>Other methods can be used to fit distributions to the data instead of maximum likelihood. For details see <span class="citation">Delignette-Muller and Dutang (<a href="#ref-DelignetteMuller15" role="doc-biblioref">2015</a>)</span>.</p>
<div id="example-breakdown-times" class="section level3 hasAnchor" number="15.3.1">
<h3><span class="header-section-number">15.3.1</span> Example: breakdown times<a href="mod-r-dist-fit.html#example-breakdown-times" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We consider a dataset that contains the recorded breakdown times of a machine part in days.</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="mod-r-dist-fit.html#cb770-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tfa)  <span class="co"># update to latest version using remotes::install_github(&quot;bss-osca/tfa-package&quot;, upgrade = FALSE) </span></span>
<span id="cb770-2"><a href="mod-r-dist-fit.html#cb770-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> breakdown</span>
<span id="cb770-3"><a href="mod-r-dist-fit.html#cb770-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotdist</span>(dat, <span class="at">histo =</span> <span class="cn">TRUE</span>, <span class="at">demp =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-668-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Since breakdown times may be seen as a continuous variable we try to fit a continuous variable. First we try to find distribution candidates:</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="mod-r-dist-fit.html#cb771-1" aria-hidden="true" tabindex="-1"></a><span class="fu">descdist</span>(dat)</span>
<span id="cb771-2"><a href="mod-r-dist-fit.html#cb771-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; summary statistics</span></span>
<span id="cb771-3"><a href="mod-r-dist-fit.html#cb771-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb771-4"><a href="mod-r-dist-fit.html#cb771-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; min:  91   max:  280 </span></span>
<span id="cb771-5"><a href="mod-r-dist-fit.html#cb771-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; median:  182 </span></span>
<span id="cb771-6"><a href="mod-r-dist-fit.html#cb771-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean:  183 </span></span>
<span id="cb771-7"><a href="mod-r-dist-fit.html#cb771-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated sd:  30.7 </span></span>
<span id="cb771-8"><a href="mod-r-dist-fit.html#cb771-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated skewness:  0.0503 </span></span>
<span id="cb771-9"><a href="mod-r-dist-fit.html#cb771-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated kurtosis:  3.32</span></span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-669-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The observation is close to the normal and lognormal values and we try to fit these two distributions:</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="mod-r-dist-fit.html#cb772-1" aria-hidden="true" tabindex="-1"></a>fitN <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;norm&quot;</span>)</span>
<span id="cb772-2"><a href="mod-r-dist-fit.html#cb772-2" aria-hidden="true" tabindex="-1"></a>fitL <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;lnorm&quot;</span>)</span>
<span id="cb772-3"><a href="mod-r-dist-fit.html#cb772-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitN)</span>
<span id="cb772-4"><a href="mod-r-dist-fit.html#cb772-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; norm &#39; by maximum likelihood </span></span>
<span id="cb772-5"><a href="mod-r-dist-fit.html#cb772-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb772-6"><a href="mod-r-dist-fit.html#cb772-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      estimate Std. Error</span></span>
<span id="cb772-7"><a href="mod-r-dist-fit.html#cb772-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean    183.2       1.99</span></span>
<span id="cb772-8"><a href="mod-r-dist-fit.html#cb772-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd       30.6       1.41</span></span>
<span id="cb772-9"><a href="mod-r-dist-fit.html#cb772-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -1142   AIC:  2288   BIC:  2295 </span></span>
<span id="cb772-10"><a href="mod-r-dist-fit.html#cb772-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation matrix:</span></span>
<span id="cb772-11"><a href="mod-r-dist-fit.html#cb772-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      mean sd</span></span>
<span id="cb772-12"><a href="mod-r-dist-fit.html#cb772-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean    1  0</span></span>
<span id="cb772-13"><a href="mod-r-dist-fit.html#cb772-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd      0  1</span></span>
<span id="cb772-14"><a href="mod-r-dist-fit.html#cb772-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitL)</span>
<span id="cb772-15"><a href="mod-r-dist-fit.html#cb772-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; lnorm &#39; by maximum likelihood </span></span>
<span id="cb772-16"><a href="mod-r-dist-fit.html#cb772-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb772-17"><a href="mod-r-dist-fit.html#cb772-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         estimate Std. Error</span></span>
<span id="cb772-18"><a href="mod-r-dist-fit.html#cb772-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; meanlog    5.196    0.01130</span></span>
<span id="cb772-19"><a href="mod-r-dist-fit.html#cb772-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sdlog      0.174    0.00799</span></span>
<span id="cb772-20"><a href="mod-r-dist-fit.html#cb772-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -1148   AIC:  2300   BIC:  2306 </span></span>
<span id="cb772-21"><a href="mod-r-dist-fit.html#cb772-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation matrix:</span></span>
<span id="cb772-22"><a href="mod-r-dist-fit.html#cb772-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         meanlog sdlog</span></span>
<span id="cb772-23"><a href="mod-r-dist-fit.html#cb772-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; meanlog       1     0</span></span>
<span id="cb772-24"><a href="mod-r-dist-fit.html#cb772-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sdlog         0     1</span></span>
<span id="cb772-25"><a href="mod-r-dist-fit.html#cb772-25" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))  <span class="co"># 4 plots in one figure</span></span>
<span id="cb772-26"><a href="mod-r-dist-fit.html#cb772-26" aria-hidden="true" tabindex="-1"></a>pLegend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>, <span class="st">&quot;lognormal&quot;</span>)</span>
<span id="cb772-27"><a href="mod-r-dist-fit.html#cb772-27" aria-hidden="true" tabindex="-1"></a>lst <span class="ot">&lt;-</span> <span class="fu">list</span>(fitN, fitL)</span>
<span id="cb772-28"><a href="mod-r-dist-fit.html#cb772-28" aria-hidden="true" tabindex="-1"></a><span class="fu">denscomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb772-29"><a href="mod-r-dist-fit.html#cb772-29" aria-hidden="true" tabindex="-1"></a><span class="fu">qqcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb772-30"><a href="mod-r-dist-fit.html#cb772-30" aria-hidden="true" tabindex="-1"></a><span class="fu">cdfcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb772-31"><a href="mod-r-dist-fit.html#cb772-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ppcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-670"></span>
<img src="TFA_files/figure-html/unnamed-chunk-670-1.png" alt="Four Goodness-of-fit plots for various distributions fitted to the breakdown data." width="100%" />
<p class="caption">
Figure 15.4: Four Goodness-of-fit plots for various distributions fitted to the breakdown data.
</p>
</div>
<p>Note it seems that the normal distribution has a better fit (AIC smallest). Also intuitively it makes sense that breakdown times are normal distributed around a mean value (however the probability of negative values should be low).</p>
</div>
</div>
<div id="sec-r-dist-fit-discrete" class="section level2 hasAnchor" number="15.4">
<h2><span class="header-section-number">15.4</span> Fitting distributions to discrete data<a href="mod-r-dist-fit.html#sec-r-dist-fit-discrete" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You may also need to fit discrete distributions such as:</p>
<ul>
<li><p>The Poisson distribution which is a discrete probability distribution that expresses the probability of a given number of events occurring in a fixed interval of time and/or space if these events occur with a known average rate and independently of the time since the last event. The Poisson distribution can be applied to systems with a large number of possible events, each of which is rare. How many such events will occur during a fixed time interval? Under the right circumstances, this is a random number following a Poisson distribution.</p></li>
<li><p>The binomial distribution which is a probability distribution that is used to model the number of successes in a sequence of <span class="math inline">\(n\)</span> independent experiments with probability <span class="math inline">\(p\)</span> for success. The Bernoulli distribution is a special case of the Binomial distribution where <span class="math inline">\(n=1\)</span> (one experiment).</p></li>
<li><p>The negative binomial distribution which is a discrete probability distribution that models the number of failures in a sequence of independent and identically distributed Bernoulli trials before a specified number of successes occurs.</p></li>
<li><p>The geometric distribution which is a special case of the negative binomial distribution where the specified number of successes are one.</p></li>
</ul>
<div id="example-sales-of-lottery-tickets" class="section level3 hasAnchor" number="15.4.1">
<h3><span class="header-section-number">15.4.1</span> Example: sales of lottery tickets<a href="mod-r-dist-fit.html#example-sales-of-lottery-tickets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider data of the number of houses that must be visited before selling 20 lottery tickets (assuming only one is sold at a time).</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="mod-r-dist-fit.html#cb773-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> lottery</span>
<span id="cb773-2"><a href="mod-r-dist-fit.html#cb773-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotdist</span>(dat, <span class="at">discrete =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-671-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Since the number of houses that must be visited (trials) is unknown, a negative binomial distribution seems as a good choice (with 20 successes). The fit of a discrete distribution to discrete data requires the same procedure as for continuous data.</p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="mod-r-dist-fit.html#cb774-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;nbinom&quot;</span>, <span class="at">discrete =</span> <span class="cn">TRUE</span>, <span class="at">fix.arg =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">20</span>))</span>
<span id="cb774-2"><a href="mod-r-dist-fit.html#cb774-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb774-3"><a href="mod-r-dist-fit.html#cb774-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; nbinom &#39; by maximum likelihood </span></span>
<span id="cb774-4"><a href="mod-r-dist-fit.html#cb774-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb774-5"><a href="mod-r-dist-fit.html#cb774-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    estimate Std. Error</span></span>
<span id="cb774-6"><a href="mod-r-dist-fit.html#cb774-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu     37.2       1.38</span></span>
<span id="cb774-7"><a href="mod-r-dist-fit.html#cb774-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fixed parameters:</span></span>
<span id="cb774-8"><a href="mod-r-dist-fit.html#cb774-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      value</span></span>
<span id="cb774-9"><a href="mod-r-dist-fit.html#cb774-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; size    20</span></span>
<span id="cb774-10"><a href="mod-r-dist-fit.html#cb774-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -200   AIC:  402   BIC:  404</span></span>
<span id="cb774-11"><a href="mod-r-dist-fit.html#cb774-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))  <span class="co"># 2 plots in one figure</span></span>
<span id="cb774-12"><a href="mod-r-dist-fit.html#cb774-12" aria-hidden="true" tabindex="-1"></a>pLegend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;negative binomial&quot;</span>)</span>
<span id="cb774-13"><a href="mod-r-dist-fit.html#cb774-13" aria-hidden="true" tabindex="-1"></a>lst <span class="ot">&lt;-</span> <span class="fu">list</span>(fit)</span>
<span id="cb774-14"><a href="mod-r-dist-fit.html#cb774-14" aria-hidden="true" tabindex="-1"></a><span class="fu">denscomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb774-15"><a href="mod-r-dist-fit.html#cb774-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cdfcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-672"></span>
<img src="TFA_files/figure-html/unnamed-chunk-672-1.png" alt="Four Goodness-of-fit plots for various distributions fitted to the breakdown data." width="100%" />
<p class="caption">
Figure 15.5: Four Goodness-of-fit plots for various distributions fitted to the breakdown data.
</p>
</div>
<p>Note only the density and CDF is plotted for discrete data. Moreover, this is an example where some of the parameters of the negative binomial distribution are known in advance. The negative binomial distribution has two parameters (see <code>?pnbinom</code>): the specified number of successes to occur (<code>size</code> argument) and the probability of success in each trial (<code>prob</code> argument). Given the information about the dataset, <code>size</code> equals 20 and we want to to try finding the probability of success in each trial. You fix a parameter by using the <code>fix.arg</code> argument in <code>fitdist</code>. Note that the summary only outputs the mean estimate <code>mu</code> but <code>prob = size/(size+mu)</code>:</p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="mod-r-dist-fit.html#cb775-1" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="dv">20</span><span class="sc">/</span>(<span class="dv">20</span> <span class="sc">+</span> fit<span class="sc">$</span>estimate)</span>
<span id="cb775-2"><a href="mod-r-dist-fit.html#cb775-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(prob) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb775-3"><a href="mod-r-dist-fit.html#cb775-3" aria-hidden="true" tabindex="-1"></a>prob</span>
<span id="cb775-4"><a href="mod-r-dist-fit.html#cb775-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.35</span></span></code></pre></div>
<p>That is the probability of success when visiting each house is approx. 35% and e.g. the number of houses that must be visited before all lottery tickets are sold with 95% probability is:</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="mod-r-dist-fit.html#cb776-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnbinom</span>(<span class="fl">0.95</span>, <span class="at">size =</span> <span class="dv">20</span>, prob)</span>
<span id="cb776-2"><a href="mod-r-dist-fit.html#cb776-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 55</span></span></code></pre></div>
</div>
</div>
<div id="sec-dist-fit-pois" class="section level2 hasAnchor" number="15.5">
<h2><span class="header-section-number">15.5</span> The Poisson process<a href="mod-r-dist-fit.html#sec-dist-fit-pois" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A Poisson process models a series of discrete events. The average time between events is known, but the exact timing of events is random: the waiting time between events are exponential distributed. Since the exponential distribution is memoryless, the arrival time of an event is independent of what happend in the past (e.g. the arrival time of the last event). A Poisson process is often used in queueing theory to model random events, such as the arrival of customers at a store or phone calls arriving at a call center.</p>
<p>More formally a Poisson process is defined as process counting the total number of events <span class="math inline">\(N(t)\)</span> at time <span class="math inline">\(t\)</span> given the average arrival rate <span class="math inline">\(\lambda\)</span>. The process satisfy that:</p>
<ul>
<li><span class="math inline">\(N(0)=0\)</span>;</li>
<li>The waiting time between events is exponential distributed with rate <span class="math inline">\(\lambda\)</span>;</li>
<li>The number of arrivals in any interval of length <span class="math inline">\(\tau\)</span> is Poisson distributed with parameter <span class="math inline">\(\tau\lambda\)</span></li>
</ul>
<p>The arrivals in a Poisson process with on average 4 arrivals per time unit (<span class="math inline">\(\lambda=4\)</span>) may look like:</p>
<p><img src="TFA_files/figure-html/poisson_process-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Let us consider the data set <code>demand_goods</code> containing demand for two different goods/products:</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="mod-r-dist-fit.html#cb777-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tfa)  <span class="co"># update to latest version using remotes::install_github(&quot;bss-osca/tfa-package&quot;, upgrade = FALSE) </span></span>
<span id="cb777-2"><a href="mod-r-dist-fit.html#cb777-2" aria-hidden="true" tabindex="-1"></a>demand_goods</span>
<span id="cb777-3"><a href="mod-r-dist-fit.html#cb777-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 362 × 3</span></span>
<span id="cb777-4"><a href="mod-r-dist-fit.html#cb777-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    date                demand product</span></span>
<span id="cb777-5"><a href="mod-r-dist-fit.html#cb777-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dttm&gt;               &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb777-6"><a href="mod-r-dist-fit.html#cb777-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 2016-01-01 00:00:00      8       1</span></span>
<span id="cb777-7"><a href="mod-r-dist-fit.html#cb777-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 2016-01-06 00:00:00     10       1</span></span>
<span id="cb777-8"><a href="mod-r-dist-fit.html#cb777-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 2016-01-08 00:00:00     10       1</span></span>
<span id="cb777-9"><a href="mod-r-dist-fit.html#cb777-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 2016-01-11 00:00:00      7       1</span></span>
<span id="cb777-10"><a href="mod-r-dist-fit.html#cb777-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 2016-01-22 00:00:00      9       1</span></span>
<span id="cb777-11"><a href="mod-r-dist-fit.html#cb777-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 2016-02-01 00:00:00      8       1</span></span>
<span id="cb777-12"><a href="mod-r-dist-fit.html#cb777-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 2016-02-05 00:00:00      8       1</span></span>
<span id="cb777-13"><a href="mod-r-dist-fit.html#cb777-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 2016-02-06 00:00:00      7       1</span></span>
<span id="cb777-14"><a href="mod-r-dist-fit.html#cb777-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 2016-02-13 00:00:00      9       1</span></span>
<span id="cb777-15"><a href="mod-r-dist-fit.html#cb777-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 2016-02-14 00:00:00      8       1</span></span>
<span id="cb777-16"><a href="mod-r-dist-fit.html#cb777-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 352 more rows</span></span></code></pre></div>
<p>The arrival of demands and demand size may follow a compound Poisson process which differ from a Poisson process by allowing more than a demand of one given an arrival. That is, the inter arrival times should still follow an exponential distribution. Let us find the inter arrival times between each order and try to fit it:</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="mod-r-dist-fit.html#cb778-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb778-2"><a href="mod-r-dist-fit.html#cb778-2" aria-hidden="true" tabindex="-1"></a>datDf <span class="ot">&lt;-</span> demand_goods <span class="sc">%&gt;%</span> </span>
<span id="cb778-3"><a href="mod-r-dist-fit.html#cb778-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(product) <span class="sc">%&gt;%</span> </span>
<span id="cb778-4"><a href="mod-r-dist-fit.html#cb778-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">between =</span> <span class="fu">as.numeric</span>(date <span class="sc">-</span> <span class="fu">lag</span>(date), <span class="at">units=</span><span class="st">&quot;days&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb778-5"><a href="mod-r-dist-fit.html#cb778-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span>
<span id="cb778-6"><a href="mod-r-dist-fit.html#cb778-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 362 × 4</span></span>
<span id="cb778-7"><a href="mod-r-dist-fit.html#cb778-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Groups:   product [2]</span></span>
<span id="cb778-8"><a href="mod-r-dist-fit.html#cb778-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    date                demand product between</span></span>
<span id="cb778-9"><a href="mod-r-dist-fit.html#cb778-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;dttm&gt;               &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb778-10"><a href="mod-r-dist-fit.html#cb778-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 2016-01-01 00:00:00      8       1      NA</span></span>
<span id="cb778-11"><a href="mod-r-dist-fit.html#cb778-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 2016-01-06 00:00:00     10       1       5</span></span>
<span id="cb778-12"><a href="mod-r-dist-fit.html#cb778-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 2016-01-08 00:00:00     10       1       2</span></span>
<span id="cb778-13"><a href="mod-r-dist-fit.html#cb778-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 2016-01-11 00:00:00      7       1       3</span></span>
<span id="cb778-14"><a href="mod-r-dist-fit.html#cb778-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 2016-01-22 00:00:00      9       1      11</span></span>
<span id="cb778-15"><a href="mod-r-dist-fit.html#cb778-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 2016-02-01 00:00:00      8       1      10</span></span>
<span id="cb778-16"><a href="mod-r-dist-fit.html#cb778-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 2016-02-05 00:00:00      8       1       4</span></span>
<span id="cb778-17"><a href="mod-r-dist-fit.html#cb778-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 2016-02-06 00:00:00      7       1       1</span></span>
<span id="cb778-18"><a href="mod-r-dist-fit.html#cb778-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 2016-02-13 00:00:00      9       1       7</span></span>
<span id="cb778-19"><a href="mod-r-dist-fit.html#cb778-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 2016-02-14 00:00:00      8       1       1</span></span>
<span id="cb778-20"><a href="mod-r-dist-fit.html#cb778-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 352 more rows</span></span>
<span id="cb778-21"><a href="mod-r-dist-fit.html#cb778-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb778-22"><a href="mod-r-dist-fit.html#cb778-22" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> datDf <span class="sc">%&gt;%</span> </span>
<span id="cb778-23"><a href="mod-r-dist-fit.html#cb778-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product <span class="sc">==</span> <span class="dv">1</span>, <span class="sc">!</span><span class="fu">is.na</span>(between)) <span class="sc">%&gt;%</span> </span>
<span id="cb778-24"><a href="mod-r-dist-fit.html#cb778-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(between)</span>
<span id="cb778-25"><a href="mod-r-dist-fit.html#cb778-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plotdist</span>(dat, <span class="at">histo =</span> <span class="cn">TRUE</span>, <span class="at">demp =</span> <span class="cn">TRUE</span>)</span>
<span id="cb778-26"><a href="mod-r-dist-fit.html#cb778-26" aria-hidden="true" tabindex="-1"></a><span class="fu">descdist</span>(dat)</span>
<span id="cb778-27"><a href="mod-r-dist-fit.html#cb778-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; summary statistics</span></span>
<span id="cb778-28"><a href="mod-r-dist-fit.html#cb778-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb778-29"><a href="mod-r-dist-fit.html#cb778-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; min:  0   max:  33 </span></span>
<span id="cb778-30"><a href="mod-r-dist-fit.html#cb778-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; median:  4 </span></span>
<span id="cb778-31"><a href="mod-r-dist-fit.html#cb778-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean:  5.08 </span></span>
<span id="cb778-32"><a href="mod-r-dist-fit.html#cb778-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated sd:  4.72 </span></span>
<span id="cb778-33"><a href="mod-r-dist-fit.html#cb778-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated skewness:  1.85 </span></span>
<span id="cb778-34"><a href="mod-r-dist-fit.html#cb778-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated kurtosis:  8.86</span></span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-676-1.png" width="672" style="display: block; margin: auto;" /><img src="TFA_files/figure-html/unnamed-chunk-676-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>The observation is close to the exponential and lognormal values. However, a lognormal distribution cannot equal zero values:</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="mod-r-dist-fit.html#cb779-1" aria-hidden="true" tabindex="-1"></a>fitE1 <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;exp&quot;</span>)</span>
<span id="cb779-2"><a href="mod-r-dist-fit.html#cb779-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitE1)</span>
<span id="cb779-3"><a href="mod-r-dist-fit.html#cb779-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; exp &#39; by maximum likelihood </span></span>
<span id="cb779-4"><a href="mod-r-dist-fit.html#cb779-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb779-5"><a href="mod-r-dist-fit.html#cb779-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      estimate Std. Error</span></span>
<span id="cb779-6"><a href="mod-r-dist-fit.html#cb779-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rate    0.197     0.0135</span></span>
<span id="cb779-7"><a href="mod-r-dist-fit.html#cb779-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -557   AIC:  1115   BIC:  1119</span></span>
<span id="cb779-8"><a href="mod-r-dist-fit.html#cb779-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))  <span class="co"># 4 plots in one figure</span></span>
<span id="cb779-9"><a href="mod-r-dist-fit.html#cb779-9" aria-hidden="true" tabindex="-1"></a>pLegend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;exp&quot;</span>)</span>
<span id="cb779-10"><a href="mod-r-dist-fit.html#cb779-10" aria-hidden="true" tabindex="-1"></a>lst <span class="ot">&lt;-</span> <span class="fu">list</span>(fitE1)</span>
<span id="cb779-11"><a href="mod-r-dist-fit.html#cb779-11" aria-hidden="true" tabindex="-1"></a><span class="fu">denscomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb779-12"><a href="mod-r-dist-fit.html#cb779-12" aria-hidden="true" tabindex="-1"></a><span class="fu">qqcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb779-13"><a href="mod-r-dist-fit.html#cb779-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cdfcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb779-14"><a href="mod-r-dist-fit.html#cb779-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ppcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-677"></span>
<img src="TFA_files/figure-html/unnamed-chunk-677-1.png" alt="Four Goodness-of-fit plots for various distributions fitted to the breakdown data." width="100%" />
<p class="caption">
Figure 15.6: Four Goodness-of-fit plots for various distributions fitted to the breakdown data.
</p>
</div>
<p>The fit seems okay. Note that the horizontal and vertical points in the Q-Q and P-P plot indicate that another scale on measuring the inter arrival times would have been better (such as hours or minutes). Using days may round the numbers to much.</p>
<p>Let us do the analysis for product 2:</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="mod-r-dist-fit.html#cb780-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> datDf <span class="sc">%&gt;%</span> </span>
<span id="cb780-2"><a href="mod-r-dist-fit.html#cb780-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product <span class="sc">==</span> <span class="dv">2</span>, <span class="sc">!</span><span class="fu">is.na</span>(between)) <span class="sc">%&gt;%</span> </span>
<span id="cb780-3"><a href="mod-r-dist-fit.html#cb780-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(between)</span>
<span id="cb780-4"><a href="mod-r-dist-fit.html#cb780-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotdist</span>(dat, <span class="at">histo =</span> <span class="cn">TRUE</span>, <span class="at">demp =</span> <span class="cn">TRUE</span>)</span>
<span id="cb780-5"><a href="mod-r-dist-fit.html#cb780-5" aria-hidden="true" tabindex="-1"></a><span class="fu">descdist</span>(dat)</span>
<span id="cb780-6"><a href="mod-r-dist-fit.html#cb780-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; summary statistics</span></span>
<span id="cb780-7"><a href="mod-r-dist-fit.html#cb780-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb780-8"><a href="mod-r-dist-fit.html#cb780-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; min:  0   max:  41 </span></span>
<span id="cb780-9"><a href="mod-r-dist-fit.html#cb780-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; median:  5 </span></span>
<span id="cb780-10"><a href="mod-r-dist-fit.html#cb780-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean:  7.36 </span></span>
<span id="cb780-11"><a href="mod-r-dist-fit.html#cb780-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated sd:  7.26 </span></span>
<span id="cb780-12"><a href="mod-r-dist-fit.html#cb780-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated skewness:  2 </span></span>
<span id="cb780-13"><a href="mod-r-dist-fit.html#cb780-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated kurtosis:  8.4</span></span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-678-1.png" width="672" style="display: block; margin: auto;" /><img src="TFA_files/figure-html/unnamed-chunk-678-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>The observation is close to the exponential values:</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="mod-r-dist-fit.html#cb781-1" aria-hidden="true" tabindex="-1"></a>fitE2 <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;exp&quot;</span>)</span>
<span id="cb781-2"><a href="mod-r-dist-fit.html#cb781-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitE2)</span>
<span id="cb781-3"><a href="mod-r-dist-fit.html#cb781-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; exp &#39; by maximum likelihood </span></span>
<span id="cb781-4"><a href="mod-r-dist-fit.html#cb781-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb781-5"><a href="mod-r-dist-fit.html#cb781-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      estimate Std. Error</span></span>
<span id="cb781-6"><a href="mod-r-dist-fit.html#cb781-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rate    0.136     0.0112</span></span>
<span id="cb781-7"><a href="mod-r-dist-fit.html#cb781-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -444   AIC:  889   BIC:  892</span></span>
<span id="cb781-8"><a href="mod-r-dist-fit.html#cb781-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))  <span class="co"># 4 plots in one figure</span></span>
<span id="cb781-9"><a href="mod-r-dist-fit.html#cb781-9" aria-hidden="true" tabindex="-1"></a>pLegend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;exp&quot;</span>)</span>
<span id="cb781-10"><a href="mod-r-dist-fit.html#cb781-10" aria-hidden="true" tabindex="-1"></a>lst <span class="ot">&lt;-</span> <span class="fu">list</span>(fitE2)</span>
<span id="cb781-11"><a href="mod-r-dist-fit.html#cb781-11" aria-hidden="true" tabindex="-1"></a><span class="fu">denscomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb781-12"><a href="mod-r-dist-fit.html#cb781-12" aria-hidden="true" tabindex="-1"></a><span class="fu">qqcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb781-13"><a href="mod-r-dist-fit.html#cb781-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cdfcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb781-14"><a href="mod-r-dist-fit.html#cb781-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ppcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-679"></span>
<img src="TFA_files/figure-html/unnamed-chunk-679-1.png" alt="Four Goodness-of-fit plots for various distributions fitted to the breakdown data." width="100%" />
<p class="caption">
Figure 15.7: Four Goodness-of-fit plots for various distributions fitted to the breakdown data.
</p>
</div>
<p>Again the fit seems okay.</p>
<p>To summarize the demand rate for product 1 is estimated to be 0.2 per day and for product 2 to be 0.14 per day.</p>
<p>Given a demand arrive the question is how much is the demand size? That is, we have to fit a distribution to the demand. Let us do the analysis for product 2:</p>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="mod-r-dist-fit.html#cb782-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> datDf <span class="sc">%&gt;%</span> </span>
<span id="cb782-2"><a href="mod-r-dist-fit.html#cb782-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb782-3"><a href="mod-r-dist-fit.html#cb782-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(demand)</span>
<span id="cb782-4"><a href="mod-r-dist-fit.html#cb782-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotdist</span>(dat, <span class="at">histo =</span> <span class="cn">TRUE</span>, <span class="at">demp =</span> <span class="cn">TRUE</span>, <span class="at">discrete =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-680-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Let us try to fit the negative binomial, Poisson and geometric distribution:</p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="mod-r-dist-fit.html#cb783-1" aria-hidden="true" tabindex="-1"></a>fitN2 <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;nbinom&quot;</span>)</span>
<span id="cb783-2"><a href="mod-r-dist-fit.html#cb783-2" aria-hidden="true" tabindex="-1"></a>fitP2 <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;pois&quot;</span>)</span>
<span id="cb783-3"><a href="mod-r-dist-fit.html#cb783-3" aria-hidden="true" tabindex="-1"></a>fitG2 <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;geom&quot;</span>)</span>
<span id="cb783-4"><a href="mod-r-dist-fit.html#cb783-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitN2)</span>
<span id="cb783-5"><a href="mod-r-dist-fit.html#cb783-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; nbinom &#39; by maximum likelihood </span></span>
<span id="cb783-6"><a href="mod-r-dist-fit.html#cb783-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb783-7"><a href="mod-r-dist-fit.html#cb783-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      estimate Std. Error</span></span>
<span id="cb783-8"><a href="mod-r-dist-fit.html#cb783-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; size     3.83      0.939</span></span>
<span id="cb783-9"><a href="mod-r-dist-fit.html#cb783-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu       3.19      0.198</span></span>
<span id="cb783-10"><a href="mod-r-dist-fit.html#cb783-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -321   AIC:  645   BIC:  651 </span></span>
<span id="cb783-11"><a href="mod-r-dist-fit.html#cb783-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation matrix:</span></span>
<span id="cb783-12"><a href="mod-r-dist-fit.html#cb783-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           size        mu</span></span>
<span id="cb783-13"><a href="mod-r-dist-fit.html#cb783-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; size  1.000000 -0.000436</span></span>
<span id="cb783-14"><a href="mod-r-dist-fit.html#cb783-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu   -0.000436  1.000000</span></span>
<span id="cb783-15"><a href="mod-r-dist-fit.html#cb783-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitP2)</span>
<span id="cb783-16"><a href="mod-r-dist-fit.html#cb783-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; pois &#39; by maximum likelihood </span></span>
<span id="cb783-17"><a href="mod-r-dist-fit.html#cb783-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb783-18"><a href="mod-r-dist-fit.html#cb783-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        estimate Std. Error</span></span>
<span id="cb783-19"><a href="mod-r-dist-fit.html#cb783-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lambda     3.19      0.146</span></span>
<span id="cb783-20"><a href="mod-r-dist-fit.html#cb783-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -340   AIC:  683   BIC:  686</span></span>
<span id="cb783-21"><a href="mod-r-dist-fit.html#cb783-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitG2)</span>
<span id="cb783-22"><a href="mod-r-dist-fit.html#cb783-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; geom &#39; by maximum likelihood </span></span>
<span id="cb783-23"><a href="mod-r-dist-fit.html#cb783-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb783-24"><a href="mod-r-dist-fit.html#cb783-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      estimate Std. Error</span></span>
<span id="cb783-25"><a href="mod-r-dist-fit.html#cb783-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; prob    0.239     0.0171</span></span>
<span id="cb783-26"><a href="mod-r-dist-fit.html#cb783-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -343   AIC:  688   BIC:  691</span></span>
<span id="cb783-27"><a href="mod-r-dist-fit.html#cb783-27" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) </span>
<span id="cb783-28"><a href="mod-r-dist-fit.html#cb783-28" aria-hidden="true" tabindex="-1"></a>pLegend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;neg binomial&quot;</span>, <span class="st">&quot;Poisson&quot;</span>, <span class="st">&quot;geometric&quot;</span>)</span>
<span id="cb783-29"><a href="mod-r-dist-fit.html#cb783-29" aria-hidden="true" tabindex="-1"></a>lst <span class="ot">&lt;-</span> <span class="fu">list</span>(fitN2, fitP2, fitG2)</span>
<span id="cb783-30"><a href="mod-r-dist-fit.html#cb783-30" aria-hidden="true" tabindex="-1"></a><span class="fu">denscomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb783-31"><a href="mod-r-dist-fit.html#cb783-31" aria-hidden="true" tabindex="-1"></a><span class="fu">cdfcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-681"></span>
<img src="TFA_files/figure-html/unnamed-chunk-681-1.png" alt="Four Goodness-of-fit plots for various distributions fitted to the breakdown data." width="100%" />
<p class="caption">
Figure 15.8: Four Goodness-of-fit plots for various distributions fitted to the breakdown data.
</p>
</div>
<p>The negative binomial seems to give the best fit and may be a good candidate.</p>
</div>
<div id="rc-r-dist-fit" class="section level2 hasAnchor" number="15.6">
<h2><span class="header-section-number">15.6</span> Recap<a href="mod-r-dist-fit.html#rc-r-dist-fit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Fitting distributions to data is a very common task in statistics and consists in choosing a probability distribution modelling the random variable, as well as finding parameter estimates for that distribution.</li>
<li>Fitting a univariate distribution requires judgment and expertise and generally needs an iterative process of distribution choice, parameter estimation, and quality of fit assessment. Steps may be:
<ul>
<li>Examine data a decide on discrete vs continuous distribution.</li>
<li>Find a set of candidate distributions.</li>
<li>Fit the distributions using statistical methods and consider various plots.</li>
<li>Decide on a distribution</li>
</ul></li>
<li>The AIC value may give you an indication about the best model fit.</li>
<li>Other methods can be used to fit distributions to the data instead of maximum likelihood. For details see <span class="citation">Delignette-Muller and Dutang (<a href="#ref-DelignetteMuller15" role="doc-biblioref">2015</a>)</span>.</li>
<li>This module have only considered uncensored data. See <span class="citation">Delignette-Muller and Dutang (<a href="#ref-DelignetteMuller15" role="doc-biblioref">2015</a>)</span> on how to handle censored data.</li>
</ul>
<div>
You may also have a look at the
<a href="https://bss-osca.github.io/tfa/slides/15_r-dist-fit-slides.html" target="_blank">slides for this module</a>
.
</div>
</div>
<div id="ex-r-dist-fit" class="section level2 hasAnchor" number="15.7">
<h2><span class="header-section-number">15.7</span> Exercises<a href="mod-r-dist-fit.html#ex-r-dist-fit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Below you will find a set of exercises. Always have a look at the exercises before you meet in your study group and try to solve them yourself. Are you stuck, see the <a href="help.html#help">help page</a>. Some of the solutions to each exercise can be seen by pressing the button at each question. Beware, you will not learn by giving up too early. Put some effort into finding a solution! Always practice using shortcuts in RStudio (see <strong>Tools &gt; Keyboard Shortcuts Help</strong>).</p>
<p>Go to the <a href="https://posit.cloud/spaces/426101/join?access_code=GVlexpHQRCXUAiqRiC9ux_KgoAXUyilsrVtxjaB8">Tools for Analytics</a> workspace and download/export the TM15 project. Open it on your laptop and have a look at the files in the <code>exercises</code> folder which can be used as a starting point.</p>
<div id="exercise---call-center" class="section level3 hasAnchor" number="15.7.1">
<h3><span class="header-section-number">15.7.1</span> Exercise - Call center<a href="mod-r-dist-fit.html#exercise---call-center" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider data from a call center: the Los Angeles 311 Call Center in 2014 from 8-17:</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="mod-r-dist-fit.html#cb784-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb784-2"><a href="mod-r-dist-fit.html#cb784-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tfa)</span>
<span id="cb784-3"><a href="mod-r-dist-fit.html#cb784-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb784-4"><a href="mod-r-dist-fit.html#cb784-4" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(calls)</span></code></pre></div>
<table style="width: auto;" class="table table-condensed">
<caption>
<span id="tab:unnamed-chunk-683">Table 15.1: </span>Data summary
</caption>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
calls
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
855077
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
difftime
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
POSIXct
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
empty
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:right;">
whitespace
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
department
</td>
<td style="text-align:right;">
79892
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
service
</td>
<td style="text-align:right;">
79892
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1304
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
solved_how
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: difftime</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:left;">
min
</th>
<th style="text-align:left;">
max
</th>
<th style="text-align:left;">
median
</th>
<th style="text-align:right;">
n_unique
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
time
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
28800 secs
</td>
<td style="text-align:left;">
61200 secs
</td>
<td style="text-align:left;">
12:00:10
</td>
<td style="text-align:right;">
31964
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
zip
</td>
<td style="text-align:right;">
19512
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
91653
</td>
<td style="text-align:right;">
5420
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
90029
</td>
<td style="text-align:right;">
90094
</td>
<td style="text-align:right;">
91403
</td>
<td style="text-align:right;">
99999
</td>
<td style="text-align:left;">
▁▁▁▁▇
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: POSIXct</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:left;">
min
</th>
<th style="text-align:left;">
max
</th>
<th style="text-align:left;">
median
</th>
<th style="text-align:right;">
n_unique
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
date
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2014-01-01
</td>
<td style="text-align:left;">
2014-12-31
</td>
<td style="text-align:left;">
2014-07-04
</td>
<td style="text-align:right;">
363
</td>
</tr>
</tbody>
</table>
<p>We first transform the dataset a bit:</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="mod-r-dist-fit.html#cb785-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb785-2"><a href="mod-r-dist-fit.html#cb785-2" aria-hidden="true" tabindex="-1"></a>calls <span class="ot">&lt;-</span> calls <span class="sc">%&gt;%</span></span>
<span id="cb785-3"><a href="mod-r-dist-fit.html#cb785-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span> </span>
<span id="cb785-4"><a href="mod-r-dist-fit.html#cb785-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date, time) <span class="sc">%&gt;%</span> </span>
<span id="cb785-5"><a href="mod-r-dist-fit.html#cb785-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb785-6"><a href="mod-r-dist-fit.html#cb785-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrival =</span> <span class="fu">row_number</span>(),</span>
<span id="cb785-7"><a href="mod-r-dist-fit.html#cb785-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">wday =</span> <span class="fu">wday</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb785-8"><a href="mod-r-dist-fit.html#cb785-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">hour =</span> <span class="fu">hour</span>(time),</span>
<span id="cb785-9"><a href="mod-r-dist-fit.html#cb785-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">between =</span> time <span class="sc">-</span> <span class="fu">lag</span>(time)</span>
<span id="cb785-10"><a href="mod-r-dist-fit.html#cb785-10" aria-hidden="true" tabindex="-1"></a>  ) </span></code></pre></div>
<div id="solution-NGXQaRmfANqr59nTe1ggBY5my5hIC7lT2CZN4rAx" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-NGXQaRmfANqr59nTe1ggBY5my5hIC7lT2CZN4rAx-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-NGXQaRmfANqr59nTe1ggBY5my5hIC7lT2CZN4rAx-title1">
Solution
</h4>
</div>
<div class="modal-body">
<p>
<code>arrival</code> = number of arrivals on the given day, <code>wday</code> = weekday, <code>hour</code> = hour considered, <code>between</code> = time between calls in secs (inter arrival times).
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-NGXQaRmfANqr59nTe1ggBY5my5hIC7lT2CZN4rAx">
Solution
</button>
<ol style="list-style-type: decimal">
<li>Explain the new columns.</li>
</ol>
<p>The number of calls may follow a Poisson process with a fixed rate of calls per hour during the day. Let us try to plot the hourly rates:</p>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="mod-r-dist-fit.html#cb786-1" aria-hidden="true" tabindex="-1"></a>calls <span class="sc">%&gt;%</span> </span>
<span id="cb786-2"><a href="mod-r-dist-fit.html#cb786-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(date, hour, wday) <span class="sc">%&gt;%</span> </span>
<span id="cb786-3"><a href="mod-r-dist-fit.html#cb786-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hour, wday) <span class="sc">%&gt;%</span> </span>
<span id="cb786-4"><a href="mod-r-dist-fit.html#cb786-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">rate =</span> <span class="fu">mean</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb786-5"><a href="mod-r-dist-fit.html#cb786-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hour, <span class="at">y =</span> rate)) <span class="sc">+</span> </span>
<span id="cb786-6"><a href="mod-r-dist-fit.html#cb786-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb786-7"><a href="mod-r-dist-fit.html#cb786-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>wday) <span class="sc">+</span> </span>
<span id="cb786-8"><a href="mod-r-dist-fit.html#cb786-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;calls/hour&quot;</span>)</span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-686-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="solution-A1B5ysdW89EkZ7JR2dumrkNhceTpvMM84e5eUqB9" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-A1B5ysdW89EkZ7JR2dumrkNhceTpvMM84e5eUqB9-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-A1B5ysdW89EkZ7JR2dumrkNhceTpvMM84e5eUqB9-title1">
Solution
</h4>
</div>
<div class="modal-body">
<p>
As can be seen the rate is not constaint over the day (we don’t have a homogeneous Possion process). Moreover, in weekends the rate is much lower.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-A1B5ysdW89EkZ7JR2dumrkNhceTpvMM84e5eUqB9">
Solution
</button>
<ol start="2" style="list-style-type: decimal">
<li>Is the rate constant during a day and is the rate the same for different weekdays (explain)?</li>
</ol>
<p>Since the rate is not fixed we may have a non-homogeneous Poisson process where the rate change during the day. Hence let us try to consider an specific hour and test if the rate here can be considered as fixed (i.e. we have a Poisson process with a fixed rate when considering a specific hour)</p>
<div id="solution-kdIKgkisEn898BsGZfVERagrqhntdXNbrAZjK2k5" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-kdIKgkisEn898BsGZfVERagrqhntdXNbrAZjK2k5-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-kdIKgkisEn898BsGZfVERagrqhntdXNbrAZjK2k5-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="mod-r-dist-fit.html#cb787-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fitdistrplus)</span>
<span id="cb787-2"><a href="mod-r-dist-fit.html#cb787-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> calls <span class="sc">%&gt;%</span> </span>
<span id="cb787-3"><a href="mod-r-dist-fit.html#cb787-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb787-4"><a href="mod-r-dist-fit.html#cb787-4" aria-hidden="true" tabindex="-1"></a>    wday <span class="sc">==</span> <span class="st">&quot;Tue&quot;</span>,</span>
<span id="cb787-5"><a href="mod-r-dist-fit.html#cb787-5" aria-hidden="true" tabindex="-1"></a>    hour <span class="sc">==</span> <span class="dv">10</span>,</span>
<span id="cb787-6"><a href="mod-r-dist-fit.html#cb787-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(between)) <span class="sc">%&gt;%</span> </span>
<span id="cb787-7"><a href="mod-r-dist-fit.html#cb787-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(between) <span class="sc">%&gt;%</span> </span>
<span id="cb787-8"><a href="mod-r-dist-fit.html#cb787-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>() </span>
<span id="cb787-9"><a href="mod-r-dist-fit.html#cb787-9" aria-hidden="true" tabindex="-1"></a><span class="fu">descdist</span>(dat)</span>
<span id="cb787-10"><a href="mod-r-dist-fit.html#cb787-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; summary statistics</span></span>
<span id="cb787-11"><a href="mod-r-dist-fit.html#cb787-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb787-12"><a href="mod-r-dist-fit.html#cb787-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; min:  1   max:  98 </span></span>
<span id="cb787-13"><a href="mod-r-dist-fit.html#cb787-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; median:  6 </span></span>
<span id="cb787-14"><a href="mod-r-dist-fit.html#cb787-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean:  9.01 </span></span>
<span id="cb787-15"><a href="mod-r-dist-fit.html#cb787-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated sd:  8.35 </span></span>
<span id="cb787-16"><a href="mod-r-dist-fit.html#cb787-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated skewness:  1.95 </span></span>
<span id="cb787-17"><a href="mod-r-dist-fit.html#cb787-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated kurtosis:  8.73</span></span>
<span id="cb787-18"><a href="mod-r-dist-fit.html#cb787-18" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;exp&quot;</span>)</span>
<span id="cb787-19"><a href="mod-r-dist-fit.html#cb787-19" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;lnorm&quot;</span>)</span>
<span id="cb787-20"><a href="mod-r-dist-fit.html#cb787-20" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb787-21"><a href="mod-r-dist-fit.html#cb787-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span>
<span id="cb787-22"><a href="mod-r-dist-fit.html#cb787-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; exp &#39; by maximum likelihood </span></span>
<span id="cb787-23"><a href="mod-r-dist-fit.html#cb787-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb787-24"><a href="mod-r-dist-fit.html#cb787-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      estimate Std. Error</span></span>
<span id="cb787-25"><a href="mod-r-dist-fit.html#cb787-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rate    0.111    0.00077</span></span>
<span id="cb787-26"><a href="mod-r-dist-fit.html#cb787-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -66456   AIC:  132914   BIC:  132922</span></span>
<span id="cb787-27"><a href="mod-r-dist-fit.html#cb787-27" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span>
<span id="cb787-28"><a href="mod-r-dist-fit.html#cb787-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; lnorm &#39; by maximum likelihood </span></span>
<span id="cb787-29"><a href="mod-r-dist-fit.html#cb787-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb787-30"><a href="mod-r-dist-fit.html#cb787-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         estimate Std. Error</span></span>
<span id="cb787-31"><a href="mod-r-dist-fit.html#cb787-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; meanlog    1.779    0.00673</span></span>
<span id="cb787-32"><a href="mod-r-dist-fit.html#cb787-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sdlog      0.971    0.00476</span></span>
<span id="cb787-33"><a href="mod-r-dist-fit.html#cb787-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -65826   AIC:  131657   BIC:  131673 </span></span>
<span id="cb787-34"><a href="mod-r-dist-fit.html#cb787-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation matrix:</span></span>
<span id="cb787-35"><a href="mod-r-dist-fit.html#cb787-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           meanlog     sdlog</span></span>
<span id="cb787-36"><a href="mod-r-dist-fit.html#cb787-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; meanlog  1.00e+00 -1.17e-10</span></span>
<span id="cb787-37"><a href="mod-r-dist-fit.html#cb787-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sdlog   -1.17e-10  1.00e+00</span></span>
<span id="cb787-38"><a href="mod-r-dist-fit.html#cb787-38" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3)</span>
<span id="cb787-39"><a href="mod-r-dist-fit.html#cb787-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; gamma &#39; by maximum likelihood </span></span>
<span id="cb787-40"><a href="mod-r-dist-fit.html#cb787-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb787-41"><a href="mod-r-dist-fit.html#cb787-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       estimate Std. Error</span></span>
<span id="cb787-42"><a href="mod-r-dist-fit.html#cb787-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; shape    1.334    0.01180</span></span>
<span id="cb787-43"><a href="mod-r-dist-fit.html#cb787-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rate     0.148    0.00158</span></span>
<span id="cb787-44"><a href="mod-r-dist-fit.html#cb787-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -65966   AIC:  131936   BIC:  131952 </span></span>
<span id="cb787-45"><a href="mod-r-dist-fit.html#cb787-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation matrix:</span></span>
<span id="cb787-46"><a href="mod-r-dist-fit.html#cb787-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       shape  rate</span></span>
<span id="cb787-47"><a href="mod-r-dist-fit.html#cb787-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; shape 1.000 0.827</span></span>
<span id="cb787-48"><a href="mod-r-dist-fit.html#cb787-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rate  0.827 1.000</span></span>
<span id="cb787-49"><a href="mod-r-dist-fit.html#cb787-49" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))  <span class="co"># 4 plots in one figure</span></span>
<span id="cb787-50"><a href="mod-r-dist-fit.html#cb787-50" aria-hidden="true" tabindex="-1"></a>pLegend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;exp&quot;</span>, <span class="st">&quot;lnorm&quot;</span>, <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb787-51"><a href="mod-r-dist-fit.html#cb787-51" aria-hidden="true" tabindex="-1"></a>lst <span class="ot">&lt;-</span> <span class="fu">list</span>(fit1, fit2, fit3)</span>
<span id="cb787-52"><a href="mod-r-dist-fit.html#cb787-52" aria-hidden="true" tabindex="-1"></a><span class="fu">denscomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb787-53"><a href="mod-r-dist-fit.html#cb787-53" aria-hidden="true" tabindex="-1"></a><span class="fu">qqcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb787-54"><a href="mod-r-dist-fit.html#cb787-54" aria-hidden="true" tabindex="-1"></a><span class="fu">cdfcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb787-55"><a href="mod-r-dist-fit.html#cb787-55" aria-hidden="true" tabindex="-1"></a><span class="fu">ppcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span></code></pre></div>
<img src="TFA_files/figure-html/unnamed-chunk-688-1.png" width="672" style="display: block; margin: auto;" /><img src="TFA_files/figure-html/unnamed-chunk-688-2.png" width="672" style="display: block; margin: auto;" />
<p>
For a Poisson process the inter arrival times should follow an exponential distribution. It seems to be a good fit here.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-kdIKgkisEn898BsGZfVERagrqhntdXNbrAZjK2k5">
Solution
</button>
<div id="hint-dd2BreR6OVh2wgn2ibdVUpWzo2oMiF" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-dd2BreR6OVh2wgn2ibdVUpWzo2oMiF-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-dd2BreR6OVh2wgn2ibdVUpWzo2oMiF-title1">
Hint
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="mod-r-dist-fit.html#cb788-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fitdistrplus)</span>
<span id="cb788-2"><a href="mod-r-dist-fit.html#cb788-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> calls <span class="sc">%&gt;%</span> </span>
<span id="cb788-3"><a href="mod-r-dist-fit.html#cb788-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb788-4"><a href="mod-r-dist-fit.html#cb788-4" aria-hidden="true" tabindex="-1"></a>    wday <span class="sc">==</span> ___,</span>
<span id="cb788-5"><a href="mod-r-dist-fit.html#cb788-5" aria-hidden="true" tabindex="-1"></a>    hour <span class="sc">==</span> ___</span>
<span id="cb788-6"><a href="mod-r-dist-fit.html#cb788-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(between)) <span class="sc">%&gt;%</span> </span>
<span id="cb788-7"><a href="mod-r-dist-fit.html#cb788-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(between) <span class="sc">%&gt;%</span> </span>
<span id="cb788-8"><a href="mod-r-dist-fit.html#cb788-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb788-9"><a href="mod-r-dist-fit.html#cb788-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span>
<span id="cb788-10"><a href="mod-r-dist-fit.html#cb788-10" aria-hidden="true" tabindex="-1"></a><span class="fu">descdist</span>(dat)</span>
<span id="cb788-11"><a href="mod-r-dist-fit.html#cb788-11" aria-hidden="true" tabindex="-1"></a>___ <span class="co"># try to fit the exp, lnorm and gamma</span></span></code></pre></div>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-dd2BreR6OVh2wgn2ibdVUpWzo2oMiF">
Hint
</button>
<ol start="3" style="list-style-type: decimal">
<li>Consider Tuesdays from 10-11 and fit the inter arrival times (<code>between</code>). If the data follow a Poisson process then the distribution should be?</li>
</ol>
<div id="solution-lFk6mg6azhNxW2fcQOlLTFeQhpmC3N0fzf3x2NtQ" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-lFk6mg6azhNxW2fcQOlLTFeQhpmC3N0fzf3x2NtQ-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-lFk6mg6azhNxW2fcQOlLTFeQhpmC3N0fzf3x2NtQ-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="mod-r-dist-fit.html#cb789-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fitdistrplus)</span>
<span id="cb789-2"><a href="mod-r-dist-fit.html#cb789-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> calls <span class="sc">%&gt;%</span> </span>
<span id="cb789-3"><a href="mod-r-dist-fit.html#cb789-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb789-4"><a href="mod-r-dist-fit.html#cb789-4" aria-hidden="true" tabindex="-1"></a>    wday <span class="sc">==</span> <span class="st">&quot;Tue&quot;</span>,</span>
<span id="cb789-5"><a href="mod-r-dist-fit.html#cb789-5" aria-hidden="true" tabindex="-1"></a>    hour <span class="sc">==</span> <span class="dv">15</span>,</span>
<span id="cb789-6"><a href="mod-r-dist-fit.html#cb789-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(between)) <span class="sc">%&gt;%</span> </span>
<span id="cb789-7"><a href="mod-r-dist-fit.html#cb789-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(between) <span class="sc">%&gt;%</span> </span>
<span id="cb789-8"><a href="mod-r-dist-fit.html#cb789-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>() </span>
<span id="cb789-9"><a href="mod-r-dist-fit.html#cb789-9" aria-hidden="true" tabindex="-1"></a><span class="fu">descdist</span>(dat)</span>
<span id="cb789-10"><a href="mod-r-dist-fit.html#cb789-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; summary statistics</span></span>
<span id="cb789-11"><a href="mod-r-dist-fit.html#cb789-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ------</span></span>
<span id="cb789-12"><a href="mod-r-dist-fit.html#cb789-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; min:  1   max:  103 </span></span>
<span id="cb789-13"><a href="mod-r-dist-fit.html#cb789-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; median:  7 </span></span>
<span id="cb789-14"><a href="mod-r-dist-fit.html#cb789-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean:  9.99 </span></span>
<span id="cb789-15"><a href="mod-r-dist-fit.html#cb789-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated sd:  9.41 </span></span>
<span id="cb789-16"><a href="mod-r-dist-fit.html#cb789-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated skewness:  2.01 </span></span>
<span id="cb789-17"><a href="mod-r-dist-fit.html#cb789-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; estimated kurtosis:  9.13</span></span>
<span id="cb789-18"><a href="mod-r-dist-fit.html#cb789-18" aria-hidden="true" tabindex="-1"></a>fit12 <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;exp&quot;</span>)</span>
<span id="cb789-19"><a href="mod-r-dist-fit.html#cb789-19" aria-hidden="true" tabindex="-1"></a>fit22 <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;lnorm&quot;</span>)</span>
<span id="cb789-20"><a href="mod-r-dist-fit.html#cb789-20" aria-hidden="true" tabindex="-1"></a>fit32 <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(dat, <span class="at">distr =</span> <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb789-21"><a href="mod-r-dist-fit.html#cb789-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit12)</span>
<span id="cb789-22"><a href="mod-r-dist-fit.html#cb789-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; exp &#39; by maximum likelihood </span></span>
<span id="cb789-23"><a href="mod-r-dist-fit.html#cb789-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb789-24"><a href="mod-r-dist-fit.html#cb789-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      estimate Std. Error</span></span>
<span id="cb789-25"><a href="mod-r-dist-fit.html#cb789-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rate      0.1   0.000731</span></span>
<span id="cb789-26"><a href="mod-r-dist-fit.html#cb789-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -61883   AIC:  123768   BIC:  123776</span></span>
<span id="cb789-27"><a href="mod-r-dist-fit.html#cb789-27" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit22)</span>
<span id="cb789-28"><a href="mod-r-dist-fit.html#cb789-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; lnorm &#39; by maximum likelihood </span></span>
<span id="cb789-29"><a href="mod-r-dist-fit.html#cb789-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb789-30"><a href="mod-r-dist-fit.html#cb789-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         estimate Std. Error</span></span>
<span id="cb789-31"><a href="mod-r-dist-fit.html#cb789-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; meanlog    1.872    0.00719</span></span>
<span id="cb789-32"><a href="mod-r-dist-fit.html#cb789-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sdlog      0.985    0.00509</span></span>
<span id="cb789-33"><a href="mod-r-dist-fit.html#cb789-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -61398   AIC:  122800   BIC:  122816 </span></span>
<span id="cb789-34"><a href="mod-r-dist-fit.html#cb789-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation matrix:</span></span>
<span id="cb789-35"><a href="mod-r-dist-fit.html#cb789-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           meanlog     sdlog</span></span>
<span id="cb789-36"><a href="mod-r-dist-fit.html#cb789-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; meanlog  1.00e+00 -3.33e-11</span></span>
<span id="cb789-37"><a href="mod-r-dist-fit.html#cb789-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sdlog   -3.33e-11  1.00e+00</span></span>
<span id="cb789-38"><a href="mod-r-dist-fit.html#cb789-38" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit32)</span>
<span id="cb789-39"><a href="mod-r-dist-fit.html#cb789-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fitting of the distribution &#39; gamma &#39; by maximum likelihood </span></span>
<span id="cb789-40"><a href="mod-r-dist-fit.html#cb789-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters : </span></span>
<span id="cb789-41"><a href="mod-r-dist-fit.html#cb789-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       estimate Std. Error</span></span>
<span id="cb789-42"><a href="mod-r-dist-fit.html#cb789-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; shape    1.305    0.01214</span></span>
<span id="cb789-43"><a href="mod-r-dist-fit.html#cb789-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rate     0.131    0.00147</span></span>
<span id="cb789-44"><a href="mod-r-dist-fit.html#cb789-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loglikelihood:  -61501   AIC:  123007   BIC:  123022 </span></span>
<span id="cb789-45"><a href="mod-r-dist-fit.html#cb789-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation matrix:</span></span>
<span id="cb789-46"><a href="mod-r-dist-fit.html#cb789-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       shape  rate</span></span>
<span id="cb789-47"><a href="mod-r-dist-fit.html#cb789-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; shape 1.000 0.824</span></span>
<span id="cb789-48"><a href="mod-r-dist-fit.html#cb789-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rate  0.824 1.000</span></span>
<span id="cb789-49"><a href="mod-r-dist-fit.html#cb789-49" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))  <span class="co"># 4 plots in one figure</span></span>
<span id="cb789-50"><a href="mod-r-dist-fit.html#cb789-50" aria-hidden="true" tabindex="-1"></a>pLegend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;exp&quot;</span>, <span class="st">&quot;lnorm&quot;</span>, <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb789-51"><a href="mod-r-dist-fit.html#cb789-51" aria-hidden="true" tabindex="-1"></a>lst <span class="ot">&lt;-</span> <span class="fu">list</span>(fit12, fit22, fit32)</span>
<span id="cb789-52"><a href="mod-r-dist-fit.html#cb789-52" aria-hidden="true" tabindex="-1"></a><span class="fu">denscomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb789-53"><a href="mod-r-dist-fit.html#cb789-53" aria-hidden="true" tabindex="-1"></a><span class="fu">qqcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb789-54"><a href="mod-r-dist-fit.html#cb789-54" aria-hidden="true" tabindex="-1"></a><span class="fu">cdfcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span>
<span id="cb789-55"><a href="mod-r-dist-fit.html#cb789-55" aria-hidden="true" tabindex="-1"></a><span class="fu">ppcomp</span>(lst, <span class="at">legendtext =</span> pLegend)</span></code></pre></div>
<p><img src="TFA_files/figure-html/unnamed-chunk-690-1.png" width="672" style="display: block; margin: auto;" /><img src="TFA_files/figure-html/unnamed-chunk-690-2.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-lFk6mg6azhNxW2fcQOlLTFeQhpmC3N0fzf3x2NtQ">
Solution
</button>
<ol start="4" style="list-style-type: decimal">
<li>Consider Tuesdays from 15-16 and fit the inter arrival times (<code>between</code>).</li>
</ol>
<div id="solution-S2ruSlDqc9OwDFAvUUCimYSCARFI69iR8BiUuZml" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="solution-S2ruSlDqc9OwDFAvUUCimYSCARFI69iR8BiUuZml-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="solution-S2ruSlDqc9OwDFAvUUCimYSCARFI69iR8BiUuZml-title1">
Solution
</h4>
</div>
<div class="modal-body">
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="mod-r-dist-fit.html#cb790-1" aria-hidden="true" tabindex="-1"></a>fit1<span class="sc">$</span>estimate <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="co"># 10-11</span></span>
<span id="cb790-2"><a href="mod-r-dist-fit.html#cb790-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rate </span></span>
<span id="cb790-3"><a href="mod-r-dist-fit.html#cb790-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  400</span></span>
<span id="cb790-4"><a href="mod-r-dist-fit.html#cb790-4" aria-hidden="true" tabindex="-1"></a>fit12<span class="sc">$</span>estimate <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="co"># 15-16</span></span>
<span id="cb790-5"><a href="mod-r-dist-fit.html#cb790-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rate </span></span>
<span id="cb790-6"><a href="mod-r-dist-fit.html#cb790-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  360</span></span></code></pre></div>
<p>
The rate is higher (40 calls more per hour) in period 10-11.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#solution-S2ruSlDqc9OwDFAvUUCimYSCARFI69iR8BiUuZml">
Solution
</button>
<div id="hint-hCDkNVwMnrYbhDC6NdKDpxCh70H9W6" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-hCDkNVwMnrYbhDC6NdKDpxCh70H9W6-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-hCDkNVwMnrYbhDC6NdKDpxCh70H9W6-title1">
Hint
</h4>
</div>
<div class="modal-body">
<p>
You have to look at the estimates of the rate.
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-hCDkNVwMnrYbhDC6NdKDpxCh70H9W6">
Hint
</button>
<ol start="5" style="list-style-type: decimal">
<li>What is the estimated arrival rate per hour Tuesday 10-11 and 15-16? Is the arrival rate the same?</li>
</ol>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Cullen99" class="csl-entry">
Cullen, A. C., and H. C. Frey. 1999. <em>The Use of Probabilistic Techniques in Exposure Assessment</em>. Plenum.
</div>
<div id="ref-DelignetteMuller15" class="csl-entry">
Delignette-Muller, Marie Laure, and Christophe Dutang. 2015. <span>“Fitdistrplus: An r Package for Fitting Distributions.”</span> <em>Journal of Statistical Software</em> 64 (4): 1–34. <a href="https://doi.org/10.18637/jss.v064.i04">https://doi.org/10.18637/jss.v064.i04</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mod-r-plot.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mod-r-maps.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/bss-osca/tfa/edit/master/book/15_r-dist-fit.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
