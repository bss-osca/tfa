<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 6 Generating random numbers | Tools for Analytics (TFA)</title>
  <meta name="description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 6 Generating random numbers | Tools for Analytics (TFA)" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bss-osca.github.io/tfa//assets/logo.png" />
  <meta property="og:description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="github-repo" content="bss-osca/tfa" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 6 Generating random numbers | Tools for Analytics (TFA)" />
  
  <meta name="twitter:description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="twitter:image" content="https://bss-osca.github.io/tfa//assets/logo.png" />

<meta name="author" content="Lars Relund Nielsen" />


<meta name="date" content="2024-12-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon" />
<link rel="prev" href="mod-vba-datatypes.html"/>
<link rel="next" href="mod-r-install.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.11/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<link href="libs/minichart-0.2.2/minicharts.css" rel="stylesheet" />
<script src="libs/minichart-0.2.2/leaflet.minicharts.min.js"></script>
<link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" />
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<html>
<head>
<script>
  $(document).ready(function() {

  // Section anchors
  $('.section h1, .section h2, .section h3, .section h4, .section h5').each(function() {
    anchor = '#' + $(this).parent().attr('id');
    $(this).addClass("hasAnchor").prepend('<a href="' + anchor + '" class="anchor"></a>');
  });
});
</script>
<script src="https://hypothes.is/embed.js" async></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</head>
</html>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="img/logo.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to the course</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#lo-intro"><i class="fa fa-check"></i><b>1.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.2</b> Purpose for the course</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#r-vs-vba"><i class="fa fa-check"></i><b>1.3</b> R vs Excel/VBA</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#computer"><i class="fa fa-check"></i><b>1.4</b> How a computer works</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i><b>1.5</b> How the notes are organized</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#ack"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#how-to-cite"><i class="fa fa-check"></i><b>1.7</b> How to cite</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#ex-intro"><i class="fa fa-check"></i><b>1.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="index.html"><a href="index.html#ex-annotate"><i class="fa fa-check"></i><b>1.8.1</b> Exercise - How to annotate</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I VBA</b></span></li>
<li class="chapter" data-level="2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html"><i class="fa fa-check"></i><b>2</b> An introduction to VBA</a>
<ul>
<li class="chapter" data-level="2.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#lo-vba-intro"><i class="fa fa-check"></i><b>2.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-what"><i class="fa fa-check"></i><b>2.2</b> What is VBA</a></li>
<li class="chapter" data-level="2.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-setup"><i class="fa fa-check"></i><b>2.3</b> Setup Excel for VBA</a></li>
<li class="chapter" data-level="2.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-hello"><i class="fa fa-check"></i><b>2.4</b> Your first program</a></li>
<li class="chapter" data-level="2.5" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-macro"><i class="fa fa-check"></i><b>2.5</b> The macro recorder</a></li>
<li class="chapter" data-level="2.6" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-overview"><i class="fa fa-check"></i><b>2.6</b> VBA - A short overview</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#variables"><i class="fa fa-check"></i><b>2.6.1</b> Variables</a></li>
<li class="chapter" data-level="2.6.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#procedures"><i class="fa fa-check"></i><b>2.6.2</b> Procedures</a></li>
<li class="chapter" data-level="2.6.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#input-and-output"><i class="fa fa-check"></i><b>2.6.3</b> Input and output</a></li>
<li class="chapter" data-level="2.6.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#conditional-statements"><i class="fa fa-check"></i><b>2.6.4</b> Conditional statements</a></li>
<li class="chapter" data-level="2.6.5" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#loops"><i class="fa fa-check"></i><b>2.6.5</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-coding-practice"><i class="fa fa-check"></i><b>2.7</b> Good coding pratice</a></li>
<li class="chapter" data-level="2.8" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#rc-vba-intro"><i class="fa fa-check"></i><b>2.8</b> Recap</a></li>
<li class="chapter" data-level="2.9" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-intro"><i class="fa fa-check"></i><b>2.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-hello"><i class="fa fa-check"></i><b>2.9.1</b> Exercise - Hello</a></li>
<li class="chapter" data-level="2.9.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-macro"><i class="fa fa-check"></i><b>2.9.2</b> Exercise - Record a macro</a></li>
<li class="chapter" data-level="2.9.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-user-input"><i class="fa fa-check"></i><b>2.9.3</b> Exercise - User input</a></li>
<li class="chapter" data-level="2.9.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-max-min"><i class="fa fa-check"></i><b>2.9.4</b> Exercise - Max and min number</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html"><i class="fa fa-check"></i><b>3</b> Loops and conditional statements</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#lo-vba-loops-cond"><i class="fa fa-check"></i><b>3.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.2" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-operators"><i class="fa fa-check"></i><b>3.2</b> Relational and logical operators</a></li>
<li class="chapter" data-level="3.3" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-loops"><i class="fa fa-check"></i><b>3.3</b> Loops</a></li>
<li class="chapter" data-level="3.4" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-cond"><i class="fa fa-check"></i><b>3.4</b> Conditional statements</a></li>
<li class="chapter" data-level="3.5" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-ex-jen"><i class="fa fa-check"></i><b>3.5</b> Example - Find Jen</a></li>
<li class="chapter" data-level="3.6" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-ex-dist-mat"><i class="fa fa-check"></i><b>3.6</b> Example - A distance matrix</a></li>
<li class="chapter" data-level="3.7" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#recap"><i class="fa fa-check"></i><b>3.7</b> Recap</a></li>
<li class="chapter" data-level="3.8" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-loops-cond"><i class="fa fa-check"></i><b>3.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-loops"><i class="fa fa-check"></i><b>3.8.1</b> Exercise - Loops</a></li>
<li class="chapter" data-level="3.8.2" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-cond"><i class="fa fa-check"></i><b>3.8.2</b> Exercise - Conditional statements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html"><i class="fa fa-check"></i><b>4</b> Procedures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#lo-vba-procedures"><i class="fa fa-check"></i><b>4.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="4.2" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-subs-functions"><i class="fa fa-check"></i><b>4.2</b> Subs and functions - The basics</a></li>
<li class="chapter" data-level="4.3" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-optional-arg"><i class="fa fa-check"></i><b>4.3</b> Optional arguments</a></li>
<li class="chapter" data-level="4.4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-pub-priv"><i class="fa fa-check"></i><b>4.4</b> Public and private procedures</a></li>
<li class="chapter" data-level="4.5" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-byref"><i class="fa fa-check"></i><b>4.5</b> Passing arguments by reference or by value</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#return-values-from-a-sub"><i class="fa fa-check"></i><b>4.5.1</b> Return values from a sub</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-built-in"><i class="fa fa-check"></i><b>4.6</b> Built-in functions</a></li>
<li class="chapter" data-level="4.7" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-test-persons"><i class="fa fa-check"></i><b>4.7</b> Example - Selection of test persons</a></li>
<li class="chapter" data-level="4.8" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#recap-1"><i class="fa fa-check"></i><b>4.8</b> Recap</a></li>
<li class="chapter" data-level="4.9" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-procedures"><i class="fa fa-check"></i><b>4.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-subs"><i class="fa fa-check"></i><b>4.9.1</b> Exercise - Subs</a></li>
<li class="chapter" data-level="4.9.2" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#exercise---temperatures"><i class="fa fa-check"></i><b>4.9.2</b> Exercise - Temperatures</a></li>
<li class="chapter" data-level="4.9.3" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-functions"><i class="fa fa-check"></i><b>4.9.3</b> Exercise - Functions</a></li>
<li class="chapter" data-level="4.9.4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-worksheet-functions"><i class="fa fa-check"></i><b>4.9.4</b> Exercise - Worksheet functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html"><i class="fa fa-check"></i><b>5</b> Advanced data types and usage</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#lo-vba-datatypes"><i class="fa fa-check"></i><b>5.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="5.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-strings"><i class="fa fa-check"></i><b>5.2</b> Strings</a></li>
<li class="chapter" data-level="5.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-objects"><i class="fa fa-check"></i><b>5.3</b> Objects</a></li>
<li class="chapter" data-level="5.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-wst"><i class="fa fa-check"></i><b>5.4</b> The Worksheet object</a></li>
<li class="chapter" data-level="5.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#wst-rng"><i class="fa fa-check"></i><b>5.5</b> The Range object</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#named-ranges-in-excel"><i class="fa fa-check"></i><b>5.5.1</b> Named ranges in Excel</a></li>
<li class="chapter" data-level="5.5.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#current-region-of-a-range"><i class="fa fa-check"></i><b>5.5.2</b> Current region of a range</a></li>
<li class="chapter" data-level="5.5.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#input-and-output-1"><i class="fa fa-check"></i><b>5.5.3</b> Input and output</a></li>
<li class="chapter" data-level="5.5.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#sorting-a-range"><i class="fa fa-check"></i><b>5.5.4</b> Sorting a range</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-ary"><i class="fa fa-check"></i><b>5.6</b> Arrays</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#multi-dimensional-arrays"><i class="fa fa-check"></i><b>5.6.1</b> Multi-dimensional arrays</a></li>
<li class="chapter" data-level="5.6.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#dynamic-arrays"><i class="fa fa-check"></i><b>5.6.2</b> Dynamic arrays</a></li>
<li class="chapter" data-level="5.6.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#input-and-output-2"><i class="fa fa-check"></i><b>5.6.3</b> Input and output</a></li>
<li class="chapter" data-level="5.6.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#sorting-arrays"><i class="fa fa-check"></i><b>5.6.4</b> Sorting arrays</a></li>
<li class="chapter" data-level="5.6.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#use-arrays-instead-of-ranges"><i class="fa fa-check"></i><b>5.6.5</b> Use arrays instead of ranges</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-coll"><i class="fa fa-check"></i><b>5.7</b> Collections</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#accessing-collections-using-keys"><i class="fa fa-check"></i><b>5.7.1</b> Accessing collections using keys</a></li>
<li class="chapter" data-level="5.7.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#collections-containing-objects"><i class="fa fa-check"></i><b>5.7.2</b> Collections containing objects</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-ex-job-seq"><i class="fa fa-check"></i><b>5.8</b> Example - Job sequencing</a></li>
<li class="chapter" data-level="5.9" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#recap-2"><i class="fa fa-check"></i><b>5.9</b> Recap</a></li>
<li class="chapter" data-level="5.10" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-datatypes"><i class="fa fa-check"></i><b>5.10</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-equal"><i class="fa fa-check"></i><b>5.10.1</b> Exercise - Equal entries</a></li>
<li class="chapter" data-level="5.10.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-products"><i class="fa fa-check"></i><b>5.10.2</b> Exercise - Product search</a></li>
<li class="chapter" data-level="5.10.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-read-collections"><i class="fa fa-check"></i><b>5.10.3</b> Exercise - Read collections</a></li>
<li class="chapter" data-level="5.10.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-read-arrays"><i class="fa fa-check"></i><b>5.10.4</b> Exercise - Read arrays</a></li>
<li class="chapter" data-level="5.10.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-process"><i class="fa fa-check"></i><b>5.10.5</b> Exercise - Process numbers</a></li>
<li class="chapter" data-level="5.10.6" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-pay"><i class="fa fa-check"></i><b>5.10.6</b> Exercise - Search payments</a></li>
<li class="chapter" data-level="5.10.7" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-flight"><i class="fa fa-check"></i><b>5.10.7</b> Exercise - Flight search</a></li>
<li class="chapter" data-level="5.10.8" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-table"><i class="fa fa-check"></i><b>5.10.8</b> Exercise - Search table</a></li>
<li class="chapter" data-level="5.10.9" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-next-task"><i class="fa fa-check"></i><b>5.10.9</b> Exercise - Find next task</a></li>
<li class="chapter" data-level="5.10.10" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-seat-reservation"><i class="fa fa-check"></i><b>5.10.10</b> Exercise - Seat reservation</a></li>
<li class="chapter" data-level="5.10.11" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-select"><i class="fa fa-check"></i><b>5.10.11</b> Exercise - Transform data (select and filter)</a></li>
<li class="chapter" data-level="5.10.12" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-mutate"><i class="fa fa-check"></i><b>5.10.12</b> Exercise - Transform data (arrange and mutate)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html"><i class="fa fa-check"></i><b>6</b> Generating random numbers</a>
<ul>
<li class="chapter" data-level="6.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#lo-vba-random-numbers"><i class="fa fa-check"></i><b>6.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="6.2" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#vba-random-numbers"><i class="fa fa-check"></i><b>6.2</b> Generating random numbers</a></li>
<li class="chapter" data-level="6.3" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#vba-simulation"><i class="fa fa-check"></i><b>6.3</b> Simulation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#sec-vba-tsp"><i class="fa fa-check"></i><b>6.3.1</b> Example - Traveling salesman problem</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#recap-3"><i class="fa fa-check"></i><b>6.4</b> Recap</a></li>
<li class="chapter" data-level="6.5" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-random-numbers"><i class="fa fa-check"></i><b>6.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-random-int"><i class="fa fa-check"></i><b>6.5.1</b> Exercise - Two random integers</a></li>
<li class="chapter" data-level="6.5.2" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-swap"><i class="fa fa-check"></i><b>6.5.2</b> Exercise - Swap entries</a></li>
<li class="chapter" data-level="6.5.3" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-bakery"><i class="fa fa-check"></i><b>6.5.3</b> Exercise - Dan’s bakery</a></li>
<li class="chapter" data-level="6.5.4" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-generate"><i class="fa fa-check"></i><b>6.5.4</b> Exercise - Generating random numbers</a></li>
<li class="chapter" data-level="6.5.5" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-stoc-functions"><i class="fa fa-check"></i><b>6.5.5</b> Exercise - Stochastic functions</a></li>
<li class="chapter" data-level="6.5.6" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-customer-demand"><i class="fa fa-check"></i><b>6.5.6</b> Exercise - Customer demand</a></li>
<li class="chapter" data-level="6.5.7" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-simple-game"><i class="fa fa-check"></i><b>6.5.7</b> Exercise - A simple game</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II R</b></span></li>
<li class="chapter" data-level="7" data-path="mod-r-install.html"><a href="mod-r-install.html"><i class="fa fa-check"></i><b>7</b> Setting up R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mod-r-install.html"><a href="mod-r-install.html#lo-r-install"><i class="fa fa-check"></i><b>7.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="7.2" data-path="mod-r-install.html"><a href="mod-r-install.html#r-install"><i class="fa fa-check"></i><b>7.2</b> Install R and RStudio</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="mod-r-install.html"><a href="mod-r-install.html#test-your-installation"><i class="fa fa-check"></i><b>7.2.1</b> Test your installation</a></li>
<li class="chapter" data-level="7.2.2" data-path="mod-r-install.html"><a href="mod-r-install.html#add-on-packages"><i class="fa fa-check"></i><b>7.2.2</b> Add-on packages</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="mod-r-install.html"><a href="mod-r-install.html#r-cloud"><i class="fa fa-check"></i><b>7.3</b> Setup and test Posit Cloud</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html"><i class="fa fa-check"></i><b>8</b> R basics and workflows</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#lo-r-workflow"><i class="fa fa-check"></i><b>8.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="8.2" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#working-with-r-at-the-command-line-in-rstudio"><i class="fa fa-check"></i><b>8.2</b> Working with R at the command line in RStudio</a></li>
<li class="chapter" data-level="8.3" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#your-first-datacamp-course"><i class="fa fa-check"></i><b>8.3</b> Your first DataCamp course</a></li>
<li class="chapter" data-level="8.4" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#pipes"><i class="fa fa-check"></i><b>8.4</b> Pipes</a></li>
<li class="chapter" data-level="8.5" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#rprojs"><i class="fa fa-check"></i><b>8.5</b> RStudio projects</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#storing-your-code-in-a-script-file"><i class="fa fa-check"></i><b>8.5.1</b> Storing your code in a script file</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#rc-r-workflow"><i class="fa fa-check"></i><b>8.6</b> Recap</a></li>
<li class="chapter" data-level="8.7" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#ex-r-workflow"><i class="fa fa-check"></i><b>8.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-group-work"><i class="fa fa-check"></i><b>8.7.1</b> Exercise (group work)</a></li>
<li class="chapter" data-level="8.7.2" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-piping"><i class="fa fa-check"></i><b>8.7.2</b> Exercise (piping)</a></li>
<li class="chapter" data-level="8.7.3" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-working-dir"><i class="fa fa-check"></i><b>8.7.3</b> Exercise (working dir)</a></li>
<li class="chapter" data-level="8.7.4" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-vectors"><i class="fa fa-check"></i><b>8.7.4</b> Exercise (vectors)</a></li>
<li class="chapter" data-level="8.7.5" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-matrices"><i class="fa fa-check"></i><b>8.7.5</b> Exercise (matrices)</a></li>
<li class="chapter" data-level="8.7.6" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-data-frames"><i class="fa fa-check"></i><b>8.7.6</b> Exercise (data frames)</a></li>
<li class="chapter" data-level="8.7.7" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-lists"><i class="fa fa-check"></i><b>8.7.7</b> Exercise (lists)</a></li>
<li class="chapter" data-level="8.7.8" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#ex-strings"><i class="fa fa-check"></i><b>8.7.8</b> Exercise (string management)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html"><i class="fa fa-check"></i><b>9</b> Loops and conditionals</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#lo-loops"><i class="fa fa-check"></i><b>9.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="9.2" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#r-dc-loops-cond"><i class="fa fa-check"></i><b>9.2</b> Conditionals and control flow</a></li>
<li class="chapter" data-level="9.3" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#r-loops"><i class="fa fa-check"></i><b>9.3</b> Loops</a></li>
<li class="chapter" data-level="9.4" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#rc-r-loops-cond"><i class="fa fa-check"></i><b>9.4</b> Recap</a></li>
<li class="chapter" data-level="9.5" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-loops-cond"><i class="fa fa-check"></i><b>9.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-conditional-expressions"><i class="fa fa-check"></i><b>9.5.1</b> Exercise (conditional expressions)</a></li>
<li class="chapter" data-level="9.5.2" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-loops"><i class="fa fa-check"></i><b>9.5.2</b> Exercise (loops)</a></li>
<li class="chapter" data-level="9.5.3" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-search-vector"><i class="fa fa-check"></i><b>9.5.3</b> Exercise (search vector)</a></li>
<li class="chapter" data-level="9.5.4" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-dist"><i class="fa fa-check"></i><b>9.5.4</b> Exercise (calculating distances)</a></li>
<li class="chapter" data-level="9.5.5" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-expand"><i class="fa fa-check"></i><b>9.5.5</b> Exercise (expand_grid)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mod-r-functions.html"><a href="mod-r-functions.html"><i class="fa fa-check"></i><b>10</b> Functions</a>
<ul>
<li class="chapter" data-level="10.1" data-path="mod-r-functions.html"><a href="mod-r-functions.html#lo-r-functions"><i class="fa fa-check"></i><b>10.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="10.2" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-dc-functions"><i class="fa fa-check"></i><b>10.2</b> DataCamp course</a></li>
<li class="chapter" data-level="10.3" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-extra"><i class="fa fa-check"></i><b>10.3</b> Functions returning multiple objects</a></li>
<li class="chapter" data-level="10.4" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-arg"><i class="fa fa-check"></i><b>10.4</b> The <code>...</code> argument</a></li>
<li class="chapter" data-level="10.5" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-doc"><i class="fa fa-check"></i><b>10.5</b> Documenting your functions</a></li>
<li class="chapter" data-level="10.6" data-path="mod-r-functions.html"><a href="mod-r-functions.html#example---job-sequencing"><i class="fa fa-check"></i><b>10.6</b> Example - Job sequencing</a></li>
<li class="chapter" data-level="10.7" data-path="mod-r-functions.html"><a href="mod-r-functions.html#rc-functions"><i class="fa fa-check"></i><b>10.7</b> Recap</a></li>
<li class="chapter" data-level="10.8" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-functions"><i class="fa fa-check"></i><b>10.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-def-func"><i class="fa fa-check"></i><b>10.8.1</b> Exercise (defining functions)</a></li>
<li class="chapter" data-level="10.8.2" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-euclidean-distances"><i class="fa fa-check"></i><b>10.8.2</b> Exercise (euclidean distances)</a></li>
<li class="chapter" data-level="10.8.3" data-path="mod-r-functions.html"><a href="mod-r-functions.html#exercise-scope"><i class="fa fa-check"></i><b>10.8.3</b> Exercise (scope)</a></li>
<li class="chapter" data-level="10.8.4" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-time-conversion"><i class="fa fa-check"></i><b>10.8.4</b> Exercise (time conversion)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html"><i class="fa fa-check"></i><b>11</b> Introduction to tidyverse and RMarkdown</a>
<ul>
<li class="chapter" data-level="11.1" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#lo-tidyverse-intro"><i class="fa fa-check"></i><b>11.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="11.2" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-tidyverse-intro"><i class="fa fa-check"></i><b>11.2</b> The tidyverse package</a></li>
<li class="chapter" data-level="11.3" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-markdown-intro"><i class="fa fa-check"></i><b>11.3</b> Writing reproducible reports</a></li>
<li class="chapter" data-level="11.4" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-tibbles-intro"><i class="fa fa-check"></i><b>11.4</b> Tibbles</a></li>
<li class="chapter" data-level="11.5" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#rc-tidyverse-intro"><i class="fa fa-check"></i><b>11.5</b> Recap</a></li>
<li class="chapter" data-level="11.6" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#ex-tidyverse-intro"><i class="fa fa-check"></i><b>11.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#exercise-your-first-rmarkdown-exercise"><i class="fa fa-check"></i><b>11.6.1</b> Exercise (your first RMarkdown exercise)</a></li>
<li class="chapter" data-level="11.6.2" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#exercise-tibbles"><i class="fa fa-check"></i><b>11.6.2</b> Exercise (tibbles)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mod-r-io.html"><a href="mod-r-io.html"><i class="fa fa-check"></i><b>12</b> Importing and exporting data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="mod-r-io.html"><a href="mod-r-io.html#lo-r-io"><i class="fa fa-check"></i><b>12.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="12.2" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-csv"><i class="fa fa-check"></i><b>12.2</b> CSV files</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="mod-r-io.html"><a href="mod-r-io.html#reading-a-csv-file"><i class="fa fa-check"></i><b>12.2.1</b> Reading a CSV file</a></li>
<li class="chapter" data-level="12.2.2" data-path="mod-r-io.html"><a href="mod-r-io.html#writing-to-csv-files"><i class="fa fa-check"></i><b>12.2.2</b> Writing to CSV files</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-excel"><i class="fa fa-check"></i><b>12.3</b> Excel</a></li>
<li class="chapter" data-level="12.4" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-google"><i class="fa fa-check"></i><b>12.4</b> Google Sheets</a></li>
<li class="chapter" data-level="12.5" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-text"><i class="fa fa-check"></i><b>12.5</b> Text files</a></li>
<li class="chapter" data-level="12.6" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-r"><i class="fa fa-check"></i><b>12.6</b> R’s native binary format</a></li>
<li class="chapter" data-level="12.7" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-json"><i class="fa fa-check"></i><b>12.7</b> Json</a></li>
<li class="chapter" data-level="12.8" data-path="mod-r-io.html"><a href="mod-r-io.html#rc-r-io"><i class="fa fa-check"></i><b>12.8</b> Recap</a></li>
<li class="chapter" data-level="12.9" data-path="mod-r-io.html"><a href="mod-r-io.html#ex-r-io"><i class="fa fa-check"></i><b>12.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="mod-r-io.html"><a href="mod-r-io.html#exercise-statistikbanken"><i class="fa fa-check"></i><b>12.9.1</b> Exercise (Statistikbanken)</a></li>
<li class="chapter" data-level="12.9.2" data-path="mod-r-io.html"><a href="mod-r-io.html#exercise-tuples-in-opl"><i class="fa fa-check"></i><b>12.9.2</b> Exercise (tuples in OPL)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="mod-r-transform.html"><a href="mod-r-transform.html"><i class="fa fa-check"></i><b>13</b> Transforming data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="mod-r-transform.html"><a href="mod-r-transform.html#lo-r-transform"><i class="fa fa-check"></i><b>13.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="13.2" data-path="mod-r-transform.html"><a href="mod-r-transform.html#r-transform-tidyverse"><i class="fa fa-check"></i><b>13.2</b> Working with data in the tidyverse</a></li>
<li class="chapter" data-level="13.3" data-path="mod-r-transform.html"><a href="mod-r-transform.html#r-transform-joins"><i class="fa fa-check"></i><b>13.3</b> Mutating joins</a></li>
<li class="chapter" data-level="13.4" data-path="mod-r-transform.html"><a href="mod-r-transform.html#rc-r-transform"><i class="fa fa-check"></i><b>13.4</b> Recap</a></li>
<li class="chapter" data-level="13.5" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-transform"><i class="fa fa-check"></i><b>13.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-gapminder1"><i class="fa fa-check"></i><b>13.5.1</b> Exercise (gapminder)</a></li>
<li class="chapter" data-level="13.5.2" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-babynames1"><i class="fa fa-check"></i><b>13.5.2</b> Exercise (babynames)</a></li>
<li class="chapter" data-level="13.5.3" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-profit1"><i class="fa fa-check"></i><b>13.5.3</b> Exercise (profit)</a></li>
<li class="chapter" data-level="13.5.4" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-fish"><i class="fa fa-check"></i><b>13.5.4</b> Exercise (fisheries)</a></li>
<li class="chapter" data-level="13.5.5" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-company"><i class="fa fa-check"></i><b>13.5.5</b> Exercise (company ranking)</a></li>
<li class="chapter" data-level="13.5.6" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-titanic"><i class="fa fa-check"></i><b>13.5.6</b> Exercise (Titanic)</a></li>
<li class="chapter" data-level="13.5.7" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-covid"><i class="fa fa-check"></i><b>13.5.7</b> Exercise (covid)</a></li>
<li class="chapter" data-level="13.5.8" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-election"><i class="fa fa-check"></i><b>13.5.8</b> Exercise (election)</a></li>
<li class="chapter" data-level="13.5.9" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-orders"><i class="fa fa-check"></i><b>13.5.9</b> Exercise (orders)</a></li>
<li class="chapter" data-level="13.5.10" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-jobs"><i class="fa fa-check"></i><b>13.5.10</b> Exercise (jobs)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="mod-r-plot.html"><a href="mod-r-plot.html"><i class="fa fa-check"></i><b>14</b> Data visualization using ggplot</a>
<ul>
<li class="chapter" data-level="14.1" data-path="mod-r-plot.html"><a href="mod-r-plot.html#lo-plot"><i class="fa fa-check"></i><b>14.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="14.2" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-intro"><i class="fa fa-check"></i><b>14.2</b> Introduction to data visualization</a></li>
<li class="chapter" data-level="14.3" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-multi"><i class="fa fa-check"></i><b>14.3</b> Combining plots into one using <em>patchwork</em></a></li>
<li class="chapter" data-level="14.4" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-save"><i class="fa fa-check"></i><b>14.4</b> Saving graphics</a></li>
<li class="chapter" data-level="14.5" data-path="mod-r-plot.html"><a href="mod-r-plot.html#rc-r-plot"><i class="fa fa-check"></i><b>14.5</b> Recap</a></li>
<li class="chapter" data-level="14.6" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-plot"><i class="fa fa-check"></i><b>14.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-gapminder2"><i class="fa fa-check"></i><b>14.6.1</b> Exercise (gapminder)</a></li>
<li class="chapter" data-level="14.6.2" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-profit2"><i class="fa fa-check"></i><b>14.6.2</b> Exercise (profit)</a></li>
<li class="chapter" data-level="14.6.3" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-covid19"><i class="fa fa-check"></i><b>14.6.3</b> Exercise (COVID-19)</a></li>
<li class="chapter" data-level="14.6.4" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-lego"><i class="fa fa-check"></i><b>14.6.4</b> Exercise (Lego and sales)</a></li>
<li class="chapter" data-level="14.6.5" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-company-plot"><i class="fa fa-check"></i><b>14.6.5</b> Exercise (company ranking)</a></li>
<li class="chapter" data-level="14.6.6" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-titanic-plot"><i class="fa fa-check"></i><b>14.6.6</b> Exercise (Titanic)</a></li>
<li class="chapter" data-level="14.6.7" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-covid-plot"><i class="fa fa-check"></i><b>14.6.7</b> Exercise (covid)</a></li>
<li class="chapter" data-level="14.6.8" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-election-plot"><i class="fa fa-check"></i><b>14.6.8</b> Exercise (election)</a></li>
<li class="chapter" data-level="14.6.9" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-orders-plot"><i class="fa fa-check"></i><b>14.6.9</b> Exercise (orders)</a></li>
<li class="chapter" data-level="14.6.10" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-nycflights"><i class="fa fa-check"></i><b>14.6.10</b> Exercise (New York flights)</a></li>
<li class="chapter" data-level="14.6.11" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-jobs-plot"><i class="fa fa-check"></i><b>14.6.11</b> Exercise (jobs)</a></li>
<li class="chapter" data-level="14.6.12" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-onecom"><i class="fa fa-check"></i><b>14.6.12</b> Exercise (OneCom)</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Extra R</b></span></li>
<li class="chapter" data-level="15" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html"><i class="fa fa-check"></i><b>15</b> Fitting probability distributions</a>
<ul>
<li class="chapter" data-level="15.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#lo-r-dist-fit"><i class="fa fa-check"></i><b>15.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="15.2" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-intro"><i class="fa fa-check"></i><b>15.2</b> Introduction</a></li>
<li class="chapter" data-level="15.3" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-cont"><i class="fa fa-check"></i><b>15.3</b> Fitting distributions to continuous data</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#example-breakdown-times"><i class="fa fa-check"></i><b>15.3.1</b> Example: breakdown times</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-discrete"><i class="fa fa-check"></i><b>15.4</b> Fitting distributions to discrete data</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#example-sales-of-lottery-tickets"><i class="fa fa-check"></i><b>15.4.1</b> Example: sales of lottery tickets</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-dist-fit-pois"><i class="fa fa-check"></i><b>15.5</b> The Poisson process</a></li>
<li class="chapter" data-level="15.6" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#rc-r-dist-fit"><i class="fa fa-check"></i><b>15.6</b> Recap</a></li>
<li class="chapter" data-level="15.7" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#ex-r-dist-fit"><i class="fa fa-check"></i><b>15.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#exercise---call-center"><i class="fa fa-check"></i><b>15.7.1</b> Exercise - Call center</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="mod-r-maps.html"><a href="mod-r-maps.html"><i class="fa fa-check"></i><b>16</b> Spatial data and maps</a>
<ul>
<li class="chapter" data-level="16.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#lo-maps"><i class="fa fa-check"></i><b>16.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="16.2" data-path="mod-r-maps.html"><a href="mod-r-maps.html#sec-map-api-key"><i class="fa fa-check"></i><b>16.2</b> Services for obtatining spatial data</a></li>
<li class="chapter" data-level="16.3" data-path="mod-r-maps.html"><a href="mod-r-maps.html#calculating-distances"><i class="fa fa-check"></i><b>16.3</b> Calculating distances</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#using-google-maps"><i class="fa fa-check"></i><b>16.3.1</b> Using Google Maps</a></li>
<li class="chapter" data-level="16.3.2" data-path="mod-r-maps.html"><a href="mod-r-maps.html#using-bing-maps"><i class="fa fa-check"></i><b>16.3.2</b> Using Bing Maps</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="mod-r-maps.html"><a href="mod-r-maps.html#geocoding-and-reverse-geocoding"><i class="fa fa-check"></i><b>16.4</b> Geocoding and reverse geocoding</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#using-google-maps-1"><i class="fa fa-check"></i><b>16.4.1</b> Using Google maps</a></li>
<li class="chapter" data-level="16.4.2" data-path="mod-r-maps.html"><a href="mod-r-maps.html#use-bing-maps"><i class="fa fa-check"></i><b>16.4.2</b> Use Bing Maps</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="mod-r-maps.html"><a href="mod-r-maps.html#adding-markers-and-routes-to-a-map"><i class="fa fa-check"></i><b>16.5</b> Adding markers and routes to a map</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="groups.html"><a href="groups.html"><i class="fa fa-check"></i><b>A</b> Working in groups</a>
<ul>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#using-git"><i class="fa fa-check"></i>Using Git together with GitHub</a>
<ul>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#register-a-free-github-account"><i class="fa fa-check"></i>Register a free GitHub account</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#install-git"><i class="fa fa-check"></i>Install Git</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#check-your-installation"><i class="fa fa-check"></i>Check your installation</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#setup-projects-using-git-and-github"><i class="fa fa-check"></i>Setup projects using Git and GitHub</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="annotate.html"><a href="annotate.html"><i class="fa fa-check"></i><b>B</b> Annotate the course notes</a></li>
<li class="chapter" data-level="C" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>C</b> Getting help</a></li>
<li class="chapter" data-level="D" data-path="coding-convention.html"><a href="coding-convention.html"><i class="fa fa-check"></i><b>D</b> Coding/naming convention</a>
<ul>
<li class="chapter" data-level="D.1" data-path="coding-convention.html"><a href="coding-convention.html#commenting-your-code"><i class="fa fa-check"></i><b>D.1</b> Commenting your code</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="apdx-vba.html"><a href="apdx-vba.html"><i class="fa fa-check"></i><b>E</b> VBA specific topics</a>
<ul>
<li class="chapter" data-level="E.1" data-path="apdx-vba.html"><a href="apdx-vba.html#vba-debug"><i class="fa fa-check"></i><b>E.1</b> Debugging your code</a></li>
<li class="chapter" data-level="E.2" data-path="apdx-vba.html"><a href="apdx-vba.html#error-handling"><i class="fa fa-check"></i><b>E.2</b> Error handling</a></li>
<li class="chapter" data-level="E.3" data-path="apdx-vba.html"><a href="apdx-vba.html#vba-course-procedures"><i class="fa fa-check"></i><b>E.3</b> Course procedures</a>
<ul>
<li class="chapter" data-level="E.3.1" data-path="apdx-vba.html"><a href="apdx-vba.html#detailed-descriptions-of-course-procedures"><i class="fa fa-check"></i><b>E.3.1</b> Detailed descriptions of course procedures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="F" data-path="lg-course.html"><a href="lg-course.html"><i class="fa fa-check"></i><b>F</b> Learning goals</a></li>
<li class="chapter" data-level="G" data-path="ba.html"><a href="ba.html"><i class="fa fa-check"></i><b>G</b> Business Analytics</a></li>
<li class="chapter" data-level="H" data-path="colophon.html"><a href="colophon.html"><i class="fa fa-check"></i><b>H</b> Colophon</a></li>
<li class="divider"></li>
<li><center>
  <a rel="license" href="./index.html#ack">
    License: CC BY-NC-SA<br>
    <i class = "fab fa-creative-commons fa-2x"></i>
    <i class = "fab fa-creative-commons-by fa-2x"></i>
    <i class = "fab fa-creative-commons-nc fa-2x"></i>
    <i class = "fab fa-creative-commons-sa fa-2x"></i>
  </a>
</li></center>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tools for Analytics (TFA)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod-vba-random-numbers" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Module 6</span> Generating random numbers<a href="mod-vba-random-numbers.html#mod-vba-random-numbers" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This module gives a short introduction on how to generate random numbers and using them in a simulation. Simulation studies that you do in Excel may be done easier using VBA together with Excel. For more advanced simulation studies you may use dedicated programs (such as Arena) or Excel plugins (such as @Risk).</p>
<div>
A template with VBA code is given in the file
<a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-template.xlsm" target="_blank">vba-template.xlsm</a>
(open it and use it while reading the notes). Have a look inside the module
<i>TM6_ex</i>
in the VBA editor for examples used in the notes and during lectures. Have a look at module
<i>TM6_exercises</i>
for exercises. Guiding answers for the exercises can be found in the file
<a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-solution.xlsm" target="_blank">vba-solution.xlsm</a>
.
</div>
<div id="learning-path-diagram-5" class="section level4 unnumbered hasAnchor">
<h4>Learning path diagram<a href="mod-vba-random-numbers.html#learning-path-diagram-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Click/hover the nodes to follow links and see details.</p>
<div id="htmlwidget-676e8a3c3b3d5631375f" style="width:100%;height:100px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-676e8a3c3b3d5631375f">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"💡 Random numbers\", URL = \"#vba-random-numbers\", tooltip = \"Random numbers (interactive)\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"2,1!\"] \n  \"2\" [label = \"💡 Simulation\", URL = \"#vba-simulation\", tooltip = \"Simulation (interactive)\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"5,1!\"] \n  \"3\" [label = \"💻 Exercises\", URL = \"#ex-vba-random-numbers\", tooltip = \"Exercises\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"8,1!\"] \n\"1\"->\"2\" [color = \"black\", arrowhead = \"vee\"] \n\"2\"->\"3\" [color = \"black\", arrowhead = \"vee\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="lo-vba-random-numbers" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Learning outcomes<a href="mod-vba-random-numbers.html#lo-vba-random-numbers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By the end of this module, you are expected to be able to:</p>
<ul>
<li>Describe what a random number is.</li>
<li>Generate a random number from a distribution.</li>
<li>Run a simulation and compare/analyse results.</li>
</ul>
<p>The learning outcomes relate to the <a href="lg-course.html#lg-course">overall learning goals</a> number 2-4, 8-14 and 16 of the course.</p>
<!-- SOLO increasing: identify · memorise · name · do simple procedure · collect data · -->
<!-- enumerate · describe · interpret · formulate · list · paraphrase · combine · do -->
<!-- algorithms · compare · contrast · explain causes · analyse · relate · derive · -->
<!-- evaluate · apply · argue · theorise · generalise · hypothesise · solve · reflect -->
</div>
<div id="vba-random-numbers" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Generating random numbers<a href="mod-vba-random-numbers.html#vba-random-numbers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Often we want to model a system where some of the elements are uncertain. To simulate the system we want to generate some random numbers following different distributions. This can be done using the built-in VBA and Excel functions for most distributions. The <a href="apdx-vba.html#vba-course-procedures">course procedures</a> (module <em>ModRand</em>) contain a set of procedures for generating random numbers. Let us have a look at how to generate random numbers from a continuous uniform distribution:</p>
<pre><code>&#39;&#39; Generate a random number from a continuous uniform distribution
&#39; @param dblMin Minimum number.
&#39; @param dblMax Maximum number (not included).
Function RandInvUniformCont(dblMin As Double, dblMax As Double) As Double
    RandInvUniformCont = dblMin + (dblMax - dblMin) * Rnd()
End Function</code></pre>
<p>Here a single random number is returned. The <code>Rnd</code> function is used to generate random numbers in the interval <span class="math inline">\([0,1[\)</span>, i.e. a continuous uniform distribution. The <code>Rnd</code> function is a built-in VBA function. To generate random numbers between [<code>dblMin</code>, <code>dblMax</code>[, we use the formula <code>dblMin + (dblMax - dblMin) * Rnd()</code>.</p>
<p>If you need more than a single random number, you can use the almost same procedure with <code>Gen</code> in its name instead of <code>Inv</code>:</p>
<pre><code>&#39;&#39; Generate random numbers from a continuous uniform distribution
&#39; @param intSize Random numbers generated
&#39; @param dblMin Minimum number.
&#39; @param dblMax Maximum number (not included).
&#39; @param ary Array to store the values in.
Sub RandGenUniformCont(intSize As Integer, dblMin As Double, dblMax As Double, ary() As Double)
    Dim i As Integer
    ReDim ary(intSize) As Double
    
    For i = 1 To intSize
        ary(i) = dblMin + (dblMax - dblMin) * Rnd()
    Next
End Sub</code></pre>
<p>The difference is that an array <code>ary</code> of <code>intSize</code> is used to store the random numbers.</p>
<p>Let us consider another example, the normal distribution:</p>
<pre><code>&#39;&#39; Generate a random number from a normal distribution
&#39; @param dblMean Mean.
&#39; @param dblSD Standard deviation.
Function RandInvNormal(dblMean As Double, dblSD As Double) As Double
    RandInvNormal = Application.WorksheetFunction.NormInv(Rnd, dblMean, dblSD)
End Function</code></pre>
<p>The procedure takes the mean and standard deviation as arguments and return a random number. Multiple random numbers are found using:</p>
<pre><code>&#39;&#39; Generate random numbers from a normal distribution
&#39; @param intSize Random numbers generated
&#39; @param dblMean Mean.
&#39; @param dblSD Standard deviation.
&#39; @param ary Array to store the values in.
Sub RandGenNormal(intSize As Integer, dblMean As Double, dblSD As Double, ary() As Double)
    Dim i As Integer
    ReDim ary(intSize) As Double
    
    For i = 1 To intSize
        ary(i) = Application.WorksheetFunction.NormInv(Rnd, dblMean, dblSD)
    Next
End Sub</code></pre>
<p>Here <code>intSize</code> random numbers in stored in the output array <code>ary</code>.</p>
<p>Similar procedures can be found for the uniform (discrete), binomial, poisson and a custom discrete distribution. Let us try some examples:</p>
<pre><code>Sub TM6_RandDistEx()
    Dim aryDens As Variant

    Randomize    &#39; initialize random-number generator
    MsgBox (&quot;Normal: &quot; &amp; RandInvNormal(100, 20))
    &#39; Cont. uniform [10,500[
    MsgBox (&quot;Uniform (continuous): &quot; &amp; RandInvUniformCont(10, 500))
    &#39; Discrete uniform 10,...,500
    MsgBox (&quot;Uniform (discrete): &quot; &amp; RandInvUniformDisc(10, 500))
    &#39; Binomial 100 trials, pr = 0.2
    MsgBox (&quot;Binomial: &quot; &amp; RandInvBinomial(100, 0.2))
    &#39; Poisson lambda = 5
    MsgBox (&quot;Poisson: &quot; &amp; RandInvPoisson(5))
    &#39; Custom discrete
    ReDim aryDens(1 To 4, 1 To 2)
    aryDens(1, 1) = &quot;A&quot;
    aryDens(2, 1) = &quot;B&quot;
    aryDens(3, 1) = &quot;C&quot;
    aryDens(4, 1) = &quot;D&quot;
    aryDens(1, 2) = 0.1
    aryDens(2, 2) = 0.3
    aryDens(3, 2) = 0.5
    aryDens(4, 2) = 0.1
    MsgBox (&quot;Custom (discrete): &quot; &amp; RandInvDiscrete(aryDens))
End Sub</code></pre>
<p>First, observe that in the start of the procedure, the <code>Randomize</code> procedure is called. <code>Randomize</code> initialize the random-number generator and it is always a good idea to call it if you want true random numbers. Next we generate a random number from the different distributions. For generating random numbers from a custom discrete distribution we need a 2D array where each row store the outcome and the probability. For instance here the probability of outcome 5 is 50%.</p>
<p>Let us try to generate 20 random numbers from each distribution:</p>
<pre><code>Sub TM6_RandDistAryEx()
    Dim ary() As Double
    Dim ary1 As Variant
    Dim aryDens As Variant
    Dim intSize As Integer
    
    ThisWorkbook.Worksheets(&quot;TM6&quot;).Activate
    Call TM6_ClearTestTM6
    Randomize    &#39; initialize random-number generator
    intSize = 20 &#39; generate 20 numbers for each distribution
    &#39; Normal
    Call RandGenNormal(intSize, 100, 20, ary)
    Range(&quot;A1&quot;) = &quot;Normal&quot;
    Call AryPaste(ary, Range(&quot;A2&quot;), False)
    &#39; Cont. uniform [10,500[
    Call RandGenUniformCont(intSize, 10, 500, ary)
    Range(&quot;B1&quot;) = &quot;Uniform&quot;
    Call AryPaste(ary, Range(&quot;B2&quot;), False)
    &#39; Discrete uniform 10,...,500
    Call RandGenUniformDisc(intSize, 10, 500, ary)
    Range(&quot;B1&quot;) = &quot;Uniform&quot;
    Call AryPaste(ary, Range(&quot;B2&quot;), False)
    &#39; Binomial 100 trials, pr = 0.2
    Call RandGenBinomial(intSize, 100, 0.2, ary)
    Range(&quot;C1&quot;) = &quot;Binomial&quot;
    Call AryPaste(ary, Range(&quot;C2&quot;), False)
    &#39; Poisson lambda = 5
    Call RandGenPoisson(intSize, 5, ary)
    Range(&quot;D1&quot;) = &quot;Poisson&quot;
    Call AryPaste(ary, Range(&quot;D2&quot;), False)
    &#39; Custom discrete
    ReDim aryDens(1 To 4, 1 To 2)
    aryDens(1, 1) = &quot;A&quot;
    aryDens(2, 1) = &quot;B&quot;
    aryDens(3, 1) = &quot;C&quot;
    aryDens(4, 1) = &quot;D&quot;
    aryDens(1, 2) = 0.1
    aryDens(2, 2) = 0.3
    aryDens(3, 2) = 0.5
    aryDens(4, 2) = 0.1
    Call RandGenDiscrete(intSize, aryDens, ary1)
    Range(&quot;E1&quot;) = &quot;Custom&quot;
    Call AryPaste(ary1, Range(&quot;E2&quot;), False)
    Range(&quot;G3&quot;) = &quot;Custom distribution:&quot;
    Range(&quot;G4&quot;) = &quot;Value&quot;
    Range(&quot;H4&quot;) = &quot;Prob.&quot;
    Call AryPaste(aryDens, Range(&quot;G5&quot;))
End Sub</code></pre>
</div>
<div id="vba-simulation" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Simulation<a href="mod-vba-random-numbers.html#vba-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Given an uncertain system we simulate the system by:</p>
<ol style="list-style-type: decimal">
<li>Constructing a deterministic model (that is we assume the random numbers have some specific values) and algorithms for solving it.</li>
<li>Generate random numbers and use them to solve the model and store the results.</li>
<li>Repeat a number of times and gather statistics such as minimum, mean, standard deviation or maximum value.</li>
</ol>
<p>Let us consider some examples in the next sections.</p>
<div id="sec-vba-tsp" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Example - Traveling salesman problem<a href="mod-vba-random-numbers.html#sec-vba-tsp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <a href="https://en.wikipedia.org/wiki/Travelling_salesman_problem">travelling salesman problem</a> (TSP) asks the following question:</p>
<blockquote>
<p>Given a list of cities and the distances between each pair of the cities,
what is the shortest possible route that visits each city exactly once
and returns to the origin city?</p>
</blockquote>
<p>The problem is an NP-hard problem (worst case solution time grows exponential with the number of cities) in combinatorial optimization, important in theoretical computer science and operations research. The problem was first formulated in 1930 and is one of the most intensively studied problems in optimization. Even though the problem is computationally difficult, many heuristics and exact algorithms are known.</p>
<p>The goal with this example is to test different heuristics on a set of problem instances. To see which one works best.</p>
<p>Let us first create a procedure <code>TM6_GenTSPData</code> that generate a TSP instance:</p>
<pre><code>&#39;&#39; Generate cities for the TSP (a TSP problem instance)
&#39; @param dblCoord A (cities x 3) array to store the generated id and coordinates in (output ByRef).
&#39; @param intCities Number of cities to generate. If 0 then ask.
&#39; @param blnPrint If true then print out the data in columns A:C in the TM6_TSP sheet.
Sub TM6_GenTSPData(dblCoord() As Double, Optional intCities As Integer = 0, _
                       Optional blnPrint As Boolean = False)
    Dim dblMin As Double
    Dim dblMax As Double
    Dim i As Integer
    Dim ary1() As Double, ary2() As Double
    
    Randomize
    &#39; Min and max values for uniform distribution
    dblMin = 0
    dblMax = 10
    &#39; Reallocate
    If intCities = 0 Then intCities = InputBox(&quot;How many points should I generate?&quot;)
    ReDim dblCoord(1 To intCities, 1 To 3)
    &#39; Generate random numbers
    Call RandGenUniformCont(intCities, dblMin, dblMax, ary1)
    Call RandGenUniformCont(intCities, dblMin, dblMax, ary2)
    For i = 1 To intCities
        dblCoord(i, 1) = i
        dblCoord(i, 2) = ary1(i)
        dblCoord(i, 3) = ary2(i)
    Next
    &#39;&#39; Print data
    If blnPrint Then
        ThisWorkbook.Worksheets(&quot;TM6_TSP&quot;).Activate
        Call TM6_ClearTestTSP
        Cells(1, 1).value = &quot;City&quot;
        Cells(1, 2).value = &quot;x-coord&quot;
        Cells(1, 3).value = &quot;y-coord&quot;
        For i = 1 To intCities
            Cells(i + 1, 1).value = dblCoord(i, 1)
            Cells(i + 1, 2).value = dblCoord(i, 2)
            Cells(i + 1, 3).value = dblCoord(i, 3)
        Next
    End If
End Sub</code></pre>
<p>Note we specify the number of cities as an input argument. Each city has an id number and a <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>-coordinate and the result is stored in array <code>dblCoord</code> with <code>intCities</code> rows and three columns (column 1 store the city id, column 2 the <span class="math inline">\(x\)</span>-coordinate and column 3 the <span class="math inline">\(y\)</span>-coordinate). The <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>-coordinates are random numbers from an uniform distribution between 0 and 10. If <code>blnPrint</code> is true then coordinates are printed to the sheet and if <code>intCities</code> is zero then use an input box to ask for the number of cities.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tm6-tsp"></span>
<img src="img/tm6-tsp.png" alt="TSP algorithms and cost (*TM6_TSP* worksheet)." width="600px" />
<p class="caption">
Figure 6.1: TSP algorithms and cost (<em>TM6_TSP</em> worksheet).
</p>
</div>
<p>We now can create a procedure <code>BtnGenTSPData</code> that calls <code>GenTSPData</code>, ask for the number of cities and print the result to the sheet. A button linking to the procedure is made in worksheet <em>TM6_TSP</em> (see Figure <a href="mod-vba-random-numbers.html#fig:tm6-tsp">6.1</a>):</p>
<pre><code>Sub TM6_BtnGenTSPData()
    Dim dblCoord() As Double
    Call TM6_GenTSPData(dblCoord, 0, True)
End Sub</code></pre>
<p>Given the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>-coordinates of a problem instance (stored in <code>dblCoord</code>) we need to calculate the distance matrix:</p>
<pre><code>&#39;&#39; Calculate distance matrix
&#39; @param dblDist The distance matrix to store distances (output ByRef).
&#39; @param dblCoord A (cities x 3) array with id and coordinates.
&#39; @pre Assume that dblCoord has not been sorted yet!
&#39; @post Distances stored in dblDist.
Sub TM6_CalcDistArray(ByRef dblDist() As Double, dblCoord() As Double)
    Dim i As Integer, j As Integer
    Dim dblDiffX As Double, dblDiffY As Double
    Dim intCities As Integer
    
    intCities = UBound(dblCoord, 1)
    ReDim dblDist(intCities, intCities)
    For i = 1 To intCities
        For j = i + 1 To intCities
            dblDiffX = dblCoord(i, 2) - dblCoord(j, 2)
            dblDiffY = dblCoord(i, 3) - dblCoord(j, 3)
            dblDist(i, j) = Sqr((dblDiffX * dblDiffX) + (dblDiffY * dblDiffY))
            dblDist(j, i) = dblDist(i, j)  &#39; assume symmetric
        Next
    Next
End Sub</code></pre>
<p>The procedure takes the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>-coordinates (stored in <code>dblCoord</code>) and calculate the distance matrix stored in <code>dblDist</code>, i.e. <code>dblDist(i, j)</code> store the euclidean distance between city <code>i</code> and <code>j</code>. Symmetric distances are assumed, i.e. <code>dblDist(i, j) = dblDist(j, i)</code>.</p>
<p>We are now ready to consider algorithms for calculating a TSP route. Let us first consider a procedure <code>TM6_SolveTSPIncX</code> that sort the array <code>dblCoord</code> increasing in the x-coordinate and visit the cities in the order of the sorted array and return to the starting city:</p>
<pre><code>&#39;&#39; Calculate visiting sequence based on increasing x-coord
&#39; @param dblCoord A (cities x 3) array with id and coordinates.
&#39; @param dblDist The distance matrix.
&#39; @param dblCost Total cost (output ByRef).
&#39; @param intSeq The visiting sequence (output ByRef).
&#39; @post The total cost and sequence returned.
 Sub TM6_SolveTSPIncX(dblCoord() As Double, dblDist() As Double, _
                      dblCost As Double, intSeq() As Integer)
    Dim j As Integer
    Dim intCities As Integer
    
    &#39; Sort
    intCities = UBound(dblDist, 1)
    ReDim intSeq(intCities)
    Call AryQuickSort(dblCoord, 2)
    &#39; Store visiting sequence
    For j = 1 To intCities
        intSeq(j) = dblCoord(j, 1)
    Next
    dblCost = TM6_CalcCost(dblDist, intSeq)
End Sub</code></pre>
<p>First, observe that we sort the array using course procedure <code>AryQuickSort</code>. Next, the visiting city sequence are stored in <code>intSeq</code>. Finally, the total cost are stored in <code>dblCost</code> which call the function <code>TM6_CalcCost</code>:</p>
<pre><code>&#39;&#39; Calculate the cost of a route
&#39; @param dblDist The distance matrix.
&#39; @param intSeq The visiting sequence (output ByRef).
&#39; @return The cost of a route.
Function TM6_CalcCost(dblDist() As Double, intSeq() As Integer) As Double
    Dim dblCost As Double
    Dim intCities As Integer
    Dim j As Integer
    
    intCities = UBound(intSeq)
    dblCost = 0
    For j = 1 To intCities - 1
        dblCost = dblCost + dblDist(intSeq(j), intSeq(j + 1))
    Next
    TM6_CalcCost = dblCost + dblDist(intSeq(intCities), intSeq(1))   &#39; cost + cost of returning to start
End Function</code></pre>
<p>If we want to use the algorithm on the data in sheet <em>TM6_TSP</em> we first need a procedure reading the data:</p>
<pre><code>&#39;&#39; Read the coordinates into an 2D array
&#39; @param dblCoord A (cities x 3) array to store the generated id and coordinates in.
&#39; @post Generated data stored in dblCoord.
Sub TM6_ReadCoord(dblCoord() As Double)
    Dim rng As Range
    
    ThisWorkbook.Worksheets(&quot;TM6_TSP&quot;).Activate
    Set rng = RngGetCurRegionRange(Range(&quot;A1&quot;), 2) &#39;current region except the header
    Call AryRead(dblCoord, rng)
End Sub</code></pre>
<p>and then a procedure <code>TM6_BtnSolveTSPIncX</code> that calls <code>TM6_SolveTSPIncX</code> using the TSP data in the sheet and print out the total cost in cell H4. We include a button linking to the procedure (see Figure <a href="mod-vba-random-numbers.html#fig:tm6-tsp">6.1</a>):</p>
<pre><code>Sub TM6_BtnSolveTSPIncX()
    Dim dblCoord() As Double
    Dim dblDist() As Double
    Dim intSeq() As Integer
    Dim dblCost As Double
    
    Call TM6_ReadCoord(dblCoord)
    Call AryQuickSort(dblCoord, 1)  &#39; so sure sorted by id
    Call TM6_CalcDistArray(dblDist, dblCoord)
    Call TM6_SolveTSPIncX(dblCoord, dblDist, dblCost, intSeq)
    Range(&quot;H3&quot;) = &quot;Cost:&quot;
    Range(&quot;H5&quot;) = dblCost
End Sub</code></pre>
<p>Another algorithm <code>TM6_SolveTSPIncY</code> that sort the array <code>dblCoord</code> increasing in the <span class="math inline">\(y\)</span>-coordinate and visit the cities in the order of the sorted array and return to the starting city can be made similar to above (see Figure <a href="mod-vba-random-numbers.html#fig:tm6-tsp">6.1</a>). A possibility is also an algorithm that visit the cities in the order of the <code>dblCoord</code> array and return to the starting city. This may seen as we visit the cities in random order since we generate the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>-coordinate random.</p>
<p>Finally, we will consider a nearest neighbour algorithm. We start in City 1. Given the current city, the next city (not already visited) is the city with the shortest distance:</p>
<pre><code>&#39;&#39; Calculate visiting sequence based on nearest neighbour
&#39; @param dblCoord A (cities x 3) array with id and coordinates.
&#39; @param dblDist The distance matrix.
&#39; @param dblCost Total cost.
&#39; @param intSeq The visiting sequence.
&#39; @post The total cost and sequence returned.
 Sub TM6_SolveTSPNN(dblCoord() As Double, dblDist() As Double, ByRef dblCost As Double, ByRef intSeq() As Integer)
    Dim i As Integer, id As Integer
    Dim intCities As Integer, intCurCity As Integer, intBestCity As Integer
    Dim dblMinDist As Double
    Dim intUsed() As Integer       &#39; intUsed(id) = 1 if city id have been used in sequence
    
    intCities = UBound(dblDist, 1)
    ReDim intSeq(intCities)
    ReDim intUsed(intCities)
    &#39; Find nearst neighbor
    id = 1
    intSeq(1) = id  &#39; start in city id = 1
    intUsed(id) = 1
    For i = 2 To intCities        &#39; find next city to add to intSeq(i)
        dblMinDist = 1000000      &#39; large number
        intCurCity = intSeq(i - 1)
        For id = 2 To intCities   &#39; scan for next candidate (id = 1 already used)
            If intUsed(id) = 0 And dblDist(intCurCity, id) &lt; dblMinDist Then   &#39; shorter distance found
                intBestCity = id
                dblMinDist = dblDist(intCurCity, id)
            End If
        Next
        intSeq(i) = intBestCity
        intUsed(intBestCity) = 1
    Next
    dblCost = TM6_CalcCost(dblDist, intSeq)
End Sub</code></pre>
<p>Here we need to have an array <code>intUsed</code> to store if a city already visited (equal 1 if yes). Nested loops is used to scan for the not-visited city nearest to the current one. The results for all the algorithms on an problem instance with 20 cities can be seen in Figure <a href="mod-vba-random-numbers.html#fig:tm6-tsp">6.1</a>.</p>
<p>We now have a set of algorithms which can be tested on some problem instances that we can generate. On the problem instance we used above the nearest neighbour algorithm seems to find the best route (shortest cost). However, we can not state that this holds in general without testing on many problem instances. Hence we want to do a simulation study with steps:</p>
<ul>
<li>Generate a problem instance with <code>intCities</code> cities which are chosen random between 10 and 500.</li>
<li>Calculate the distance matrix.</li>
<li>Solve the instance using all of the above algorithms.</li>
<li>Store the result in a row in the <em>TM6_TSPSim</em> sheet.</li>
<li>Repeat 100 times and calculate min, mean and max values for each solution algorithm.</li>
</ul>
<p>This is done in procedure <code>TM6_TSPSim</code>:</p>
<pre><code>Sub TM6_TSPSim()
    Dim intCities As Integer
    Dim s As Integer
    Dim dblCoord() As Double
    Dim dblDist() As Double
    Dim intSeq() As Integer
    Dim dblCost As Double
    Dim intRow As Integer
    
    &#39; Setup sheet
    ThisWorkbook.Worksheets(&quot;TM6_TSPSim&quot;).Activate
    Call RngClear(Range(&quot;A:F&quot;))
    Cells(1, 1) = &quot;Simulation results&quot;
    Cells(3, 2) = &quot;Min&quot;
    Cells(4, 2) = &quot;Mean&quot;
    Cells(5, 2) = &quot;Max&quot;
    intRow = 7
    Cells(intRow, 1) = &quot;Run&quot;
    Cells(intRow, 2) = &quot;Cities&quot;
    Cells(intRow, 3) = &quot;IncX&quot;
    Cells(intRow, 4) = &quot;IncY&quot;
    Cells(intRow, 5) = &quot;Random&quot;
    Cells(intRow, 6) = &quot;NN&quot;
    &#39; Run simulation
    For s = 1 To 100
        Cells(s + intRow, 1) = s
        intCities = WorksheetFunction.RandBetween(10, 500) &#39; number of cities
        Cells(s + intRow, 2) = intCities
        Call TM6_GenTSPData(dblCoord, intCities, False)
        Call TM6_CalcDistArray(dblDist, dblCoord)
        Call TM6_SolveTSPIncX(dblCoord, dblDist, dblCost, intSeq)
        Cells(s + intRow, 3) = dblCost
        Call TM6_SolveTSPIncY(dblCoord, dblDist, dblCost, intSeq)
        Cells(s + intRow, 4) = dblCost
        Call TM6_SolveTSPRand(dblCoord, dblDist, dblCost, intSeq)
        Cells(s + intRow, 5) = dblCost
        Call TM6_SolveTSPNN(dblCoord, dblDist, dblCost, intSeq)
        Cells(s + intRow, 6) = dblCost
    Next
    &#39; Calc statistics
    For s = 3 To 6
        Cells(3, s) = WorksheetFunction.Min(Range(Cells(intRow + 1, s), Cells(intRow + 100, s)))
        Cells(4, s) = WorksheetFunction.Average(Range(Cells(intRow + 1, s), Cells(intRow + 100, s)))
        Cells(5, s) = WorksheetFunction.Max(Range(Cells(intRow + 1, s), Cells(intRow + 100, s)))
    Next
    &#39; Format cells
    Call RngFormat(Cells(3, 2).CurrentRegion, &quot;green&quot;)
    Call RngFormat(Cells(intRow, 1).CurrentRegion, &quot;orange&quot;, True)
End Sub</code></pre>
<p>First, we setup the worksheet <em>TM6_TSPSim</em> so it is ready for the results. Next, we run the simulation 100 times in a for loop. In each loop we first generate the number of instances, then a problem instance for which we find the distance matrix. The algorithms is then run on the problem instance and results are added to the worksheet. After the loop we calculate statistics for all the runs. Finally, the results are formatted for nice appearance.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tm6-tsp-sim"></span>
<img src="img/tm6-tsp-sim.png" alt="Simulation comparing TSP algorithms (*TM6_TSPSim* worksheet)." width="600px" />
<p class="caption">
Figure 6.2: Simulation comparing TSP algorithms (<em>TM6_TSPSim</em> worksheet).
</p>
</div>
<p>The results are given in Figure <a href="mod-vba-random-numbers.html#fig:tm6-tsp-sim">6.2</a>. As can be seen the nearest neighbour algorithm is best and gives the shortest average distance.</p>
</div>
</div>
<div id="recap-3" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Recap<a href="mod-vba-random-numbers.html#recap-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Often we want to model a system where some of the elements are uncertain. To simulate the system we want to generate some random numbers following different distributions. This can be done using the built-in VBA and Excel functions for most distributions.</p></li>
<li><p>Initialize generation of random numbers using</p>
<pre><code>Randomize()     &#39; chooses a random seed </code></pre>
<p>Or</p>
<pre><code>Randomize(100)     &#39; generate the same sequence of random numbers</code></pre>
<p>We normally use the first option.</p></li>
<li><p>When generating random numbers in VBA and writing them to the worksheet, they will NOT be changed when the worksheet is updated! Only when the code is executed!</p></li>
<li><p>The <a href="apdx-vba.html#vba-course-procedures">course procedures</a> (module <em>ModRand</em>) also contain a set of procedures for generating random numbers that are stored in an array.</p></li>
<li><p>Given an uncertain system we simulate the system by:</p>
<ol style="list-style-type: decimal">
<li>Constructing a deterministic model (that is we assume the random numbers have some specific values) and algorithms for solving it.</li>
<li>Generate random numbers and use them to solve the model and store the results.</li>
<li>Repeat a number of times and gather statistics such as minimum, mean, standard deviation or maximum value.</li>
</ol></li>
</ul>
<div>
You may also have a look at the
<a href="https://bss-osca.github.io/tfa/slides/06_vba-random-numbers-slides.html" target="_blank">slides for this module</a>
.
</div>
</div>
<div id="ex-vba-random-numbers" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Exercises<a href="mod-vba-random-numbers.html#ex-vba-random-numbers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Below you will find a set of exercises. Always have a look at the exercises before you meet in your study group and try to solve them yourself. Are you stuck, see the <a href="help.html#help">help page</a>. Some of the solutions to each exercise can be seen by pressing the button at each question. Beware, you will not learn by giving up too early. Put some effort into finding a solution!</p>
<div>
A template with VBA code is given in the file
<a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-template.xlsm" target="_blank">vba-template.xlsm</a>
(open it and use it while reading the notes). Have a look inside the module
<i>TM6_ex</i>
in the VBA editor for examples used in the notes and during lectures. Have a look at module
<i>TM6_exercises</i>
for exercises. Guiding answers for the exercises can be found in the file
<a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-solution.xlsm" target="_blank">vba-solution.xlsm</a>
.
</div>
<div id="ex-vba-random-int" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Exercise - Two random integers<a href="mod-vba-random-numbers.html#ex-vba-random-int" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a slightly modified version an exam assignment (reexam 2021-A4).</em></p>
<p>Consider worksheet <em>TM6</em>.</p>
<ol style="list-style-type: decimal">
<li><p>Write a sub <code>TM6_RandInt1</code> that reads two integer numbers, <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> (assume that <span class="math inline">\(a &lt; b\)</span>) from cells B24 and B25, and generates two random integer numbers, <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span>, uniformly between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> such that <span class="math inline">\(r_1 \neq r_2\)</span>. The sub should write <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span> in cells D24 and D25 with the smaller of the two numbers in D24.</p></li>
<li><p>Write a sub <code>TM6_RandInt2</code> that should take two integer arguments, <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, and generate two random numbers <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span> following the same rules as in Question 1. However, <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span> may not be written to the spreadsheet. Instead, they should be updated by calling the sub <code>TM6_RandInt2</code>.</p></li>
<li><p>Write a sub <code>TM6_RandInt2Main</code> that call <code>TM6_RandInt2</code> using <span class="math inline">\(a=2\)</span> and <span class="math inline">\(b=17\)</span> and output <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span> in a message box.</p></li>
<li><p>Is your code robust? What happens if <span class="math inline">\(a&gt;b\)</span>?</p></li>
</ol>
</div>
<div id="ex-vba-swap" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Exercise - Swap entries<a href="mod-vba-random-numbers.html#ex-vba-swap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a slightly modified version an exam assignment (reexam 2021-A5).</em></p>
<p>Consider worksheet <em>TM6_Swap</em> which contains a list of names (from A4) and two numbers between 1 and 20 (in B1 and B2). You may assume that the number in B2 is strictly larger than the one in B1. In the following, let <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span> represent these two numbers. Sometimes, we need to change the order of the items in such lists, and in this assignment, you will be asked to do that in three different ways.</p>
<ol style="list-style-type: decimal">
<li><p>Write a sub <code>TM6_Swap1</code> that, given values of <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span> (to be read from B1 and B2), swaps the <span class="math inline">\(r_1\)</span>’th and the <span class="math inline">\(r_2\)</span>’th name in the list. Print the result in column D.</p></li>
<li><p>Write a sub <code>TM6_Swap2</code> that, given values of <span class="math inline">\(r_1\)</span> and <span class="math inline">\(r_2\)</span> (to be read from B1 and B2), reverses the sequence from the <span class="math inline">\(r_1\)</span>’th to the <span class="math inline">\(r_2\)</span>’th name in the list. Print the result in column E.</p></li>
<li><p>Write a sub <code>TM6_Swap3</code> that changes the order of the names so they appear in random order. Print the result in column F.</p></li>
</ol>
<p>Figure <a href="mod-vba-random-numbers.html#fig:exc-swap">6.3</a> gives an example on the swap operations.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:exc-swap"></span>
<img src="img/exc-swap.png" alt="Swap entries (*TM6_Swap* worksheet)." width="500px" />
<p class="caption">
Figure 6.3: Swap entries (<em>TM6_Swap</em> worksheet).
</p>
</div>
</div>
<div id="ex-vba-bakery" class="section level3 hasAnchor" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> Exercise - Dan’s bakery<a href="mod-vba-random-numbers.html#ex-vba-bakery" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dan owns a small bakery baking a single cold-rised bread. The demand level <span class="math inline">\(l\)</span> for bread is uncertain and on a given day the demand level equals <span class="math inline">\(l=1\)</span> (low) with probability 0.2, <span class="math inline">\(l=2\)</span> (medium) with probability 0.5 and <span class="math inline">\(l=3\)</span> (high) with probability 0.3. The actual demand (number of customers) depends on the demand level and is Poisson distributed with mean <span class="math inline">\(50 + 60l\)</span>.</p>
<p>Currently, the sales price per bread is 45 DKK and production cost 7 DKK. If a customer arrives and Dan has no bread left then he estimates the loss of goodwill to be 10 DKK.</p>
<p>A customer always buy one bread. Dan can have 20 breads in the oven a time and hence always produce a multiple of 20 breads.</p>
<ol style="list-style-type: decimal">
<li><p>Create a function <code>TM6_DanProfit</code> that returns the daily profit given a specific demand and production. The profit given demand <span class="math inline">\(d\)</span> and production <span class="math inline">\(p\)</span> using the current prices and costs is <span class="math display">\[(45-7)\min(d,p) - 7\max(0,p-d) - 10\max(0,d-p).\]</span> Let the arguments of the function be:</p>
<pre><code>&#39; @param dblDemand Demand.
&#39; @param dblProd Production.
&#39; @param dblPrice Sales price.
&#39; @param dblCost Production costs.
&#39; @param dblGW Lost goodwill cost.</code></pre></li>
<li><p>Create a procedure <code>TM6_DanSim</code> that simulate the system for <span class="math inline">\(y\)</span> days given that Dan choose to produce <span class="math inline">\(x\)</span> breads each day. The procedure arguments are:</p>
<pre><code>&#39; @param dblProd Production (x).
&#39; @param dblPrice Sales price.
&#39; @param dblCost Production costs.
&#39; @param dblGW Lost goodwill cost.
&#39; @param aryDens Demand level density array (needed for RandGenDiscrete).
&#39; @param intDays Days to simulate (y).
&#39; @param aryStat Array to store the output statistics (output ByRef).</code></pre>
<p>The result array <code>aryProfit</code> has entries:</p>
<ul>
<li>number of runs (days),</li>
<li>production</li>
<li>sales price</li>
<li>production cost</li>
<li>lost goodwill cost</li>
<li>average profit</li>
<li>standard deviation</li>
<li>min and max profit</li>
</ul></li>
<li><p>Create a procedure <code>TM6_DanBtnSim</code> that calls <code>TM6_DanSim</code> for production levels 20, 40, …, 400 and output the results in worksheet <em>TM6_DanSim</em>. The procedure must use the demand level distribution, prices and cost given in the worksheet.</p></li>
<li><p>What is the best production level?</p></li>
<li><p>What is the best production level if the demand levels changes to low with probability 0.7, medium with probability 0.2 and high with probability 0.1?</p></li>
</ol>
</div>
<div id="ex-vba-generate" class="section level3 hasAnchor" number="6.5.4">
<h3><span class="header-section-number">6.5.4</span> Exercise - Generating random numbers<a href="mod-vba-random-numbers.html#ex-vba-generate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Create a procedure <code>TM6_GenRandNumb</code> that generate 5000 random numbers of</p>
<ul>
<li>A normal distribution with mean 100 and standard deviation 20.</li>
<li>An continuous uniform distribution with range 10 to 500.</li>
<li>A binomial distribution with 100 trials and a 0.2 probability of success.</li>
<li>A poisson distribution with mean 5.</li>
<li>Plot the results for each distribution using <code>TM6_PlotFreq</code> (given).</li>
</ul>
</div>
<div id="ex-vba-stoc-functions" class="section level3 hasAnchor" number="6.5.5">
<h3><span class="header-section-number">6.5.5</span> Exercise - Stochastic functions<a href="mod-vba-random-numbers.html#ex-vba-stoc-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a slightly modified version an exam assignment (exam 2022-A5).</em></p>
<p>Given an investment of <span class="math inline">\(x\)</span> thousand dollars you have the option of investing in two projects:</p>
<ul>
<li><p>Project 1: The profit function is
<span class="math display">\[
\pi_1(x) =
\begin{cases}
        A_1 x,      &amp; \text{if $0 \leq x &lt; 20$}\\
        A_2 x - 40, &amp; \text{if $20\leq x &lt; 50$}\\
  A_3 x - 140 &amp; \text{if $x \geq 50$}
\end{cases}
\]</span>
where <span class="math inline">\(A_i\)</span> is normal distributed with mean <span class="math inline">\(2i\)</span> and standard deviation <span class="math inline">\(0.1i\)</span>.</p></li>
<li><p>Project 2: The profit function is
<span class="math display">\[
\pi_2(x) =
\begin{cases}
        1.25 x,      &amp; \text{if $0 \leq x &lt; 40$}\\
        (x - A_1)^2 + 50, &amp; \text{if $40\leq x &lt; 60$}\\
  A_2 x + 510 &amp; \text{if $x \geq 60$}
\end{cases}
\]</span>
where <span class="math inline">\(A_1\)</span> is a continuous random number between 38 and 42 (uniform distributed) and <span class="math inline">\(A_2\)</span> is a continuous random number between -2 and -0.5 (uniform distributed).</p></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Create two functions (<code>TM6_ProfitP1</code> and <code>TM6_ProfitP2</code>) that return the profit of Project 1 and 2 given investment <span class="math inline">\(x\)</span> as input argument, i.e. the random samples <span class="math inline">\(A_i\)</span> is calculated inside the functions.</p></li>
<li><p>Make a sub <code>TM6_FunctionSim</code> that do a simulation with the following features:</p>
<ul>
<li>Considers investment sizes <span class="math inline">\(x = 10, 20, 30, ..., 100\)</span>.</li>
<li>Uses 50 samples for each investment <span class="math inline">\(x\)</span>.</li>
<li>Calculates the average profit and standard deviation of the two projects for each <span class="math inline">\(x\)</span>.</li>
<li>Stores the results in worksheet <em>TM6_Functions</em>.</li>
</ul></li>
</ol>
</div>
<div id="ex-vba-customer-demand" class="section level3 hasAnchor" number="6.5.6">
<h3><span class="header-section-number">6.5.6</span> Exercise - Customer demand<a href="mod-vba-random-numbers.html#ex-vba-customer-demand" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a slightly modified version an exam assignment (exam 2024-A2).</em></p>
<p>A company sells a product and the demand <span class="math inline">\(D\)</span> of the product depends on the price <span class="math inline">\(p\)</span>. The demand has been estimated to be <span class="math inline">\(D = D_1 + D_2\)</span>, where <span class="math inline">\(D_i\)</span> denote the demand from Customer Segment <span class="math inline">\(i\)</span>. The demand from Customer Segment 1 is stochastic and follows a custom discrete distribution:</p>
<ul>
<li><span class="math inline">\(D_1=\frac{625}{p}-5\)</span> with probability <span class="math inline">\(0.25\)</span></li>
<li><span class="math inline">\(D_1=\frac{625}{p}\)</span> with probability <span class="math inline">\(0.5\)</span></li>
<li><span class="math inline">\(D_1=\frac{625}{p}+5\)</span> with probability <span class="math inline">\(0.25\)</span></li>
</ul>
<p>The demand from Customer Segment 2 is stochastic and follows a Possion distribution with parameter/mean equal to <span class="math inline">\(8000/p^2\)</span>. Hint: The course procedure <code>RandInvPoisson</code> stored in module <code>ModRand</code> may be useful.</p>
<p>Write a set of VBA procedures that answer/complete the following questions/tasks. All procedures should be documented using a skeleton similar to the examples given in the course notes (<a href="https://bss-osca.github.io/tfa/coding-convention.html#commenting-your-code">Section D1</a>).</p>
<ol style="list-style-type: decimal">
<li><p>Create two procedures <code>TM6_Demand1</code> and <code>TM6_Demand2</code> that return the stochastic demand <span class="math inline">\(D_1\)</span> and <span class="math inline">\(D_2\)</span> given a price. Next, create a procedure <code>TM6_Demand</code> that use the procedures <code>TM6_Demand1</code> and <code>TM6_Demand2</code> to calculate the total stochastic demand.</p></li>
<li><p>The company has a production capacity of 75 units. If the demand is above the production capacity then sales is 75 and the remaining demand is lost at a cost of <span class="math inline">\(l\)</span> DKK per unit. The profit is given by the sales revenue minus the lost sales cost.</p>
<p>Create a procedure <code>TM6_Profit</code> that calculates the profit given price <span class="math inline">\(p\)</span> and lost sales cost <span class="math inline">\(l\)</span> with the following features:</p>
<ul>
<li>Stochastic demand are used inside the procedure and returned (<code>ByRef</code>)</li>
<li>The number of sold units is returned (<code>ByRef</code>).</li>
<li>The number of lost sales units is returned (<code>ByRef</code>).</li>
<li>The profit is returned (<code>ByRef</code>).</li>
<li>The default value of <span class="math inline">\(l\)</span> is 10 DKK.</li>
</ul>
<p>You may test <code>TM6_Profit</code> using procedure <code>TM6_ProfitTest</code>:</p>
<pre><code>Sub TM6_ProfitTest()
   Dim dblDemand As Double
   Dim dblSold As Double
   Dim dblLost As Double
   Dim dblProfit As Double

   Call TM6_Profit(20, dblDemand, dblSold, dblLost, dblProfit, dblCost:=20)
   MsgBox (&quot;The profit is &quot; &amp; dblProfit)
End Sub</code></pre></li>
<li><p>The company consider setting the price <span class="math inline">\(p\)</span> of the product in the range <span class="math inline">\(5, \ldots, 40\)</span>. Make a procedure <code>TM6_ProfitSim</code> that does a simulation with the following features:</p>
<ul>
<li>An input box is used to give the lost sales cost <span class="math inline">\(l\)</span>.</li>
<li>Given a price calculate measures: demand, number of sold units, number of lost sales units and the profit.</li>
<li>For each price in the range do 500 runs and calculate the averages for each measure.</li>
<li>Output the results in worksheet <em>TM6_CustDemand</em> so one row is given for each price with the averages.</li>
</ul>
<p>Add a button running the procedure to worksheet <em>TM6_CustDemand</em>. Which price gives the best profit given <span class="math inline">\(l=15\)</span> (add this as a comment inside the procedure)?</p></li>
</ol>
</div>
<div id="ex-vba-simple-game" class="section level3 hasAnchor" number="6.5.7">
<h3><span class="header-section-number">6.5.7</span> Exercise - A simple game<a href="mod-vba-random-numbers.html#ex-vba-simple-game" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider a simple game using an uneven dice with outcomes 1-8. The outcome <span class="math inline">\(D\)</span> of the dice follows a custom discrete distribution (unknown to the player):
<span class="math display">\[
\Pr(D = x) =
\begin{cases}
            0.1,      &amp; x = 1, 2, 4, 5, 7\\
            0.3,      &amp; x = 3\\
            0.15,     &amp; x = 6\\
            0.05,     &amp; x = 8
\end{cases}
\]</span></p>
<p>The player of the game bet on an outcome <span class="math inline">\(x\)</span>, next he throws the dice 6 times and wins if the dice hit <span class="math inline">\(x\)</span> at least one time.</p>
<p>Write a set of VBA procedures that answer/complete the following questions/tasks. All procedures MUST be documented using a skeleton similar to the examples given in the course notes (<a href="coding-convention.html#coding-convention">Section D1</a>).</p>
<ol style="list-style-type: decimal">
<li><p>Create a function <code>TM6_PlayAGame</code> that returns true if the game is won given argument <span class="math inline">\(x\)</span> (the number to bet on); otherwise false is returned.</p></li>
<li><p>Create a procedure <code>TM6_Play</code> with the following features:</p>
<ul>
<li>Use an input box to ask for the number <span class="math inline">\(x\)</span> to bet on.</li>
<li>Play the game 4 times and store the results of each play in a collection.</li>
<li>Use message box(s) to output which games you won or that you did not win any games.</li>
</ul>
<p>Add a button running the procedure to worksheet <em>TM6_Game</em>.</p></li>
<li><p>If you bet on number <span class="math inline">\(x\)</span> then it costs you <span class="math inline">\(x/2\)</span> and if you win then you receive <span class="math inline">\(x\)</span>. That is, the profit is
<span class="math display">\[
\pi =
\begin{cases}
        -x/2,      &amp; \text{if loose}\\
        x - x/2,   &amp;  \text{if win}
\end{cases}
\]</span></p>
<p>Make a sub <code>TM6_SimGame</code> that does a simulation with the following features:</p>
<ul>
<li>For each bet <span class="math inline">\(x\)</span> calculate the average profit based on 1000 runs.</li>
<li>Output the results in worksheet <em>Game</em> so one row is given for each bet <span class="math inline">\(x\)</span> with the bet <span class="math inline">\(x\)</span> and average profit.</li>
</ul>
<p>Add a button running the procedure to worksheet <em>TM6_Game</em>. Which bet gives the best average profit (add this as a comment inside the procedure)?</p></li>
</ol>
<script src="//unpkg.com/@highlightjs/cdn-assets@11.5.1/highlight.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/highlightjs-vba/dist/vba.min.js"></script>
<!-- <script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script> -->
<script type="text/javascript">
  hljs.initHighlightingOnLoad();
  // hljs.initLineNumbersOnLoad({singleLine: true}); 
</script>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="mod-vba-datatypes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mod-r-install.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/bss-osca/tfa/edit/master/book/06_vba-random-numbers.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
