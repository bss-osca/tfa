<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>E VBA specific topics | Tools for Analytics (TFA)</title>
  <meta name="description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="E VBA specific topics | Tools for Analytics (TFA)" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bss-osca.github.io/tfa//assets/logo.png" />
  <meta property="og:description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="github-repo" content="bss-osca/tfa" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="E VBA specific topics | Tools for Analytics (TFA)" />
  
  <meta name="twitter:description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="twitter:image" content="https://bss-osca.github.io/tfa//assets/logo.png" />

<meta name="author" content="Lars Relund Nielsen" />


<meta name="date" content="2025-09-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon" />
<link rel="prev" href="coding-convention.html"/>
<link rel="next" href="lg-course.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.11/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<link href="libs/minichart-0.2.2/minicharts.css" rel="stylesheet" />
<script src="libs/minichart-0.2.2/leaflet.minicharts.min.js"></script>
<link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" />
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<html>
<head>
<script>
  $(document).ready(function() {

  // Section anchors
  $('.section h1, .section h2, .section h3, .section h4, .section h5').each(function() {
    anchor = '#' + $(this).parent().attr('id');
    $(this).addClass("hasAnchor").prepend('<a href="' + anchor + '" class="anchor"></a>');
  });
});
</script>
<script src="https://hypothes.is/embed.js" async></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</head>
</html>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="img/logo.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to the course</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#lo-intro"><i class="fa fa-check"></i><b>1.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.2</b> Purpose for the course</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#r-vs-vba"><i class="fa fa-check"></i><b>1.3</b> R vs Excel/VBA</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#computer"><i class="fa fa-check"></i><b>1.4</b> How a computer works</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i><b>1.5</b> How the notes are organized</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#ack"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#how-to-cite"><i class="fa fa-check"></i><b>1.7</b> How to cite</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#ex-intro"><i class="fa fa-check"></i><b>1.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="index.html"><a href="index.html#ex-annotate"><i class="fa fa-check"></i><b>1.8.1</b> Exercise - How to annotate</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I VBA</b></span></li>
<li class="chapter" data-level="2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html"><i class="fa fa-check"></i><b>2</b> An introduction to VBA</a>
<ul>
<li class="chapter" data-level="2.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#lo-vba-intro"><i class="fa fa-check"></i><b>2.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-what"><i class="fa fa-check"></i><b>2.2</b> What is VBA</a></li>
<li class="chapter" data-level="2.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-setup"><i class="fa fa-check"></i><b>2.3</b> Setup Excel for VBA</a></li>
<li class="chapter" data-level="2.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-hello"><i class="fa fa-check"></i><b>2.4</b> Your first program</a></li>
<li class="chapter" data-level="2.5" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-macro"><i class="fa fa-check"></i><b>2.5</b> The macro recorder</a></li>
<li class="chapter" data-level="2.6" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-overview"><i class="fa fa-check"></i><b>2.6</b> VBA - A short overview</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#variables"><i class="fa fa-check"></i><b>2.6.1</b> Variables</a></li>
<li class="chapter" data-level="2.6.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#procedures"><i class="fa fa-check"></i><b>2.6.2</b> Procedures</a></li>
<li class="chapter" data-level="2.6.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#input-and-output"><i class="fa fa-check"></i><b>2.6.3</b> Input and output</a></li>
<li class="chapter" data-level="2.6.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#conditional-statements"><i class="fa fa-check"></i><b>2.6.4</b> Conditional statements</a></li>
<li class="chapter" data-level="2.6.5" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#loops"><i class="fa fa-check"></i><b>2.6.5</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-coding-practice"><i class="fa fa-check"></i><b>2.7</b> Good coding pratice</a></li>
<li class="chapter" data-level="2.8" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#rc-vba-intro"><i class="fa fa-check"></i><b>2.8</b> Recap</a></li>
<li class="chapter" data-level="2.9" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-intro"><i class="fa fa-check"></i><b>2.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-hello"><i class="fa fa-check"></i><b>2.9.1</b> Exercise - Hello</a></li>
<li class="chapter" data-level="2.9.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-macro"><i class="fa fa-check"></i><b>2.9.2</b> Exercise - Record a macro</a></li>
<li class="chapter" data-level="2.9.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-user-input"><i class="fa fa-check"></i><b>2.9.3</b> Exercise - User input</a></li>
<li class="chapter" data-level="2.9.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-max-min"><i class="fa fa-check"></i><b>2.9.4</b> Exercise - Max and min number</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html"><i class="fa fa-check"></i><b>3</b> Loops and conditional statements</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#lo-vba-loops-cond"><i class="fa fa-check"></i><b>3.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.2" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-operators"><i class="fa fa-check"></i><b>3.2</b> Relational and logical operators</a></li>
<li class="chapter" data-level="3.3" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-loops"><i class="fa fa-check"></i><b>3.3</b> Loops</a></li>
<li class="chapter" data-level="3.4" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-cond"><i class="fa fa-check"></i><b>3.4</b> Conditional statements</a></li>
<li class="chapter" data-level="3.5" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-ex-jen"><i class="fa fa-check"></i><b>3.5</b> Example - Find Jen</a></li>
<li class="chapter" data-level="3.6" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-ex-dist-mat"><i class="fa fa-check"></i><b>3.6</b> Example - A distance matrix</a></li>
<li class="chapter" data-level="3.7" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#recap"><i class="fa fa-check"></i><b>3.7</b> Recap</a></li>
<li class="chapter" data-level="3.8" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-loops-cond"><i class="fa fa-check"></i><b>3.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-loops"><i class="fa fa-check"></i><b>3.8.1</b> Exercise - Loops</a></li>
<li class="chapter" data-level="3.8.2" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-cond"><i class="fa fa-check"></i><b>3.8.2</b> Exercise - Conditional statements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html"><i class="fa fa-check"></i><b>4</b> Procedures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#lo-vba-procedures"><i class="fa fa-check"></i><b>4.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="4.2" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-subs-functions"><i class="fa fa-check"></i><b>4.2</b> Subs and functions - The basics</a></li>
<li class="chapter" data-level="4.3" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-optional-arg"><i class="fa fa-check"></i><b>4.3</b> Optional arguments</a></li>
<li class="chapter" data-level="4.4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-pub-priv"><i class="fa fa-check"></i><b>4.4</b> Public and private procedures</a></li>
<li class="chapter" data-level="4.5" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-byref"><i class="fa fa-check"></i><b>4.5</b> Passing arguments by reference or by value</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#return-values-from-a-sub"><i class="fa fa-check"></i><b>4.5.1</b> Return values from a sub</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-built-in"><i class="fa fa-check"></i><b>4.6</b> Built-in functions</a></li>
<li class="chapter" data-level="4.7" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-test-persons"><i class="fa fa-check"></i><b>4.7</b> Example - Selection of test persons</a></li>
<li class="chapter" data-level="4.8" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#recap-1"><i class="fa fa-check"></i><b>4.8</b> Recap</a></li>
<li class="chapter" data-level="4.9" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-procedures"><i class="fa fa-check"></i><b>4.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-subs"><i class="fa fa-check"></i><b>4.9.1</b> Exercise - Subs</a></li>
<li class="chapter" data-level="4.9.2" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#exercise---temperatures"><i class="fa fa-check"></i><b>4.9.2</b> Exercise - Temperatures</a></li>
<li class="chapter" data-level="4.9.3" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-functions"><i class="fa fa-check"></i><b>4.9.3</b> Exercise - Functions</a></li>
<li class="chapter" data-level="4.9.4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-worksheet-functions"><i class="fa fa-check"></i><b>4.9.4</b> Exercise - Worksheet functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html"><i class="fa fa-check"></i><b>5</b> Advanced data types and usage</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#lo-vba-datatypes"><i class="fa fa-check"></i><b>5.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="5.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-strings"><i class="fa fa-check"></i><b>5.2</b> Strings</a></li>
<li class="chapter" data-level="5.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-objects"><i class="fa fa-check"></i><b>5.3</b> Objects</a></li>
<li class="chapter" data-level="5.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-wst"><i class="fa fa-check"></i><b>5.4</b> The Worksheet object</a></li>
<li class="chapter" data-level="5.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#wst-rng"><i class="fa fa-check"></i><b>5.5</b> The Range object</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#named-ranges-in-excel"><i class="fa fa-check"></i><b>5.5.1</b> Named ranges in Excel</a></li>
<li class="chapter" data-level="5.5.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#current-region-of-a-range"><i class="fa fa-check"></i><b>5.5.2</b> Current region of a range</a></li>
<li class="chapter" data-level="5.5.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#input-and-output-1"><i class="fa fa-check"></i><b>5.5.3</b> Input and output</a></li>
<li class="chapter" data-level="5.5.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#sorting-a-range"><i class="fa fa-check"></i><b>5.5.4</b> Sorting a range</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-ary"><i class="fa fa-check"></i><b>5.6</b> Arrays</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#multi-dimensional-arrays"><i class="fa fa-check"></i><b>5.6.1</b> Multi-dimensional arrays</a></li>
<li class="chapter" data-level="5.6.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#dynamic-arrays"><i class="fa fa-check"></i><b>5.6.2</b> Dynamic arrays</a></li>
<li class="chapter" data-level="5.6.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#input-and-output-2"><i class="fa fa-check"></i><b>5.6.3</b> Input and output</a></li>
<li class="chapter" data-level="5.6.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#sorting-arrays"><i class="fa fa-check"></i><b>5.6.4</b> Sorting arrays</a></li>
<li class="chapter" data-level="5.6.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#use-arrays-instead-of-ranges"><i class="fa fa-check"></i><b>5.6.5</b> Use arrays instead of ranges</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-coll"><i class="fa fa-check"></i><b>5.7</b> Collections</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#accessing-collections-using-keys"><i class="fa fa-check"></i><b>5.7.1</b> Accessing collections using keys</a></li>
<li class="chapter" data-level="5.7.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#collections-containing-objects"><i class="fa fa-check"></i><b>5.7.2</b> Collections containing objects</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-ex-job-seq"><i class="fa fa-check"></i><b>5.8</b> Example - Job sequencing</a></li>
<li class="chapter" data-level="5.9" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#recap-2"><i class="fa fa-check"></i><b>5.9</b> Recap</a></li>
<li class="chapter" data-level="5.10" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-datatypes"><i class="fa fa-check"></i><b>5.10</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-equal"><i class="fa fa-check"></i><b>5.10.1</b> Exercise - Equal entries</a></li>
<li class="chapter" data-level="5.10.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-products"><i class="fa fa-check"></i><b>5.10.2</b> Exercise - Product search</a></li>
<li class="chapter" data-level="5.10.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-read-collections"><i class="fa fa-check"></i><b>5.10.3</b> Exercise - Read collections</a></li>
<li class="chapter" data-level="5.10.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-read-arrays"><i class="fa fa-check"></i><b>5.10.4</b> Exercise - Read arrays</a></li>
<li class="chapter" data-level="5.10.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-process"><i class="fa fa-check"></i><b>5.10.5</b> Exercise - Process numbers</a></li>
<li class="chapter" data-level="5.10.6" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-pay"><i class="fa fa-check"></i><b>5.10.6</b> Exercise - Search payments</a></li>
<li class="chapter" data-level="5.10.7" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-flight"><i class="fa fa-check"></i><b>5.10.7</b> Exercise - Flight search</a></li>
<li class="chapter" data-level="5.10.8" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-table"><i class="fa fa-check"></i><b>5.10.8</b> Exercise - Search table</a></li>
<li class="chapter" data-level="5.10.9" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-next-task"><i class="fa fa-check"></i><b>5.10.9</b> Exercise - Find next task</a></li>
<li class="chapter" data-level="5.10.10" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-seat-reservation"><i class="fa fa-check"></i><b>5.10.10</b> Exercise - Seat reservation</a></li>
<li class="chapter" data-level="5.10.11" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-select"><i class="fa fa-check"></i><b>5.10.11</b> Exercise - Transform data (select and filter)</a></li>
<li class="chapter" data-level="5.10.12" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-mutate"><i class="fa fa-check"></i><b>5.10.12</b> Exercise - Transform data (arrange and mutate)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html"><i class="fa fa-check"></i><b>6</b> Generating random numbers</a>
<ul>
<li class="chapter" data-level="6.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#lo-vba-random-numbers"><i class="fa fa-check"></i><b>6.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="6.2" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#vba-random-numbers"><i class="fa fa-check"></i><b>6.2</b> Generating random numbers</a></li>
<li class="chapter" data-level="6.3" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#vba-simulation"><i class="fa fa-check"></i><b>6.3</b> Simulation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#sec-vba-tsp"><i class="fa fa-check"></i><b>6.3.1</b> Example - Traveling salesman problem</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#recap-3"><i class="fa fa-check"></i><b>6.4</b> Recap</a></li>
<li class="chapter" data-level="6.5" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-random-numbers"><i class="fa fa-check"></i><b>6.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-random-int"><i class="fa fa-check"></i><b>6.5.1</b> Exercise - Two random integers</a></li>
<li class="chapter" data-level="6.5.2" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-swap"><i class="fa fa-check"></i><b>6.5.2</b> Exercise - Swap entries</a></li>
<li class="chapter" data-level="6.5.3" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-bakery"><i class="fa fa-check"></i><b>6.5.3</b> Exercise - Dan’s bakery</a></li>
<li class="chapter" data-level="6.5.4" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-generate"><i class="fa fa-check"></i><b>6.5.4</b> Exercise - Generating random numbers</a></li>
<li class="chapter" data-level="6.5.5" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-stoc-functions"><i class="fa fa-check"></i><b>6.5.5</b> Exercise - Stochastic functions</a></li>
<li class="chapter" data-level="6.5.6" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-customer-demand"><i class="fa fa-check"></i><b>6.5.6</b> Exercise - Customer demand</a></li>
<li class="chapter" data-level="6.5.7" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-simple-game"><i class="fa fa-check"></i><b>6.5.7</b> Exercise - A simple game</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II R</b></span></li>
<li class="chapter" data-level="7" data-path="mod-r-install.html"><a href="mod-r-install.html"><i class="fa fa-check"></i><b>7</b> Setting up R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mod-r-install.html"><a href="mod-r-install.html#lo-r-install"><i class="fa fa-check"></i><b>7.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="7.2" data-path="mod-r-install.html"><a href="mod-r-install.html#r-install"><i class="fa fa-check"></i><b>7.2</b> Install R and RStudio</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="mod-r-install.html"><a href="mod-r-install.html#test-your-installation"><i class="fa fa-check"></i><b>7.2.1</b> Test your installation</a></li>
<li class="chapter" data-level="7.2.2" data-path="mod-r-install.html"><a href="mod-r-install.html#add-on-packages"><i class="fa fa-check"></i><b>7.2.2</b> Add-on packages</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="mod-r-install.html"><a href="mod-r-install.html#r-cloud"><i class="fa fa-check"></i><b>7.3</b> Setup and test Posit Cloud</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html"><i class="fa fa-check"></i><b>8</b> R basics and workflows</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#lo-r-workflow"><i class="fa fa-check"></i><b>8.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="8.2" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#working-with-r-at-the-command-line-in-rstudio"><i class="fa fa-check"></i><b>8.2</b> Working with R at the command line in RStudio</a></li>
<li class="chapter" data-level="8.3" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#your-first-datacamp-course"><i class="fa fa-check"></i><b>8.3</b> Your first DataCamp course</a></li>
<li class="chapter" data-level="8.4" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#pipes"><i class="fa fa-check"></i><b>8.4</b> Pipes</a></li>
<li class="chapter" data-level="8.5" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#rprojs"><i class="fa fa-check"></i><b>8.5</b> RStudio projects</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#storing-your-code-in-a-script-file"><i class="fa fa-check"></i><b>8.5.1</b> Storing your code in a script file</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#rc-r-workflow"><i class="fa fa-check"></i><b>8.6</b> Recap</a></li>
<li class="chapter" data-level="8.7" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#ex-r-workflow"><i class="fa fa-check"></i><b>8.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-group-work"><i class="fa fa-check"></i><b>8.7.1</b> Exercise (group work)</a></li>
<li class="chapter" data-level="8.7.2" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-piping"><i class="fa fa-check"></i><b>8.7.2</b> Exercise (piping)</a></li>
<li class="chapter" data-level="8.7.3" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-working-dir"><i class="fa fa-check"></i><b>8.7.3</b> Exercise (working dir)</a></li>
<li class="chapter" data-level="8.7.4" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-vectors"><i class="fa fa-check"></i><b>8.7.4</b> Exercise (vectors)</a></li>
<li class="chapter" data-level="8.7.5" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-matrices"><i class="fa fa-check"></i><b>8.7.5</b> Exercise (matrices)</a></li>
<li class="chapter" data-level="8.7.6" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-data-frames"><i class="fa fa-check"></i><b>8.7.6</b> Exercise (data frames)</a></li>
<li class="chapter" data-level="8.7.7" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-lists"><i class="fa fa-check"></i><b>8.7.7</b> Exercise (lists)</a></li>
<li class="chapter" data-level="8.7.8" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#ex-strings"><i class="fa fa-check"></i><b>8.7.8</b> Exercise (string management)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html"><i class="fa fa-check"></i><b>9</b> Loops and conditionals</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#lo-loops"><i class="fa fa-check"></i><b>9.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="9.2" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#r-dc-loops-cond"><i class="fa fa-check"></i><b>9.2</b> Conditionals and control flow</a></li>
<li class="chapter" data-level="9.3" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#r-loops"><i class="fa fa-check"></i><b>9.3</b> Loops</a></li>
<li class="chapter" data-level="9.4" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#rc-r-loops-cond"><i class="fa fa-check"></i><b>9.4</b> Recap</a></li>
<li class="chapter" data-level="9.5" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-loops-cond"><i class="fa fa-check"></i><b>9.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-conditional-expressions"><i class="fa fa-check"></i><b>9.5.1</b> Exercise (conditional expressions)</a></li>
<li class="chapter" data-level="9.5.2" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-loops"><i class="fa fa-check"></i><b>9.5.2</b> Exercise (loops)</a></li>
<li class="chapter" data-level="9.5.3" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-search-vector"><i class="fa fa-check"></i><b>9.5.3</b> Exercise (search vector)</a></li>
<li class="chapter" data-level="9.5.4" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-dist"><i class="fa fa-check"></i><b>9.5.4</b> Exercise (calculating distances)</a></li>
<li class="chapter" data-level="9.5.5" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-expand"><i class="fa fa-check"></i><b>9.5.5</b> Exercise (expand_grid)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mod-r-functions.html"><a href="mod-r-functions.html"><i class="fa fa-check"></i><b>10</b> Functions</a>
<ul>
<li class="chapter" data-level="10.1" data-path="mod-r-functions.html"><a href="mod-r-functions.html#lo-r-functions"><i class="fa fa-check"></i><b>10.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="10.2" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-dc-functions"><i class="fa fa-check"></i><b>10.2</b> DataCamp course</a></li>
<li class="chapter" data-level="10.3" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-extra"><i class="fa fa-check"></i><b>10.3</b> Functions returning multiple objects</a></li>
<li class="chapter" data-level="10.4" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-arg"><i class="fa fa-check"></i><b>10.4</b> The <code>...</code> argument</a></li>
<li class="chapter" data-level="10.5" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-doc"><i class="fa fa-check"></i><b>10.5</b> Documenting your functions</a></li>
<li class="chapter" data-level="10.6" data-path="mod-r-functions.html"><a href="mod-r-functions.html#example---job-sequencing"><i class="fa fa-check"></i><b>10.6</b> Example - Job sequencing</a></li>
<li class="chapter" data-level="10.7" data-path="mod-r-functions.html"><a href="mod-r-functions.html#rc-functions"><i class="fa fa-check"></i><b>10.7</b> Recap</a></li>
<li class="chapter" data-level="10.8" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-functions"><i class="fa fa-check"></i><b>10.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-def-func"><i class="fa fa-check"></i><b>10.8.1</b> Exercise (defining functions)</a></li>
<li class="chapter" data-level="10.8.2" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-euclidean-distances"><i class="fa fa-check"></i><b>10.8.2</b> Exercise (euclidean distances)</a></li>
<li class="chapter" data-level="10.8.3" data-path="mod-r-functions.html"><a href="mod-r-functions.html#exercise-scope"><i class="fa fa-check"></i><b>10.8.3</b> Exercise (scope)</a></li>
<li class="chapter" data-level="10.8.4" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-time-conversion"><i class="fa fa-check"></i><b>10.8.4</b> Exercise (time conversion)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html"><i class="fa fa-check"></i><b>11</b> Introduction to tidyverse and RMarkdown</a>
<ul>
<li class="chapter" data-level="11.1" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#lo-tidyverse-intro"><i class="fa fa-check"></i><b>11.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="11.2" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-tidyverse-intro"><i class="fa fa-check"></i><b>11.2</b> The tidyverse package</a></li>
<li class="chapter" data-level="11.3" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-markdown-intro"><i class="fa fa-check"></i><b>11.3</b> Writing reproducible reports</a></li>
<li class="chapter" data-level="11.4" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-tibbles-intro"><i class="fa fa-check"></i><b>11.4</b> Tibbles</a></li>
<li class="chapter" data-level="11.5" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#rc-tidyverse-intro"><i class="fa fa-check"></i><b>11.5</b> Recap</a></li>
<li class="chapter" data-level="11.6" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#ex-tidyverse-intro"><i class="fa fa-check"></i><b>11.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#exercise-your-first-rmarkdown-exercise"><i class="fa fa-check"></i><b>11.6.1</b> Exercise (your first RMarkdown exercise)</a></li>
<li class="chapter" data-level="11.6.2" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#exercise-tibbles"><i class="fa fa-check"></i><b>11.6.2</b> Exercise (tibbles)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mod-r-io.html"><a href="mod-r-io.html"><i class="fa fa-check"></i><b>12</b> Importing and exporting data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="mod-r-io.html"><a href="mod-r-io.html#lo-r-io"><i class="fa fa-check"></i><b>12.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="12.2" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-csv"><i class="fa fa-check"></i><b>12.2</b> CSV files</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="mod-r-io.html"><a href="mod-r-io.html#reading-a-csv-file"><i class="fa fa-check"></i><b>12.2.1</b> Reading a CSV file</a></li>
<li class="chapter" data-level="12.2.2" data-path="mod-r-io.html"><a href="mod-r-io.html#writing-to-csv-files"><i class="fa fa-check"></i><b>12.2.2</b> Writing to CSV files</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-excel"><i class="fa fa-check"></i><b>12.3</b> Excel</a></li>
<li class="chapter" data-level="12.4" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-google"><i class="fa fa-check"></i><b>12.4</b> Google Sheets</a></li>
<li class="chapter" data-level="12.5" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-text"><i class="fa fa-check"></i><b>12.5</b> Text files</a></li>
<li class="chapter" data-level="12.6" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-r"><i class="fa fa-check"></i><b>12.6</b> R’s native binary format</a></li>
<li class="chapter" data-level="12.7" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-json"><i class="fa fa-check"></i><b>12.7</b> Json</a></li>
<li class="chapter" data-level="12.8" data-path="mod-r-io.html"><a href="mod-r-io.html#rc-r-io"><i class="fa fa-check"></i><b>12.8</b> Recap</a></li>
<li class="chapter" data-level="12.9" data-path="mod-r-io.html"><a href="mod-r-io.html#ex-r-io"><i class="fa fa-check"></i><b>12.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="mod-r-io.html"><a href="mod-r-io.html#exercise-statistikbanken"><i class="fa fa-check"></i><b>12.9.1</b> Exercise (Statistikbanken)</a></li>
<li class="chapter" data-level="12.9.2" data-path="mod-r-io.html"><a href="mod-r-io.html#exercise-tuples-in-opl"><i class="fa fa-check"></i><b>12.9.2</b> Exercise (tuples in OPL)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="mod-r-transform.html"><a href="mod-r-transform.html"><i class="fa fa-check"></i><b>13</b> Transforming data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="mod-r-transform.html"><a href="mod-r-transform.html#lo-r-transform"><i class="fa fa-check"></i><b>13.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="13.2" data-path="mod-r-transform.html"><a href="mod-r-transform.html#r-transform-tidyverse"><i class="fa fa-check"></i><b>13.2</b> Working with data in the tidyverse</a></li>
<li class="chapter" data-level="13.3" data-path="mod-r-transform.html"><a href="mod-r-transform.html#r-transform-joins"><i class="fa fa-check"></i><b>13.3</b> Mutating joins</a></li>
<li class="chapter" data-level="13.4" data-path="mod-r-transform.html"><a href="mod-r-transform.html#rc-r-transform"><i class="fa fa-check"></i><b>13.4</b> Recap</a></li>
<li class="chapter" data-level="13.5" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-transform"><i class="fa fa-check"></i><b>13.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-gapminder1"><i class="fa fa-check"></i><b>13.5.1</b> Exercise (gapminder)</a></li>
<li class="chapter" data-level="13.5.2" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-babynames1"><i class="fa fa-check"></i><b>13.5.2</b> Exercise (babynames)</a></li>
<li class="chapter" data-level="13.5.3" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-profit1"><i class="fa fa-check"></i><b>13.5.3</b> Exercise (profit)</a></li>
<li class="chapter" data-level="13.5.4" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-fish"><i class="fa fa-check"></i><b>13.5.4</b> Exercise (fisheries)</a></li>
<li class="chapter" data-level="13.5.5" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-company"><i class="fa fa-check"></i><b>13.5.5</b> Exercise (company ranking)</a></li>
<li class="chapter" data-level="13.5.6" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-titanic"><i class="fa fa-check"></i><b>13.5.6</b> Exercise (Titanic)</a></li>
<li class="chapter" data-level="13.5.7" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-covid"><i class="fa fa-check"></i><b>13.5.7</b> Exercise (covid)</a></li>
<li class="chapter" data-level="13.5.8" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-election"><i class="fa fa-check"></i><b>13.5.8</b> Exercise (election)</a></li>
<li class="chapter" data-level="13.5.9" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-orders"><i class="fa fa-check"></i><b>13.5.9</b> Exercise (orders)</a></li>
<li class="chapter" data-level="13.5.10" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-jobs"><i class="fa fa-check"></i><b>13.5.10</b> Exercise (jobs)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="mod-r-plot.html"><a href="mod-r-plot.html"><i class="fa fa-check"></i><b>14</b> Data visualization using ggplot</a>
<ul>
<li class="chapter" data-level="14.1" data-path="mod-r-plot.html"><a href="mod-r-plot.html#lo-plot"><i class="fa fa-check"></i><b>14.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="14.2" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-intro"><i class="fa fa-check"></i><b>14.2</b> Introduction to data visualization</a></li>
<li class="chapter" data-level="14.3" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-multi"><i class="fa fa-check"></i><b>14.3</b> Combining plots into one using <em>patchwork</em></a></li>
<li class="chapter" data-level="14.4" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-save"><i class="fa fa-check"></i><b>14.4</b> Saving graphics</a></li>
<li class="chapter" data-level="14.5" data-path="mod-r-plot.html"><a href="mod-r-plot.html#rc-r-plot"><i class="fa fa-check"></i><b>14.5</b> Recap</a></li>
<li class="chapter" data-level="14.6" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-plot"><i class="fa fa-check"></i><b>14.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-gapminder2"><i class="fa fa-check"></i><b>14.6.1</b> Exercise (gapminder)</a></li>
<li class="chapter" data-level="14.6.2" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-profit2"><i class="fa fa-check"></i><b>14.6.2</b> Exercise (profit)</a></li>
<li class="chapter" data-level="14.6.3" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-covid19"><i class="fa fa-check"></i><b>14.6.3</b> Exercise (COVID-19)</a></li>
<li class="chapter" data-level="14.6.4" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-lego"><i class="fa fa-check"></i><b>14.6.4</b> Exercise (Lego and sales)</a></li>
<li class="chapter" data-level="14.6.5" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-company-plot"><i class="fa fa-check"></i><b>14.6.5</b> Exercise (company ranking)</a></li>
<li class="chapter" data-level="14.6.6" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-titanic-plot"><i class="fa fa-check"></i><b>14.6.6</b> Exercise (Titanic)</a></li>
<li class="chapter" data-level="14.6.7" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-covid-plot"><i class="fa fa-check"></i><b>14.6.7</b> Exercise (covid)</a></li>
<li class="chapter" data-level="14.6.8" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-election-plot"><i class="fa fa-check"></i><b>14.6.8</b> Exercise (election)</a></li>
<li class="chapter" data-level="14.6.9" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-orders-plot"><i class="fa fa-check"></i><b>14.6.9</b> Exercise (orders)</a></li>
<li class="chapter" data-level="14.6.10" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-nycflights"><i class="fa fa-check"></i><b>14.6.10</b> Exercise (New York flights)</a></li>
<li class="chapter" data-level="14.6.11" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-jobs-plot"><i class="fa fa-check"></i><b>14.6.11</b> Exercise (jobs)</a></li>
<li class="chapter" data-level="14.6.12" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-onecom"><i class="fa fa-check"></i><b>14.6.12</b> Exercise (OneCom)</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Extra R</b></span></li>
<li class="chapter" data-level="15" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html"><i class="fa fa-check"></i><b>15</b> Fitting probability distributions</a>
<ul>
<li class="chapter" data-level="15.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#lo-r-dist-fit"><i class="fa fa-check"></i><b>15.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="15.2" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-intro"><i class="fa fa-check"></i><b>15.2</b> Introduction</a></li>
<li class="chapter" data-level="15.3" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-cont"><i class="fa fa-check"></i><b>15.3</b> Fitting distributions to continuous data</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#example-breakdown-times"><i class="fa fa-check"></i><b>15.3.1</b> Example: breakdown times</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-discrete"><i class="fa fa-check"></i><b>15.4</b> Fitting distributions to discrete data</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#example-sales-of-lottery-tickets"><i class="fa fa-check"></i><b>15.4.1</b> Example: sales of lottery tickets</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-dist-fit-pois"><i class="fa fa-check"></i><b>15.5</b> The Poisson process</a></li>
<li class="chapter" data-level="15.6" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#rc-r-dist-fit"><i class="fa fa-check"></i><b>15.6</b> Recap</a></li>
<li class="chapter" data-level="15.7" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#ex-r-dist-fit"><i class="fa fa-check"></i><b>15.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#exercise---call-center"><i class="fa fa-check"></i><b>15.7.1</b> Exercise - Call center</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="mod-r-maps.html"><a href="mod-r-maps.html"><i class="fa fa-check"></i><b>16</b> Spatial data and maps</a>
<ul>
<li class="chapter" data-level="16.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#lo-maps"><i class="fa fa-check"></i><b>16.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="16.2" data-path="mod-r-maps.html"><a href="mod-r-maps.html#sec-map-api-key"><i class="fa fa-check"></i><b>16.2</b> Services for obtatining spatial data</a></li>
<li class="chapter" data-level="16.3" data-path="mod-r-maps.html"><a href="mod-r-maps.html#calculating-distances"><i class="fa fa-check"></i><b>16.3</b> Calculating distances</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#using-google-maps"><i class="fa fa-check"></i><b>16.3.1</b> Using Google Maps</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="mod-r-maps.html"><a href="mod-r-maps.html#geocoding-and-reverse-geocoding"><i class="fa fa-check"></i><b>16.4</b> Geocoding and reverse geocoding</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#using-google-maps-1"><i class="fa fa-check"></i><b>16.4.1</b> Using Google maps</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="mod-r-maps.html"><a href="mod-r-maps.html#adding-markers-and-routes-to-a-map"><i class="fa fa-check"></i><b>16.5</b> Adding markers and routes to a map</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="groups.html"><a href="groups.html"><i class="fa fa-check"></i><b>A</b> Working in groups</a>
<ul>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#using-git"><i class="fa fa-check"></i>Using Git together with GitHub</a>
<ul>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#register-a-free-github-account"><i class="fa fa-check"></i>Register a free GitHub account</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#install-git"><i class="fa fa-check"></i>Install Git</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#check-your-installation"><i class="fa fa-check"></i>Check your installation</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#setup-projects-using-git-and-github"><i class="fa fa-check"></i>Setup projects using Git and GitHub</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="annotate.html"><a href="annotate.html"><i class="fa fa-check"></i><b>B</b> Annotate the course notes</a></li>
<li class="chapter" data-level="C" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>C</b> Getting help</a></li>
<li class="chapter" data-level="D" data-path="coding-convention.html"><a href="coding-convention.html"><i class="fa fa-check"></i><b>D</b> Coding/naming convention</a>
<ul>
<li class="chapter" data-level="D.1" data-path="coding-convention.html"><a href="coding-convention.html#commenting-your-code"><i class="fa fa-check"></i><b>D.1</b> Commenting your code</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="apdx-vba.html"><a href="apdx-vba.html"><i class="fa fa-check"></i><b>E</b> VBA specific topics</a>
<ul>
<li class="chapter" data-level="E.1" data-path="apdx-vba.html"><a href="apdx-vba.html#vba-debug"><i class="fa fa-check"></i><b>E.1</b> Debugging your code</a></li>
<li class="chapter" data-level="E.2" data-path="apdx-vba.html"><a href="apdx-vba.html#error-handling"><i class="fa fa-check"></i><b>E.2</b> Error handling</a></li>
<li class="chapter" data-level="E.3" data-path="apdx-vba.html"><a href="apdx-vba.html#vba-course-procedures"><i class="fa fa-check"></i><b>E.3</b> Course procedures</a>
<ul>
<li class="chapter" data-level="E.3.1" data-path="apdx-vba.html"><a href="apdx-vba.html#detailed-descriptions-of-course-procedures"><i class="fa fa-check"></i><b>E.3.1</b> Detailed descriptions of course procedures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="F" data-path="lg-course.html"><a href="lg-course.html"><i class="fa fa-check"></i><b>F</b> Learning goals</a></li>
<li class="chapter" data-level="G" data-path="ba.html"><a href="ba.html"><i class="fa fa-check"></i><b>G</b> Business Analytics</a></li>
<li class="chapter" data-level="H" data-path="colophon.html"><a href="colophon.html"><i class="fa fa-check"></i><b>H</b> Colophon</a></li>
<li class="divider"></li>
<li><center>
  <a rel="license" href="./index.html#ack">
    License: CC BY-NC-SA<br>
    <i class = "fab fa-creative-commons fa-2x"></i>
    <i class = "fab fa-creative-commons-by fa-2x"></i>
    <i class = "fab fa-creative-commons-nc fa-2x"></i>
    <i class = "fab fa-creative-commons-sa fa-2x"></i>
  </a>
</li></center>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tools for Analytics (TFA)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="apdx-vba" class="section level1 hasAnchor" number="21">
<h1><span class="header-section-number">E</span> VBA specific topics<a href="apdx-vba.html#apdx-vba" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="vba-debug" class="section level2 hasAnchor" number="21.1">
<h2><span class="header-section-number">E.1</span> Debugging your code<a href="apdx-vba.html#vba-debug" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You debug you code to find errors and correct bugs in your program. VBA has a built-in debugger that you may use to step though you code and check if the values in memory are correct. You start and use the debugger using the debugger buttons in the VBA editor, e.g. set the cursor in the top of a sub and press the <strong>Step Into</strong> button (<svg viewBox="0 0 448 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"> <path d="M0 93.7l183.6-25.3v177.4H0V93.7zm0 324.6l183.6 25.3V268.4H0v149.9zm203.8 28L448 480V268.4H203.8v177.9zm0-380.6v180.1H448V32L203.8 65.7z"></path></svg> F8, <svg viewBox="0 0 384 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"> <path d="M318.7 268.7c-.2-36.7 16.4-64.4 50-84.8-18.8-26.9-47.2-41.7-84.7-44.6-35.5-2.8-74.3 20.7-88.5 20.7-15 0-49.4-19.7-76.4-19.7C63.3 141.2 4 184.8 4 273.5q0 39.3 14.4 81.2c12.8 36.7 59 126.7 107.2 125.2 25.2-.6 43-17.9 75.8-17.9 31.8 0 48.3 17.9 76.4 17.9 48.6-.7 90.4-82.5 102.6-119.3-65.2-30.7-61.7-90-61.7-91.9zm-56.6-164.2c27.3-32.4 24.8-61.9 24-72.5-24.1 1.4-52 16.4-67.9 34.9-17.5 19.8-27.8 44.3-25.6 71.9 26.1 2 49.9-11.4 69.5-34.3z"></path></svg> ⇧⌘I). You can now repeatedly press the button to step though the code.</p>
<p>In the <strong>Locals</strong> window you can see the values of the variables as you run you code.
<!-- In the **Immediate** window you can add output using the [`Debug.Print`](https://www.automateexcel.com/vba/debug-print-immediate-window/) and test code.   --></p>
<p>Finally, if you want to run the program until a specific line or code then insert a break-point by clicking the margin of that line in the VBA editor. Next, run you sub and the debugger will stop at that line.</p>
<p>For more details you may have a look at Chapter 9 in <span class="citation">Wøhlk (<a href="#ref-vba-book">2010</a>)</span> or the videos <a href="https://youtu.be/AONXBZdx20Y">Debug toolbar</a>, <a href="https://youtu.be/BC8py7Ce2rg">Locals window</a> and <a href="https://youtu.be/k_1zrFdlZCU">Breakpoints</a>.</p>
</div>
<div id="error-handling" class="section level2 hasAnchor" number="21.2">
<h2><span class="header-section-number">E.2</span> Error handling<a href="apdx-vba.html#error-handling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>See <a href="https://excelmacromastery.com/vba-error-handling/" class="uri">https://excelmacromastery.com/vba-error-handling/</a></p>
</div>
<div id="vba-course-procedures" class="section level2 hasAnchor" number="21.3">
<h2><span class="header-section-number">E.3</span> Course procedures<a href="apdx-vba.html#vba-course-procedures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The course have a set of <em>course procedures</em> that you may use ‘as is’ during the course and at the exam without any warranty. I will explicitly state if you are not allowed to use them. An overview is given in Table <a href="apdx-vba.html#tab:course-proc">E.1</a>. All procedures within a topic start with the same suffix so you easy can find them using auto complete in the VBA editor (Ctrl + Space). On a mac you may have to disable the default shortcut (Ctrl + Space) for switching input sources. You can go to the <em>System Preferences -&gt; Keyboard -&gt; Shortcuts -&gt; Input Sources</em> and disable it. For instance all procedures related to arrays start with suffix <code>Ary</code>. Similar the procedures are stored in module <code>ModAry</code>. The modules are stored in the Excel files we use during the course and all course procedures can also be found as <a href="https://github.com/bss-osca/tfa/tree/master/vba/bas">text files</a>. If you want to use a course procedure in your own file copy/import the whole module containing the procedure to the Excel file.</p>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:course-proc">Table E.1: </span>Course procedures. See the modules named ModRng, ModAry, ModWst, ModCol, ModTm, and ModRand for further info.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Procedure
</th>
<th style="text-align:left;">
Type
</th>
<th style="text-align:left;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-AryCopyColumn"><code>AryCopyColumn</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Create a 1D array by copying it from a column in a 2D array
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-AryCopyRow"><code>AryCopyRow</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Create a 1D array by copying it from a row in a 2D array
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-AryDim"><code>AryDim</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Array dimension
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-AryEmpty"><code>AryEmpty</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Check if an array empty
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-AryFromCSV"><code>AryFromCSV</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Read a csv file to and array
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-AryPaste"><code>AryPaste</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Paste a 1D or 2D array to a sheet
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-AryPasteColumn"><code>AryPasteColumn</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Paste a column of a 2D array to a sheet
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-AryPasteRow"><code>AryPasteRow</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Paste a row of a 2D array to a sheet
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-AryQuickSort"><code>AryQuickSort</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Sort a 2-Dimensional array using a quicksort algorithm
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-AryRead"><code>AryRead</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Read a range into a 2D array
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-AryReadLong"><code>AryReadLong</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Read a range (long format) into an array (up to a 5D array is supported)
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-AryToSeq"><code>AryToSeq</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Set all array elements to a sequence
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-AryToStr"><code>AryToStr</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Convert an array to a string
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-AryToVal"><code>AryToVal</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Set all array elements to a specific value
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-Col2Str"><code>Col2Str</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Convert a collection to a string
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-ColCopy"><code>ColCopy</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Copy a collection
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RandGenBinomial"><code>RandGenBinomial</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Generate random numbers from a binomial distribution
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RandGenDiscrete"><code>RandGenDiscrete</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Generate random numbers from a custom discrete distribution
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RandGenNormal"><code>RandGenNormal</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Generate random numbers from a normal distribution
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RandGenPoisson"><code>RandGenPoisson</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Generate random numbers from a poisson distribution
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RandGenUniformCont"><code>RandGenUniformCont</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Generate random numbers from a continuous uniform distribution
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RandGenUniformDisc"><code>RandGenUniformDisc</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Generate random numbers from a discrete uniform distribution
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RandInvBinomial"><code>RandInvBinomial</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Generate a random number from a binomial distribution
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RandInvDiscrete"><code>RandInvDiscrete</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Generate a random number from a custom discrete distribution
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RandInvNormal"><code>RandInvNormal</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Generate a random number from a normal distribution
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RandInvPoisson"><code>RandInvPoisson</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Generate a random number from a Poisson distribution
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RandInvUniformCont"><code>RandInvUniformCont</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Generate a random number from a continuous uniform distribution
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RandInvUniformDisc"><code>RandInvUniformDisc</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Generate a random number from a discrete uniform distribution
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngClear"><code>RngClear</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Clear a range
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngCurRegion"><code>RngCurRegion</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Return the current region of a range
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngFormat"><code>RngFormat</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Format a range
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngFromCSV"><code>RngFromCSV</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Read a csv file and output it to cells
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetAddress"><code>RngGetAddress</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Return the address of a range.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetColLetter"><code>RngGetColLetter</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Convert column number to letter
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetCols"><code>RngGetCols</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Columns in range
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetCurRegionAddress"><code>RngGetCurRegionAddress</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Return the address of the current region of a range
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetCurRegionCols"><code>RngGetCurRegionCols</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Columns in current region
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetCurRegionFirstCol"><code>RngGetCurRegionFirstCol</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
First column in current region
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetCurRegionFirstRow"><code>RngGetCurRegionFirstRow</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
First row in current region
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetCurRegionLastCol"><code>RngGetCurRegionLastCol</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Last column in current region
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetCurRegionLastRow"><code>RngGetCurRegionLastRow</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Last row in current region
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetCurRegionLowerLeft"><code>RngGetCurRegionLowerLeft</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Return the lower left cell of the current region
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetCurRegionLowerRight"><code>RngGetCurRegionLowerRight</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Return the lower right cell of the current region
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetCurRegionRange"><code>RngGetCurRegionRange</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Return the part of the current region starting with upper right cell in row and col number (counting within the current range) and lower right corner of the current range.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetCurRegionRows"><code>RngGetCurRegionRows</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Rows in current region
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetCurRegionUpperLeft"><code>RngGetCurRegionUpperLeft</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Return the upper left cell of the current region
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetCurRegionUpperRight"><code>RngGetCurRegionUpperRight</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Return the upper right cell of the current region
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetFirstCol"><code>RngGetFirstCol</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
First column in range
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetFirstRow"><code>RngGetFirstRow</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
First row in range
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetLastCol"><code>RngGetLastCol</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Last column in range
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetLastRow"><code>RngGetLastRow</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Last row in range
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetLowerLeft"><code>RngGetLowerLeft</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Return the lower left cell of the range
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetLowerRight"><code>RngGetLowerRight</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Return the lower right cell of the range
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetRange"><code>RngGetRange</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Return the part of the range starting with upper right cell in row and col
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetRows"><code>RngGetRows</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Rows in range
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetUpperLeft"><code>RngGetUpperLeft</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Return the upper left cell of the range
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngGetUpperRight"><code>RngGetUpperRight</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Return the upper right cell of the range
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngJoin"><code>RngJoin</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Join two ranges
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngPaste"><code>RngPaste</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Paste a range on a sheet.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngRemoveInterior"><code>RngRemoveInterior</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Remove fill colors in cell range
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-RngToCSV"><code>RngToCSV</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Write a range to a csv file
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-TmElapsed"><code>TmElapsed</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Time since timer has be started.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-TmRestoreAfterSpeedOptimize"><code>TmRestoreAfterSpeedOptimize</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Restore properties for the Application object after have called ApplicationSpeedOptimize
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-TmSpeedOptimize"><code>TmSpeedOptimize</code></a>
</td>
<td style="text-align:left;">
sub
</td>
<td style="text-align:left;">
Set some properties for the Application object to optimize excecution of vba
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-TmStart"><code>TmStart</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Start timer (unit seconds)
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-WstClear"><code>WstClear</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Clear a worksheet if it exists
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-WstCreate"><code>WstCreate</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Create a worksheet
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-WstDelete"><code>WstDelete</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Delete a worksheet if it exists
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-WstExists"><code>WstExists</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Check if a worksheet exists
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="apdx-vba.html#def-vba-WstRename"><code>WstRename</code></a>
</td>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Rename a worksheet if it exists and no sheet with the new name
</td>
</tr>
</tbody>
</table>
<div id="detailed-descriptions-of-course-procedures" class="section level3 hasAnchor" number="21.3.1">
<h3><span class="header-section-number">E.3.1</span> Detailed descriptions of course procedures<a href="apdx-vba.html#detailed-descriptions-of-course-procedures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; • `` -&gt; `...1`
#&gt; • `` -&gt; `...2`
#&gt; Warning in stri_sub(string, from = start, to = end): argument is not an atomic vector; coercing
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; • `` -&gt; `...1`
#&gt; • `` -&gt; `...2`</code></pre>
<div id="def-vba-RngRemoveInterior" class="section level4 hasAnchor" number="21.3.1.1">
<h4><span class="header-section-number">E.3.1.1</span> RngRemoveInterior: Remove fill colors in cell range<a href="apdx-vba.html#def-vba-RngRemoveInterior" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub RngRemoveInterior(
   rng As Range
)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">Range to clear.</td>
</tr>
</tbody>
</table>
</div>
<div id="def-vba-RngFormat" class="section level4 hasAnchor" number="21.3.1.2">
<h4><span class="header-section-number">E.3.1.2</span> RngFormat: Format a range<a href="apdx-vba.html#def-vba-RngFormat" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub RngFormat(
   rng As Range,
   Optional color As String = &quot;none&quot;,
   Optional fit As Boolean = False,
   Optional vertical As Boolean = False,
   Optional merge As Boolean = False,
   Optional wrap As Boolean = False
)</code></pre>
<table>
<colgroup>
<col width="10%" />
<col width="89%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">Range to format.</td>
</tr>
<tr class="even">
<td align="left"><code>color</code></td>
<td align="left">A string equal “normal”, “yellow”, “orange” or “green” (otherwise leave background as is).</td>
</tr>
<tr class="odd">
<td align="left"><code>fit</code></td>
<td align="left">Autofit width?</td>
</tr>
<tr class="even">
<td align="left"><code>vertical</code></td>
<td align="left">Make orientation vertical?</td>
</tr>
<tr class="odd">
<td align="left"><code>merge</code></td>
<td align="left">Merge range?</td>
</tr>
<tr class="even">
<td align="left"><code>wrap</code></td>
<td align="left">Wrap text?</td>
</tr>
</tbody>
</table>
<p>Only works if you use an english version of Excel since e.g. .Style=“Good” must be replaced with .Style = “God” in DK.</p>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    Dim rngNew As Range
    Set rng = RngCurRegion(Range(&quot;D7&quot;))         &#39; get current region
    MsgBox (&quot;Copy to H14 (upper left corner).&quot;)
    Set rngNew = RngPaste(rng, Range(&quot;H14&quot;))    &#39; rngNew is now the new range
    MsgBox (&quot;Make yellow.&quot;)
    Call RngFormat(rngNew, &quot;yellow&quot;)
    MsgBox (&quot;Remove format.&quot;)
    Call RngClear(rngNew, blnCells:=False, blnFormat:=True)
    MsgBox (&quot;Clear range.&quot;)
    Call RngClear(rngNew)</code></pre>
</div>
<div id="def-vba-RngGetCurRegionRows" class="section level4 hasAnchor" number="21.3.1.3">
<h4><span class="header-section-number">E.3.1.3</span> RngGetCurRegionRows: Rows in current region<a href="apdx-vba.html#def-vba-RngGetCurRegionRows" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetCurRegionRows(
   rng As Range
) As Long</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range within the currentregion</td>
</tr>
</tbody>
</table>
<p>Currentregion is the 2-dim range exapanded until empty cells</p>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Set rng = Range(&quot;D7&quot;)  &#39; assume we know that data contains cell D7
    MsgBox (&quot;Address: &quot; &amp; RngGetCurRegionAddress(rng))
    MsgBox (&quot;Rows = &quot; &amp; RngGetCurRegionRows(rng) &amp; &quot; cols = &quot; &amp; RngGetCurRegionCols(rng))
    MsgBox (&quot;First row number = &quot; &amp; RngGetCurRegionFirstRow(rng) &amp; &quot;. Last row number = &quot; &amp; RngGetCurRegionLastRow(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col number = &quot; &amp; RngGetCurRegionFirstCol(rng) &amp; &quot;. Last col number = &quot; &amp; RngGetCurRegionLastCol(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col letter = &quot; &amp; RngGetCurRegionFirstCol(rng, True) &amp; &quot;. Last col letter = &quot; &amp; RngGetCurRegionLastCol(rng, True) &amp; &quot;.&quot;)</code></pre>
</div>
<div id="def-vba-RngGetCurRegionCols" class="section level4 hasAnchor" number="21.3.1.4">
<h4><span class="header-section-number">E.3.1.4</span> RngGetCurRegionCols: Columns in current region<a href="apdx-vba.html#def-vba-RngGetCurRegionCols" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetCurRegionCols(
   rng As Range
) As Long</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range within the currentregion</td>
</tr>
</tbody>
</table>
<p>Currentregion is the 2-dim range exapanded until empty cells</p>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Set rng = Range(&quot;D7&quot;)  &#39; assume we know that data contains cell D7
    MsgBox (&quot;Address: &quot; &amp; RngGetCurRegionAddress(rng))
    MsgBox (&quot;Rows = &quot; &amp; RngGetCurRegionRows(rng) &amp; &quot; cols = &quot; &amp; RngGetCurRegionCols(rng))
    MsgBox (&quot;First row number = &quot; &amp; RngGetCurRegionFirstRow(rng) &amp; &quot;. Last row number = &quot; &amp; RngGetCurRegionLastRow(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col number = &quot; &amp; RngGetCurRegionFirstCol(rng) &amp; &quot;. Last col number = &quot; &amp; RngGetCurRegionLastCol(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col letter = &quot; &amp; RngGetCurRegionFirstCol(rng, True) &amp; &quot;. Last col letter = &quot; &amp; RngGetCurRegionLastCol(rng, True) &amp; &quot;.&quot;)</code></pre>
</div>
<div id="def-vba-RngGetColLetter" class="section level4 hasAnchor" number="21.3.1.5">
<h4><span class="header-section-number">E.3.1.5</span> RngGetColLetter: Convert column number to letter<a href="apdx-vba.html#def-vba-RngGetColLetter" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetColLetter(
   lngCol As Long
) As String</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>lngCol</code></td>
<td align="left">Column number.</td>
</tr>
</tbody>
</table>
</div>
<div id="def-vba-RngGetCurRegionFirstRow" class="section level4 hasAnchor" number="21.3.1.6">
<h4><span class="header-section-number">E.3.1.6</span> RngGetCurRegionFirstRow: First row in current region<a href="apdx-vba.html#def-vba-RngGetCurRegionFirstRow" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetCurRegionFirstRow(
   rng As Range
) As Long</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range within the currentregion</td>
</tr>
</tbody>
</table>
<p>Current region is the 2-dim range expanded until empty cells</p>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Set rng = Range(&quot;D7&quot;)  &#39; assume we know that data contains cell D7
    MsgBox (&quot;Address: &quot; &amp; RngGetCurRegionAddress(rng))
    MsgBox (&quot;Rows = &quot; &amp; RngGetCurRegionRows(rng) &amp; &quot; cols = &quot; &amp; RngGetCurRegionCols(rng))
    MsgBox (&quot;First row number = &quot; &amp; RngGetCurRegionFirstRow(rng) &amp; &quot;. Last row number = &quot; &amp; RngGetCurRegionLastRow(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col number = &quot; &amp; RngGetCurRegionFirstCol(rng) &amp; &quot;. Last col number = &quot; &amp; RngGetCurRegionLastCol(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col letter = &quot; &amp; RngGetCurRegionFirstCol(rng, True) &amp; &quot;. Last col letter = &quot; &amp; RngGetCurRegionLastCol(rng, True) &amp; &quot;.&quot;)</code></pre>
</div>
<div id="def-vba-RngGetCurRegionFirstCol" class="section level4 hasAnchor" number="21.3.1.7">
<h4><span class="header-section-number">E.3.1.7</span> RngGetCurRegionFirstCol: First column in current region<a href="apdx-vba.html#def-vba-RngGetCurRegionFirstCol" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetCurRegionFirstCol(
   rng As Range,
   Optional asLetter As Boolean = False
) As Variant</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range within the currentregion</td>
</tr>
</tbody>
</table>
<p>Currentregion is the 2-dim range expanded until empty cells</p>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Set rng = Range(&quot;D7&quot;)  &#39; assume we know that data contains cell D7
    MsgBox (&quot;Address: &quot; &amp; RngGetCurRegionAddress(rng))
    MsgBox (&quot;Rows = &quot; &amp; RngGetCurRegionRows(rng) &amp; &quot; cols = &quot; &amp; RngGetCurRegionCols(rng))
    MsgBox (&quot;First row number = &quot; &amp; RngGetCurRegionFirstRow(rng) &amp; &quot;. Last row number = &quot; &amp; RngGetCurRegionLastRow(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col number = &quot; &amp; RngGetCurRegionFirstCol(rng) &amp; &quot;. Last col number = &quot; &amp; RngGetCurRegionLastCol(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col letter = &quot; &amp; RngGetCurRegionFirstCol(rng, True) &amp; &quot;. Last col letter = &quot; &amp; RngGetCurRegionLastCol(rng, True) &amp; &quot;.&quot;)</code></pre>
</div>
<div id="def-vba-RngGetCurRegionLastRow" class="section level4 hasAnchor" number="21.3.1.8">
<h4><span class="header-section-number">E.3.1.8</span> RngGetCurRegionLastRow: Last row in current region<a href="apdx-vba.html#def-vba-RngGetCurRegionLastRow" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetCurRegionLastRow(
   rng As Range
) As Long</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range within the currentregion</td>
</tr>
</tbody>
</table>
<p>Currentregion is the 2-dim range expanded until empty cells</p>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Set rng = Range(&quot;D7&quot;)  &#39; assume we know that data contains cell D7
    MsgBox (&quot;Address: &quot; &amp; RngGetCurRegionAddress(rng))
    MsgBox (&quot;Rows = &quot; &amp; RngGetCurRegionRows(rng) &amp; &quot; cols = &quot; &amp; RngGetCurRegionCols(rng))
    MsgBox (&quot;First row number = &quot; &amp; RngGetCurRegionFirstRow(rng) &amp; &quot;. Last row number = &quot; &amp; RngGetCurRegionLastRow(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col number = &quot; &amp; RngGetCurRegionFirstCol(rng) &amp; &quot;. Last col number = &quot; &amp; RngGetCurRegionLastCol(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col letter = &quot; &amp; RngGetCurRegionFirstCol(rng, True) &amp; &quot;. Last col letter = &quot; &amp; RngGetCurRegionLastCol(rng, True) &amp; &quot;.&quot;)</code></pre>
</div>
<div id="def-vba-RngGetCurRegionLastCol" class="section level4 hasAnchor" number="21.3.1.9">
<h4><span class="header-section-number">E.3.1.9</span> RngGetCurRegionLastCol: Last column in current region<a href="apdx-vba.html#def-vba-RngGetCurRegionLastCol" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetCurRegionLastCol(
   rng As Range,
   Optional asLetter As Boolean = False
) As Variant</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range within the currentregion</td>
</tr>
</tbody>
</table>
<p>Currentregion is the 2-dim range expanded until empty cells</p>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Set rng = Range(&quot;D7&quot;)  &#39; assume we know that data contains cell D7
    MsgBox (&quot;Address: &quot; &amp; RngGetCurRegionAddress(rng))
    MsgBox (&quot;Rows = &quot; &amp; RngGetCurRegionRows(rng) &amp; &quot; cols = &quot; &amp; RngGetCurRegionCols(rng))
    MsgBox (&quot;First row number = &quot; &amp; RngGetCurRegionFirstRow(rng) &amp; &quot;. Last row number = &quot; &amp; RngGetCurRegionLastRow(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col number = &quot; &amp; RngGetCurRegionFirstCol(rng) &amp; &quot;. Last col number = &quot; &amp; RngGetCurRegionLastCol(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col letter = &quot; &amp; RngGetCurRegionFirstCol(rng, True) &amp; &quot;. Last col letter = &quot; &amp; RngGetCurRegionLastCol(rng, True) &amp; &quot;.&quot;)</code></pre>
</div>
<div id="def-vba-RngGetCurRegionRange" class="section level4 hasAnchor" number="21.3.1.10">
<h4><span class="header-section-number">E.3.1.10</span> RngGetCurRegionRange: Return the part of the current region starting with upper right cell in row and col number (counting within the current range) and lower right corner of the current range.<a href="apdx-vba.html#def-vba-RngGetCurRegionRange" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetCurRegionRange(
   rng As Range,
   Optional row As Integer = 1,
   Optional col As Integer = 1
) As Range</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range within the currentregion</td>
</tr>
<tr class="even">
<td align="left"><code>row</code></td>
<td align="left">First row number in the current range.</td>
</tr>
<tr class="odd">
<td align="left"><code>col</code></td>
<td align="left">First column number in the current range.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    RngGetCurRegionRange(rng, 2, 3) &#39; return the range of the current region starting in row number 2 and column number 3.</code></pre>
</div>
<div id="def-vba-RngGetCurRegionUpperLeft" class="section level4 hasAnchor" number="21.3.1.11">
<h4><span class="header-section-number">E.3.1.11</span> RngGetCurRegionUpperLeft: Return the upper left cell of the current region<a href="apdx-vba.html#def-vba-RngGetCurRegionUpperLeft" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetCurRegionUpperLeft(
   rng As Range,
   Optional asString As Boolean = False
) As Variant</code></pre>
<table>
<colgroup>
<col width="15%" />
<col width="84%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range within the currentregion</td>
</tr>
<tr class="even">
<td align="left"><code>asString</code></td>
<td align="left">Return as R1C1 string; otherwise return a Range to the cell.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>  Dim rng As Range
  Set rng = ThisWorkbook.Worksheets(&quot;TM5&quot;).Range(&quot;C5&quot;)
  MsgBox (&quot;Address: &quot; &amp; RngGetCurRegionAddress(rng))
  MsgBox (&quot;Number of rows: &quot; &amp; RngGetCurRegionRows(rng))
  MsgBox (&quot;Number of cols: &quot; &amp; RngGetCurRegionCols(rng))
  MsgBox (&quot;First column number: &quot; &amp; RngGetCurRegionFirstCol(rng))
  MsgBox (&quot;First column letter: &quot; &amp; RngGetCurRegionFirstCol(rng, asLetter:=True))
  MsgBox (&quot;Lower left cell: &quot; &amp; RngGetCurRegionLowerLeft(rng, asString:=True))
  MsgBox (&quot;Upper left cell: &quot; &amp; RngGetCurRegionUpperLeft(rng, asString:=True))
  MsgBox (&quot;Lower right cell: &quot; &amp; RngGetCurRegionLowerRight(rng, asString:=True))
  MsgBox (&quot;Upper right cell: &quot; &amp; RngGetCurRegionUpperRight(rng, asString:=True))</code></pre>
</div>
<div id="def-vba-RngGetCurRegionLowerLeft" class="section level4 hasAnchor" number="21.3.1.12">
<h4><span class="header-section-number">E.3.1.12</span> RngGetCurRegionLowerLeft: Return the lower left cell of the current region<a href="apdx-vba.html#def-vba-RngGetCurRegionLowerLeft" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetCurRegionLowerLeft(
   rng As Range,
   Optional asString As Boolean = False
) As Variant</code></pre>
<table>
<colgroup>
<col width="15%" />
<col width="84%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range within the currentregion</td>
</tr>
<tr class="even">
<td align="left"><code>asString</code></td>
<td align="left">Return as R1C1 string; otherwise return a Range to the cell.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>  Dim rng As Range
  Set rng = ThisWorkbook.Worksheets(&quot;TM5&quot;).Range(&quot;C5&quot;)
  MsgBox (&quot;Address: &quot; &amp; RngGetCurRegionAddress(rng))
  MsgBox (&quot;Number of rows: &quot; &amp; RngGetCurRegionRows(rng))
  MsgBox (&quot;Number of cols: &quot; &amp; RngGetCurRegionCols(rng))
  MsgBox (&quot;First column number: &quot; &amp; RngGetCurRegionFirstCol(rng))
  MsgBox (&quot;First column letter: &quot; &amp; RngGetCurRegionFirstCol(rng, asLetter:=True))
  MsgBox (&quot;Lower left cell: &quot; &amp; RngGetCurRegionLowerLeft(rng, asString:=True))
  MsgBox (&quot;Upper left cell: &quot; &amp; RngGetCurRegionUpperLeft(rng, asString:=True))
  MsgBox (&quot;Lower right cell: &quot; &amp; RngGetCurRegionLowerRight(rng, asString:=True))
  MsgBox (&quot;Upper right cell: &quot; &amp; RngGetCurRegionUpperRight(rng, asString:=True))</code></pre>
</div>
<div id="def-vba-RngGetCurRegionUpperRight" class="section level4 hasAnchor" number="21.3.1.13">
<h4><span class="header-section-number">E.3.1.13</span> RngGetCurRegionUpperRight: Return the upper right cell of the current region<a href="apdx-vba.html#def-vba-RngGetCurRegionUpperRight" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetCurRegionUpperRight(
   rng As Range,
   Optional asString As Boolean = False
) As Variant</code></pre>
<table>
<colgroup>
<col width="15%" />
<col width="84%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range within the currentregion</td>
</tr>
<tr class="even">
<td align="left"><code>asString</code></td>
<td align="left">Return as R1C1 string; otherwise return a Range to the cell.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>  Dim rng As Range
  Set rng = ThisWorkbook.Worksheets(&quot;TM5&quot;).Range(&quot;C5&quot;)
  MsgBox (&quot;Address: &quot; &amp; RngGetCurRegionAddress(rng))
  MsgBox (&quot;Number of rows: &quot; &amp; RngGetCurRegionRows(rng))
  MsgBox (&quot;Number of cols: &quot; &amp; RngGetCurRegionCols(rng))
  MsgBox (&quot;First column number: &quot; &amp; RngGetCurRegionFirstCol(rng))
  MsgBox (&quot;First column letter: &quot; &amp; RngGetCurRegionFirstCol(rng, asLetter:=True))
  MsgBox (&quot;Lower left cell: &quot; &amp; RngGetCurRegionLowerLeft(rng, asString:=True))
  MsgBox (&quot;Upper left cell: &quot; &amp; RngGetCurRegionUpperLeft(rng, asString:=True))
  MsgBox (&quot;Lower right cell: &quot; &amp; RngGetCurRegionLowerRight(rng, asString:=True))
  MsgBox (&quot;Upper right cell: &quot; &amp; RngGetCurRegionUpperRight(rng, asString:=True))</code></pre>
</div>
<div id="def-vba-RngGetCurRegionLowerRight" class="section level4 hasAnchor" number="21.3.1.14">
<h4><span class="header-section-number">E.3.1.14</span> RngGetCurRegionLowerRight: Return the lower right cell of the current region<a href="apdx-vba.html#def-vba-RngGetCurRegionLowerRight" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetCurRegionLowerRight(
   rng As Range,
   Optional asString As Boolean = False
) As Variant</code></pre>
<table>
<colgroup>
<col width="15%" />
<col width="84%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range within the currentregion</td>
</tr>
<tr class="even">
<td align="left"><code>asString</code></td>
<td align="left">Return as R1C1 string; otherwise return a Range to the cell.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>  Dim rng As Range
  Set rng = ThisWorkbook.Worksheets(&quot;TM5&quot;).Range(&quot;C5&quot;)
  MsgBox (&quot;Address: &quot; &amp; RngGetCurRegionAddress(rng))
  MsgBox (&quot;Number of rows: &quot; &amp; RngGetCurRegionRows(rng))
  MsgBox (&quot;Number of cols: &quot; &amp; RngGetCurRegionCols(rng))
  MsgBox (&quot;First column number: &quot; &amp; RngGetCurRegionFirstCol(rng))
  MsgBox (&quot;First column letter: &quot; &amp; RngGetCurRegionFirstCol(rng, asLetter:=True))
  MsgBox (&quot;Lower left cell: &quot; &amp; RngGetCurRegionLowerLeft(rng, asString:=True))
  MsgBox (&quot;Upper left cell: &quot; &amp; RngGetCurRegionUpperLeft(rng, asString:=True))
  MsgBox (&quot;Lower right cell: &quot; &amp; RngGetCurRegionLowerRight(rng, asString:=True))
  MsgBox (&quot;Upper right cell: &quot; &amp; RngGetCurRegionUpperRight(rng, asString:=True))</code></pre>
</div>
<div id="def-vba-RngJoin" class="section level4 hasAnchor" number="21.3.1.15">
<h4><span class="header-section-number">E.3.1.15</span> RngJoin: Join two ranges<a href="apdx-vba.html#def-vba-RngJoin" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngJoin(
   rng1 As Range,
   rng2 As Range
) As Range</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>character(</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>   Dim rng As Range
   ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
   Set rng = RngJoin(Range(&quot;A35:B38&quot;), Range(&quot;A49:D56&quot;))
   MsgBox (RngGetAddress(rng))  &#39; note rng is two seperate blocks of cells</code></pre>
</div>
<div id="def-vba-RngPaste" class="section level4 hasAnchor" number="21.3.1.16">
<h4><span class="header-section-number">E.3.1.16</span> RngPaste: Paste a range on a sheet.<a href="apdx-vba.html#def-vba-RngPaste" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngPaste(
   rng As Range,
   rngUL As Range,
   Optional withFormat As Boolean = False
) As Range</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">The range to paste</td>
</tr>
<tr class="even">
<td align="left"><code>rngUL</code></td>
<td align="left">The upper left cell to paste to.</td>
</tr>
<tr class="odd">
<td align="left"><code>withFormat</code></td>
<td align="left">If true also copy cell format too.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    Dim rngNew As Range
    Set rng = RngCurRegion(Range(&quot;D7&quot;))         &#39; get current region
    MsgBox (&quot;Copy to H14 (upper left corner).&quot;)
    Set rngNew = RngPaste(rng, Range(&quot;H14&quot;))    &#39; rngNew is now the new range
    MsgBox (&quot;Make yellow.&quot;)
    Call RngFormat(rngNew, &quot;yellow&quot;)
    MsgBox (&quot;Remove format.&quot;)
    Call RngClear(rngNew, blnCells:=False, blnFormat:=True)
    MsgBox (&quot;Clear range.&quot;)
    Call RngClear(rngNew)</code></pre>
</div>
<div id="def-vba-RngClear" class="section level4 hasAnchor" number="21.3.1.17">
<h4><span class="header-section-number">E.3.1.17</span> RngClear: Clear a range<a href="apdx-vba.html#def-vba-RngClear" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub RngClear(
   rng As Range,
   Optional blnCells As Boolean = True,
   Optional blnContents As Boolean = False,
   Optional blnFormat As Boolean = False
)</code></pre>
<table>
<colgroup>
<col width="19%" />
<col width="80%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">Range to clear.</td>
</tr>
<tr class="even">
<td align="left"><code>blnCells</code></td>
<td align="left">Delete cell contents, formats, comments, etc. (default).</td>
</tr>
<tr class="odd">
<td align="left"><code>blnContents</code></td>
<td align="left">Delete cell contents.</td>
</tr>
<tr class="even">
<td align="left"><code>blnFormat</code></td>
<td align="left">Delete cell format.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    Dim rngNew As Range
    Set rng = RngCurRegion(Range(&quot;D7&quot;))         &#39; get current region
    MsgBox (&quot;Copy to H14 (upper left corner).&quot;)
    Set rngNew = RngPaste(rng, Range(&quot;H14&quot;))    &#39; rngNew is now the new range
    MsgBox (&quot;Make yellow.&quot;)
    Call RngFormat(rngNew, &quot;yellow&quot;)
    MsgBox (&quot;Remove format.&quot;)
    Call RngClear(rngNew, blnCells:=False, blnFormat:=True)
    MsgBox (&quot;Clear range.&quot;)
    Call RngClear(rngNew)</code></pre>
</div>
<div id="def-vba-RngCurRegion" class="section level4 hasAnchor" number="21.3.1.18">
<h4><span class="header-section-number">E.3.1.18</span> RngCurRegion: Return the current region of a range<a href="apdx-vba.html#def-vba-RngCurRegion" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngCurRegion(
   rng As Range
) As Range</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">The range to get the current region from.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Set rng = RngCurRegion(Range(&quot;D7&quot;))  &#39; rng now is the current region
    MsgBox (&quot;Address: &quot; &amp; RngGetAddress(rng))
    MsgBox (&quot;Rows = &quot; &amp; RngGetRows(rng) &amp; &quot; cols = &quot; &amp; RngGetCols(rng))
    MsgBox (&quot;First row number = &quot; &amp; RngGetFirstRow(rng) &amp; &quot;. Last row number = &quot; &amp; RngGetLastRow(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col number = &quot; &amp; RngGetFirstCol(rng) &amp; &quot;. Last col number = &quot; &amp; RngGetLastCol(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col letter = &quot; &amp; RngGetFirstCol(rng, True) &amp; &quot;. Last col letter = &quot; &amp; RngGetLastCol(rng, True) &amp; &quot;.&quot;)</code></pre>
</div>
<div id="def-vba-RngGetCurRegionAddress" class="section level4 hasAnchor" number="21.3.1.19">
<h4><span class="header-section-number">E.3.1.19</span> RngGetCurRegionAddress: Return the address of the current region of a range<a href="apdx-vba.html#def-vba-RngGetCurRegionAddress" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetCurRegionAddress(
   rng As Range
) As String</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">The range to get the current region from.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Set rng = Range(&quot;D7&quot;)  &#39; assume we know that data contains cell D7
    MsgBox (&quot;Address: &quot; &amp; RngGetCurRegionAddress(rng))
    MsgBox (&quot;Rows = &quot; &amp; RngGetCurRegionRows(rng) &amp; &quot; cols = &quot; &amp; RngGetCurRegionCols(rng))
    MsgBox (&quot;First row number = &quot; &amp; RngGetCurRegionFirstRow(rng) &amp; &quot;. Last row number = &quot; &amp; RngGetCurRegionLastRow(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col number = &quot; &amp; RngGetCurRegionFirstCol(rng) &amp; &quot;. Last col number = &quot; &amp; RngGetCurRegionLastCol(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col letter = &quot; &amp; RngGetCurRegionFirstCol(rng, True) &amp; &quot;. Last col letter = &quot; &amp; RngGetCurRegionLastCol(rng, True) &amp; &quot;.&quot;)</code></pre>
</div>
<div id="def-vba-RngGetAddress" class="section level4 hasAnchor" number="21.3.1.20">
<h4><span class="header-section-number">E.3.1.20</span> RngGetAddress: Return the address of a range.<a href="apdx-vba.html#def-vba-RngGetAddress" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetAddress(
   rng As Range
) As String</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">The range to get the current region from</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Set rng = RngCurRegion(Range(&quot;D7&quot;))  &#39; rng now is the current region
    MsgBox (&quot;Address: &quot; &amp; RngGetAddress(rng))
    MsgBox (&quot;Rows = &quot; &amp; RngGetRows(rng) &amp; &quot; cols = &quot; &amp; RngGetCols(rng))
    MsgBox (&quot;First row number = &quot; &amp; RngGetFirstRow(rng) &amp; &quot;. Last row number = &quot; &amp; RngGetLastRow(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col number = &quot; &amp; RngGetFirstCol(rng) &amp; &quot;. Last col number = &quot; &amp; RngGetLastCol(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col letter = &quot; &amp; RngGetFirstCol(rng, True) &amp; &quot;. Last col letter = &quot; &amp; RngGetLastCol(rng, True) &amp; &quot;.&quot;)</code></pre>
</div>
<div id="def-vba-RngGetRows" class="section level4 hasAnchor" number="21.3.1.21">
<h4><span class="header-section-number">E.3.1.21</span> RngGetRows: Rows in range<a href="apdx-vba.html#def-vba-RngGetRows" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetRows(
   rng As Range
) As Long</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>  Dim rng As Range
  Set rng = ThisWorkbook.Worksheets(&quot;TM5&quot;).Range(&quot;C4:E19&quot;)
  MsgBox (&quot;Number of rows: &quot; &amp; RngGetRows(rng))
  MsgBox (&quot;Number of cols: &quot; &amp; RngGetCols(rng))
  MsgBox (&quot;First column number: &quot; &amp; RngGetFirstCol(rng))
  MsgBox (&quot;First column letter: &quot; &amp; RngGetFirstCol(rng, asLetter:=True))
  MsgBox (&quot;Lower right cell: &quot; &amp; RngGetLowerRight(rng, asString:=True))
  MsgBox (&quot;Upper right cell: &quot; &amp; RngGetUpperRight(rng, asString:=True))</code></pre>
</div>
<div id="def-vba-RngGetCols" class="section level4 hasAnchor" number="21.3.1.22">
<h4><span class="header-section-number">E.3.1.22</span> RngGetCols: Columns in range<a href="apdx-vba.html#def-vba-RngGetCols" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetCols(
   rng As Range
) As Long</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>  Dim rng As Range
  Set rng = ThisWorkbook.Worksheets(&quot;TM5&quot;).Range(&quot;C4:E19&quot;)
  MsgBox (&quot;Number of rows: &quot; &amp; RngGetRows(rng))
  MsgBox (&quot;Number of cols: &quot; &amp; RngGetCols(rng))
  MsgBox (&quot;First column number: &quot; &amp; RngGetFirstCol(rng))
  MsgBox (&quot;First column letter: &quot; &amp; RngGetFirstCol(rng, asLetter:=True))
  MsgBox (&quot;Lower right cell: &quot; &amp; RngGetLowerRight(rng, asString:=True))
  MsgBox (&quot;Upper right cell: &quot; &amp; RngGetUpperRight(rng, asString:=True))</code></pre>
</div>
<div id="def-vba-RngGetFirstRow" class="section level4 hasAnchor" number="21.3.1.23">
<h4><span class="header-section-number">E.3.1.23</span> RngGetFirstRow: First row in range<a href="apdx-vba.html#def-vba-RngGetFirstRow" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetFirstRow(
   rng As Range
) As Long</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Set rng = RngCurRegion(Range(&quot;D7&quot;))  &#39; rng now is the current region
    MsgBox (&quot;Address: &quot; &amp; RngGetAddress(rng))
    MsgBox (&quot;Rows = &quot; &amp; RngGetRows(rng) &amp; &quot; cols = &quot; &amp; RngGetCols(rng))
    MsgBox (&quot;First row number = &quot; &amp; RngGetFirstRow(rng) &amp; &quot;. Last row number = &quot; &amp; RngGetLastRow(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col number = &quot; &amp; RngGetFirstCol(rng) &amp; &quot;. Last col number = &quot; &amp; RngGetLastCol(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col letter = &quot; &amp; RngGetFirstCol(rng, True) &amp; &quot;. Last col letter = &quot; &amp; RngGetLastCol(rng, True) &amp; &quot;.&quot;)</code></pre>
</div>
<div id="def-vba-RngGetFirstCol" class="section level4 hasAnchor" number="21.3.1.24">
<h4><span class="header-section-number">E.3.1.24</span> RngGetFirstCol: First column in range<a href="apdx-vba.html#def-vba-RngGetFirstCol" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetFirstCol(
   rng As Range,
   Optional asLetter As Boolean = False
) As Variant</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>  Dim rng As Range
  Set rng = ThisWorkbook.Worksheets(&quot;TM5&quot;).Range(&quot;C4:E19&quot;)
  MsgBox (&quot;Number of rows: &quot; &amp; RngGetRows(rng))
  MsgBox (&quot;Number of cols: &quot; &amp; RngGetCols(rng))
  MsgBox (&quot;First column number: &quot; &amp; RngGetFirstCol(rng))
  MsgBox (&quot;First column letter: &quot; &amp; RngGetFirstCol(rng, asLetter:=True))
  MsgBox (&quot;Lower right cell: &quot; &amp; RngGetLowerRight(rng, asString:=True))
  MsgBox (&quot;Upper right cell: &quot; &amp; RngGetUpperRight(rng, asString:=True))</code></pre>
</div>
<div id="def-vba-RngGetLastRow" class="section level4 hasAnchor" number="21.3.1.25">
<h4><span class="header-section-number">E.3.1.25</span> RngGetLastRow: Last row in range<a href="apdx-vba.html#def-vba-RngGetLastRow" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetLastRow(
   rng As Range
) As Long</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Set rng = RngCurRegion(Range(&quot;D7&quot;))  &#39; rng now is the current region
    MsgBox (&quot;Address: &quot; &amp; RngGetAddress(rng))
    MsgBox (&quot;Rows = &quot; &amp; RngGetRows(rng) &amp; &quot; cols = &quot; &amp; RngGetCols(rng))
    MsgBox (&quot;First row number = &quot; &amp; RngGetFirstRow(rng) &amp; &quot;. Last row number = &quot; &amp; RngGetLastRow(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col number = &quot; &amp; RngGetFirstCol(rng) &amp; &quot;. Last col number = &quot; &amp; RngGetLastCol(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col letter = &quot; &amp; RngGetFirstCol(rng, True) &amp; &quot;. Last col letter = &quot; &amp; RngGetLastCol(rng, True) &amp; &quot;.&quot;)</code></pre>
</div>
<div id="def-vba-RngGetLastCol" class="section level4 hasAnchor" number="21.3.1.26">
<h4><span class="header-section-number">E.3.1.26</span> RngGetLastCol: Last column in range<a href="apdx-vba.html#def-vba-RngGetLastCol" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetLastCol(
   rng As Range,
   Optional asLetter As Boolean = False
) As Variant</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Set rng = RngCurRegion(Range(&quot;D7&quot;))  &#39; rng now is the current region
    MsgBox (&quot;Address: &quot; &amp; RngGetAddress(rng))
    MsgBox (&quot;Rows = &quot; &amp; RngGetRows(rng) &amp; &quot; cols = &quot; &amp; RngGetCols(rng))
    MsgBox (&quot;First row number = &quot; &amp; RngGetFirstRow(rng) &amp; &quot;. Last row number = &quot; &amp; RngGetLastRow(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col number = &quot; &amp; RngGetFirstCol(rng) &amp; &quot;. Last col number = &quot; &amp; RngGetLastCol(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col letter = &quot; &amp; RngGetFirstCol(rng, True) &amp; &quot;. Last col letter = &quot; &amp; RngGetLastCol(rng, True) &amp; &quot;.&quot;)</code></pre>
</div>
<div id="def-vba-RngGetRange" class="section level4 hasAnchor" number="21.3.1.27">
<h4><span class="header-section-number">E.3.1.27</span> RngGetRange: Return the part of the range starting with upper right cell in row and col<a href="apdx-vba.html#def-vba-RngGetRange" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetRange(
   rng As Range,
   Optional row As Integer = 1,
   Optional col As Integer = 1
) As Range</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range.</td>
</tr>
<tr class="even">
<td align="left"><code>row</code></td>
<td align="left">Row number in the current range.</td>
</tr>
<tr class="odd">
<td align="left"><code>col</code></td>
<td align="left">Column number in the current range.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    RngGetRange(rng, 2, 3) &#39; return the range of the range starting in row number 2 and column number 3.</code></pre>
</div>
<div id="def-vba-RngGetUpperLeft" class="section level4 hasAnchor" number="21.3.1.28">
<h4><span class="header-section-number">E.3.1.28</span> RngGetUpperLeft: Return the upper left cell of the range<a href="apdx-vba.html#def-vba-RngGetUpperLeft" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetUpperLeft(
   rng As Range,
   Optional asString As Boolean = False
) As Variant</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>  MsgBox (&quot;Address: &quot; &amp; RngGetAddress(rng) &amp; vbLf &amp; _
          &quot;Rows: &quot; &amp; RngGetRows(rng) &amp; &quot; &quot; &amp; &quot;Cols: &quot; &amp; RngGetCols(rng) &amp; vbLf &amp; _
          &quot;UL: &quot; &amp; RngGetUpperLeft(rng, asString:=True) &amp; &quot; &quot; &amp; _
          &quot;UR: &quot; &amp; RngGetUpperRight(rng, asString:=True) &amp; vbLf &amp; _
          &quot;LL: &quot; &amp; RngGetLowerLeft(rng, asString:=True) &amp; &quot; &quot; &amp; _
          &quot;LR: &quot; &amp; RngGetLowerRight(rng, asString:=True))</code></pre>
</div>
<div id="def-vba-RngGetLowerLeft" class="section level4 hasAnchor" number="21.3.1.29">
<h4><span class="header-section-number">E.3.1.29</span> RngGetLowerLeft: Return the lower left cell of the range<a href="apdx-vba.html#def-vba-RngGetLowerLeft" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetLowerLeft(
   rng As Range,
   Optional asString As Boolean = False
) As Variant</code></pre>
<table>
<colgroup>
<col width="14%" />
<col width="85%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range.</td>
</tr>
<tr class="even">
<td align="left"><code>asString</code></td>
<td align="left">Return as address string; otherwise return a Range to the cell.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>  MsgBox (&quot;Address: &quot; &amp; RngGetAddress(rng) &amp; vbLf &amp; _
          &quot;Rows: &quot; &amp; RngGetRows(rng) &amp; &quot; &quot; &amp; &quot;Cols: &quot; &amp; RngGetCols(rng) &amp; vbLf &amp; _
          &quot;UL: &quot; &amp; RngGetUpperLeft(rng, asString:=True) &amp; &quot; &quot; &amp; _
          &quot;UR: &quot; &amp; RngGetUpperRight(rng, asString:=True) &amp; vbLf &amp; _
          &quot;LL: &quot; &amp; RngGetLowerLeft(rng, asString:=True) &amp; &quot; &quot; &amp; _
          &quot;LR: &quot; &amp; RngGetLowerRight(rng, asString:=True))</code></pre>
</div>
<div id="def-vba-RngGetUpperRight" class="section level4 hasAnchor" number="21.3.1.30">
<h4><span class="header-section-number">E.3.1.30</span> RngGetUpperRight: Return the upper right cell of the range<a href="apdx-vba.html#def-vba-RngGetUpperRight" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetUpperRight(
   rng As Range,
   Optional asString As Boolean = False
) As Variant</code></pre>
<table>
<colgroup>
<col width="15%" />
<col width="84%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range.</td>
</tr>
<tr class="even">
<td align="left"><code>asString</code></td>
<td align="left">Return as R1C1 string; otherwise return a Range to the cell.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>  Dim rng As Range
  Set rng = ThisWorkbook.Worksheets(&quot;TM5&quot;).Range(&quot;C4:E19&quot;)
  MsgBox (&quot;Number of rows: &quot; &amp; RngGetRows(rng))
  MsgBox (&quot;Number of cols: &quot; &amp; RngGetCols(rng))
  MsgBox (&quot;First column number: &quot; &amp; RngGetFirstCol(rng))
  MsgBox (&quot;First column letter: &quot; &amp; RngGetFirstCol(rng, asLetter:=True))
  MsgBox (&quot;Lower right cell: &quot; &amp; RngGetLowerRight(rng, asString:=True))
  MsgBox (&quot;Upper right cell: &quot; &amp; RngGetUpperRight(rng, asString:=True))</code></pre>
</div>
<div id="def-vba-RngGetLowerRight" class="section level4 hasAnchor" number="21.3.1.31">
<h4><span class="header-section-number">E.3.1.31</span> RngGetLowerRight: Return the lower right cell of the range<a href="apdx-vba.html#def-vba-RngGetLowerRight" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngGetLowerRight(
   rng As Range,
   Optional asString As Boolean = False
) As Variant</code></pre>
<table>
<colgroup>
<col width="15%" />
<col width="84%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>rng</code></td>
<td align="left">A range.</td>
</tr>
<tr class="even">
<td align="left"><code>asString</code></td>
<td align="left">Return as R1C1 string; otherwise return a Range to the cell.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>  Dim rng As Range
  Set rng = ThisWorkbook.Worksheets(&quot;TM5&quot;).Range(&quot;C4:E19&quot;)
  MsgBox (&quot;Number of rows: &quot; &amp; RngGetRows(rng))
  MsgBox (&quot;Number of cols: &quot; &amp; RngGetCols(rng))
  MsgBox (&quot;First column number: &quot; &amp; RngGetFirstCol(rng))
  MsgBox (&quot;First column letter: &quot; &amp; RngGetFirstCol(rng, asLetter:=True))
  MsgBox (&quot;Lower right cell: &quot; &amp; RngGetLowerRight(rng, asString:=True))
  MsgBox (&quot;Upper right cell: &quot; &amp; RngGetUpperRight(rng, asString:=True))</code></pre>
</div>
<div id="def-vba-RngToCSV" class="section level4 hasAnchor" number="21.3.1.32">
<h4><span class="header-section-number">E.3.1.32</span> RngToCSV: Write a range to a csv file<a href="apdx-vba.html#def-vba-RngToCSV" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub RngToCSV(
   strFileName As String,
   rng As Range,
   Optional strDelim As String = &quot;;&quot;,
   Optional blnAddCharacter As Boolean = False,
   Optional blnAbsPath As Boolean = False
)</code></pre>
<table>
<colgroup>
<col width="13%" />
<col width="86%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>strFileName</code></td>
<td align="left">File name.</td>
</tr>
<tr class="even">
<td align="left"><code>rng</code></td>
<td align="left">Range given the upper left cell of where to place the data.</td>
</tr>
<tr class="odd">
<td align="left"><code>strDelim</code></td>
<td align="left">Delimiter, e.g. “,” in a comma delimited file.</td>
</tr>
<tr class="even">
<td align="left"><code>blnAddCharacter</code></td>
<td align="left">Add quotes around values.</td>
</tr>
<tr class="odd">
<td align="left"><code>blnAbsPath</code></td>
<td align="left">If true strName specify the absolute path otherwise create the folder as a subfolder to the current file placement.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5    &#39; clear test cells so have empty cells
    &#39;&#39; Write to csv file
    Set rng = Range(&quot;C4:E19&quot;)
    Call RngToCSV(&quot;test.csv&quot;, rng, &quot;;&quot;)     &#39; semicolon (;) separated file
    &#39;&#39; Read test.csv file to check
    Range(&quot;G3&quot;) = &quot;Content of test.csv:&quot;
    Set rng = RngFromCSV(&quot;test.csv&quot;, Range(&quot;G4&quot;), &quot;;&quot;)</code></pre>
</div>
<div id="def-vba-RngFromCSV" class="section level4 hasAnchor" number="21.3.1.33">
<h4><span class="header-section-number">E.3.1.33</span> RngFromCSV: Read a csv file and output it to cells<a href="apdx-vba.html#def-vba-RngFromCSV" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RngFromCSV(
   strFileName As String,
   rngUL As Range,
   Optional strDelim As String = &quot;;&quot;,
   Optional strExcludeCharacter As String = &quot;&quot;,
   Optional blnAbsPath As Boolean = False
) As Range</code></pre>
<table>
<colgroup>
<col width="15%" />
<col width="84%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>strFileName</code></td>
<td align="left">File name.</td>
</tr>
<tr class="even">
<td align="left"><code>rngUL</code></td>
<td align="left">The upper left cell of where to place the data.</td>
</tr>
<tr class="odd">
<td align="left"><code>strDelim</code></td>
<td align="left">Delimiter, e.g. “,” in a comma delimited file.</td>
</tr>
<tr class="even">
<td align="left"><code>strExcludeCharacter</code></td>
<td align="left">Sometimes csv files have quotes around strings (“value”). If strExcludeCharacter = “““” then removes the quotes.</td>
</tr>
<tr class="odd">
<td align="left"><code>blnAbsPath</code></td>
<td align="left">If true strName specify the absolute path otherwise create the folder as a subfolder to the current file placement.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5    &#39; clear test cells so have empty cells
    &#39;&#39; Read data1.csv file (NOTE you must know the separator in the csv file beforehand!)
    Range(&quot;G3&quot;) = &quot;Content of data1.csv:&quot;
    Set rng = RngFromCSV(&quot;data1.csv&quot;, Range(&quot;G4&quot;), &quot;;&quot;) &#39; paste file in range with upper left cell G4
    MsgBox (RngGetAddress(rng))
    &#39;&#39; Read data2.csv file (NOTE you must know the separator in the csv file beforehand!)
    Range(&quot;G8&quot;) = &quot;Content of data2.csv:&quot;
    Set rng = RngFromCSV(&quot;data2.csv&quot;, Range(&quot;G9&quot;), &quot;,&quot;) &#39; paste file in range with upper left cell G9
    MsgBox (RngGetAddress(rng))
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; • `` -&gt; `...1`
#&gt; • `` -&gt; `...2`</code></pre>
</div>
<div id="def-vba-AryDim" class="section level4 hasAnchor" number="21.3.1.34">
<h4><span class="header-section-number">E.3.1.34</span> AryDim: Array dimension<a href="apdx-vba.html#def-vba-AryDim" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function AryDim(
   ary As Variant
) As Integer</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>ary</code></td>
<td align="left">The array.</td>
</tr>
</tbody>
</table>
</div>
<div id="def-vba-AryToStr" class="section level4 hasAnchor" number="21.3.1.35">
<h4><span class="header-section-number">E.3.1.35</span> AryToStr: Convert an array to a string<a href="apdx-vba.html#def-vba-AryToStr" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function AryToStr(
   ary As Variant,
   Optional strSep As String = &quot;, &quot;
) As String</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>ary</code></td>
<td align="left">A 1D or 2D array.</td>
</tr>
<tr class="even">
<td align="left"><code>strSep</code></td>
<td align="left">Seperator used to seperate the values.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>   Dim intAry(4) As Integer      &#39; define array of integers with index 0-4
   &#39; Set values
   intAry(0) = 9
   intAry(1) = 12
   intAry(2) = 222
   intAry(3) = 4
   intAry(4) = 100
   &#39; Information about the array
   MsgBox (&quot;Lowest index: &quot; &amp; LBound(intAry))
   MsgBox (&quot;Largest index: &quot; &amp; UBound(intAry))
   MsgBox (&quot;Number of elements   : &quot; &amp; UBound(intAry) - LBound(intAry) + 1)
   MsgBox (&quot;Array as a string: &quot; &amp; AryToStr(intAry))</code></pre>
</div>
<div id="def-vba-AryPaste" class="section level4 hasAnchor" number="21.3.1.36">
<h4><span class="header-section-number">E.3.1.36</span> AryPaste: Paste a 1D or 2D array to a sheet<a href="apdx-vba.html#def-vba-AryPaste" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub AryPaste(
   ary As Variant,
   rngUL As Range,
   Optional blnRowwise As Boolean = True
)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>ary</code></td>
<td align="left">The array.</td>
</tr>
<tr class="even">
<td align="left"><code>rng</code></td>
<td align="left">The upper left cell of the printed cells.</td>
</tr>
<tr class="odd">
<td align="left"><code>blnRowwise</code></td>
<td align="left">Paste the 1D array as a column or row (default).</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim ary() As Integer
    Dim strAry() As String
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5
    &#39;&#39; Set to value single value
    ReDim ary(2)
    Call AryToVal(ary, 5)
    Range(&quot;G4&quot;) = &quot;A fixed value:&quot;
    Call AryPaste(ary, Range(&quot;G5&quot;)) &#39; the upper left cell is G5
    &#39;&#39; Paste vertical
    Range(&quot;K4&quot;) = &quot;Paste vertical:&quot;
    Call AryPaste(ary, Range(&quot;K5&quot;), False)
    &#39;&#39; Set to sequence
    Call AryToSeq(ary, 1, 6)
    Range(&quot;G10&quot;) = &quot;A sequence:&quot;
    Call AryPaste(ary, Range(&quot;G11&quot;))
    &#39;&#39; Read strings from a range
    Call AryRead(strAry, Range(&quot;C31:D33&quot;))  &#39; read a 2D array
    Range(&quot;G31&quot;) = &quot;Names in the &quot; &amp; AryDim(strAry) &amp; &quot;D array:&quot;
    Call AryPaste(strAry, Range(&quot;G32&quot;))</code></pre>
</div>
<div id="def-vba-AryPasteRow" class="section level4 hasAnchor" number="21.3.1.37">
<h4><span class="header-section-number">E.3.1.37</span> AryPasteRow: Paste a row of a 2D array to a sheet<a href="apdx-vba.html#def-vba-AryPasteRow" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub AryPasteRow(
   ary As Variant,
   intRowIdx As Integer,
   rngUL As Range,
   Optional blnRowwise As Boolean = True
)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>ary</code></td>
<td align="left">The 2D array.</td>
</tr>
<tr class="even">
<td align="left"><code>intRowIdx</code></td>
<td align="left">The index of the row to paste.</td>
</tr>
<tr class="odd">
<td align="left"><code>rngUL</code></td>
<td align="left">The upper left cell of the paste area.</td>
</tr>
<tr class="even">
<td align="left"><code>blnRowwise</code></td>
<td align="left">Paste the row horizontal (default).</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>   Dim ary(2 To 3, 2 To 5) As Integer
   Call AryToVal(ary, 5)  &#39; set all entries to 5
   &#39; Paste rows
   Call AryPasteRow(ary, 2, Range(&quot;B2&quot;)) &#39; paste row with index 2
   Call AryPasteRow(ary, 0, Range(&quot;B4&quot;)) &#39; nothing happens since index is not valid
   Call AryPasteRow(ary, 3, Range(&quot;B4&quot;), blnRowwise:=False) &#39; print horizontial
   &#39; Paste columns
   Call AryPasteColumn(ary, 2, Range(&quot;A9&quot;)) &#39; paste column with index 2
   Call AryPasteColumn(ary, 1, Range(&quot;B12&quot;)) &#39;  nothing happens since index is not valid
   Call AryPasteColumn(ary, 5, Range(&quot;B12&quot;), blnColwise:=False) &#39; print vertical</code></pre>
</div>
<div id="def-vba-AryPasteColumn" class="section level4 hasAnchor" number="21.3.1.38">
<h4><span class="header-section-number">E.3.1.38</span> AryPasteColumn: Paste a column of a 2D array to a sheet<a href="apdx-vba.html#def-vba-AryPasteColumn" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub AryPasteColumn(
   ary As Variant,
   intColumnIdx As Integer,
   rngUL As Range,
   Optional blnColwise As Boolean = True
)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>ary</code></td>
<td align="left">The 2D array.</td>
</tr>
<tr class="even">
<td align="left"><code>intColumnIdx</code></td>
<td align="left">The index of the row to paste.</td>
</tr>
<tr class="odd">
<td align="left"><code>rngUL</code></td>
<td align="left">The upper left cell of the paste area.</td>
</tr>
<tr class="even">
<td align="left"><code>blnColwise</code></td>
<td align="left">Paste the column vertical (default).</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>   Dim ary(2 To 3, 2 To 5) As Integer
   Call AryToVal(ary, 5)  &#39; set all entries to 5
   &#39; Paste rows
   Call AryPasteRow(ary, 2, Range(&quot;B2&quot;)) &#39; paste row with index 2
   Call AryPasteRow(ary, 0, Range(&quot;B4&quot;)) &#39; nothing happens since index is not valid
   Call AryPasteRow(ary, 3, Range(&quot;B4&quot;), blnRowwise:=False) &#39; print horizontial
   &#39; Paste columns
   Call AryPasteColumn(ary, 2, Range(&quot;A9&quot;)) &#39; paste column with index 2
   Call AryPasteColumn(ary, 1, Range(&quot;B12&quot;)) &#39;  nothing happens since index is not valid
   Call AryPasteColumn(ary, 5, Range(&quot;B12&quot;), blnColwise:=False) &#39; print vertical</code></pre>
</div>
<div id="def-vba-AryCopyRow" class="section level4 hasAnchor" number="21.3.1.39">
<h4><span class="header-section-number">E.3.1.39</span> AryCopyRow: Create a 1D array by copying it from a row in a 2D array<a href="apdx-vba.html#def-vba-AryCopyRow" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub AryCopyRow(
   ary As Variant,
   intRowIdx As Integer,
   aryRes As Variant
)</code></pre>
<table>
<colgroup>
<col width="10%" />
<col width="89%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>ary</code></td>
<td align="left">The 2D array.</td>
</tr>
<tr class="even">
<td align="left"><code>intRowIdx</code></td>
<td align="left">The index of the row.</td>
</tr>
<tr class="odd">
<td align="left"><code>aryRes</code></td>
<td align="left">The 1D array to return (dynamic, ByRef). The array will use the same start and end index as the 2D array!</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>   Dim ary(2 To 3, 2 To 5) As Integer
   Dim aryRes() As Integer
   &#39; Copy row
   Call AryToVal(ary, 5)  &#39; set all entries to 5
   Call AryCopyRow(ary, 2, aryRes)  &#39; copy row with index 2
   Call AryCopyRow(ary, 1, aryRes)  &#39; nothing happens since index is not valid
   &#39; Copy column
   Call AryCopyColumn(ary, 3, aryRes)  &#39; copy column with index 2
   Call AryCopyColumn(ary, 0, aryRes)  &#39; nothing happens since index is not valid</code></pre>
</div>
<div id="def-vba-AryCopyColumn" class="section level4 hasAnchor" number="21.3.1.40">
<h4><span class="header-section-number">E.3.1.40</span> AryCopyColumn: Create a 1D array by copying it from a column in a 2D array<a href="apdx-vba.html#def-vba-AryCopyColumn" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub AryCopyColumn(
   ary As Variant,
   intColumnIdx As Integer,
   aryRes As Variant
)</code></pre>
<table>
<colgroup>
<col width="12%" />
<col width="87%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>ary</code></td>
<td align="left">The 2D array.</td>
</tr>
<tr class="even">
<td align="left"><code>intColumnIdx</code></td>
<td align="left">The index of the column.</td>
</tr>
<tr class="odd">
<td align="left"><code>aryRes</code></td>
<td align="left">The 1D array to return (dynamic, ByRef). The array will use the same start and end index as the 2D array!</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>   Dim ary(2 To 3, 2 To 5) As Integer
   Dim aryRes() As Integer
   &#39; Copy row
   Call AryToVal(ary, 5)  &#39; set all entries to 5
   Call AryCopyRow(ary, 2, aryRes)  &#39; copy row with index 2
   Call AryCopyRow(ary, 1, aryRes)  &#39; nothing happens since index is not valid
   &#39; Copy column
   Call AryCopyColumn(ary, 3, aryRes)  &#39; copy column with index 2
   Call AryCopyColumn(ary, 0, aryRes)  &#39; nothing happens since index is not valid</code></pre>
</div>
<div id="def-vba-AryRead" class="section level4 hasAnchor" number="21.3.1.41">
<h4><span class="header-section-number">E.3.1.41</span> AryRead: Read a range into a 2D array<a href="apdx-vba.html#def-vba-AryRead" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub AryRead(
   ByRef ary As Variant,
   ByRef rng As Range,
   Optional intStartIdx1 As Integer = 1,
   Optional intStartIdx2 As Integer = 1,
   Optional blnReduceDim As Boolean = True
)</code></pre>
<table>
<colgroup>
<col width="12%" />
<col width="87%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>ary</code></td>
<td align="left">Dynamic array.</td>
</tr>
<tr class="even">
<td align="left"><code>rng</code></td>
<td align="left">Range to be copied.</td>
</tr>
<tr class="odd">
<td align="left"><code>intStartIdx1</code></td>
<td align="left">Starting index for first dimension (default 1).</td>
</tr>
<tr class="even">
<td align="left"><code>intStartIdx2</code></td>
<td align="left">Starting index for second dimension (default 1).</td>
</tr>
<tr class="odd">
<td align="left"><code>blnReduceDim</code></td>
<td align="left">If true then reduce a range with 1 row or column to a 1D array. <span class="citation">(<a href="#ref-post"><strong>post?</strong></a>)</span> The array contains the range values</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim ary() As Integer
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5
    &#39;&#39; Read values from a range with only 1 column
    Call AryRead(ary, Range(&quot;C5:C9&quot;))
    Range(&quot;G4&quot;) = AryDim(ary) &amp; &quot;D array:&quot;
    Call AryPaste(ary, Range(&quot;G5&quot;), False)
    &#39;&#39; Read values from a range with only 1 row
    Call AryRead(ary, Range(&quot;C5:E5&quot;))
    Range(&quot;I4&quot;) = AryDim(ary) &amp; &quot;D array:&quot;
    Call AryPaste(ary, Range(&quot;I5&quot;))
    &#39;&#39; Read values from a range with only 1 column/row but use 2D array
    Call AryRead(ary, Range(&quot;C11:C14&quot;), blnReduceDim:=False)
    Range(&quot;G10&quot;) = AryDim(ary) &amp; &quot;D array:&quot;
    Call AryPaste(ary, Range(&quot;G11&quot;), False)
    &#39;&#39; Use other start and end index
    Call AryRead(ary, Range(&quot;C17:E19&quot;), intStartIdx1:=2, intStartIdx2:=5)
    Range(&quot;G16&quot;) = AryDim(ary) &amp; &quot;D array with start index &quot; &amp; LBound(ary, 1) &amp; &quot; and &quot; &amp; LBound(ary, 2) &amp; &quot;:&quot;
    Call AryPaste(ary, Range(&quot;G17&quot;))</code></pre>
</div>
<div id="def-vba-AryReadLong" class="section level4 hasAnchor" number="21.3.1.42">
<h4><span class="header-section-number">E.3.1.42</span> AryReadLong: Read a range (long format) into an array (up to a 5D array is supported)<a href="apdx-vba.html#def-vba-AryReadLong" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub AryReadLong(
   ByRef ary As Variant,
   ByRef rng As Range,
   Optional vntDefalult As Variant = 0
)</code></pre>
<table>
<colgroup>
<col width="5%" />
<col width="94%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>ary</code></td>
<td align="left">Dynamic array.</td>
</tr>
<tr class="even">
<td align="left"><code>rng</code></td>
<td align="left">Range to be copied in long format, i.e. index in all columns except the last which contains the values. <span class="citation">(<a href="#ref-post"><strong>post?</strong></a>)</span> The array contains the range values</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim ary() As Integer
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5
    &#39;&#39; Read 1D array
    Call AryReadLong(ary, Range(&quot;A36:B38&quot;), 3)   &#39; default value = 3
    Range(&quot;G35&quot;) = &quot;Values in the &quot; &amp; AryDim(ary) &amp; &quot;D array:&quot;
    Call AryPaste(ary, Range(&quot;G36&quot;))
    &#39;&#39; Read 2D array
    Call AryReadLong(ary, Range(&quot;A41:C47&quot;), 4)   &#39; default value = 4
    Range(&quot;G40&quot;) = &quot;Values in the &quot; &amp; AryDim(ary) &amp; &quot;D array:&quot;
    Call AryPaste(ary, Range(&quot;G41&quot;))
    &#39;&#39; Read 3D array (cannot be pasted to the sheet, have a look at it using the debugger)
    Call AryReadLong(ary, Range(&quot;A50:D56&quot;), 5)   &#39; default value = 5</code></pre>
</div>
<div id="def-vba-AryEmpty" class="section level4 hasAnchor" number="21.3.1.43">
<h4><span class="header-section-number">E.3.1.43</span> AryEmpty: Check if an array empty<a href="apdx-vba.html#def-vba-AryEmpty" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function AryEmpty(
   ary As Variant
) As Boolean</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>ary</code></td>
<td align="left">The variable to check.</td>
</tr>
</tbody>
</table>
</div>
<div id="def-vba-AryToVal" class="section level4 hasAnchor" number="21.3.1.44">
<h4><span class="header-section-number">E.3.1.44</span> AryToVal: Set all array elements to a specific value<a href="apdx-vba.html#def-vba-AryToVal" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub AryToVal(
   ByRef ary As Variant,
   value As Variant
)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>ary</code></td>
<td align="left">A 1D to 5D array.</td>
</tr>
<tr class="even">
<td align="left"><code>value</code></td>
<td align="left">The value.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim ary() As Integer
    Dim strAry() As String
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5
    &#39;&#39; Set to value single value
    ReDim ary(2)
    Call AryToVal(ary, 5)
    Range(&quot;G4&quot;) = &quot;A fixed value:&quot;
    Call AryPaste(ary, Range(&quot;G5&quot;)) &#39; the upper left cell is G5</code></pre>
</div>
<div id="def-vba-AryToSeq" class="section level4 hasAnchor" number="21.3.1.45">
<h4><span class="header-section-number">E.3.1.45</span> AryToSeq: Set all array elements to a sequence<a href="apdx-vba.html#def-vba-AryToSeq" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub AryToSeq(
   ByRef ary As Variant,
   lngFrom As Long,
   lngTo As Long,
   Optional lngIdx As Long = 1
)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>ary</code></td>
<td align="left">A dynamic array (use redim to resize it)</td>
</tr>
<tr class="even">
<td align="left"><code>lngFrom</code></td>
<td align="left">From value.</td>
</tr>
<tr class="odd">
<td align="left"><code>lngTo</code></td>
<td align="left">To value.</td>
</tr>
<tr class="even">
<td align="left"><code>lngIdx</code></td>
<td align="left">Start index in the array.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim ary() As Integer
    Dim strAry() As String
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5
    &#39;&#39; Set to sequence
    Call AryToSeq(ary, 1, 6)
    Range(&quot;G10&quot;) = &quot;A sequence:&quot;
    Call AryPaste(ary, Range(&quot;G11&quot;))</code></pre>
</div>
<div id="def-vba-AryQuickSort" class="section level4 hasAnchor" number="21.3.1.46">
<h4><span class="header-section-number">E.3.1.46</span> AryQuickSort: Sort a 2-Dimensional array using a quicksort algorithm<a href="apdx-vba.html#def-vba-AryQuickSort" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub AryQuickSort(
   ByRef ary As Variant,
   Optional lngColumn As Long = 0,
   Optional lngStartIdx As Long = -1,
   Optional lngEndIdx As Long = -1
)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>ary</code></td>
<td align="left">Array to sort and return.</td>
</tr>
<tr class="even">
<td align="left"><code>lngColumn</code></td>
<td align="left">Column to sort</td>
</tr>
<tr class="odd">
<td align="left"><code>lngStartIdx</code></td>
<td align="left">Start index to sort from</td>
</tr>
<tr class="even">
<td align="left"><code>lngEndIdx</code></td>
<td align="left">End index to sort from</td>
</tr>
</tbody>
</table>
<p><a href="https://stackoverflow.com/questions/4873182/sorting-a-multidimensionnal-array-in-vba" class="uri">https://stackoverflow.com/questions/4873182/sorting-a-multidimensionnal-array-in-vba</a> Posted by Jim Rech 10/20/98 Excel.Programming. Modifications by Nigel Heffernan: Escape failed comparison with empty variant and defensive coding: check inputs</p>
<p><strong>Examples</strong></p>
<pre><code>    Dim ary() As Integer
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5
    &#39;&#39; Read from a range and sort
    Call AryRead(ary, Range(&quot;C5:E19&quot;))
    Call AryQuickSort(ary, 1)
    Range(&quot;G3&quot;) = &quot;Sort w.r.t. 1. column:&quot;
    Call RngPaste(Range(&quot;C4:E4&quot;), Range(&quot;G4&quot;))
    Call AryPaste(ary, Range(&quot;G5&quot;))</code></pre>
</div>
<div id="def-vba-AryFromCSV" class="section level4 hasAnchor" number="21.3.1.47">
<h4><span class="header-section-number">E.3.1.47</span> AryFromCSV: Read a csv file to and array<a href="apdx-vba.html#def-vba-AryFromCSV" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub AryFromCSV(
   ary As Variant,
   strFileName As String,
   Optional strDelim As String = &quot;;&quot;,
   Optional strExcludeCharacter As String = &quot;&quot;,
   Optional blnAbsPath As Boolean = False,
   Optional lngReadFrom As Long = 1
)</code></pre>
<table>
<colgroup>
<col width="15%" />
<col width="84%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>strFileName</code></td>
<td align="left">File name.</td>
</tr>
<tr class="even">
<td align="left"><code>strDelim</code></td>
<td align="left">Delimiter, e.g. “,” in a comma delimited file.</td>
</tr>
<tr class="odd">
<td align="left"><code>strExcludeCharacter</code></td>
<td align="left">Sometimes csv files have quotes around strings (“value”). If strExcludeCharacter = “““” then removes the quotes.</td>
</tr>
<tr class="even">
<td align="left"><code>blnAbsPath</code></td>
<td align="left">If true strName specify the absolute path otherwise create the folder as a subfolder to the current file placement.</td>
</tr>
<tr class="odd">
<td align="left"><code>lngReadFrom</code></td>
<td align="left">The line to read from.</td>
</tr>
</tbody>
</table>
<p>Inspired by <a href="http://stackoverflow.com/questions/9564908/open-csv-file-via-vba-performance" class="uri">http://stackoverflow.com/questions/9564908/open-csv-file-via-vba-performance</a> Will not work if the cell values contain the delimeter. You MUST use blnAbsPath = True if the files are stored at a network folder (e.g. OneDrive) and specify the full path.</p>
<p><strong>Examples</strong></p>
<pre><code>    Dim rng As Range
    Dim ary() As Integer
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5
    &#39;&#39; Read csv file (NOTE you must know the separator in the csv file beforehand!)
    Range(&quot;G3&quot;) = &quot;Array values:&quot;
    Call AryFromCSV(ary, &quot;data2.csv&quot;, &quot;,&quot;)   &#39; know that it contains integers (otherwise use variant)
    Call AryPaste(ary, Range(&quot;G4&quot;))
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; • `` -&gt; `...1`
#&gt; • `` -&gt; `...2`</code></pre>
</div>
<div id="def-vba-WstExists" class="section level4 hasAnchor" number="21.3.1.48">
<h4><span class="header-section-number">E.3.1.48</span> WstExists: Check if a worksheet exists<a href="apdx-vba.html#def-vba-WstExists" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function WstExists(
   strName As String
) As Boolean</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>strName</code></td>
<td align="left">Name of worksheet.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    If WstExists(&quot;Test&quot;) Then MsgBox (&quot;Found it!&quot;)</code></pre>
</div>
<div id="def-vba-WstDelete" class="section level4 hasAnchor" number="21.3.1.49">
<h4><span class="header-section-number">E.3.1.49</span> WstDelete: Delete a worksheet if it exists<a href="apdx-vba.html#def-vba-WstDelete" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function WstDelete(
   strName As String
) As Boolean</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>strName</code></td>
<td align="left">Name of worksheet.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    If WstDelete(&quot;Test1&quot;) Then MsgBox (&quot;Deleted Test1&quot;)</code></pre>
</div>
<div id="def-vba-WstCreate" class="section level4 hasAnchor" number="21.3.1.50">
<h4><span class="header-section-number">E.3.1.50</span> WstCreate: Create a worksheet<a href="apdx-vba.html#def-vba-WstCreate" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function WstCreate(
   strName As String,
   Optional blnForce As Boolean = False
) As Boolean</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>strName</code></td>
<td align="left">Name of worksheet.</td>
</tr>
<tr class="even">
<td align="left"><code>blnForce</code></td>
<td align="left">Force deletion of worksheet if exists.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    If WstCreate(&quot;Test&quot;, blnForce:=True) Then MsgBox (&quot;Created Test&quot;)  &#39; create Test sheet</code></pre>
</div>
<div id="def-vba-WstRename" class="section level4 hasAnchor" number="21.3.1.51">
<h4><span class="header-section-number">E.3.1.51</span> WstRename: Rename a worksheet if it exists and no sheet with the new name<a href="apdx-vba.html#def-vba-WstRename" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function WstRename(
   strName As String,
   strNewName As String
) As Boolean</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>strName</code></td>
<td align="left">Name of worksheet.</td>
</tr>
<tr class="even">
<td align="left"><code>strNewName</code></td>
<td align="left">New name of worksheet.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    If WstRename(&quot;Test&quot;, &quot;Test1&quot;) Then MsgBox (&quot;Renamed the Test to Test1&quot;)  &#39; only work if no Test1 sheet</code></pre>
</div>
<div id="def-vba-WstClear" class="section level4 hasAnchor" number="21.3.1.52">
<h4><span class="header-section-number">E.3.1.52</span> WstClear: Clear a worksheet if it exists<a href="apdx-vba.html#def-vba-WstClear" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function WstClear(
   strName As String,
   Optional blnCells As Boolean = True,
   Optional blnContents As Boolean = False,
   Optional blnFormat As Boolean = False,
   Optional blnObjects As Boolean = False
) As Boolean</code></pre>
<table>
<colgroup>
<col width="19%" />
<col width="80%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>strName</code></td>
<td align="left">Name of worksheet.</td>
</tr>
<tr class="even">
<td align="left"><code>blnCells</code></td>
<td align="left">Delete cell contents, formats, comments, etc. (default).</td>
</tr>
<tr class="odd">
<td align="left"><code>blnContents</code></td>
<td align="left">Delete only cell contents.</td>
</tr>
<tr class="even">
<td align="left"><code>blnFormat</code></td>
<td align="left">Delete only cell format.</td>
</tr>
<tr class="odd">
<td align="left"><code>blnObjects</code></td>
<td align="left">Delete cell buttons and charts too.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    If WstClear(&quot;Test8&quot;) Then MsgBox (&quot;Cleared Test8&quot;) &#39; no clearing since if no sheet with that name
#&gt; New names:
#&gt; New names:
#&gt; • `` -&gt; `...1`
#&gt; • `` -&gt; `...2`</code></pre>
</div>
<div id="def-vba-Col2Str" class="section level4 hasAnchor" number="21.3.1.53">
<h4><span class="header-section-number">E.3.1.53</span> Col2Str: Convert a collection to a string<a href="apdx-vba.html#def-vba-Col2Str" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function Col2Str(
   col As Collection,
   Optional strSep As String = &quot;, &quot;
) As String</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>col</code></td>
<td align="left">A collection.</td>
</tr>
<tr class="even">
<td align="left"><code>strSep</code></td>
<td align="left">Seperator used to seperate the values.</td>
</tr>
</tbody>
</table>
</div>
<div id="def-vba-ColCopy" class="section level4 hasAnchor" number="21.3.1.54">
<h4><span class="header-section-number">E.3.1.54</span> ColCopy: Copy a collection<a href="apdx-vba.html#def-vba-ColCopy" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function ColCopy(
   colFrom As Collection
) As Collection</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>colFrom</code></td>
<td align="left">The collection to copy.</td>
</tr>
</tbody>
</table>
<pre><code>#&gt; Warning in stri_sub(string, from = start, to = end): argument is not an atomic vector; coercing
#&gt; New names:
#&gt; New names:
#&gt; • `` -&gt; `...1`
#&gt; • `` -&gt; `...2`
#&gt; Warning in stri_sub(string, from = start, to = end): argument is not an atomic vector; coercing
#&gt; New names:
#&gt; • `` -&gt; `...1`
#&gt; • `` -&gt; `...2`
#&gt; Warning in stri_sub(string, from = start, to = end): argument is not an atomic vector; coercing
#&gt; New names:
#&gt; • `` -&gt; `...1`
#&gt; • `` -&gt; `...2`</code></pre>
</div>
<div id="def-vba-TmStart" class="section level4 hasAnchor" number="21.3.1.55">
<h4><span class="header-section-number">E.3.1.55</span> TmStart: Start timer (unit seconds)<a href="apdx-vba.html#def-vba-TmStart" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function TmStart() As Double</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>character(</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    dblTimer = TmStart()
    Application.Wait (Now() + TimeValue(&quot;0:00:02&quot;))   &#39; wait for approx 2 sec
    MsgBox (TmElapsed(dblTimer, &quot;sec&quot;))</code></pre>
</div>
<div id="def-vba-TmElapsed" class="section level4 hasAnchor" number="21.3.1.56">
<h4><span class="header-section-number">E.3.1.56</span> TmElapsed: Time since timer has be started.<a href="apdx-vba.html#def-vba-TmElapsed" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function TmElapsed(
   dblTimer As Double,
   Optional strUnit As String = &quot;sec&quot;
)</code></pre>
<table>
<colgroup>
<col width="13%" />
<col width="86%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>dblTimer</code></td>
<td align="left">Timer when started the timer using timer = StartTimer().</td>
</tr>
<tr class="even">
<td align="left"><code>strUnit</code></td>
<td align="left">Return unit must be either ms, sec, min or hour otherwise return -1</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    dblTimer = TmStart()
    Application.Wait (Now() + TimeValue(&quot;0:00:02&quot;))   &#39; wait for approx 2 sec
    MsgBox (TmElapsed(dblTimer, &quot;sec&quot;))</code></pre>
</div>
<div id="def-vba-TmSpeedOptimize" class="section level4 hasAnchor" number="21.3.1.57">
<h4><span class="header-section-number">E.3.1.57</span> TmSpeedOptimize: Set some properties for the Application object to optimize excecution of vba<a href="apdx-vba.html#def-vba-TmSpeedOptimize" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub TmSpeedOptimize()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>character(</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim dbltimer As Double
    Dim i As Integer
    Dim dblT1 As Double, dblT2 As Double
    &#39; Measure cpu time
    dbltimer = TmStart()
    Application.Wait (Now() + TimeValue(&quot;0:00:02&quot;))   &#39; wait for approx 2 sec
    MsgBox (&quot;Time used: &quot; &amp; TmElapsed(dbltimer, &quot;sec&quot;) &amp; &quot; sec&quot;)
    &#39; Impact of disabling application updates
    Call TmSpeedOptimize
    dbltimer = TmStart()
    For i = 1 To 10000
      Cells(200, 500) = 56
    Next
    dblT1 = TmElapsed(dbltimer, &quot;sec&quot;)
    Call TmRestoreAfterSpeedOptimize
    dbltimer = TmStart()
    For i = 1 To 10000
      Cells(200, 500) = 56
    Next
    dblT2 = TmElapsed(dbltimer, &quot;sec&quot;)
    MsgBox (&quot;Time without updates: &quot; &amp; dblT1 &amp; vbCr &amp; &quot;Time with updates: &quot; &amp; dblT2)
    Cells(200, 500).Clear</code></pre>
</div>
<div id="def-vba-TmRestoreAfterSpeedOptimize" class="section level4 hasAnchor" number="21.3.1.58">
<h4><span class="header-section-number">E.3.1.58</span> TmRestoreAfterSpeedOptimize: Restore properties for the Application object after have called ApplicationSpeedOptimize<a href="apdx-vba.html#def-vba-TmRestoreAfterSpeedOptimize" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub TmRestoreAfterSpeedOptimize()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>character(</code></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim dbltimer As Double
    Dim i As Integer
    Dim dblT1 As Double, dblT2 As Double
    &#39; Measure cpu time
    dbltimer = TmStart()
    Application.Wait (Now() + TimeValue(&quot;0:00:02&quot;))   &#39; wait for approx 2 sec
    MsgBox (&quot;Time used: &quot; &amp; TmElapsed(dbltimer, &quot;sec&quot;) &amp; &quot; sec&quot;)
    &#39; Impact of disabling application updates
    Call TmSpeedOptimize
    dbltimer = TmStart()
    For i = 1 To 10000
      Cells(200, 500) = 56
    Next
    dblT1 = TmElapsed(dbltimer, &quot;sec&quot;)
    Call TmRestoreAfterSpeedOptimize
    dbltimer = TmStart()
    For i = 1 To 10000
      Cells(200, 500) = 56
    Next
    dblT2 = TmElapsed(dbltimer, &quot;sec&quot;)
    MsgBox (&quot;Time without updates: &quot; &amp; dblT1 &amp; vbCr &amp; &quot;Time with updates: &quot; &amp; dblT2)
    Cells(200, 500).Clear
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; New names:
#&gt; • `` -&gt; `...1`
#&gt; • `` -&gt; `...2`</code></pre>
</div>
<div id="def-vba-RandGenNormal" class="section level4 hasAnchor" number="21.3.1.59">
<h4><span class="header-section-number">E.3.1.59</span> RandGenNormal: Generate random numbers from a normal distribution<a href="apdx-vba.html#def-vba-RandGenNormal" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub RandGenNormal(
   intSize As Integer,
   dblMean As Double,
   dblSD As Double,
   ary() As Double
)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>intSize</code></td>
<td align="left">Random numbers generated</td>
</tr>
<tr class="even">
<td align="left"><code>dblMean</code></td>
<td align="left">Mean.</td>
</tr>
<tr class="odd">
<td align="left"><code>dblSD</code></td>
<td align="left">Standard deviation.</td>
</tr>
<tr class="even">
<td align="left"><code>ary</code></td>
<td align="left">Array to store the values in.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim ary() As Double
    Dim aryDens() As Double
    Dim intSize As Integer

    ThisWorkbook.Worksheets(&quot;TM6&quot;).Activate
    Randomize    &#39; initialize random-number generator
    intSize = 20 &#39; generate 20 numbers for each distribution
    &#39; Normal
    Call RandGenNormal(intSize, 100, 20, ary)
    Range(&quot;A1&quot;) = &quot;Normal&quot;
    Call AryPaste(ary, Range(&quot;A2&quot;), False)
    &#39; Cont. uniform [10,500[
    Call RandGenUniformCont(intSize, 10, 500, ary)
    Range(&quot;B1&quot;) = &quot;Uniform&quot;
    Call AryPaste(ary, Range(&quot;B2&quot;), False)
    &#39; Discrete uniform 10,...,500
    Call RandGenUniformDisc(intSize, 10, 500, ary)
    Range(&quot;B1&quot;) = &quot;Uniform&quot;
    Call AryPaste(ary, Range(&quot;B2&quot;), False)
    &#39; Binomial 100 trials, pr = 0.2
    Call RandGenBinomial(intSize, 100, 0.2, ary)
    Range(&quot;C1&quot;) = &quot;Binomial&quot;
    Call AryPaste(ary, Range(&quot;C2&quot;), False)
    &#39; Poisson lambda = 5
    Call RandGenPoisson(intSize, 5, ary)
    Range(&quot;D1&quot;) = &quot;Poisson&quot;
    Call AryPaste(ary, Range(&quot;D2&quot;), False)
    &#39; Custom discrete
    ReDim aryDens(1 To 4, 1 To 2)
    aryDens(1, 1) = 3
    aryDens(2, 1) = 4
    aryDens(3, 1) = 5
    aryDens(4, 1) = 6
    aryDens(1, 2) = 0.1
    aryDens(2, 2) = 0.3
    aryDens(3, 2) = 0.5
    aryDens(4, 2) = 0.1
    Call RandGenDiscrete(intSize, aryDens, ary)
    Range(&quot;E1&quot;) = &quot;Custom&quot;
    Call AryPaste(ary, Range(&quot;E2&quot;), False)
    Range(&quot;G3&quot;) = &quot;Custom distribution:&quot;
    Range(&quot;G4&quot;) = &quot;Value&quot;
    Range(&quot;H4&quot;) = &quot;Prob.&quot;
    Call AryPaste(aryDens, Range(&quot;G5&quot;))</code></pre>
</div>
<div id="def-vba-RandInvNormal" class="section level4 hasAnchor" number="21.3.1.60">
<h4><span class="header-section-number">E.3.1.60</span> RandInvNormal: Generate a random number from a normal distribution<a href="apdx-vba.html#def-vba-RandInvNormal" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RandInvNormal(
   dblMean As Double,
   dblSD As Double
) As Double</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>dblMean</code></td>
<td align="left">Mean.</td>
</tr>
<tr class="even">
<td align="left"><code>dblSD</code></td>
<td align="left">Standard deviation.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    MsgBox (&quot;Normal: &quot; &amp; RandInvNormal(100, 20))</code></pre>
</div>
<div id="def-vba-RandGenUniformCont" class="section level4 hasAnchor" number="21.3.1.61">
<h4><span class="header-section-number">E.3.1.61</span> RandGenUniformCont: Generate random numbers from a continuous uniform distribution<a href="apdx-vba.html#def-vba-RandGenUniformCont" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub RandGenUniformCont(
   intSize As Integer,
   dblMin As Double,
   dblMax As Double,
   ary() As Double
)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>intSize</code></td>
<td align="left">Random numbers generated</td>
</tr>
<tr class="even">
<td align="left"><code>dblMin</code></td>
<td align="left">Minimum number.</td>
</tr>
<tr class="odd">
<td align="left"><code>dblMax</code></td>
<td align="left">Maximum number (not included).</td>
</tr>
<tr class="even">
<td align="left"><code>ary</code></td>
<td align="left">Array to store the values in.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim ary() As Double
    Dim aryDens() As Double
    Dim intSize As Integer

    ThisWorkbook.Worksheets(&quot;TM6&quot;).Activate
    Randomize    &#39; initialize random-number generator
    intSize = 20 &#39; generate 20 numbers for each distribution
    &#39; Normal
    Call RandGenNormal(intSize, 100, 20, ary)
    Range(&quot;A1&quot;) = &quot;Normal&quot;
    Call AryPaste(ary, Range(&quot;A2&quot;), False)
    &#39; Cont. uniform [10,500[
    Call RandGenUniformCont(intSize, 10, 500, ary)
    Range(&quot;B1&quot;) = &quot;Uniform&quot;
    Call AryPaste(ary, Range(&quot;B2&quot;), False)
    &#39; Discrete uniform 10,...,500
    Call RandGenUniformDisc(intSize, 10, 500, ary)
    Range(&quot;B1&quot;) = &quot;Uniform&quot;
    Call AryPaste(ary, Range(&quot;B2&quot;), False)
    &#39; Binomial 100 trials, pr = 0.2
    Call RandGenBinomial(intSize, 100, 0.2, ary)
    Range(&quot;C1&quot;) = &quot;Binomial&quot;
    Call AryPaste(ary, Range(&quot;C2&quot;), False)
    &#39; Poisson lambda = 5
    Call RandGenPoisson(intSize, 5, ary)
    Range(&quot;D1&quot;) = &quot;Poisson&quot;
    Call AryPaste(ary, Range(&quot;D2&quot;), False)
    &#39; Custom discrete
    ReDim aryDens(1 To 4, 1 To 2)
    aryDens(1, 1) = 3
    aryDens(2, 1) = 4
    aryDens(3, 1) = 5
    aryDens(4, 1) = 6
    aryDens(1, 2) = 0.1
    aryDens(2, 2) = 0.3
    aryDens(3, 2) = 0.5
    aryDens(4, 2) = 0.1
    Call RandGenDiscrete(intSize, aryDens, ary)
    Range(&quot;E1&quot;) = &quot;Custom&quot;
    Call AryPaste(ary, Range(&quot;E2&quot;), False)
    Range(&quot;G3&quot;) = &quot;Custom distribution:&quot;
    Range(&quot;G4&quot;) = &quot;Value&quot;
    Range(&quot;H4&quot;) = &quot;Prob.&quot;
    Call AryPaste(aryDens, Range(&quot;G5&quot;))</code></pre>
</div>
<div id="def-vba-RandInvUniformCont" class="section level4 hasAnchor" number="21.3.1.62">
<h4><span class="header-section-number">E.3.1.62</span> RandInvUniformCont: Generate a random number from a continuous uniform distribution<a href="apdx-vba.html#def-vba-RandInvUniformCont" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RandInvUniformCont(
   dblMin As Double,
   dblMax As Double
) As Double</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>dblMin</code></td>
<td align="left">Minimum number.</td>
</tr>
<tr class="even">
<td align="left"><code>dblMax</code></td>
<td align="left">Maximum number (not included).</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    &#39; Cont. uniform [10,500[
    MsgBox (&quot;Uniform (continuous): &quot; &amp; RandInvUniformCont(10, 500))</code></pre>
</div>
<div id="def-vba-RandGenUniformDisc" class="section level4 hasAnchor" number="21.3.1.63">
<h4><span class="header-section-number">E.3.1.63</span> RandGenUniformDisc: Generate random numbers from a discrete uniform distribution<a href="apdx-vba.html#def-vba-RandGenUniformDisc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub RandGenUniformDisc(
   intSize As Integer,
   vntMin As Variant,
   vntMax As Variant,
   ary As Variant
)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>intSize</code></td>
<td align="left">Random numbers generated</td>
</tr>
<tr class="even">
<td align="left"><code>vntMin</code></td>
<td align="left">Minimum number.</td>
</tr>
<tr class="odd">
<td align="left"><code>vntMax</code></td>
<td align="left">Maximum number.</td>
</tr>
<tr class="even">
<td align="left"><code>ary</code></td>
<td align="left">Array to store the values in.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim ary() As Double
    Dim aryDens() As Double
    Dim intSize As Integer

    ThisWorkbook.Worksheets(&quot;TM6&quot;).Activate
    Randomize    &#39; initialize random-number generator
    intSize = 20 &#39; generate 20 numbers for each distribution
    &#39; Normal
    Call RandGenNormal(intSize, 100, 20, ary)
    Range(&quot;A1&quot;) = &quot;Normal&quot;
    Call AryPaste(ary, Range(&quot;A2&quot;), False)
    &#39; Cont. uniform [10,500[
    Call RandGenUniformCont(intSize, 10, 500, ary)
    Range(&quot;B1&quot;) = &quot;Uniform&quot;
    Call AryPaste(ary, Range(&quot;B2&quot;), False)
    &#39; Discrete uniform 10,...,500
    Call RandGenUniformDisc(intSize, 10, 500, ary)
    Range(&quot;B1&quot;) = &quot;Uniform&quot;
    Call AryPaste(ary, Range(&quot;B2&quot;), False)
    &#39; Binomial 100 trials, pr = 0.2
    Call RandGenBinomial(intSize, 100, 0.2, ary)
    Range(&quot;C1&quot;) = &quot;Binomial&quot;
    Call AryPaste(ary, Range(&quot;C2&quot;), False)
    &#39; Poisson lambda = 5
    Call RandGenPoisson(intSize, 5, ary)
    Range(&quot;D1&quot;) = &quot;Poisson&quot;
    Call AryPaste(ary, Range(&quot;D2&quot;), False)
    &#39; Custom discrete
    ReDim aryDens(1 To 4, 1 To 2)
    aryDens(1, 1) = 3
    aryDens(2, 1) = 4
    aryDens(3, 1) = 5
    aryDens(4, 1) = 6
    aryDens(1, 2) = 0.1
    aryDens(2, 2) = 0.3
    aryDens(3, 2) = 0.5
    aryDens(4, 2) = 0.1
    Call RandGenDiscrete(intSize, aryDens, ary)
    Range(&quot;E1&quot;) = &quot;Custom&quot;
    Call AryPaste(ary, Range(&quot;E2&quot;), False)
    Range(&quot;G3&quot;) = &quot;Custom distribution:&quot;
    Range(&quot;G4&quot;) = &quot;Value&quot;
    Range(&quot;H4&quot;) = &quot;Prob.&quot;
    Call AryPaste(aryDens, Range(&quot;G5&quot;))</code></pre>
</div>
<div id="def-vba-RandInvUniformDisc" class="section level4 hasAnchor" number="21.3.1.64">
<h4><span class="header-section-number">E.3.1.64</span> RandInvUniformDisc: Generate a random number from a discrete uniform distribution<a href="apdx-vba.html#def-vba-RandInvUniformDisc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RandInvUniformDisc(
   vntMin As Variant,
   vntMax As Variant
) As Variant</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>vntMin</code></td>
<td align="left">Minimum number.</td>
</tr>
<tr class="even">
<td align="left"><code>vntMax</code></td>
<td align="left">Maximum number.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    &#39; Discrete uniform 10,...,500
    MsgBox (&quot;Uniform (discrete): &quot; &amp; RandInvUniformDisc(10, 500))</code></pre>
</div>
<div id="def-vba-RandGenBinomial" class="section level4 hasAnchor" number="21.3.1.65">
<h4><span class="header-section-number">E.3.1.65</span> RandGenBinomial: Generate random numbers from a binomial distribution<a href="apdx-vba.html#def-vba-RandGenBinomial" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub RandGenBinomial(
   intSize As Integer,
   intTrials As Integer,
   dblPr As Double,
   ary() As Double
)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>intSize</code></td>
<td align="left">Random numbers generated</td>
</tr>
<tr class="even">
<td align="left"><code>intTrials</code></td>
<td align="left">Number of trials.</td>
</tr>
<tr class="odd">
<td align="left"><code>dblPr</code></td>
<td align="left">Probability of success.</td>
</tr>
<tr class="even">
<td align="left"><code>ary</code></td>
<td align="left">Array to store the values in.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    Dim ary() As Double
    Dim aryDens() As Double
    Dim intSize As Integer

    ThisWorkbook.Worksheets(&quot;TM6&quot;).Activate
    Randomize    &#39; initialize random-number generator
    intSize = 20 &#39; generate 20 numbers for each distribution
    &#39; Normal
    Call RandGenNormal(intSize, 100, 20, ary)
    Range(&quot;A1&quot;) = &quot;Normal&quot;
    Call AryPaste(ary, Range(&quot;A2&quot;), False)
    &#39; Cont. uniform [10,500[
    Call RandGenUniformCont(intSize, 10, 500, ary)
    Range(&quot;B1&quot;) = &quot;Uniform&quot;
    Call AryPaste(ary, Range(&quot;B2&quot;), False)
    &#39; Discrete uniform 10,...,500
    Call RandGenUniformDisc(intSize, 10, 500, ary)
    Range(&quot;B1&quot;) = &quot;Uniform&quot;
    Call AryPaste(ary, Range(&quot;B2&quot;), False)
    &#39; Binomial 100 trials, pr = 0.2
    Call RandGenBinomial(intSize, 100, 0.2, ary)
    Range(&quot;C1&quot;) = &quot;Binomial&quot;
    Call AryPaste(ary, Range(&quot;C2&quot;), False)
    &#39; Poisson lambda = 5
    Call RandGenPoisson(intSize, 5, ary)
    Range(&quot;D1&quot;) = &quot;Poisson&quot;
    Call AryPaste(ary, Range(&quot;D2&quot;), False)
    &#39; Custom discrete
    ReDim aryDens(1 To 4, 1 To 2)
    aryDens(1, 1) = 3
    aryDens(2, 1) = 4
    aryDens(3, 1) = 5
    aryDens(4, 1) = 6
    aryDens(1, 2) = 0.1
    aryDens(2, 2) = 0.3
    aryDens(3, 2) = 0.5
    aryDens(4, 2) = 0.1
    Call RandGenDiscrete(intSize, aryDens, ary)
    Range(&quot;E1&quot;) = &quot;Custom&quot;
    Call AryPaste(ary, Range(&quot;E2&quot;), False)
    Range(&quot;G3&quot;) = &quot;Custom distribution:&quot;
    Range(&quot;G4&quot;) = &quot;Value&quot;
    Range(&quot;H4&quot;) = &quot;Prob.&quot;
    Call AryPaste(aryDens, Range(&quot;G5&quot;))</code></pre>
</div>
<div id="def-vba-RandInvBinomial" class="section level4 hasAnchor" number="21.3.1.66">
<h4><span class="header-section-number">E.3.1.66</span> RandInvBinomial: Generate a random number from a binomial distribution<a href="apdx-vba.html#def-vba-RandInvBinomial" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RandInvBinomial(
   intTrials As Integer,
   dblPr As Double
) As Double</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>intTrials</code></td>
<td align="left">Number of trials.</td>
</tr>
<tr class="even">
<td align="left"><code>dblPr</code></td>
<td align="left">Probability of success.</td>
</tr>
</tbody>
</table>
<p><strong>Examples</strong></p>
<pre><code>    &#39; Binomial 100 trials, pr = 0.2
    MsgBox (&quot;Binomial: &quot; &amp; RandInvBinomial(100, 0.2))</code></pre>
</div>
<div id="def-vba-RandGenPoisson" class="section level4 hasAnchor" number="21.3.1.67">
<h4><span class="header-section-number">E.3.1.67</span> RandGenPoisson: Generate random numbers from a poisson distribution<a href="apdx-vba.html#def-vba-RandGenPoisson" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub RandGenPoisson(
   intSize As Integer,
   dblLambda As Double,
   ary() As Double
)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>intSize</code></td>
<td align="left">Random numbers generated</td>
</tr>
<tr class="even">
<td align="left"><code>dblLambda</code></td>
<td align="left">Mean.</td>
</tr>
<tr class="odd">
<td align="left"><code>ary</code></td>
<td align="left">Array to store the values in.</td>
</tr>
</tbody>
</table>
<p>Algorithm suggested by D. Knuth.</p>
<p><strong>Examples</strong></p>
<pre><code>    Dim ary() As Double
    Dim aryDens() As Double
    Dim intSize As Integer

    ThisWorkbook.Worksheets(&quot;TM6&quot;).Activate
    Randomize    &#39; initialize random-number generator
    intSize = 20 &#39; generate 20 numbers for each distribution
    &#39; Normal
    Call RandGenNormal(intSize, 100, 20, ary)
    Range(&quot;A1&quot;) = &quot;Normal&quot;
    Call AryPaste(ary, Range(&quot;A2&quot;), False)
    &#39; Cont. uniform [10,500[
    Call RandGenUniformCont(intSize, 10, 500, ary)
    Range(&quot;B1&quot;) = &quot;Uniform&quot;
    Call AryPaste(ary, Range(&quot;B2&quot;), False)
    &#39; Discrete uniform 10,...,500
    Call RandGenUniformDisc(intSize, 10, 500, ary)
    Range(&quot;B1&quot;) = &quot;Uniform&quot;
    Call AryPaste(ary, Range(&quot;B2&quot;), False)
    &#39; Binomial 100 trials, pr = 0.2
    Call RandGenBinomial(intSize, 100, 0.2, ary)
    Range(&quot;C1&quot;) = &quot;Binomial&quot;
    Call AryPaste(ary, Range(&quot;C2&quot;), False)
    &#39; Poisson lambda = 5
    Call RandGenPoisson(intSize, 5, ary)
    Range(&quot;D1&quot;) = &quot;Poisson&quot;
    Call AryPaste(ary, Range(&quot;D2&quot;), False)
    &#39; Custom discrete
    ReDim aryDens(1 To 4, 1 To 2)
    aryDens(1, 1) = 3
    aryDens(2, 1) = 4
    aryDens(3, 1) = 5
    aryDens(4, 1) = 6
    aryDens(1, 2) = 0.1
    aryDens(2, 2) = 0.3
    aryDens(3, 2) = 0.5
    aryDens(4, 2) = 0.1
    Call RandGenDiscrete(intSize, aryDens, ary)
    Range(&quot;E1&quot;) = &quot;Custom&quot;
    Call AryPaste(ary, Range(&quot;E2&quot;), False)
    Range(&quot;G3&quot;) = &quot;Custom distribution:&quot;
    Range(&quot;G4&quot;) = &quot;Value&quot;
    Range(&quot;H4&quot;) = &quot;Prob.&quot;
    Call AryPaste(aryDens, Range(&quot;G5&quot;))</code></pre>
</div>
<div id="def-vba-RandInvPoisson" class="section level4 hasAnchor" number="21.3.1.68">
<h4><span class="header-section-number">E.3.1.68</span> RandInvPoisson: Generate a random number from a Poisson distribution<a href="apdx-vba.html#def-vba-RandInvPoisson" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RandInvPoisson(
   dblLambda As Double
) As Long</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>dblLambda</code></td>
<td align="left">Mean.</td>
</tr>
</tbody>
</table>
<p>Algorithm suggested by D. Knuth.</p>
<p><strong>Examples</strong></p>
<pre><code>    &#39; Poisson lambda = 5
    MsgBox (&quot;Poisson: &quot; &amp; RandInvPoisson(5))</code></pre>
</div>
<div id="def-vba-RandGenDiscrete" class="section level4 hasAnchor" number="21.3.1.69">
<h4><span class="header-section-number">E.3.1.69</span> RandGenDiscrete: Generate random numbers from a custom discrete distribution<a href="apdx-vba.html#def-vba-RandGenDiscrete" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Sub RandGenDiscrete(
   intSize As Integer,
   dblDens As Variant,
   ary As Variant
)</code></pre>
<table>
<colgroup>
<col width="9%" />
<col width="90%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>intSize</code></td>
<td align="left">Random numbers generated</td>
</tr>
<tr class="even">
<td align="left"><code>dblDens</code></td>
<td align="left">The probability density. First column contains the outcome and the second the probability.</td>
</tr>
<tr class="odd">
<td align="left"><code>ary</code></td>
<td align="left">Array to store the values in.</td>
</tr>
</tbody>
</table>
<p>Assume that the second column in aryDens sums to one.</p>
<p><strong>Examples</strong></p>
<pre><code>    Dim ary() As Double
    Dim aryDens() As Double
    Dim intSize As Integer

    ThisWorkbook.Worksheets(&quot;TM6&quot;).Activate
    Randomize    &#39; initialize random-number generator
    intSize = 20 &#39; generate 20 numbers for each distribution
    &#39; Normal
    Call RandGenNormal(intSize, 100, 20, ary)
    Range(&quot;A1&quot;) = &quot;Normal&quot;
    Call AryPaste(ary, Range(&quot;A2&quot;), False)
    &#39; Cont. uniform [10,500[
    Call RandGenUniformCont(intSize, 10, 500, ary)
    Range(&quot;B1&quot;) = &quot;Uniform&quot;
    Call AryPaste(ary, Range(&quot;B2&quot;), False)
    &#39; Discrete uniform 10,...,500
    Call RandGenUniformDisc(intSize, 10, 500, ary)
    Range(&quot;B1&quot;) = &quot;Uniform&quot;
    Call AryPaste(ary, Range(&quot;B2&quot;), False)
    &#39; Binomial 100 trials, pr = 0.2
    Call RandGenBinomial(intSize, 100, 0.2, ary)
    Range(&quot;C1&quot;) = &quot;Binomial&quot;
    Call AryPaste(ary, Range(&quot;C2&quot;), False)
    &#39; Poisson lambda = 5
    Call RandGenPoisson(intSize, 5, ary)
    Range(&quot;D1&quot;) = &quot;Poisson&quot;
    Call AryPaste(ary, Range(&quot;D2&quot;), False)
    &#39; Custom discrete
    ReDim aryDens(1 To 4, 1 To 2)
    aryDens(1, 1) = 3
    aryDens(2, 1) = 4
    aryDens(3, 1) = 5
    aryDens(4, 1) = 6
    aryDens(1, 2) = 0.1
    aryDens(2, 2) = 0.3
    aryDens(3, 2) = 0.5
    aryDens(4, 2) = 0.1
    Call RandGenDiscrete(intSize, aryDens, ary)
    Range(&quot;E1&quot;) = &quot;Custom&quot;
    Call AryPaste(ary, Range(&quot;E2&quot;), False)
    Range(&quot;G3&quot;) = &quot;Custom distribution:&quot;
    Range(&quot;G4&quot;) = &quot;Value&quot;
    Range(&quot;H4&quot;) = &quot;Prob.&quot;
    Call AryPaste(aryDens, Range(&quot;G5&quot;))</code></pre>
</div>
<div id="def-vba-RandInvDiscrete" class="section level4 hasAnchor" number="21.3.1.70">
<h4><span class="header-section-number">E.3.1.70</span> RandInvDiscrete: Generate a random number from a custom discrete distribution<a href="apdx-vba.html#def-vba-RandInvDiscrete" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Usage</strong></p>
<pre><code>Function RandInvDiscrete(
   aryDens As Variant
) As Variant</code></pre>
<table>
<colgroup>
<col width="9%" />
<col width="90%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>aryDens</code></td>
<td align="left">The probability density. First column contains the outcome and the second the probability.</td>
</tr>
</tbody>
</table>
<p>Assume that the second column in aryDens sums to one.</p>
<p><strong>Examples</strong></p>
<pre><code>    Dim aryDens() As Double
    &#39; Custom discrete
    ReDim aryDens(1 To 4, 1 To 2)
    aryDens(1, 1) = 3
    aryDens(2, 1) = 4
    aryDens(3, 1) = 5
    aryDens(4, 1) = 6
    aryDens(1, 2) = 0.1
    aryDens(2, 2) = 0.3
    aryDens(3, 2) = 0.5
    aryDens(4, 2) = 0.1
    MsgBox (&quot;Custom (discrete): &quot; &amp; RandInvDiscrete(aryDens))</code></pre>
</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-vba-book" class="csl-entry">
Wøhlk, S. 2010. <em>VBA Programming in Business Economics</em>. DJØF Publishing.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="coding-convention.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lg-course.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": false,
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/bss-osca/tfa/edit/master/book/99_apdx.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
