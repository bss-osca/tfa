<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 5 Advanced data types and usage | Tools for Analytics (TFA)</title>
  <meta name="description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 5 Advanced data types and usage | Tools for Analytics (TFA)" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bss-osca.github.io/tfa//assets/logo.png" />
  <meta property="og:description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="github-repo" content="bss-osca/tfa" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 5 Advanced data types and usage | Tools for Analytics (TFA)" />
  
  <meta name="twitter:description" content="Course notes for the ‘Tools for Analytics’ course" />
  <meta name="twitter:image" content="https://bss-osca.github.io/tfa//assets/logo.png" />

<meta name="author" content="Lars Relund Nielsen" />


<meta name="date" content="2024-08-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon" />
<link rel="prev" href="mod-vba-procedures.html"/>
<link rel="next" href="mod-vba-random-numbers.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.11/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<link href="libs/minichart-0.2.2/minicharts.css" rel="stylesheet" />
<script src="libs/minichart-0.2.2/leaflet.minicharts.min.js"></script>
<link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" />
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<html>
<head>
<script>
  $(document).ready(function() {

  // Section anchors
  $('.section h1, .section h2, .section h3, .section h4, .section h5').each(function() {
    anchor = '#' + $(this).parent().attr('id');
    $(this).addClass("hasAnchor").prepend('<a href="' + anchor + '" class="anchor"></a>');
  });
});
</script>
<script src="https://hypothes.is/embed.js" async></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</head>
</html>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="img/logo.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to the course</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#lo-intro"><i class="fa fa-check"></i><b>1.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.2</b> Purpose for the course</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#r-vs-vba"><i class="fa fa-check"></i><b>1.3</b> R vs Excel/VBA</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#computer"><i class="fa fa-check"></i><b>1.4</b> How a computer works</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i><b>1.5</b> How the notes are organized</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#ack"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#ex-intro"><i class="fa fa-check"></i><b>1.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#ex-annotate"><i class="fa fa-check"></i><b>1.7.1</b> Exercise - How to annotate</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I VBA</b></span></li>
<li class="chapter" data-level="2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html"><i class="fa fa-check"></i><b>2</b> An introduction to VBA</a>
<ul>
<li class="chapter" data-level="2.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#lo-vba-intro"><i class="fa fa-check"></i><b>2.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="2.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-what"><i class="fa fa-check"></i><b>2.2</b> What is VBA</a></li>
<li class="chapter" data-level="2.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-setup"><i class="fa fa-check"></i><b>2.3</b> Setup Excel for VBA</a></li>
<li class="chapter" data-level="2.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-hello"><i class="fa fa-check"></i><b>2.4</b> Your first program</a></li>
<li class="chapter" data-level="2.5" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-macro"><i class="fa fa-check"></i><b>2.5</b> The macro recorder</a></li>
<li class="chapter" data-level="2.6" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-overview"><i class="fa fa-check"></i><b>2.6</b> VBA - A short overview</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#variables"><i class="fa fa-check"></i><b>2.6.1</b> Variables</a></li>
<li class="chapter" data-level="2.6.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#procedures"><i class="fa fa-check"></i><b>2.6.2</b> Procedures</a></li>
<li class="chapter" data-level="2.6.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#input-and-output"><i class="fa fa-check"></i><b>2.6.3</b> Input and output</a></li>
<li class="chapter" data-level="2.6.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#conditional-statements"><i class="fa fa-check"></i><b>2.6.4</b> Conditional statements</a></li>
<li class="chapter" data-level="2.6.5" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#loops"><i class="fa fa-check"></i><b>2.6.5</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#vba-coding-practice"><i class="fa fa-check"></i><b>2.7</b> Good coding pratice</a></li>
<li class="chapter" data-level="2.8" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#rc-vba-intro"><i class="fa fa-check"></i><b>2.8</b> Recap</a></li>
<li class="chapter" data-level="2.9" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-intro"><i class="fa fa-check"></i><b>2.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-hello"><i class="fa fa-check"></i><b>2.9.1</b> Exercise - Hello</a></li>
<li class="chapter" data-level="2.9.2" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-macro"><i class="fa fa-check"></i><b>2.9.2</b> Exercise - Record a macro</a></li>
<li class="chapter" data-level="2.9.3" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-user-input"><i class="fa fa-check"></i><b>2.9.3</b> Exercise - User input</a></li>
<li class="chapter" data-level="2.9.4" data-path="mod-vba-intro.html"><a href="mod-vba-intro.html#ex-vba-max-min"><i class="fa fa-check"></i><b>2.9.4</b> Exercise - Max and min number</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html"><i class="fa fa-check"></i><b>3</b> Loops and conditional statements</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#lo-vba-loops-cond"><i class="fa fa-check"></i><b>3.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="3.2" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-operators"><i class="fa fa-check"></i><b>3.2</b> Relational and logical operators</a></li>
<li class="chapter" data-level="3.3" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-loops"><i class="fa fa-check"></i><b>3.3</b> Loops</a></li>
<li class="chapter" data-level="3.4" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-cond"><i class="fa fa-check"></i><b>3.4</b> Conditional statements</a></li>
<li class="chapter" data-level="3.5" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-ex-jen"><i class="fa fa-check"></i><b>3.5</b> Example - Find Jen</a></li>
<li class="chapter" data-level="3.6" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#vba-ex-dist-mat"><i class="fa fa-check"></i><b>3.6</b> Example - A distance matrix</a></li>
<li class="chapter" data-level="3.7" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#recap"><i class="fa fa-check"></i><b>3.7</b> Recap</a></li>
<li class="chapter" data-level="3.8" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-loops-cond"><i class="fa fa-check"></i><b>3.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-loops"><i class="fa fa-check"></i><b>3.8.1</b> Exercise - Loops</a></li>
<li class="chapter" data-level="3.8.2" data-path="mod-vba-loops-cond.html"><a href="mod-vba-loops-cond.html#ex-vba-cond"><i class="fa fa-check"></i><b>3.8.2</b> Exercise - Conditional statements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html"><i class="fa fa-check"></i><b>4</b> Procedures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#lo-vba-procedures"><i class="fa fa-check"></i><b>4.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="4.2" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-subs-functions"><i class="fa fa-check"></i><b>4.2</b> Subs and functions - The basics</a></li>
<li class="chapter" data-level="4.3" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-optional-arg"><i class="fa fa-check"></i><b>4.3</b> Optional arguments</a></li>
<li class="chapter" data-level="4.4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-pub-priv"><i class="fa fa-check"></i><b>4.4</b> Public and private procedures</a></li>
<li class="chapter" data-level="4.5" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-byref"><i class="fa fa-check"></i><b>4.5</b> Passing arguments by reference or by value</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#return-values-from-a-sub"><i class="fa fa-check"></i><b>4.5.1</b> Return values from a sub</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-built-in"><i class="fa fa-check"></i><b>4.6</b> Built-in functions</a></li>
<li class="chapter" data-level="4.7" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#vba-test-persons"><i class="fa fa-check"></i><b>4.7</b> Example - Selection of test persons</a></li>
<li class="chapter" data-level="4.8" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#recap-1"><i class="fa fa-check"></i><b>4.8</b> Recap</a></li>
<li class="chapter" data-level="4.9" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-procedures"><i class="fa fa-check"></i><b>4.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-subs"><i class="fa fa-check"></i><b>4.9.1</b> Exercise - Subs</a></li>
<li class="chapter" data-level="4.9.2" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#exercise---temperatures"><i class="fa fa-check"></i><b>4.9.2</b> Exercise - Temperatures</a></li>
<li class="chapter" data-level="4.9.3" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-functions"><i class="fa fa-check"></i><b>4.9.3</b> Exercise - Functions</a></li>
<li class="chapter" data-level="4.9.4" data-path="mod-vba-procedures.html"><a href="mod-vba-procedures.html#ex-vba-worksheet-functions"><i class="fa fa-check"></i><b>4.9.4</b> Exercise - Worksheet functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html"><i class="fa fa-check"></i><b>5</b> Advanced data types and usage</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#lo-vba-datatypes"><i class="fa fa-check"></i><b>5.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="5.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-strings"><i class="fa fa-check"></i><b>5.2</b> Strings</a></li>
<li class="chapter" data-level="5.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-objects"><i class="fa fa-check"></i><b>5.3</b> Objects</a></li>
<li class="chapter" data-level="5.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-wst"><i class="fa fa-check"></i><b>5.4</b> The Worksheet object</a></li>
<li class="chapter" data-level="5.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#wst-rng"><i class="fa fa-check"></i><b>5.5</b> The Range object</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#named-ranges-in-excel"><i class="fa fa-check"></i><b>5.5.1</b> Named ranges in Excel</a></li>
<li class="chapter" data-level="5.5.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#current-region-of-a-range"><i class="fa fa-check"></i><b>5.5.2</b> Current region of a range</a></li>
<li class="chapter" data-level="5.5.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#input-and-output-1"><i class="fa fa-check"></i><b>5.5.3</b> Input and output</a></li>
<li class="chapter" data-level="5.5.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#sorting-a-range"><i class="fa fa-check"></i><b>5.5.4</b> Sorting a range</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-ary"><i class="fa fa-check"></i><b>5.6</b> Arrays</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#multi-dimensional-arrays"><i class="fa fa-check"></i><b>5.6.1</b> Multi-dimensional arrays</a></li>
<li class="chapter" data-level="5.6.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#dynamic-arrays"><i class="fa fa-check"></i><b>5.6.2</b> Dynamic arrays</a></li>
<li class="chapter" data-level="5.6.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#input-and-output-2"><i class="fa fa-check"></i><b>5.6.3</b> Input and output</a></li>
<li class="chapter" data-level="5.6.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#sorting-arrays"><i class="fa fa-check"></i><b>5.6.4</b> Sorting arrays</a></li>
<li class="chapter" data-level="5.6.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#use-arrays-instead-of-ranges"><i class="fa fa-check"></i><b>5.6.5</b> Use arrays instead of ranges</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-coll"><i class="fa fa-check"></i><b>5.7</b> Collections</a></li>
<li class="chapter" data-level="5.8" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#vba-ex-job-seq"><i class="fa fa-check"></i><b>5.8</b> Example - Job sequencing</a></li>
<li class="chapter" data-level="5.9" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#recap-2"><i class="fa fa-check"></i><b>5.9</b> Recap</a></li>
<li class="chapter" data-level="5.10" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-datatypes"><i class="fa fa-check"></i><b>5.10</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-equal"><i class="fa fa-check"></i><b>5.10.1</b> Exercise - Equal entries</a></li>
<li class="chapter" data-level="5.10.2" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-products"><i class="fa fa-check"></i><b>5.10.2</b> Exercise - Product search</a></li>
<li class="chapter" data-level="5.10.3" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-read-collections"><i class="fa fa-check"></i><b>5.10.3</b> Exercise - Read collections</a></li>
<li class="chapter" data-level="5.10.4" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-read-arrays"><i class="fa fa-check"></i><b>5.10.4</b> Exercise - Read arrays</a></li>
<li class="chapter" data-level="5.10.5" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-process"><i class="fa fa-check"></i><b>5.10.5</b> Exercise - Process numbers</a></li>
<li class="chapter" data-level="5.10.6" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-pay"><i class="fa fa-check"></i><b>5.10.6</b> Exercise - Search payments</a></li>
<li class="chapter" data-level="5.10.7" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-flight"><i class="fa fa-check"></i><b>5.10.7</b> Exercise - Flight search</a></li>
<li class="chapter" data-level="5.10.8" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-search-table"><i class="fa fa-check"></i><b>5.10.8</b> Exercise - Search table</a></li>
<li class="chapter" data-level="5.10.9" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-next-task"><i class="fa fa-check"></i><b>5.10.9</b> Exercise - Find next task</a></li>
<li class="chapter" data-level="5.10.10" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-seat-reservation"><i class="fa fa-check"></i><b>5.10.10</b> Exercise - Seat reservation</a></li>
<li class="chapter" data-level="5.10.11" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-select"><i class="fa fa-check"></i><b>5.10.11</b> Exercise - Transform data (select and filter)</a></li>
<li class="chapter" data-level="5.10.12" data-path="mod-vba-datatypes.html"><a href="mod-vba-datatypes.html#ex-vba-mutate"><i class="fa fa-check"></i><b>5.10.12</b> Exercise - Transform data (arrange and mutate)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html"><i class="fa fa-check"></i><b>6</b> Generating random numbers</a>
<ul>
<li class="chapter" data-level="6.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#lo-vba-random-numbers"><i class="fa fa-check"></i><b>6.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="6.2" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#vba-random-numbers"><i class="fa fa-check"></i><b>6.2</b> Generating random numbers</a></li>
<li class="chapter" data-level="6.3" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#vba-simulation"><i class="fa fa-check"></i><b>6.3</b> Simulation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#sec-vba-tsp"><i class="fa fa-check"></i><b>6.3.1</b> Example - Traveling salesman problem</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#recap-3"><i class="fa fa-check"></i><b>6.4</b> Recap</a></li>
<li class="chapter" data-level="6.5" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-random-numbers"><i class="fa fa-check"></i><b>6.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-random-int"><i class="fa fa-check"></i><b>6.5.1</b> Exercise - Two random integers</a></li>
<li class="chapter" data-level="6.5.2" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-swap"><i class="fa fa-check"></i><b>6.5.2</b> Exercise - Swap entries</a></li>
<li class="chapter" data-level="6.5.3" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-bakery"><i class="fa fa-check"></i><b>6.5.3</b> Exercise - Dan’s bakery</a></li>
<li class="chapter" data-level="6.5.4" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-generate"><i class="fa fa-check"></i><b>6.5.4</b> Exercise - Generating random numbers</a></li>
<li class="chapter" data-level="6.5.5" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-stoc-functions"><i class="fa fa-check"></i><b>6.5.5</b> Exercise - Stochastic functions</a></li>
<li class="chapter" data-level="6.5.6" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-customer-demand"><i class="fa fa-check"></i><b>6.5.6</b> Exercise - Customer demand</a></li>
<li class="chapter" data-level="6.5.7" data-path="mod-vba-random-numbers.html"><a href="mod-vba-random-numbers.html#ex-vba-simple-game"><i class="fa fa-check"></i><b>6.5.7</b> Exercise - A simple game</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II R</b></span></li>
<li class="chapter" data-level="7" data-path="mod-r-install.html"><a href="mod-r-install.html"><i class="fa fa-check"></i><b>7</b> Setting up R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mod-r-install.html"><a href="mod-r-install.html#lo-r-install"><i class="fa fa-check"></i><b>7.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="7.2" data-path="mod-r-install.html"><a href="mod-r-install.html#r-install"><i class="fa fa-check"></i><b>7.2</b> Install R and RStudio</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="mod-r-install.html"><a href="mod-r-install.html#test-your-installation"><i class="fa fa-check"></i><b>7.2.1</b> Test your installation</a></li>
<li class="chapter" data-level="7.2.2" data-path="mod-r-install.html"><a href="mod-r-install.html#add-on-packages"><i class="fa fa-check"></i><b>7.2.2</b> Add-on packages</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="mod-r-install.html"><a href="mod-r-install.html#r-cloud"><i class="fa fa-check"></i><b>7.3</b> Setup and test Posit Cloud</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html"><i class="fa fa-check"></i><b>8</b> R basics and workflows</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#lo-r-workflow"><i class="fa fa-check"></i><b>8.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="8.2" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#working-with-r-at-the-command-line-in-rstudio"><i class="fa fa-check"></i><b>8.2</b> Working with R at the command line in RStudio</a></li>
<li class="chapter" data-level="8.3" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#your-first-datacamp-course"><i class="fa fa-check"></i><b>8.3</b> Your first DataCamp course</a></li>
<li class="chapter" data-level="8.4" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#pipes"><i class="fa fa-check"></i><b>8.4</b> Pipes</a></li>
<li class="chapter" data-level="8.5" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#rprojs"><i class="fa fa-check"></i><b>8.5</b> RStudio projects</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#storing-your-code-in-a-script-file"><i class="fa fa-check"></i><b>8.5.1</b> Storing your code in a script file</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#rc-r-workflow"><i class="fa fa-check"></i><b>8.6</b> Recap</a></li>
<li class="chapter" data-level="8.7" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#ex-r-workflow"><i class="fa fa-check"></i><b>8.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-group-work"><i class="fa fa-check"></i><b>8.7.1</b> Exercise (group work)</a></li>
<li class="chapter" data-level="8.7.2" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-piping"><i class="fa fa-check"></i><b>8.7.2</b> Exercise (piping)</a></li>
<li class="chapter" data-level="8.7.3" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-working-dir"><i class="fa fa-check"></i><b>8.7.3</b> Exercise (working dir)</a></li>
<li class="chapter" data-level="8.7.4" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-vectors"><i class="fa fa-check"></i><b>8.7.4</b> Exercise (vectors)</a></li>
<li class="chapter" data-level="8.7.5" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-matrices"><i class="fa fa-check"></i><b>8.7.5</b> Exercise (matrices)</a></li>
<li class="chapter" data-level="8.7.6" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-data-frames"><i class="fa fa-check"></i><b>8.7.6</b> Exercise (data frames)</a></li>
<li class="chapter" data-level="8.7.7" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#exercise-lists"><i class="fa fa-check"></i><b>8.7.7</b> Exercise (lists)</a></li>
<li class="chapter" data-level="8.7.8" data-path="mod-r-workflow.html"><a href="mod-r-workflow.html#ex-strings"><i class="fa fa-check"></i><b>8.7.8</b> Exercise (string management)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html"><i class="fa fa-check"></i><b>9</b> Loops and conditionals</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#lo-loops"><i class="fa fa-check"></i><b>9.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="9.2" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#r-dc-loops-cond"><i class="fa fa-check"></i><b>9.2</b> Conditionals and control flow</a></li>
<li class="chapter" data-level="9.3" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#r-loops"><i class="fa fa-check"></i><b>9.3</b> Loops</a></li>
<li class="chapter" data-level="9.4" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#rc-r-loops-cond"><i class="fa fa-check"></i><b>9.4</b> Recap</a></li>
<li class="chapter" data-level="9.5" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-loops-cond"><i class="fa fa-check"></i><b>9.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-conditional-expressions"><i class="fa fa-check"></i><b>9.5.1</b> Exercise (conditional expressions)</a></li>
<li class="chapter" data-level="9.5.2" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-loops"><i class="fa fa-check"></i><b>9.5.2</b> Exercise (loops)</a></li>
<li class="chapter" data-level="9.5.3" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-search-vector"><i class="fa fa-check"></i><b>9.5.3</b> Exercise (search vector)</a></li>
<li class="chapter" data-level="9.5.4" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-dist"><i class="fa fa-check"></i><b>9.5.4</b> Exercise (calculating distances)</a></li>
<li class="chapter" data-level="9.5.5" data-path="mod-r-loops-cond.html"><a href="mod-r-loops-cond.html#ex-r-expand"><i class="fa fa-check"></i><b>9.5.5</b> Exercise (expand_grid)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mod-r-functions.html"><a href="mod-r-functions.html"><i class="fa fa-check"></i><b>10</b> Functions</a>
<ul>
<li class="chapter" data-level="10.1" data-path="mod-r-functions.html"><a href="mod-r-functions.html#lo-r-functions"><i class="fa fa-check"></i><b>10.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="10.2" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-dc-functions"><i class="fa fa-check"></i><b>10.2</b> DataCamp course</a></li>
<li class="chapter" data-level="10.3" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-extra"><i class="fa fa-check"></i><b>10.3</b> Functions returning multiple objects</a></li>
<li class="chapter" data-level="10.4" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-arg"><i class="fa fa-check"></i><b>10.4</b> The <code>...</code> argument</a></li>
<li class="chapter" data-level="10.5" data-path="mod-r-functions.html"><a href="mod-r-functions.html#r-functions-doc"><i class="fa fa-check"></i><b>10.5</b> Documenting your functions</a></li>
<li class="chapter" data-level="10.6" data-path="mod-r-functions.html"><a href="mod-r-functions.html#example---job-sequencing"><i class="fa fa-check"></i><b>10.6</b> Example - Job sequencing</a></li>
<li class="chapter" data-level="10.7" data-path="mod-r-functions.html"><a href="mod-r-functions.html#rc-functions"><i class="fa fa-check"></i><b>10.7</b> Recap</a></li>
<li class="chapter" data-level="10.8" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-functions"><i class="fa fa-check"></i><b>10.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-def-func"><i class="fa fa-check"></i><b>10.8.1</b> Exercise (defining functions)</a></li>
<li class="chapter" data-level="10.8.2" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-euclidean-distances"><i class="fa fa-check"></i><b>10.8.2</b> Exercise (euclidean distances)</a></li>
<li class="chapter" data-level="10.8.3" data-path="mod-r-functions.html"><a href="mod-r-functions.html#exercise-scope"><i class="fa fa-check"></i><b>10.8.3</b> Exercise (scope)</a></li>
<li class="chapter" data-level="10.8.4" data-path="mod-r-functions.html"><a href="mod-r-functions.html#ex-r-time-conversion"><i class="fa fa-check"></i><b>10.8.4</b> Exercise (time conversion)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html"><i class="fa fa-check"></i><b>11</b> Introduction to tidyverse and RMarkdown</a>
<ul>
<li class="chapter" data-level="11.1" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#lo-tidyverse-intro"><i class="fa fa-check"></i><b>11.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="11.2" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-tidyverse-intro"><i class="fa fa-check"></i><b>11.2</b> The tidyverse package</a></li>
<li class="chapter" data-level="11.3" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-markdown-intro"><i class="fa fa-check"></i><b>11.3</b> Writing reproducible reports</a></li>
<li class="chapter" data-level="11.4" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#r-tibbles-intro"><i class="fa fa-check"></i><b>11.4</b> Tibbles</a></li>
<li class="chapter" data-level="11.5" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#rc-tidyverse-intro"><i class="fa fa-check"></i><b>11.5</b> Recap</a></li>
<li class="chapter" data-level="11.6" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#ex-tidyverse-intro"><i class="fa fa-check"></i><b>11.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#exercise-your-first-rmarkdown-exercise"><i class="fa fa-check"></i><b>11.6.1</b> Exercise (your first RMarkdown exercise)</a></li>
<li class="chapter" data-level="11.6.2" data-path="mod-r-tidyverse-intro.html"><a href="mod-r-tidyverse-intro.html#exercise-tibbles"><i class="fa fa-check"></i><b>11.6.2</b> Exercise (tibbles)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mod-r-io.html"><a href="mod-r-io.html"><i class="fa fa-check"></i><b>12</b> Importing and exporting data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="mod-r-io.html"><a href="mod-r-io.html#lo-r-io"><i class="fa fa-check"></i><b>12.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="12.2" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-csv"><i class="fa fa-check"></i><b>12.2</b> CSV files</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="mod-r-io.html"><a href="mod-r-io.html#reading-a-csv-file"><i class="fa fa-check"></i><b>12.2.1</b> Reading a CSV file</a></li>
<li class="chapter" data-level="12.2.2" data-path="mod-r-io.html"><a href="mod-r-io.html#writing-to-csv-files"><i class="fa fa-check"></i><b>12.2.2</b> Writing to CSV files</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-excel"><i class="fa fa-check"></i><b>12.3</b> Excel</a></li>
<li class="chapter" data-level="12.4" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-google"><i class="fa fa-check"></i><b>12.4</b> Google Sheets</a></li>
<li class="chapter" data-level="12.5" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-text"><i class="fa fa-check"></i><b>12.5</b> Text files</a></li>
<li class="chapter" data-level="12.6" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-r"><i class="fa fa-check"></i><b>12.6</b> R’s native binary format</a></li>
<li class="chapter" data-level="12.7" data-path="mod-r-io.html"><a href="mod-r-io.html#r-io-json"><i class="fa fa-check"></i><b>12.7</b> Json</a></li>
<li class="chapter" data-level="12.8" data-path="mod-r-io.html"><a href="mod-r-io.html#rc-r-io"><i class="fa fa-check"></i><b>12.8</b> Recap</a></li>
<li class="chapter" data-level="12.9" data-path="mod-r-io.html"><a href="mod-r-io.html#ex-r-io"><i class="fa fa-check"></i><b>12.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="mod-r-io.html"><a href="mod-r-io.html#exercise-statistikbanken"><i class="fa fa-check"></i><b>12.9.1</b> Exercise (Statistikbanken)</a></li>
<li class="chapter" data-level="12.9.2" data-path="mod-r-io.html"><a href="mod-r-io.html#exercise-tuples-in-opl"><i class="fa fa-check"></i><b>12.9.2</b> Exercise (tuples in OPL)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="mod-r-transform.html"><a href="mod-r-transform.html"><i class="fa fa-check"></i><b>13</b> Transforming data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="mod-r-transform.html"><a href="mod-r-transform.html#lo-r-transform"><i class="fa fa-check"></i><b>13.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="13.2" data-path="mod-r-transform.html"><a href="mod-r-transform.html#r-transform-tidyverse"><i class="fa fa-check"></i><b>13.2</b> Working with data in the tidyverse</a></li>
<li class="chapter" data-level="13.3" data-path="mod-r-transform.html"><a href="mod-r-transform.html#r-transform-joins"><i class="fa fa-check"></i><b>13.3</b> Mutating joins</a></li>
<li class="chapter" data-level="13.4" data-path="mod-r-transform.html"><a href="mod-r-transform.html#rc-r-transform"><i class="fa fa-check"></i><b>13.4</b> Recap</a></li>
<li class="chapter" data-level="13.5" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-transform"><i class="fa fa-check"></i><b>13.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-gapminder1"><i class="fa fa-check"></i><b>13.5.1</b> Exercise (gapminder)</a></li>
<li class="chapter" data-level="13.5.2" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-babynames1"><i class="fa fa-check"></i><b>13.5.2</b> Exercise (babynames)</a></li>
<li class="chapter" data-level="13.5.3" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-profit1"><i class="fa fa-check"></i><b>13.5.3</b> Exercise (profit)</a></li>
<li class="chapter" data-level="13.5.4" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-fish"><i class="fa fa-check"></i><b>13.5.4</b> Exercise (fisheries)</a></li>
<li class="chapter" data-level="13.5.5" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-company"><i class="fa fa-check"></i><b>13.5.5</b> Exercise (company ranking)</a></li>
<li class="chapter" data-level="13.5.6" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-titanic"><i class="fa fa-check"></i><b>13.5.6</b> Exercise (Titanic)</a></li>
<li class="chapter" data-level="13.5.7" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-covid"><i class="fa fa-check"></i><b>13.5.7</b> Exercise (covid)</a></li>
<li class="chapter" data-level="13.5.8" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-election"><i class="fa fa-check"></i><b>13.5.8</b> Exercise (election)</a></li>
<li class="chapter" data-level="13.5.9" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-orders"><i class="fa fa-check"></i><b>13.5.9</b> Exercise (orders)</a></li>
<li class="chapter" data-level="13.5.10" data-path="mod-r-transform.html"><a href="mod-r-transform.html#ex-r-jobs"><i class="fa fa-check"></i><b>13.5.10</b> Exercise (jobs)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="mod-r-plot.html"><a href="mod-r-plot.html"><i class="fa fa-check"></i><b>14</b> Data visualization using ggplot</a>
<ul>
<li class="chapter" data-level="14.1" data-path="mod-r-plot.html"><a href="mod-r-plot.html#lo-plot"><i class="fa fa-check"></i><b>14.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="14.2" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-intro"><i class="fa fa-check"></i><b>14.2</b> Introduction to data visualization</a></li>
<li class="chapter" data-level="14.3" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-multi"><i class="fa fa-check"></i><b>14.3</b> Combining plots into one using <em>patchwork</em></a></li>
<li class="chapter" data-level="14.4" data-path="mod-r-plot.html"><a href="mod-r-plot.html#r-plot-save"><i class="fa fa-check"></i><b>14.4</b> Saving graphics</a></li>
<li class="chapter" data-level="14.5" data-path="mod-r-plot.html"><a href="mod-r-plot.html#rc-r-plot"><i class="fa fa-check"></i><b>14.5</b> Recap</a></li>
<li class="chapter" data-level="14.6" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-plot"><i class="fa fa-check"></i><b>14.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-gapminder2"><i class="fa fa-check"></i><b>14.6.1</b> Exercise (gapminder)</a></li>
<li class="chapter" data-level="14.6.2" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-profit2"><i class="fa fa-check"></i><b>14.6.2</b> Exercise (profit)</a></li>
<li class="chapter" data-level="14.6.3" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-covid19"><i class="fa fa-check"></i><b>14.6.3</b> Exercise (COVID-19)</a></li>
<li class="chapter" data-level="14.6.4" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-lego"><i class="fa fa-check"></i><b>14.6.4</b> Exercise (Lego and sales)</a></li>
<li class="chapter" data-level="14.6.5" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-company-plot"><i class="fa fa-check"></i><b>14.6.5</b> Exercise (company ranking)</a></li>
<li class="chapter" data-level="14.6.6" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-titanic-plot"><i class="fa fa-check"></i><b>14.6.6</b> Exercise (Titanic)</a></li>
<li class="chapter" data-level="14.6.7" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-covid-plot"><i class="fa fa-check"></i><b>14.6.7</b> Exercise (covid)</a></li>
<li class="chapter" data-level="14.6.8" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-election-plot"><i class="fa fa-check"></i><b>14.6.8</b> Exercise (election)</a></li>
<li class="chapter" data-level="14.6.9" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-orders-plot"><i class="fa fa-check"></i><b>14.6.9</b> Exercise (orders)</a></li>
<li class="chapter" data-level="14.6.10" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-nycflights"><i class="fa fa-check"></i><b>14.6.10</b> Exercise (New York flights)</a></li>
<li class="chapter" data-level="14.6.11" data-path="mod-r-plot.html"><a href="mod-r-plot.html#ex-r-jobs-plot"><i class="fa fa-check"></i><b>14.6.11</b> Exercise (jobs)</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Extra R</b></span></li>
<li class="chapter" data-level="15" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html"><i class="fa fa-check"></i><b>15</b> Fitting probability distributions</a>
<ul>
<li class="chapter" data-level="15.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#lo-r-dist-fit"><i class="fa fa-check"></i><b>15.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="15.2" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-intro"><i class="fa fa-check"></i><b>15.2</b> Introduction</a></li>
<li class="chapter" data-level="15.3" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-cont"><i class="fa fa-check"></i><b>15.3</b> Fitting distributions to continuous data</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#example-breakdown-times"><i class="fa fa-check"></i><b>15.3.1</b> Example: breakdown times</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-r-dist-fit-discrete"><i class="fa fa-check"></i><b>15.4</b> Fitting distributions to discrete data</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#example-sales-of-lottery-tickets"><i class="fa fa-check"></i><b>15.4.1</b> Example: sales of lottery tickets</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#sec-dist-fit-pois"><i class="fa fa-check"></i><b>15.5</b> The Poisson process</a></li>
<li class="chapter" data-level="15.6" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#rc-r-dist-fit"><i class="fa fa-check"></i><b>15.6</b> Recap</a></li>
<li class="chapter" data-level="15.7" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#ex-r-dist-fit"><i class="fa fa-check"></i><b>15.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="mod-r-dist-fit.html"><a href="mod-r-dist-fit.html#exercise---call-center"><i class="fa fa-check"></i><b>15.7.1</b> Exercise - Call center</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="mod-r-maps.html"><a href="mod-r-maps.html"><i class="fa fa-check"></i><b>16</b> Spatial data and maps</a>
<ul>
<li class="chapter" data-level="16.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#lo-maps"><i class="fa fa-check"></i><b>16.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="16.2" data-path="mod-r-maps.html"><a href="mod-r-maps.html#sec-map-api-key"><i class="fa fa-check"></i><b>16.2</b> Services for obtatining spatial data</a></li>
<li class="chapter" data-level="16.3" data-path="mod-r-maps.html"><a href="mod-r-maps.html#calculating-distances"><i class="fa fa-check"></i><b>16.3</b> Calculating distances</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#using-google-maps"><i class="fa fa-check"></i><b>16.3.1</b> Using Google Maps</a></li>
<li class="chapter" data-level="16.3.2" data-path="mod-r-maps.html"><a href="mod-r-maps.html#using-bing-maps"><i class="fa fa-check"></i><b>16.3.2</b> Using Bing Maps</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="mod-r-maps.html"><a href="mod-r-maps.html#geocoding-and-reverse-geocoding"><i class="fa fa-check"></i><b>16.4</b> Geocoding and reverse geocoding</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="mod-r-maps.html"><a href="mod-r-maps.html#using-google-maps-1"><i class="fa fa-check"></i><b>16.4.1</b> Using Google maps</a></li>
<li class="chapter" data-level="16.4.2" data-path="mod-r-maps.html"><a href="mod-r-maps.html#use-bing-maps"><i class="fa fa-check"></i><b>16.4.2</b> Use Bing Maps</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="mod-r-maps.html"><a href="mod-r-maps.html#adding-markers-and-routes-to-a-map"><i class="fa fa-check"></i><b>16.5</b> Adding markers and routes to a map</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="groups.html"><a href="groups.html"><i class="fa fa-check"></i><b>A</b> Working in groups</a>
<ul>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#using-git"><i class="fa fa-check"></i>Using Git together with GitHub</a>
<ul>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#register-a-free-github-account"><i class="fa fa-check"></i>Register a free GitHub account</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#install-git"><i class="fa fa-check"></i>Install Git</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#check-your-installation"><i class="fa fa-check"></i>Check your installation</a></li>
<li class="chapter" data-level="" data-path="groups.html"><a href="groups.html#setup-projects-using-git-and-github"><i class="fa fa-check"></i>Setup projects using Git and GitHub</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="annotate.html"><a href="annotate.html"><i class="fa fa-check"></i><b>B</b> Annotate the course notes</a></li>
<li class="chapter" data-level="C" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>C</b> Getting help</a></li>
<li class="chapter" data-level="D" data-path="coding-convention.html"><a href="coding-convention.html"><i class="fa fa-check"></i><b>D</b> Coding/naming convention</a>
<ul>
<li class="chapter" data-level="D.1" data-path="coding-convention.html"><a href="coding-convention.html#commenting-your-code"><i class="fa fa-check"></i><b>D.1</b> Commenting your code</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="apdx-vba.html"><a href="apdx-vba.html"><i class="fa fa-check"></i><b>E</b> VBA specific topics</a>
<ul>
<li class="chapter" data-level="E.1" data-path="apdx-vba.html"><a href="apdx-vba.html#vba-debug"><i class="fa fa-check"></i><b>E.1</b> Debugging your code</a></li>
<li class="chapter" data-level="E.2" data-path="apdx-vba.html"><a href="apdx-vba.html#error-handling"><i class="fa fa-check"></i><b>E.2</b> Error handling</a></li>
<li class="chapter" data-level="E.3" data-path="apdx-vba.html"><a href="apdx-vba.html#vba-course-procedures"><i class="fa fa-check"></i><b>E.3</b> Course procedures</a>
<ul>
<li class="chapter" data-level="E.3.1" data-path="apdx-vba.html"><a href="apdx-vba.html#detailed-descriptions-of-course-procedures"><i class="fa fa-check"></i><b>E.3.1</b> Detailed descriptions of course procedures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="F" data-path="lg-course.html"><a href="lg-course.html"><i class="fa fa-check"></i><b>F</b> Learning goals</a></li>
<li class="chapter" data-level="G" data-path="ba.html"><a href="ba.html"><i class="fa fa-check"></i><b>G</b> Business Analytics</a></li>
<li class="chapter" data-level="H" data-path="colophon.html"><a href="colophon.html"><i class="fa fa-check"></i><b>H</b> Colophon</a></li>
<li class="divider"></li>
<li><center>
  <a rel="license" href="./index.html#ack">
    License: CC BY-NC-SA<br>
    <i class = "fab fa-creative-commons fa-2x"></i>
    <i class = "fab fa-creative-commons-by fa-2x"></i>
    <i class = "fab fa-creative-commons-nc fa-2x"></i>
    <i class = "fab fa-creative-commons-sa fa-2x"></i>
  </a>
</li></center>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tools for Analytics (TFA)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mod-vba-datatypes" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Module 5</span> Advanced data types and usage<a href="mod-vba-datatypes.html#mod-vba-datatypes" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Recall that variables are used to store information that is saved in memory. A variable may store different data types. Until now we have mostly considered basic data types such as an integer, a double or a string. In this module a short introduction to some of the more advanced data types is given such as a group of integers (an array), a range of cells in a worksheet (a range object) or a set of numbers (a collection).</p>
<div>
A template with VBA code is given in the file
<a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-template.xlsm" target="_blank">vba-template.xlsm</a>
(open it and use it while reading the notes). Have a look inside the module
<i>TM5_ex</i>
in the VBA editor for examples used in the notes and during lectures. Have a look at module
<i>TM5_exercises</i>
for exercises. Guiding answers for the exercises can be found in the file
<a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-solution.xlsm" target="_blank">vba-solution.xlsm</a>
.
</div>
<div id="learning-path-diagram-4" class="section level4 unnumbered hasAnchor">
<h4>Learning path diagram<a href="mod-vba-datatypes.html#learning-path-diagram-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Click/hover the nodes to follow links and see details.</p>
<pre><code>#&gt; ✔ Reading from &quot;learning_paths&quot;.
#&gt; ✔ Range &#39;&#39;vba-datatypes&#39;&#39;.</code></pre>
<div id="htmlwidget-943378b8a8aaaa99a136" style="width:100%;height:200px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-943378b8a8aaaa99a136">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"💡 Strings\", URL = \"#vba-strings\", tooltip = \"Strings (interactive)\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"2,1!\"] \n  \"2\" [label = \"📖 Objects\", URL = \"#vba-objects\", tooltip = \"Objects (reading)\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"rect\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"3.7,1!\"] \n  \"3\" [label = \"💡 Worksheets\", URL = \"#vba-wst\", tooltip = \"Worksheets (interactive)\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"5.5,1!\"] \n  \"4\" [label = \"💡 Ranges\", URL = \"#vba-rng\", tooltip = \"Ranges (interactive)\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"7.6,1!\"] \n  \"5\" [label = \"💡 Arrays\", URL = \"#vba-ary\", tooltip = \"Arrays (interactive)\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"9.6,1!\"] \n  \"6\" [label = \"💡 Collections\", URL = \"#vba-coll\", tooltip = \"Collections (interactive)\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"11.6,1!\"] \n  \"7\" [label = \"💡 Example\", URL = \"#vba-ex-job-seq\", tooltip = \"Example (interactive)\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"13.7,1!\"] \n  \"8\" [label = \"💻 Exercises\", URL = \"#ex-vba-datatypes\", tooltip = \"Exercises\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"egg\", margin = \"0.2\", fillcolor = \"DarkSeaGreen4\", pos = \"15.8,1!\"] \n  \"9\" [label = \"🎬 Arrays\", URL = \"https://youtu.be/ELFrOYNTxEU\", tooltip = \"Arrays\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"rect\", margin = \"0.2\", fillcolor = \"PeachPuff3\", pos = \"8.6,0!\"] \n  \"10\" [label = \"🎬 Dynamic arrays\", URL = \"https://youtu.be/AqYDI2Vt1mw\", tooltip = \"Dynamic arrays\", style = \"filled\", fixedsize = \"FALSE\", fontsize = \"11\", fontcolor = \"white\", penwidth = \"2\", fontname = \"Helvetica-bold\", shape = \"rect\", margin = \"0.2\", fillcolor = \"PeachPuff3\", pos = \"10.6,0!\"] \n\"1\"->\"2\" [color = \"black\", arrowhead = \"vee\"] \n\"2\"->\"3\" [color = \"black\", arrowhead = \"vee\"] \n\"3\"->\"4\" [color = \"black\", arrowhead = \"vee\"] \n\"4\"->\"5\" [color = \"black\", arrowhead = \"vee\"] \n\"5\"->\"6\" [color = \"black\", arrowhead = \"vee\"] \n\"5\"->\"9\" [color = \"black\", arrowhead = \"vee\"] \n\"5\"->\"10\" [color = \"black\", arrowhead = \"vee\"] \n\"6\"->\"7\" [color = \"black\", arrowhead = \"vee\"] \n\"7\"->\"8\" [color = \"black\", arrowhead = \"vee\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<p>If you like a different learning style there is a lot for videos about VBA online such as course <a href="https://www.youtube.com/playlist?list=PL3A6U40JUYCi4njVx59-vaUxYkG0yRO4m">14-Hour VBA Course</a>. The videos have been pointed out as extra online supplements in the learning path diagram. However, they are not necessary for the course. Since Excel change as new versions arrive and it work on different operating systems, the look in the screenshots and videos might be a bit different from your version. However, you still should be able to understand it.</p>
</div>
<div id="lo-vba-datatypes" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Learning outcomes<a href="mod-vba-datatypes.html#lo-vba-datatypes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By the end of this module, you are expected to be able to:</p>
<ul>
<li>Name different data types and how they effect memory size.</li>
<li>Declare a variable as a data type.</li>
<li>Declare and manipulate strings.</li>
<li>Describe what the object is.</li>
<li>Declare and set an object.</li>
<li>Manipulate worksheets (add, delete, clear).</li>
<li>Understand what a range is and extract info about it such as rows, start row, address, start column etc.</li>
<li>Use the current region of a range to get information about the size for data.</li>
<li>Sort, paste and modify a range.</li>
<li>Declare and use an array with both fixed and dynamic dimension.</li>
<li>Sort, read and modify an array.</li>
<li>Explain why using arrays is often better than ranges.</li>
<li>Declare and use a collection.</li>
<li>Explain what a collection of objects are.</li>
<li>Use a <code>For Each</code> loop to iterate though a collection of objects.</li>
</ul>
<p>The learning outcomes relate to the <a href="lg-course.html#lg-course">overall learning goals</a> number 1, 2, 4, 8 and 9 of the course.</p>
<!-- SOLO increasing: identify · memorise · name · do simple procedure · collect data · -->
<!-- enumerate · describe · interpret · formulate · list · paraphrase · combine · do -->
<!-- algorithms · compare · contrast · explain causes · analyse · relate · derive · -->
<!-- evaluate · apply · argue · theorise · generalise · hypothesise · solve · reflect -->
</div>
<div id="vba-strings" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Strings<a href="mod-vba-datatypes.html#vba-strings" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Strings contain a group of characters (an empty string is of length zero). Memory requirements vary with the length of the string (10 bytes + length <span class="math inline">\(\cdot\)</span> 2 byte). We use the symbol <code>&amp;</code> to concatenate strings (glue strings together):</p>
<pre><code>&#39;&#39; Concatenate two strings
Sub TM5_StrConcat()
    Dim strX As String
    Dim strY As String
    Dim strRes As String
    
    strX = &quot;VBA&quot;
    strY = &quot;Strings&quot;
    strRes = strX &amp; &quot; &quot; &amp; strY
    MsgBox (strRes)
    MsgBox (strX &amp; vbCr &amp; strY)   &#39; use vbCr to insert a new line
End Sub</code></pre>
<p>Note you can use constant <code>vbCr</code> to add a new line.</p>
<p>There are many <a href="https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/functions/string-functions">VBA functions that can be used to manipulate strings</a>. Some examples:</p>
<pre><code>&#39;&#39; String functions
Sub TM5_StrFunc()
    Dim str As String
    
    str = &quot;VBA Strings&quot;
    MsgBox (&quot;The length is: &quot; &amp; Len(str))
    MsgBox (&quot;In lowercase: &quot; &amp; LCase(str))
    MsgBox (&quot;Last 7 char: &quot; &amp; Right(str, 7))
    MsgBox (&quot;Replace: &quot; &amp; Replace(str, &quot;Strings&quot;, &quot;Rules&quot;))
    MsgBox (&quot;Compare: &quot; &amp; StrComp(str, &quot;VBA Strings&quot;))  &#39; result is 0 (equal)
    MsgBox (&quot;Compare: &quot; &amp; StrComp(str, &quot;Apple&quot;))        &#39; result is 1 (str alfabetically after)
    MsgBox (&quot;Compare: &quot; &amp; StrComp(str, &quot;Wait&quot;))         &#39; result is -1 (str alfabetically before)
    MsgBox (&quot;String is starting at char number: &quot; &amp; InStr(str, &quot;String&quot;))  &#39; result is 0 if not found
End Sub</code></pre>
</div>
<div id="vba-objects" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Objects<a href="mod-vba-datatypes.html#vba-objects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>VBA have a lot of predefined objects you can use. Think of an object as a datatype that holds a group of variables. Examples of some objects are <code>Range</code>, <code>Worksheet</code>, and <code>WorksheetFunction</code>. Objects are grouped, nested and you refer to an object by specifying the path, e.g.:</p>
<pre><code>Workbooks(&quot;Jobs.xlsm&quot;).Worksheets(&quot;Data values&quot;).Range(&quot;D4&quot;).value</code></pre>
<p>Here we refer to the value in cell D4 in worksheet <em>Data values</em> in the file <em>Jobs.xlsm</em>. You may skip parts of the path (VBA then uses the current active one):</p>
<pre><code>Workbooks(&quot;Jobs.xlsm&quot;).Worksheets(&quot;Data values&quot;).Range(&quot;D4&quot;).value  &#39; full specification
Worksheets(&quot;Data values&quot;).Range(&quot;D4&quot;).value  &#39; same result if Excel file &quot;Jobs.xlsm&quot; is active
Range(&quot;D4&quot;)  &#39; same result if Excel sheet &quot;Data values&quot; is active and &quot;Jobs.xlsm&quot; file</code></pre>
<p>Note <code>.value</code> has been dropped in the last line because it is the default, i.e. you do not have to write it explicit.</p>
<p>Object variables are declared like any other variables:</p>
<pre><code>Dim rng As Range
Dim wst As Worksheet</code></pre>
<p>Use <code>Set</code> to allocate the Object:</p>
<pre><code>Set rng = Range(&quot;F7&quot;)
Set wst = Worksheets(&quot;Data values&quot;)</code></pre>
<p>Now <code>rng</code> is a reference to cell F7 and <code>wst</code> is a reference to worksheet <em>Data values</em>. Think of a reference as a value that identify where in memory the object is.</p>
<!-- You may declare and set in one go using the `New` keyword: -->
<!-- ``` -->
<!-- Dim col as New Collection  ' col is now an empty collection (0 items) -->
<!-- ``` -->
<p>In the next sections let us have a look at some relevant objects.</p>
</div>
<div id="vba-wst" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> The Worksheet object<a href="mod-vba-datatypes.html#vba-wst" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>Worksheet</code> object refer to a worksheet in the Excel file and you can use it to e.g. modify cells:</p>
<pre><code>Sub TM5_TestWorksheet()
   ThisWorkbook.Activate  &#39; activate this workbook
   Worksheets(&quot;TM5_Test1&quot;).Range(&quot;B2&quot;) = &quot;Testing Worksheet&quot;  &#39; write to cell in sheet TM5_Test1
   Sheet_TM5_Test1.Range(&quot;B3&quot;) = &quot;Use the sheets code name&quot;   &#39; use the code name (also work if sheet renamed)
   &#39;ThisWorkbook.Worksheets(&quot;Test3&quot;).Range(&quot;B5&quot;) = &quot;Test&quot;     &#39; Error since there is no sheet Test3 in this workbook
   Range(&quot;B4&quot;) = &quot;Do you know which sheet is active?&quot;         &#39; Active sheet
   &#39; Good coding pratice is always to specify the full path (as above) or make the sheet under considration active
   Worksheets(&quot;TM5_Test1&quot;).Activate  &#39; Make sheet active so know where is
   Range(&quot;B5&quot;) = &quot;I know which sheet is active!&quot;
End Sub</code></pre>
<p>It is always good practice to make sure that you are working with the correct Excel file. Otherwise you will get errors if another file is active. This can be done using the <code>ThisWorkbook</code> object. Similar you either refer to a worksheet directly using its name or its code name. The code name can be set in the Properties window in the VBA editor. An alternative is to activate the worksheet.</p>
<p>You can use <code>Worksheet</code> variables:</p>
<pre><code>Sub TM5_TestWorksheetVar()
  Dim wst1 As Worksheet  &#39; define a variable which hold a reference to a Worksheet object
  Dim wst2 As Worksheet  &#39; define a variable which hold a reference to a Worksheet object
  Dim rng As Range
  
  Set wst1 = ThisWorkbook.Worksheets(&quot;TM5_Test1&quot;)  &#39; set the reference
  Set wst2 = ThisWorkbook.Worksheets(&quot;TM5_Test2&quot;)  &#39; set the reference
  wst1.Range(&quot;B6&quot;) = &quot;Writing using wst1&quot;
  wst2.Range(&quot;B2&quot;) = &quot;Writing using wst2&quot;
  wst1.Activate   &#39; just to have a look
End Sub</code></pre>
<p>Here by having two worksheet variables we can write directly to cells in different worksheets without activating the worksheet.</p>
<p>You may check if a worksheet exists using:</p>
<pre><code>&#39;&#39; Check if a worksheet exists
&#39; @param strName Name of worksheet.
&#39; @return True if exists.
Function WstExists(strName As String) As Boolean
    WstExists = Evaluate(&quot;ISREF(&#39;&quot; &amp; strName &amp; &quot;&#39;!A1)&quot;)
End Function</code></pre>
<p>The worksheet object has a lot of <em>methods/properties</em> (think of methods as procedures defined inside the object) for instance <code>wst.Add</code> and <code>wst.Delete</code>. Let us try to define a function that delete a worksheet:</p>
<pre><code>&#39;&#39; Delete a worksheet if it exists
&#39; @param strName Name of worksheet.
&#39; @return True if deleted.
&#39; @author Lars Relund &lt;lars@relund.dk&gt;
Function WstDelete(strName As String) As Boolean
    Dim wst As Worksheet
    Dim bln As Boolean
    
    bln = Application.DisplayAlerts
    Application.DisplayAlerts = False   &#39; no &quot;really want to delete&quot; alert
    If WstExists(strName) Then
        Worksheets(strName).Delete
        WstDelete = True
    Else
        WstDelete = False
    End If
    Application.DisplayAlerts = bln     &#39; restore value
End Function</code></pre>
<p>We first use the function <code>WstExists</code> to check if there is a worksheet. If there is, we call the <code>.delete</code> method and delete the worksheet. Note since we do not want an alert stating if we really want to delete the worksheet this is disabled using the <code>Application</code> object. The function returns true if the worksheet has been deleted.</p>
<p>Let us try to define a function that create a worksheet:</p>
<pre><code>&#39;&#39; Create a worksheet
&#39; @param strName Name of worksheet.
&#39; @param blnForce Force deletion of worksheet if exists.
&#39; @return True if created.
Function WstCreate(strName As String, Optional blnForce As Boolean = False) As Boolean
    Dim wst As Worksheet
    
    If blnForce And WstExists(strName) Then Call WstDelete(strName)
    If Not WstExists(strName) Then
        Set wst = Worksheets.Add
        wst.Name = strName
        WstCreate = True
    Else
        WstCreate = False
    End If
End Function</code></pre>
<p>We use an optional argument to force deletion of the old worksheet (if a worksheet with the same name). Next, we create the worksheet using the <code>.Add</code> method and rename it using the <code>.Name</code> method. The function returns true if the worksheet has been created.</p>
<p>Finally, let us create a function that clear a worksheet:</p>
<pre><code>&#39;&#39; Clear a worksheet if it exists
&#39; @param strName Name of worksheet.
&#39; @param blnCells Delete cell contents, formats, comments, etc. (default).
&#39; @param blnContents Delete cell contents.
&#39; @param blnFormat Delete cell format.
&#39; @param blnObjects Delete cell buttons and charts.
&#39; @return True if cleared.
Function WstClear(strName As String, _
  Optional blnCells As Boolean = True, _
  Optional blnContents As Boolean = False, _
  Optional blnFormat As Boolean = False, _
  Optional blnObjects As Boolean = False) As Boolean
    Dim wst As Worksheet
    
    On Error Resume Next
    If WstExists(strName) Then
        Set wst = Worksheets(strName)
        If blnCells Then wst.UsedRange.Clear
        If blnContents Then wst.Cells.ClearContents
        If blnFormat Then wst.Cells.ClearFormats
        If blnObjects Then
            wst.ChartObjects.Delete
            wst.Buttons.Delete
        End If
        WstClear = True
    Else
        WstClear = False
    End If
End Function</code></pre>
<p>First note that we have a lot of optional arguments depending on what we want to clear. Next the <code>On Error Resume Next</code> statement is used to make the program not stop even if an error happens. Finally, depending on the setting of the optional arguments we e.g. clear the format in all cells if <code>blnFormat</code> is true.</p>
<p>All the functions above is part of the <em><a href="apdx-vba.html#vba-course-procedures">course procedures</a></em> that you may use ‘as is’ during the course and at the exam. I will explicitly state if you are not allowed to use them otherwise. All the worksheet procedures start with <code>Wst</code> so you easy can find them using auto complete in the VBA editor. All worksheet procedures are stored in the <code>ModWst</code> module. You may open the module to have a look at the procedures.</p>
<p>Let us see them in action:</p>
<pre><code>&#39;&#39; Test the worksheet functions
Sub TM5_TestWorksheetFunc()
    If WstCreate(&quot;Test&quot;, blnForce:=True) Then MsgBox (&quot;Created Test&quot;)  
    If WstRename(&quot;Test&quot;, &quot;Test1&quot;) Then MsgBox (&quot;Renamed the Test to Test1&quot;)  &#39; only work if no Test1 sheet
    If WstClear(&quot;Test8&quot;) Then MsgBox (&quot;Cleared Test8&quot;) &#39; no clearing since on sheet with that name
    If WstDelete(&quot;Test1&quot;) Then MsgBox (&quot;Deleted Test1&quot;)
End Sub</code></pre>
</div>
<div id="wst-rng" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> The Range object<a href="mod-vba-datatypes.html#wst-rng" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ranges are objects that refer to parts of a worksheet e.g. a cell, a row, a column, or a rectangular selection of cells. Ranges can be used to read and write to cells</p>
<pre><code>Sub TM5_RangeEx1()
   Dim rng As Range
   Dim cell As Range
   Dim i As Integer
   
   Call TM5_ClearTestTM5    &#39; clear test cells so have empty cells
   ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
   &#39; Modify a range to a fixed value
   Set rng = Range(&quot;G4:I6&quot;)
   rng = 145   &#39; cell value in rng
   MsgBox rng.Address   &#39; range address 
   &#39; Use for each to scan range (direction left-down)
   Set rng = Range(&quot;G8:I10&quot;)
   i = 1
   For Each cell In rng
      cell = &quot;Entry &quot; &amp; i
      i = i + 1
   Next
   &#39; Use Cells to set a range
   Set rng = Range(Cells(23, 3), Cells(25, 6))
   MsgBox rng.Address
End Sub</code></pre>
<p>The method <code>.Address</code> is used to return the cell address.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tm5-sheet"></span>
<img src="img/tm5-sheet.png" alt="TM5 worksheet." width="700px" />
<p class="caption">
Figure 5.1: TM5 worksheet.
</p>
</div>
<p>Similar the number of rows can by found using <code>.rows.Count</code>:</p>
<pre><code>&#39;&#39; Rows in range
&#39; @param rng A range.
Function RngGetRows(rng As Range) As Long
    RngGetRows = rng.rows.Count
End Function</code></pre>
<p>We can also find number of columns, address of upper left cell or lower right cell etc. In the <a href="apdx-vba.html#vba-course-procedures">course procedures</a> (module <em>ModRng</em>) all these have been defined. Let us try to use them:</p>
<pre><code>Sub TM5_RangeEx2()
  Dim rng As Range
  
  Set rng = ThisWorkbook.Worksheets(&quot;TM5&quot;).Range(&quot;C4:E19&quot;)
  MsgBox (&quot;Number of rows: &quot; &amp; RngGetRows(rng))
  MsgBox (&quot;Number of cols: &quot; &amp; RngGetCols(rng))
  MsgBox (&quot;First column number: &quot; &amp; RngGetFirstCol(rng))
  MsgBox (&quot;First column letter: &quot; &amp; RngGetFirstCol(rng, asLetter:=True))
  MsgBox (&quot;Lower right cell: &quot; &amp; RngGetLowerRight(rng, asString:=True))
  MsgBox (&quot;Upper right cell: &quot; &amp; RngGetUpperRight(rng, asString:=True))
End Sub</code></pre>
<div id="named-ranges-in-excel" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Named ranges in Excel<a href="mod-vba-datatypes.html#named-ranges-in-excel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is possible to define named ranges directly in Excel. For instance the named range <code>UserAmounts</code> referring to cells C5:E19 in Figure <a href="mod-vba-datatypes.html#fig:tm5-sheet">5.1</a> has been created by selecting cells C5:E19 and defining <code>UserAmounts</code> with <em>Formulas -&gt; Define Name</em>. You can now use <code>UserAmounts</code> in VBA by</p>
<pre><code>Sub TM5_NamedRangeEx()
  Dim rng As Range
  
  ThisWorkbook.Activate
  Set rng = Range(&quot;UserAmounts&quot;)
  MsgBox (&quot;Number of rows: &quot; &amp; RngGetRows(rng))
  MsgBox (&quot;Number of cols: &quot; &amp; RngGetCols(rng))
  MsgBox (&quot;First column number: &quot; &amp; RngGetFirstCol(rng))
  MsgBox (&quot;First column letter: &quot; &amp; RngGetFirstCol(rng, asLetter:=True))
  MsgBox (&quot;Lower right cell: &quot; &amp; RngGetLowerRight(rng, asString:=True))
  MsgBox (&quot;Upper right cell: &quot; &amp; RngGetUpperRight(rng, asString:=True))
End Sub</code></pre>
<p>Now try to redefine <code>UserAmounts</code> in Excel to cells C31:D33 (<em>Formulas &gt; Name Manager &gt; Edit</em>) and run the code again. That is, by using named ranges you can modify the reference directly in Excel.</p>
</div>
<div id="current-region-of-a-range" class="section level3 hasAnchor" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Current region of a range<a href="mod-vba-datatypes.html#current-region-of-a-range" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An important method is the current region <code>.CurrentRegion</code> which expands the range until all cells surrounding the range is empty. This is very useful if don’t know the size for data. Let us make a function that return the current region:</p>
<pre><code>&#39;&#39; Return the current region of a range.
&#39; @param rng The range to get the current region from.
Function RngCurRegion(rng As Range) As Range
    Set RngCurRegion = rng.CurrentRegion
End Function</code></pre>
<p>Note we have to use the <code>Set</code> keyword since the return value is a range (object). We can now test the course procedures starting with prefix <code>RngGet</code>:</p>
<pre><code>Sub TM5_CurrentRegionEx1()
    Dim rng As Range

    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    &#39; Try to guess the output
    Set rng = RngCurRegion(Range(&quot;D7&quot;))  &#39; rng now is the current region
    MsgBox (&quot;Address: &quot; &amp; RngGetAddress(rng))
    MsgBox (&quot;Rows = &quot; &amp; RngGetRows(rng) &amp; &quot; cols = &quot; &amp; RngGetCols(rng))
    MsgBox (&quot;First row number = &quot; &amp; RngGetFirstRow(rng) &amp; &quot;. Last row number = &quot; &amp; RngGetLastRow(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col number = &quot; &amp; RngGetFirstCol(rng) &amp; &quot;. Last col number = &quot; &amp; RngGetLastCol(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col letter = &quot; &amp; RngGetFirstCol(rng, True) &amp; &quot;. Last col letter = &quot; &amp; RngGetLastCol(rng, True) &amp; &quot;.&quot;)
    &#39; Try to guess the output
    Set rng = RngCurRegion(Range(&quot;C23&quot;))  &#39; assume we know that data contains cell C23
    MsgBox (&quot;Address: &quot; &amp; RngGetAddress(rng))
End Sub</code></pre>
<p>The same result can be obtained using the course procedures starting with <code>RngGetCurRegion</code>:</p>
<pre><code>Sub TM5_CurrentRegionEx2()
    Dim rng As Range

    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    &#39; Try to guess the output
    Set rng = Range(&quot;D7&quot;)  &#39; assume we know that data contains cell D7
    MsgBox (&quot;Address: &quot; &amp; RngGetCurRegionAddress(rng))
    MsgBox (&quot;Rows = &quot; &amp; RngGetCurRegionRows(rng) &amp; &quot; cols = &quot; &amp; RngGetCurRegionCols(rng))
    MsgBox (&quot;First row number = &quot; &amp; RngGetCurRegionFirstRow(rng) &amp; &quot;. Last row number = &quot; &amp; RngGetCurRegionLastRow(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col number = &quot; &amp; RngGetCurRegionFirstCol(rng) &amp; &quot;. Last col number = &quot; &amp; RngGetCurRegionLastCol(rng) &amp; &quot;.&quot;)
    MsgBox (&quot;First col letter = &quot; &amp; RngGetCurRegionFirstCol(rng, True) &amp; &quot;. Last col letter = &quot; &amp; RngGetCurRegionLastCol(rng, True) &amp; &quot;.&quot;)
    
    Set rng = Range(&quot;C23&quot;)  &#39; assume we know that data contains cell C23
    MsgBox (&quot;Address: &quot; &amp; RngGetCurRegionAddress(rng))
End Sub</code></pre>
<p>Note the difference in how <code>rng</code> is defined.</p>
</div>
<div id="input-and-output-1" class="section level3 hasAnchor" number="5.5.3">
<h3><span class="header-section-number">5.5.3</span> Input and output<a href="mod-vba-datatypes.html#input-and-output-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can read/write and copy/paste values to a range using the course procedures:</p>
<pre><code>Sub TM5_RangeEx3()
    Dim rng As Range
    Dim rngNew As Range
    
    Set rng = RngCurRegion(Range(&quot;D7&quot;))         &#39; get current region
    MsgBox (&quot;Copy to H14 (upper left corner).&quot;)
    Set rngNew = RngPaste(rng, Range(&quot;H14&quot;))    &#39; rngNew is now the new range
    MsgBox (&quot;Make yellow.&quot;)
    Call RngFormat(rngNew, &quot;yellow&quot;)
    MsgBox (&quot;Remove format.&quot;)
    Call RngClear(rngNew, blnCells:=False, blnFormat:=True)
    MsgBox (&quot;Clear range.&quot;)
    Call RngClear(rngNew)
End Sub</code></pre>
<p>Here <code>RngPaste</code> is used to copy a range and paste it to another range. Note you may use <code>RngFormat</code> to format cells of a range.</p>
<p>Moreover, you can read/write values from/to a csv file. A <a href="https://en.wikipedia.org/wiki/Comma-separated_values">comma-separated values (csv) file</a> is a delimited text file that uses a delimiter to separate values. Each line of the file is a data record. Each record consists of one or more fields, separated by the delimiter. The file format is not fully standardized, i.e. the delimiter may be a semicolon, a colon or another delimiter. Moreover, a field may be surrounded with quotation marks. Let us have a look at a csv file <code>data1.csv</code> with a header using a semicolon as delimiter:</p>
<pre><code>Year;Brand;Model
1997;Ford;E350
2000;Mercury;Cougar</code></pre>
<p>and the csv file <code>data2.csv</code> without a header using a semicolon as delimiter:</p>
<pre><code>55,18,34,1,81,26,90,11,46,32,93
49,95,73,82,53,40,99,10,52,38,92
59,90,97,100,59,73,88,33,78,61,24
96,84,32,36,94,82,49,94,48,49,1
59,21,24,57,3,78,54,79,57,42,8</code></pre>
<p>Let us try to read the two files:</p>
<pre><code>Sub TM5_RngFromCSVEx()
    Dim rng As Range
    
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5    &#39; clear test cells so have empty cells
    &#39;&#39; Read data1.csv file (NOTE you must know the separator in the csv file beforehand!)
    Range(&quot;G3&quot;) = &quot;Content of data1.csv:&quot;
    Set rng = RngFromCSV(&quot;data1.csv&quot;, Range(&quot;G4&quot;), &quot;;&quot;) &#39; paste file in range with upper left cell G4
    MsgBox (RngGetAddress(rng))
    &#39;&#39; Read data2.csv file (NOTE you must know the separator in the csv file beforehand!)
    Range(&quot;G8&quot;) = &quot;Content of data2.csv:&quot;
    Set rng = RngFromCSV(&quot;data2.csv&quot;, Range(&quot;G9&quot;), &quot;,&quot;) &#39; paste file in range with upper left cell G9
    MsgBox (RngGetAddress(rng))
End Sub</code></pre>
<p>Here we use the course procedure <code>RngFromCSV</code> to read the file and specify the upper left corner cell of where to paste. Note the function returns the pasted range.</p>
<p>You can write the content of a range to a csv file using:</p>
<pre><code>Sub TM5_RngToCSVEx()
    Dim rng As Range
    
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5    &#39; clear test cells so have empty cells
    &#39;&#39; Write to csv file
    Set rng = Range(&quot;C4:E19&quot;)
    Call RngToCSV(&quot;test.csv&quot;, rng, &quot;;&quot;)     &#39; semicolon (;) separated file
    &#39;&#39; Read test.csv file to check
    Range(&quot;G3&quot;) = &quot;Content of test.csv:&quot;
    Set rng = RngFromCSV(&quot;test.csv&quot;, Range(&quot;G4&quot;), &quot;;&quot;)
End Sub</code></pre>
<p>Here we use the course procedure <code>RngToCSV</code> to write the range to the file. Note you can specify different delimiters (here we use a semicolon).</p>
</div>
<div id="sorting-a-range" class="section level3 hasAnchor" number="5.5.4">
<h3><span class="header-section-number">5.5.4</span> Sorting a range<a href="mod-vba-datatypes.html#sorting-a-range" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ranges can be sorted using the <a href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.sort"><code>.Sort</code></a> method:</p>
<pre><code>Sub TM5_SortRangeEx()
    Dim rng As Range
    Dim rngCur As Range
    
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5    &#39; clear test cells so have empty cells
    Set rng = RngCurRegion(Range(&quot;C4&quot;))
   
    &#39;&#39; Sort based on second column ascending
    Set rngCur = RngPaste(rng, Range(&quot;G4&quot;), withFormat:=True)  &#39; make a copy to work with
    Call rngCur.Sort(Key1:=rngCur.Columns(2), Header:=xlYes)
    rngCur(1).Offset(-1, 0) = &quot;Sort 2. column&quot;  &#39; offset first cell in range by -1 row and 0 col

    &#39;&#39; Sort based on second column and afterwards 3. column (descending)
    Set rngCur = RngPaste(rng, Range(&quot;K4&quot;), True)
    Call rngCur.Sort(Key1:=rngCur.Columns(2), Header:=xlYes, Key2:=rngCur.Columns(3), Order2:=xlDescending)
    rngCur(1).Offset(-1, 0) = &quot;Sort 2. and next 3. column&quot;
End Sub</code></pre>
<p>We use the <code>Key</code> arguments to identify which columns we want to sort and the <code>Header</code> argument to identify if the first row in the range is a header. Finally the ordering is given using the <code>Order</code> argument (either xlAscending (default) or xlDescending).</p>
</div>
</div>
<div id="vba-ary" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Arrays<a href="mod-vba-datatypes.html#vba-ary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Arrays are used to store groups of variables of a specific datatype:</p>
<pre><code>&#39;&#39; Define an array (run using the debugger - step into)
&#39; How to check the content of an array?
&#39; Use the Locals window together with debug mode or a message box
Sub TM5_ArrayEx1()
   Dim intAry(4) As Integer      &#39; define array with index 0-4
   Dim strAry(3 To 5) As String  &#39; define array with index 3-5
   Dim i As Integer
   
   &#39; Set values
   intAry(0) = 9
   intAry(1) = 12
   intAry(2) = 222
   intAry(3) = 4
   intAry(4) = 100
   &#39; Information about the array
   MsgBox (&quot;Lowest index: &quot; &amp; LBound(intAry))
   MsgBox (&quot;Largest index: &quot; &amp; UBound(intAry))
   MsgBox (&quot;Number of elements: &quot; &amp; UBound(intAry) - LBound(intAry) + 1)
   MsgBox (&quot;Array as a string: &quot; &amp; AryToStr(intAry))
   &#39; Read and assign values
    For i = 3 To 5
        strAry(i) = ThisWorkbook.Worksheets(&quot;TM5&quot;).Cells(23 + i, 3)
    Next
    MsgBox (&quot;Array values: &quot; &amp; AryToStr(strAry))
End Sub</code></pre>
<p>Array <code>intAry</code> contain 5 elements which can be accessed using index 0, 1, 2, …, 4. In memory this is done by allocating memory for 5 integers (see Figure <a href="mod-vba-datatypes.html#fig:vba-ary">5.2</a>) with index 0-4. The lower and upper index bounds can be found using <code>LBound</code> and <code>UBound</code> and we can use the course procedure <code>AryToStr</code> to print it.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:vba-ary"></span>
<img src="img/array.png" alt="An array in memory." width="60%" />
<p class="caption">
Figure 5.2: An array in memory.
</p>
</div>
<p>Note the default start index is 0. If you want another start index you can use e.g. <code>Dim strAry(3 To 5) As String</code> which use indices 3-5 (<span class="math inline">\(3 = 5-3+1\)</span> elements). Moreover, if you want to start with index 1 as default then add <code>Option Base 1</code> to the top of your module.</p>
<p>Arrays require 20 bytes of memory plus 4 bytes for each array dimension plus the number of bytes occupied by the data itself. A Variant containing an array requires 12 bytes more than the array alone.</p>
<div id="multi-dimensional-arrays" class="section level3 hasAnchor" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Multi-dimensional arrays<a href="mod-vba-datatypes.html#multi-dimensional-arrays" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:vba-ary-3d"></span>
<img src="img/3d-array.png" alt="Arrays with different dimensions." width="100%" />
<p class="caption">
Figure 5.3: Arrays with different dimensions.
</p>
</div>
<p>An array can have different dimensions (see Figure <a href="mod-vba-datatypes.html#fig:vba-ary-3d">5.3</a>) e.g. and array with three dimensions is declared using:</p>
<pre><code>Dim intOrderSize(52, 100, 50) As Integer  </code></pre>
<p>where indices may be (week, customer, product) number. Let us assume that index start from 1 then we have an array with <span class="math inline">\(52 \cdot 100 \cdot 50\)</span> elements which can be accessed using e.g.</p>
<pre><code>MsgBox(intOrderSize(2, 10, 20))  &#39; order size week 2, customer 10, product 20 </code></pre>
<p>Let us consider an example:</p>
<pre><code>Sub TM5_MultiDimArrayEx()
    Dim intA(20, 10) As Integer
    Dim i As Integer, j As Integer
    
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5    &#39; clear test cells so have empty cells
    &#39; Assign some values
    For i = LBound(intA, 1) To UBound(intA, 1)
        For j = LBound(intA, 2) To UBound(intA, 2)
            intA(i, j) = WorksheetFunction.RandBetween(1, 1000)
        Next
    Next
    &#39; print results from G4
    For i = LBound(intA, 1) To UBound(intA, 1)
        For j = LBound(intA, 2) To UBound(intA, 2)
            Cells(i + 4, j + 7) = intA(i, j)
        Next
    Next
    &#39; Call AryPaste(intA, Range(&quot;G4&quot;)) &#39; same result
End Sub</code></pre>
<p>We first assign random values to <code>intA</code> in the first loop. Note we use <code>LBound</code> and <code>UBound</code> to find the range of the indices (the second argument is the dimension we consider). Next, the results are printed to the sheet with upper left equal to G4. Here you may also have used the course procedure <code>AryPaste</code> instead.</p>
</div>
<div id="dynamic-arrays" class="section level3 hasAnchor" number="5.6.2">
<h3><span class="header-section-number">5.6.2</span> Dynamic arrays<a href="mod-vba-datatypes.html#dynamic-arrays" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Often we do not know the size of the array we need when we start the program. For this we use dynamic arrays:</p>
<pre><code>Sub TM5_DynArrayEx()
    Dim ary() As String   &#39; dynamic array, note use empty ()
    Dim i As Integer
    
    ThisWorkbook.Worksheets(&quot;TM5_Test3&quot;).Activate
    ReDim ary(2 To 5)  &#39; create entries a(2) to a(5)
    For i = 2 To 5
        ary(i) = Cells(i + 1, 1)   &#39; read from Array sheet
    Next
    MsgBox (&quot;Values are: &quot; &amp; AryToStr(ary))
    MsgBox (&quot;The lowest and higest index are &quot; &amp; LBound(ary) &amp; &quot; and &quot; &amp; UBound(ary))
    
    ReDim ary(3 To 5)  &#39; reallocate array, all values are set to default (empty string)
    MsgBox (&quot;Values are: &quot; &amp; AryToStr(ary))
    For i = 3 To 5
        ary(i) = Cells(i + 1, 1)
    Next
    MsgBox (&quot;Values are: &quot; &amp; AryToStr(ary))
    MsgBox (&quot;The lowest and higest index are &quot; &amp; LBound(ary) &amp; &quot; and &quot; &amp; UBound(ary))
End Sub</code></pre>
<p>First, the dynamic array is declared using empty parenthesis <code>Dim ary() As String</code>. Next the <code>ReDim</code> keyword is used to set the dimension.</p>
</div>
<div id="input-and-output-2" class="section level3 hasAnchor" number="5.6.3">
<h3><span class="header-section-number">5.6.3</span> Input and output<a href="mod-vba-datatypes.html#input-and-output-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A set of <a href="apdx-vba.html#vba-course-procedures">course procedures</a> (module <em>ModAry</em>) have been defined to read/set the values in an array and output the values of an array:</p>
<pre><code>Sub TM5_IOAryEx()
    Dim ary() As Integer
    Dim strAry() As String
    
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5
    &#39;&#39; Set to value single value
    ReDim ary(2)
    Call AryToVal(ary, 5)
    Range(&quot;G4&quot;) = &quot;A fixed value:&quot;
    Call AryPaste(ary, Range(&quot;G5&quot;)) &#39; the upper left cell is G5
    &#39;&#39; Paste vertical
    Range(&quot;K4&quot;) = &quot;Paste vertical:&quot;
    Call AryPaste(ary, Range(&quot;K5&quot;), False)
    &#39;&#39; Set to sequence
    Call AryToSeq(ary, 1, 6)
    Range(&quot;G10&quot;) = &quot;A sequence:&quot;
    Call AryPaste(ary, Range(&quot;G11&quot;))
    &#39;&#39; Read strings from a range
    Call AryRead(strAry, Range(&quot;C31:D33&quot;))  &#39; read a 2D array
    Range(&quot;G31&quot;) = &quot;Names in the &quot; &amp; AryDim(strAry) &amp; &quot;D array:&quot;
    Call AryPaste(strAry, Range(&quot;G32&quot;))
End Sub</code></pre>
<p>You set all entries in the array to a single value using <code>AryToVal</code> and a sequence using <code>AryToSeq</code>. Moreover, use <code>AryRead</code> to read the values of a range into an array. Finally, <code>AryPaste</code> can be used to paste values of an array to a sheet. You just have to specify the upper left cell where you want to paste.</p>
<p>Procedure <code>AryRead</code> can both read values into 1D and 2D arrays:</p>
<pre><code>Sub TM5_AryReadEx()
    Dim ary() As Integer

    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5
    &#39;&#39; Read values from a range with only 1 column
    Call AryRead(ary, Range(&quot;C5:C9&quot;))
    Range(&quot;G4&quot;) = AryDim(ary) &amp; &quot;D array:&quot;
    Call AryPaste(ary, Range(&quot;G5&quot;), False)
    &#39;&#39; Read values from a range with only 1 row
    Call AryRead(ary, Range(&quot;C5:E5&quot;))
    Range(&quot;I4&quot;) = AryDim(ary) &amp; &quot;D array:&quot;
    Call AryPaste(ary, Range(&quot;I5&quot;))
    &#39;&#39; Read values from a range with only 1 column/row but use 2D array
    Call AryRead(ary, Range(&quot;C11:C14&quot;), blnReduceDim:=False)
    Range(&quot;G10&quot;) = AryDim(ary) &amp; &quot;D array:&quot;
    Call AryPaste(ary, Range(&quot;G11&quot;), False)
    &#39;&#39; Use other start and end index
    Call AryRead(ary, Range(&quot;C17:E19&quot;), intStartIdx1:=2, intStartIdx2:=5)
    Range(&quot;G16&quot;) = AryDim(ary) &amp; &quot;D array with start index &quot; &amp; LBound(ary, 1) &amp; &quot; and &quot; &amp; LBound(ary, 2) &amp; &quot;:&quot;
    Call AryPaste(ary, Range(&quot;G17&quot;))
End Sub</code></pre>
<p>First, note that if the optional argument <code>blnReduceDim</code> is not set to false the array automatically becomes a 1D array if a range with one row or column is read. Next, you can use another start index of the array (default is 1) by specifying the optional arguments <code>intStartIdx1</code> and <code>intStartIdx2</code>.</p>
<p>Procedure <code>AryRead</code> fails if we want to set values for arrays with more than 2 dimensions. For this the <code>AryReadLong</code> can be used which can read arrays until five dimensions:</p>
<pre><code>Sub TM5_AryReadLongEx()
    Dim ary() As Integer
    
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5
    &#39;&#39; Read 1D array
    Call AryReadLong(ary, Range(&quot;A36:B38&quot;), 3)   &#39; default value = 3
    Range(&quot;G35&quot;) = &quot;Values in the &quot; &amp; AryDim(ary) &amp; &quot;D array:&quot;
    Call AryPaste(ary, Range(&quot;G36&quot;))
    &#39;&#39; Read 2D array
    Call AryReadLong(ary, Range(&quot;A41:C47&quot;), 4)   &#39; default value = 4
    Range(&quot;G40&quot;) = &quot;Values in the &quot; &amp; AryDim(ary) &amp; &quot;D array:&quot;
    Call AryPaste(ary, Range(&quot;G41&quot;))
    &#39;&#39; Read 3D array (cannot be pasted to the sheet, have a look at it using the debugger)
    Call AryReadLong(ary, Range(&quot;A50:D56&quot;), 5)   &#39; default value = 5
End Sub</code></pre>
<p>Procedure <code>AryReadLong</code> assumes that you specify the values in long format, i.e. there is index values in all columns except the last which contains the values (see Figure <a href="mod-vba-datatypes.html#fig:tm5-arylong">5.4</a>). For instance, if we consider row 54, then the specification says that <code>ary(1,3,1) = 49</code>. Note we do not have to specify all combination of indices, e.g. in the specification A41:C47 the index (2,4) is missing and set to the default value 4. It is assumed that indices start from the lowest to highest index in each dimension.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tm5-arylong"></span>
<img src="img/tm5-arylong.png" alt="Reading values to an array using a long format (TM5 worksheet)." width="800px" />
<p class="caption">
Figure 5.4: Reading values to an array using a long format (TM5 worksheet).
</p>
</div>
<p>You can also read a csv file into an array. Let us have a look at a csv file <code>data2.csv</code> using a colon as delimiter:</p>
<pre><code>55,18,34,1,81,26,90,11,46,32,93
49,95,73,82,53,40,99,10,52,38,92
59,90,97,100,59,73,88,33,78,61,24
96,84,32,36,94,82,49,94,48,49,1
59,21,24,57,3,78,54,79,57,42,8</code></pre>
<p>You can read the values into an array using <code>AryFromCSV</code>:</p>
<pre><code>Sub TM5_AryReadCSVEx()
    Dim rng As Range
    Dim ary() As Integer
    
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5
    &#39;&#39; Read csv file (NOTE you must know the separator in the csv file beforehand!)
    Range(&quot;G3&quot;) = &quot;Array values:&quot;
    Call AryFromCSV(ary, &quot;data2.csv&quot;, &quot;,&quot;)   &#39; know that it contains integers (otherwise use variant)
    Call AryPaste(ary, Range(&quot;G4&quot;))
End Sub</code></pre>
<div id="example---reading-values-from-a-sheet" class="section level4 hasAnchor" number="5.6.3.1">
<h4><span class="header-section-number">5.6.3.1</span> Example - Reading values from a sheet<a href="mod-vba-datatypes.html#example---reading-values-from-a-sheet" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><em>This example is a slightly modified version an exam assignment (exam 2022-A4).</em></p>
<p>Consider the data in worksheet <em>TM5_AryData</em>. Our goal is to create a procedure that reads the strings in the worksheet into a 2D array with the following features:</p>
<ul>
<li>Indexing must start from 1 in both dimensions.</li>
<li>The procedure should work for other datasets with a different number of columns and rows. You may assume that the data starts in cell A1.</li>
<li>A message box should be given after the data has been read with the value of array entry (1,3). If the entry does not exists a warning should be given instead.</li>
<li>A button in worksheet <em>TM5_AryData</em> should run the procedure.</li>
</ul>
<p>If you are not allowed to read the data into an array using the course procedure <code>AryRead</code>, you must use for loop(s) to assign values to the array:</p>
<pre><code>Sub TM5_AryReadValuesPlainVBA()
   Dim ary() As String
   Dim rng As Range
   Dim r As Integer, c As Integer
   
   Worksheets(&quot;TM5_AryData&quot;).Activate
   Set rng = RngCurRegion(Range(&quot;A1&quot;))  &#39; get current region
   ReDim ary(1 To RngGetLastRow(rng), 1 To RngGetLastCol(rng))  &#39; redim array
   &#39; allocate values
   For r = 1 To RngGetLastRow(rng)
       For c = 1 To RngGetLastCol(rng)
           ary(r, c) = Cells(r, c)
       Next
   Next
   &#39; print ary(1,3)
   If (UBound(ary, 2) &lt; 3) Then
       MsgBox (&quot;Array does not have 3 columns!&quot;)
       Exit Sub
   End If
   MsgBox (&quot;Value entry (1,3) is: &quot; &amp; ary(1, 3))
End Sub</code></pre>
<p>If you are allowed to use <code>AryRead</code> then you can skip the for loop:</p>
<pre><code>Sub TM5_AryReadValues()
   Dim ary() As String
   Dim rng As Range
   Dim r As Integer, c As Integer
   
   Worksheets(&quot;TM5_AryData&quot;).Activate
   Set rng = RngCurRegion(Range(&quot;A1&quot;))  &#39; get current region
   Call AryRead(ary, rng)               &#39; allocate values
   &#39; print ary(1,3)
   If (UBound(ary, 2) &lt; 3) Then
       MsgBox (&quot;Array does not have 3 columns!&quot;)
       Exit Sub
   End If
   MsgBox (&quot;Value entry (1,3) is: &quot; &amp; ary(1, 3))
End Sub</code></pre>
</div>
</div>
<div id="sorting-arrays" class="section level3 hasAnchor" number="5.6.4">
<h3><span class="header-section-number">5.6.4</span> Sorting arrays<a href="mod-vba-datatypes.html#sorting-arrays" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Arrays can be sorted using <code>AryQuickSort</code>:</p>
<pre><code>Sub TM5_ArySortEx()
    Dim ary() As Integer
    
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5
    
    &#39;&#39; Read from a range and sort
    Call AryRead(ary, Range(&quot;C5:E19&quot;))
    Call AryQuickSort(ary, 2)
    Range(&quot;G3&quot;) = &quot;Sort w.r.t. 2. column:&quot;
    Call RngPaste(Range(&quot;C4:E4&quot;), Range(&quot;G4&quot;))  &#39; copy header
    Call AryPaste(ary, Range(&quot;G5&quot;))
End Sub</code></pre>
<p>Here we sort based on the 2. column in the array.</p>
</div>
<div id="use-arrays-instead-of-ranges" class="section level3 hasAnchor" number="5.6.5">
<h3><span class="header-section-number">5.6.5</span> Use arrays instead of ranges<a href="mod-vba-datatypes.html#use-arrays-instead-of-ranges" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since a range represent a block of cells in a sheet, one may think of a range a some kind of 1D or 2D array. Hence one may use a range directly to read/write values instead of an array (we did that in Section <a href="mod-vba-procedures.html#vba-test-persons">4.7</a>). However, often arrays are better to use than ranges:</p>
<ul>
<li>You can set indices as you like so they give a meaning to you, e.g. <code>intOrderSize(2, 10, 20)</code> denote the order size of product 20, in week 2 for customer 10.</li>
<li>Arrays are much faster to update than ranges, More specific, it is much faster to update the values many times in an array compared to a range.</li>
<li>You worksheet and ranges may be seen as a place where you keep your data. Hence, when you run an algorithm, you first read the data into some arrays. Next, do some calculations (update the arrays) and finally output the result to a worksheet again.</li>
</ul>
<p>Consider for example the distance matrix calculations in Section <a href="mod-vba-loops-cond.html#vba-ex-dist-mat">3.6</a>. Here it would be faster to store the distance matrix in a 2D array:</p>
<pre><code>Sub TM5_MakeDistArray()
    Dim n As Integer
    Dim aryDist() As Double
    Dim i As Integer
    Dim j As Integer
    
    ThisWorkbook.Worksheets(&quot;TM3_DistanceMatrix&quot;).Activate
    n = Range(&quot;E1&quot;)
    ReDim aryDist(1 To n, 1 To n)
    For i = 1 To n
        For j = i + 1 To n
           aryDist(i, j) = TM3_Distance(Cells(i + 1, 2), Cells(i + 1, 3), Cells(j + 1, 2), Cells(j + 1, 3))
           aryDist(j, i) = aryDist(i, j)  &#39; set symetric value
        Next
    Next
End Sub</code></pre>
<p>Afterwards <code>aryDist</code> can be used during in an algorithm.</p>
</div>
</div>
<div id="vba-coll" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Collections<a href="mod-vba-datatypes.html#vba-coll" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Collections are a way of storing a group of items together (think of it as a set). Collections and arrays are both used to group variables. They both store a set of items e.g. a list of student marks or country names. If we compare collections against arrays:</p>
<ul>
<li>Collections are similar to arrays but better to use when the number of items is not fixed. With an array you normally set the size once. On the contrary you often add or remove items from a collection.</li>
<li>Collections are better when adding and removing items.</li>
<li>An item in a collection are read-only whereas an entry in an array are read/write.</li>
<li>Collection can be accessed using a key or an index (starting from 1).</li>
<li>Items of a collection do not have to share the same data type.</li>
</ul>
<p>Collections are a part of the predefined objects in VBA and hence a collection have to be defined in a special way. Let us consider an example:</p>
<pre><code>Sub TM5_ColEx()
    Dim col As New Collection   &#39; declare and create
    Dim e As Variant
    
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    Call TM5_ClearTestTM5
    &#39;&#39; Add items
    Call col.Add(&quot;Apple&quot;)
    Call col.Add(&quot;Pear&quot;)
    Call col.Add(123)
    Cells(4, 7) = &quot;The collection now contains &quot; &amp; col.Count &amp; &quot; items: &quot; &amp; Col2Str(col)
    &#39;&#39; Use For Each to scan elements
    For Each e In col
      MsgBox (e)
    Next e
    &#39;&#39; Access values in the collection using index
    Cells(5, 7) = &quot;The 1. item is: &quot; &amp; col(1)
    Cells(6, 7) = &quot;The 3. item is: &quot; &amp; col(3)
    &#39; Remove items
    Call col.Remove(2)
    Cells(7, 7) = &quot;The collection now contains &quot; &amp; col.Count &amp; &quot; items: &quot; &amp; Col2Str(col)
    &#39;&#39; Note index of items has now changed (the 3. item has become the 2. item)
    Cells(8, 7) = &quot;The 1. item is: &quot; &amp; col(1)
    Cells(9, 7) = &quot;The 2. item is: &quot; &amp; col(2)
    &#39;&#39; Clear collection
    Set col = Nothing
    Cells(10, 7) = &quot;The collection now contains &quot; &amp; col.Count &amp; &quot; items.&quot;
End Sub</code></pre>
<p>First we declare and create a collection:</p>
<pre><code>Dim col As New Collection</code></pre>
<p>The collection (or set) is now defined with zero items. You can add items using</p>
<pre><code>Call col.Add(&quot;Apple&quot;)
Call col.Add(&quot;Pear&quot;)
Call col.Add(123)</code></pre>
<p>Let us create a function that prints the items of a collection as string:</p>
<pre><code>Function Col2Str(col As Collection, Optional strSep As String = &quot;, &quot;) As String
    Dim e As Variant
    Dim str As String
    
    For Each e In col
        str = str &amp; e &amp; strSep
    Next e
    Col2Str = Left(str, Len(str) - Len(strSep))
End Function</code></pre>
<p>Then the output of</p>
<pre><code>&quot;The collection now contains &quot; &amp; col.Count &amp; &quot; items: &quot; &amp; Col2Str(col)</code></pre>
<p>becomes</p>
<pre><code>&quot;The collection now contains 3 items: Apple, Pear, 123&quot;</code></pre>
<p>You can access values in the collection using index:</p>
<pre><code>&quot;The 1. item is: &quot; &amp; col(1)
&quot;The 3. item is: &quot; &amp; col(3)</code></pre>
<pre><code>The 1. item is: Apple
The 3. item is: 123</code></pre>
<p>Items are removed using:</p>
<pre><code>Call col.Remove (2)
&quot;The collection now contains &quot; &amp; col.Count &amp; &quot; items: &quot; &amp; Col2Str(col)</code></pre>
<pre><code>The collection now contains 2 items: Apple, 123</code></pre>
<p>Note index of items has now changed (the 3. item has become the 2. item):</p>
<pre><code>&quot;The 1. item is: &quot; &amp; col(1)
&quot;The 2. item is: &quot; &amp; col(2)</code></pre>
<pre><code>The 1. item is: Apple
The 2. item is: 123</code></pre>
<p>You clear a collection using:</p>
<pre><code>Set col = Nothing
&quot;The collection now contains &quot; &amp; col.Count &amp; &quot; items.&quot;</code></pre>
<pre><code>The collection now contains 0 items.</code></pre>
<p>An item in a collection can be given a key (think af a key as a name tag given to each item):</p>
<pre><code>Sub TM5_ColKeyEx()
    Dim col As New Collection   &#39; declare and create
    Dim k As Variant
    
    ThisWorkbook.Worksheets(&quot;TM5&quot;).Activate
    &#39;&#39; Add using keys
    Call col.Add(&quot;Hans Jørgensen&quot;, &quot;ID123&quot;)   &#39; value, key
    Call col.Add(&quot;Jens Hansen&quot;, &quot;ID234&quot;)
    Call col.Add(&quot;Lone Nielsen&quot;, &quot;ID456&quot;)
    &#39; col.Add &quot;Sine Mikkelsen&quot;, &quot;ID456&quot; &#39; gives an error since already used the key
    Cells(12, 7) = &quot;The collection now contains &quot; &amp; col.Count &amp; &quot; items: &quot; &amp; Col2Str(col)
    &#39;&#39; Access values using keys
    Cells(13, 7) = &quot;The item with key ID123 is: &quot; &amp; col(&quot;ID123&quot;)
    &#39; Remove items using keys
    col.Remove &quot;ID123&quot;
    Cells(14, 7) = &quot;The collection now contains &quot; &amp; col.Count &amp; &quot; items: &quot; &amp; Col2Str(col)
End Sub</code></pre>
<p>Here we add items using a key:</p>
<pre><code>Call col.Add(&quot;Hans Jørgensen&quot;, &quot;ID123&quot;)   &#39; value, key
Call col.Add(&quot;Jens Hansen&quot;, &quot;ID234&quot;)
Call col.Add(&quot;Lone Nielsen&quot;, &quot;ID456&quot;)
&quot;The collection now contains &quot; &amp; col.Count &amp; &quot; items: &quot; &amp; Col2Str(col)</code></pre>
<pre><code>The collection now contains 3 items: Hans Jørgensen, Jens Hansen, Lone Nielsen</code></pre>
<p>You can now access the item using the key:</p>
<pre><code>&quot;The item with key ID123 is: &quot; &amp; col(&quot;ID123&quot;)</code></pre>
<pre><code>The item with key ID123 is: Hans Jørgensen</code></pre>
<p>Similar you can remove an item using a key:</p>
<pre><code>Call col.Remove(&quot;ID123&quot;)
&quot;The collection now contains &quot; &amp; col.Count &amp; &quot; items: &quot; &amp; Col2Str(col)</code></pre>
<pre><code>The collection now contains 2 items: Jens Hansen, Lone Nielsen</code></pre>
<p>It is recommended to use keys since using keys has three advantages:</p>
<ul>
<li>If the order changes your code will still access the correct item</li>
<li>You can directly access the item without reading through the entire collection</li>
<li>It can make you code more readable</li>
</ul>
<p>For more information about collections you may have a look at this <a href="http://excelmacromastery.com/excel-vba-collections/">webpage</a>.</p>
</div>
<div id="vba-ex-job-seq" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> Example - Job sequencing<a href="mod-vba-datatypes.html#vba-ex-job-seq" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider <span class="math inline">\(i = 1,...,n\)</span> jobs that has to be done on a machine and let <span class="math inline">\(c_{ij}\)</span> denote the setup cost of switching from job <span class="math inline">\(i\)</span> to job <span class="math inline">\(j\)</span>. Moreover, let <span class="math inline">\(c_{0i}\)</span> denote the setup cost of setting up job <span class="math inline">\(i\)</span> when the machine is idle (index 0). Let <span class="math inline">\(s = (0, s_1, \ldots, s_n)\)</span> denote the sequence of jobs and <span class="math inline">\(C\)</span> the total setup costs, e.g. if <span class="math inline">\(s = (0,1,3,2,6,5,4)\)</span>, then <span class="math inline">\(C = c_{01} + c_{13} + c_{32} + c_{26} + c_{65} + c_{54}\)</span>. Different algorithms for finding a good strategy minimizing the total setup costs exists. A greedy algorithm is:</p>
<div class="box">
<p><strong>Step 0</strong>: Select the first job as one with minimal idle setup cost.</p>
<p><strong>Step 1</strong>: Given current job <span class="math inline">\(i\)</span> select the unscheduled with minimal setup cost.</p>
<p><strong>Step 2</strong>: If no unscheduled jobs then stop and output the found job sequence else go to Step 1.</p>
</div>
<p>Often a better algorithm is:</p>
<div class="box">
<p><strong>Step 0</strong>: For each column <span class="math inline">\(j\)</span> find <span class="math inline">\(\bar{c}_j = min(c_{0j},\ldots,c_{j-1,j},c_{j+1,j},\ldots,c_{nj})\)</span> and define relative setup costs <span class="math inline">\(\hat{c}_{ij} = c_{ij}-\bar{c}_{j}\)</span> (the cost is subtracted the minimum value in that column).</p>
<p><strong>Step 1</strong>: Call the greedy algorithm using costs <span class="math inline">\(\hat{c}_{ij}\)</span>.</p>
</div>
<p>Examples on how data could look like can be seen in worksheet <em>TM5_JobSeq</em> that contains the setup costs (Figure <a href="mod-vba-datatypes.html#fig:tm5-job-seq">5.5</a>). Columns M-T contain three datasets for which we want to calculate a job sequence.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tm5-job-seq"></span>
<img src="img/tm5-job-seq.png" alt="Worksheet *TM5_JobSeq*." width="100%" />
<p class="caption">
Figure 5.5: Worksheet <em>TM5_JobSeq</em>.
</p>
</div>
<p>Let us try to implement the greedy algorithm which takes the cost array <code>costs</code> as arguments and output the job sequence and cost:</p>
<pre><code>&#39;&#39; Job sequeceing using a cost array
&#39;
&#39; @param costs An 2D array with setup costs
&#39; @param strSeq The job sequence found (returned ByRef).
&#39; @param dblCosts The total setup costs (returned ByRef).
Sub TM5_GreedyAlg(costs() As Double, strSeq As String, dblCosts As Double)
    Dim intJobs As Integer          &#39; number of jobs
    Dim used() As Integer           &#39; an entry equals 1 if already scheduled
    Dim intCurJob As Integer        &#39; current job
    Dim intNextJob As Integer       &#39; best candidate for next job (= intM if not found yet)
    Dim dblNextCost As Double       &#39; setup cost current to next job
    Dim c As Integer                &#39; iterators
    Dim intM As Integer             &#39; big number

    &#39;&#39; Allocate arrays
    intJobs = UBound(costs, 1)
    ReDim used(1 To intJobs)    &#39; set size
    Call AryToVal(used, 0)      &#39; set to 0
    
    &#39;&#39; Run greedy
    strSeq = &quot;0&quot;  &#39; start idle
    intM = 1000   &#39; a number bigger than largest cost
    intCurJob = 0  &#39; start idle
    dblCosts = 0
    Do While True &#39; find next job given current
        intNextJob = intM
        dblNextCost = intM
        For c = 1 To intJobs &#39; scan row in array to find next unused job with minimal cost
            If used(c) &lt;&gt; 1 And costs(intCurJob, c) &lt; dblNextCost Then
                intNextJob = c
                dblNextCost = costs(intCurJob, c)
            End If
        Next
        If intNextJob = intM Then Exit Do  &#39; no new job found (all jobs used)
        dblCosts = dblCosts + dblNextCost
        used(intNextJob) = 1
        intCurJob = intNextJob
        strSeq = strSeq &amp; &quot;, &quot; &amp; intNextJob
    Loop
End Sub</code></pre>
<p>First observe that the procedure have three arguments <code>costs</code>, <code>strSeq</code> and <code>dblCosts</code>. The array <code>costs</code> contain the setup costs and is an input argument to the algorithm. The last two arguments are output arguments. Since arguments are passed by reference by default (no new memory is allocated), we modify them with the solution. Next, to run the algorithm we need to keep track of which jobs have been used. We use the array <code>used</code> for this and set it to 0 (not used) and 1 (used). Finally, the <code>Do While</code> loop is used to scan a row in the cost array. We want to find the minimum cost and hence use a big number as starting value, then scan all unused jobs and choose the one with minimum cost. If no new job is found we finish; otherwise we update <code>strSeq</code> and <code>dblCosts</code>.</p>
<p>Note that the procedure do not have any interaction with a worksheet. It simply takes an array as input argument and store the result in two output arguments. That is, the procedure is independent of where the data is from (could e.g. be an csv file instead of a worksheet).</p>
<p>Let us try to link the greedy algorithm to the data in workheet <em>TM5_JobSeq</em>. Columns M-T contain three datasets for which we want to calculate a job sequence. First, let us make a procedure that copies a dataset to A4 (upper left cell):</p>
<pre><code>Sub TM5_CopyData()
   Dim str As String
   
   ThisWorkbook.Worksheets(&quot;TM5_JobSeq&quot;).Activate   &#39; so use the correct sheet
   str = InputBox(&quot;Specify cell in data (e.g. N7)&quot;) &#39; get a cell value
   Call TM5_CleanJobSeq                             &#39; delete previous data
   Call RngPaste(RngCurRegion(Range(str)), Range(&quot;A4&quot;), withFormat:=True) &#39; paste the current region
End Sub</code></pre>
<p>Note we use the current region of the cell value to retrieve the dataset. We can now run the greedy algorithm using the data starting in A4:</p>
<pre><code>Sub TM5_RunGreedy()
    Dim costs() As Double  &#39; setup costs
    Dim strSeq As String   &#39; job seq
    Dim dblCosts As Double &#39; total setup costs
    Dim rng As Range

    ThisWorkbook.Worksheets(&quot;TM5_JobSeq&quot;).Activate
    &#39; Allocate costs to array
    Set rng = RngCurRegion(Range(&quot;A4&quot;)) &#39; rng now is the whole dataset with headers
    Set rng = Range(&quot;B5:&quot; &amp; RngGetLastCol(rng, asLetter:=True) &amp; RngGetLastRow(rng)) &#39; rng now is the costs
    Call AryRead(costs, rng, 0, 1) &#39; start index from 0 (first dim) and 1 (second dim)
    &#39; Run algorithm
    Call TM5_GreedyAlg(costs, strSeq, dblCosts)
    &#39; Write results to sheet
    Range(&quot;C1&quot;) = UBound(costs, 1)
    Range(&quot;C2&quot;) = strSeq
    Range(&quot;F1&quot;) = dblCosts
End Sub</code></pre>
<p>First, observe how we allocate values to the ‘costs’ array. We use the course procedure <code>AryRead</code> and hence first have to find the range containing the setup costs. This can be done may ways, but we know that the upper left cell is B5 and the lower right is found using the <code>RngGet</code> functions. Next, we call <code>AryRead</code> and set the index to start from 0 (first dimension) and 1 (second dimension). Given setup costs, we call the greedy algorithm which returns updated <code>strSeq</code> and <code>dblCosts</code>. Finally, we output the results to the worksheet.</p>
<p>To implement the ‘better’ algorithm we need to modify the <code>costs</code> array and subtract the minimum column value:</p>
<pre><code>Sub TM5_RunBetter()
    Dim minCol() As Double &#39; min value in col c
    Dim intJobs As Integer &#39; number of jobs
    Dim costs() As Double  &#39; setup costs
    Dim strSeq As String   &#39; job seq
    Dim dblCosts As Double &#39; total setup costs
    Dim rng As Range
    Dim dbl As Double
    Dim r As Integer, c As Integer
    
    ThisWorkbook.Worksheets(&quot;TM5_JobSeq&quot;).Activate
    &#39; Allocate costs to array
    Set rng = RngCurRegion(Range(&quot;A4&quot;)) &#39; rng now is the whole dataset with headers
    Set rng = Range(&quot;B5:&quot; &amp; RngGetLastCol(rng, asLetter:=True) &amp; RngGetLastRow(rng)) &#39; rng now is the costs
    Call AryRead(costs, rng, 0, 1) &#39; start index from 0 (first dim) and 1 (second dim)
    &#39; Calc min value in each col
    intJobs = UBound(costs, 1)
    ReDim minCol(1 To intJobs)
    For c = 1 To intJobs
        dbl = 10000000   &#39; a big number
        For r = 0 To intJobs
            If costs(r, c) &lt; dbl And r &lt;&gt; c Then dbl = costs(r, c)
        Next
        minCol(c) = dbl
    Next
    &#39; Calc relative
    For c = 1 To intJobs
        For r = 0 To intJobs
            costs(r, c) = costs(r, c) - minCol(c)
        Next
    Next
    &#39; Run algorithm
    Call TM5_GreedyAlg(costs, strSeq, dblCosts)
    &#39; Write results to sheet
    Range(&quot;C1&quot;) = intJobs
    Range(&quot;C2&quot;) = strSeq
    Range(&quot;F1&quot;) = dblCosts + WorksheetFunction.Sum(minCol)
End Sub</code></pre>
<p>First, an array <code>minCol</code> is used to store the minimum values for each column. Next, we update the <code>costs</code> array with the relative values and the greedy algorithm is run with the relative setup cost values. Finally, we output the results. Note we have to add the minimum costs back to <code>dblCosts</code> (the sum of the <code>minCol</code> values).</p>
</div>
<div id="recap-2" class="section level2 hasAnchor" number="5.9">
<h2><span class="header-section-number">5.9</span> Recap<a href="mod-vba-datatypes.html#recap-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Variables are used to store information that is saved in memory. A variable may store different data types such an integer, a double, a group of doubles (an array), a range of cells in a worksheet (a range object) or a set of numbers (a collection).</p></li>
<li><p>Strings are special variables with varying length.</p></li>
<li><p>Use the <code>&amp;</code> to concatenate strings (glue strings together).</p></li>
<li><p>An empty string is of length zero.</p></li>
<li><p>VBA have a lot of predefined objects you can use. Think of an object as a datatype that holds a group of variables. Examples of some objects are <code>Range</code>, <code>Worksheet</code>, and <code>WorksheetFunction</code>.</p></li>
<li><p>Refer to an object by specifying the path in the hierarchy e.g. </p>
<pre><code>Workbooks(&quot;Jobs.xlsm&quot;).Worksheets(&quot;Data values&quot;).Range(&quot;D4&quot;).value</code></pre>
<p>You may skip parts of the path (VBA then uses the current active one).</p></li>
<li><p>Warning, you must know which sheet is active. Always specify what you want to be active</p>
<pre><code>ThisWorkbook.Worksheets(&quot;Data values&quot;).Activate  &#39; activate the sheet
dbl = Range(&quot;D4&quot;)</code></pre></li>
<li><p>Declare object variables using:</p>
<pre><code>Dim rng As Range
Dim wst As Worksheet</code></pre></li>
<li><p>Set a reference to object variables using the keyword <code>Set</code>:</p>
<pre><code>Set rng = Range(&quot;F7&quot;)
Set wst = Worksheets(&quot;Data values&quot;)</code></pre></li>
<li><p>A <code>Worksheet</code> object refer to a worksheet and you can use it to e.g. modify cells:</p>
<pre><code>Worksheets(&quot;TM5_Test1&quot;).Range(&quot;B2&quot;) = &quot;Testing Worksheet&quot;  &#39; write to cell in sheet TM5_Test1
Set wst1 = ThisWorkbook.Worksheets(&quot;TM5_Test1&quot;)  &#39; set a reference to a worksheet
wst1.Range(&quot;B6&quot;) = &quot;Writing using wst1&quot;</code></pre></li>
<li><p>Different functions for worksheets is part of the <em><a href="apdx-vba.html#vba-course-procedures">course procedures</a></em>. All the worksheet procedures start with <code>Wst</code> so you easy can find them using auto complete in the VBA editor. All worksheet procedures are stored in the <code>ModWst</code> module. You may open the module to have a look at the procedures. Examples:</p>
<pre><code>If WstCreate(&quot;Test&quot;, blnForce:=True) Then MsgBox (&quot;Created Test&quot;)  
If WstRename(&quot;Test&quot;, &quot;Test1&quot;) Then MsgBox (&quot;Renamed the Test to Test1&quot;)  &#39; only work if no Test1 sheet
If WstClear(&quot;Test8&quot;) Then MsgBox (&quot;Cleared Test8&quot;) &#39; clear sheet Test8 if exists
If WstDelete(&quot;Test1&quot;) Then MsgBox (&quot;Deleted Test1&quot;)</code></pre></li>
<li><p>Ranges are objects that refer to parts of a worksheet e.g. a cell, a row, a column, or a rectangular selection of cells.</p></li>
<li><p>Ranges can be used to read and write to cells</p>
<pre><code>Dim rng As Range
Set rng = Range(&quot;A1:D5&quot;)
rng = 145   &#39; cell value
MsgBox rng.Address   &#39; range address ($A$1:$D$5)</code></pre></li>
<li><p>You can use the <a href="apdx-vba.html#vba-course-procedures">course procedures</a> (module <em>ModRng</em>) with prefix <code>RngGet</code> to retrieve info about the range:</p>
<pre><code>Set rng = ThisWorkbook.Worksheets(&quot;TM5&quot;).Range(&quot;C4:E19&quot;)
MsgBox (&quot;Number of rows: &quot; &amp; RngGetRows(rng))
MsgBox (&quot;Number of cols: &quot; &amp; RngGetCols(rng))
MsgBox (&quot;First column number: &quot; &amp; RngGetFirstCol(rng))
MsgBox (&quot;First column letter: &quot; &amp; RngGetFirstCol(rng, asLetter:=True))
MsgBox (&quot;Lower right cell: &quot; &amp; RngGetLowerRight(rng, asString:=True))
MsgBox (&quot;Upper right cell: &quot; &amp; RngGetUpperRight(rng, asString:=True))</code></pre></li>
<li><p>The current region of a range is found by expanding the range until all cells surrounding the range is empty</p>
<pre><code>rng = Range(&quot;D23&quot;).CurrentRegion</code></pre>
<p>This is useful if don’t know the size for data.</p></li>
<li><p>You can use the <a href="apdx-vba.html#vba-course-procedures">course procedures</a> (module <em>ModRng</em>) with prefix <code>RngGetCurRegion</code> to retrieve info about the current region of a range:</p>
<pre><code>Set rng = Range(&quot;D7&quot;)  &#39; assume we know that data contains cell D7
MsgBox (&quot;Address: &quot; &amp; RngGetCurRegionAddress(rng))
MsgBox (&quot;Rows = &quot; &amp; RngGetCurRegionRows(rng) &amp; &quot; cols = &quot; &amp; RngGetCurRegionCols(rng))
MsgBox (&quot;First row number = &quot; &amp; RngGetCurRegionFirstRow(rng) &amp; &quot;. Last row number = &quot; &amp; RngGetCurRegionLastRow(rng) &amp; &quot;.&quot;)
MsgBox (&quot;First col number = &quot; &amp; RngGetCurRegionFirstCol(rng) &amp; &quot;. Last col number = &quot; &amp; RngGetCurRegionLastCol(rng) &amp; &quot;.&quot;)
MsgBox (&quot;First col letter = &quot; &amp; RngGetCurRegionFirstCol(rng, True) &amp; &quot;. Last col letter = &quot; &amp; RngGetCurRegionLastCol(rng, True) &amp; &quot;.&quot;)</code></pre></li>
<li><p>You copy/paste a range using:</p>
<pre><code>Set rng = Range(&quot;D7:E10&quot;)      
Set rngNew = RngPaste(rng, Range(&quot;H14&quot;))    &#39; paste with upper left = H14, rngNew is now the new range</code></pre></li>
<li><p>You can read values from a csv file using:</p>
<pre><code>Set rng = RngFromCSV(&quot;data1.csv&quot;, Range(&quot;G4&quot;), &quot;;&quot;) &#39; paste file in range with upper left cell G4</code></pre></li>
<li><p>You can write values from a range to a csv file using:</p>
<pre><code>Call RngToCSV(&quot;test.csv&quot;, rng, &quot;;&quot;)     &#39; semicolon (;) separated file</code></pre></li>
<li><p>The columns in a range can be <a href="https://docs.microsoft.com/en-us/office/vba/api/excel.range.sort">sorted</a>. For instance sort a range ascending with respect to the second column and next descending with respect to the first column.</p>
<pre><code>Call rng.Sort(Key1:=rng.Columns(2), Order1:=xlAscending, _
         Key2:=rng.Columns(1), Order2:=xlDescending, Header:=xlYes)</code></pre></li>
<li><p>An array store groups of variables of a specific data type. For example</p>
<pre><code>Dim intValues(8) As Integer</code></pre>
<p>The variable <code>intValues</code> is an array with 9 elements which can be accessed using index 0, 1, 2, …, 8.</p></li>
<li><p>The default start index of an array is 0. If you want to start with index 1 then add <code>Option Base 1</code> to the top of your module or use:</p>
<pre><code>Dim strAry(3 To 5) As String  &#39; define array with index 3-5</code></pre></li>
<li><p>An array can have different dimensions, e.g. three:</p>
<pre><code>Dim intOrderSize(52, 100, 50) As Integer  </code></pre>
<p>where indices may be (week, customer, product) number. Let us assume that index start from 1 then we have an array with <span class="math inline">\(52 \cdot 100 \cdot 50\)</span> elements which can be accessed using e.g.</p>
<pre><code>intOrderSize(2,10, 20)  &#39; order size week 2, customer 10, product 20 </code></pre></li>
<li><p>Arrays require 20 bytes of memory plus 4 bytes for each array dimension plus the number of bytes occupied by the data itself. A Variant containing an array requires 12 bytes more than the array alone.</p></li>
<li><p>Dynamic arrays are arrays where the dimension is unknown when they are declared. Use <code>ReDim</code> to set the dimension later:</p>
<pre><code>Dim strPeople() As String
...
n = 8
ReDim strPeople(n)</code></pre></li>
<li><p>You can set values for an array by reading from a range:</p>
<pre><code>Dim ary() As Integer
Call AryRead(ary, Range(&quot;C5:E9&quot;))</code></pre></li>
<li><p>You can paste values of an array to a range:</p>
<pre><code>Call AryPaste(ary, Range(&quot;G5&quot;)) &#39; the upper left cell is G5</code></pre></li>
<li><p>You can set values for an array with more than 2 dimensions by reading from a range:</p>
<pre><code>Dim ary() As Integer
Call AryReadLong(ary, Range(&quot;A36:B38&quot;), 3)   &#39; default value = 3</code></pre>
<p>The procedure <code>AryReadLong</code> assumes that you specify the values in long format, i.e. there is index values in all columns except the last which contains the values.</p></li>
<li><p>You can read a csv file into an array using:</p>
<pre><code>Dim ary() As Integer
Call AryFromCSV(ary, &quot;data2.csv&quot;, &quot;,&quot;)   &#39; know that it contains integers (otherwise use variant)</code></pre></li>
<li><p>Arrays can be sorted using:</p>
<pre><code>Dim ary() As Integer
Call AryQuickSort(ary, 2) &#39; sort w.r.t. 2. column</code></pre></li>
<li><p>Often arrays are better to use than ranges:</p>
<ul>
<li>You can set indices as you like so they give a meaning to you, e.g. <code>intOrderSize(2, 10, 20)</code> denote the order size of product 20, in week 2 for customer 10.</li>
<li>Arrays are much faster to update that ranges. It is much faster to update the values many times in an array compared to a range.</li>
<li>You worksheet and ranges may be seen as a place where you keep your data. Hence, when you run an algorithm, you first read the data into some arrays. Next, do some calculations (update the arrays) and finally output the result to a worksheet again.</li>
</ul></li>
<li><p>Collections are used for storing a group of items together (think of it as a set).</p></li>
<li><p>Collections and arrays are both used to group variables. If we compare collections against arrays:</p>
<ul>
<li>Collections are similar to arrays but better to use when the number of items is not fixed. With an array you normally set the size once. On the contrary you often add or remove items from a collection.</li>
<li>Collections are better when adding and removing items.</li>
<li>An item in a collection are read-only whereas an entry in an array are read/write.</li>
<li>Collection can be accessed using a key or an index (starting from 1).</li>
<li>Items of a collection do not have to share the same data type.</li>
</ul></li>
<li><p>Declare and create a collection:</p>
<pre><code>Dim col As New Collection</code></pre></li>
<li><p>Add items using:</p>
<pre><code>Call col.Add(&quot;Apple&quot;)
Call col.Add(&quot;Pear&quot;)</code></pre></li>
<li><p>Items are removed using:</p>
<pre><code>Call col.Remove (2)</code></pre></li>
<li><p>Clear a collection using:</p>
<pre><code>Set col = Nothing</code></pre></li>
<li><p>An item in a collection can be given a key (think af a key as a name tag given to each item):</p>
<pre><code>Call col.Add(&quot;Hans Jørgensen&quot;, &quot;ID123&quot;)   &#39; value, key
Call col.Add(&quot;Jens Hansen&quot;, &quot;ID234&quot;)</code></pre></li>
<li><p>You can now access the item using the key:</p>
<pre><code>&quot;The item with key ID123 is: &quot; &amp; col(&quot;ID123&quot;)</code></pre></li>
<li><p>You can remove an item using a key:</p>
<pre><code>Call col.Remove(&quot;ID123&quot;)</code></pre></li>
<li><p>It is recommended to use keys since using keys has three advantages:</p>
<ul>
<li>If the order changes your code will still access the correct item</li>
<li>You can directly access the item without reading through the entire collection</li>
<li>It can make you code more readable</li>
</ul></li>
</ul>
<div>
You may also have a look at the
<a href="https://bss-osca.github.io/tfa/slides/05_vba-datatypes-slides.html" target="_blank">slides for this module</a>
.
</div>
</div>
<div id="ex-vba-datatypes" class="section level2 hasAnchor" number="5.10">
<h2><span class="header-section-number">5.10</span> Exercises<a href="mod-vba-datatypes.html#ex-vba-datatypes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Below you will find a set of exercises. Always have a look at the exercises before you meet in your study group and try to solve them yourself. Are you stuck, see the <a href="help.html#help">help page</a>. Some of the solutions to each exercise can be seen by pressing the button at each question. Beware, you will not learn by giving up too early. Put some effort into finding a solution!</p>
<div>
A template with VBA code is given in the file
<a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-template.xlsm" target="_blank">vba-template.xlsm</a>
(open it and use it while reading the notes). Have a look inside the module
<i>TM5_ex</i>
in the VBA editor for examples used in the notes and during lectures. Have a look at module
<i>TM5_exercises</i>
for exercises. Guiding answers for the exercises can be found in the file
<a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-solution.xlsm" target="_blank">vba-solution.xlsm</a>
.
</div>
<div id="ex-vba-equal" class="section level3 hasAnchor" number="5.10.1">
<h3><span class="header-section-number">5.10.1</span> Exercise - Equal entries<a href="mod-vba-datatypes.html#ex-vba-equal" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a slightly modified version an exam assignment (exam 2021-A4).</em></p>
<p>Consider worksheet <em>TM5_Equal</em> with seven data sets. Each data set consists of a list of integer values and is contained in a single column. Your code should be able to run on any of these data sets, but only on one data set at a time.</p>
<p>The value in cell C1 states the column to use, so you can change the data set by changing this value (the values can be 1, 3, 5, …). The data sets vary in size. If you need to know the number of values in the data set, it should be done as part of your vba code.</p>
<p>Write a sub <em>TM5_Equal</em> that</p>
<ul>
<li>stores the values of the data set indicated in cell C1 in an array;</li>
<li>creates an array <code>equal</code>, where <code>equal(k,j)</code> is 1, if the k’th and j’th values are equal, and 0 otherwise.</li>
</ul>
<p>A named range <code>Numbers</code> has been stored in Excel using <em>Formulas -&gt; Define Name</em>. Write a sub <em>TM5_EqualNamedRange</em> that</p>
<ul>
<li>stores the values of the data set saved in the named range <code>Numbers</code>.</li>
<li>creates an array <code>equal</code>, where <code>equal(k,j)</code> is 1, if the k’th and j’th values are equal, and 0 otherwise.</li>
<li>Try to redefine <code>Numbers</code> using <em>Formulas &gt; Name Manager &gt; Edit</em> so reference to another dataset and rerun the the sub.</li>
</ul>
</div>
<div id="ex-vba-search-products" class="section level3 hasAnchor" number="5.10.2">
<h3><span class="header-section-number">5.10.2</span> Exercise - Product search<a href="mod-vba-datatypes.html#ex-vba-search-products" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider the worksheet <em>TM5_Products</em> containing a set of products with product code and price.</p>
<ol style="list-style-type: decimal">
<li>Create a sub <code>TM5_FindProduct</code> that
<ul>
<li>Declare two arrays to store the price and product code.</li>
<li>Assign values to the arrays.</li>
<li>Use an input box to ask for a product code.</li>
<li>Use a for loop to search for the product and output the price in a message box. Hint: the <a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/exit-statement"><code>Exit sub</code></a> may be useful.</li>
</ul></li>
<li>Add a button to the worksheet that run the procedure.</li>
<li>Test you code using different product codes.</li>
<li>What happens if you write the product code without capital letters? If your code do not work, have a look at the <a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/ucase-function"><code>UCase</code></a> function.</li>
<li>Modify your code so that if the product is not found then “Product not found!” is given in a message box.</li>
</ol>
</div>
<div id="ex-vba-read-collections" class="section level3 hasAnchor" number="5.10.3">
<h3><span class="header-section-number">5.10.3</span> Exercise - Read collections<a href="mod-vba-datatypes.html#ex-vba-read-collections" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider worksheet <em>TM5_Col</em> with numbers in column A to be read into a collection. Create a procedure <code>TM5_ColNoKeys</code> that:</p>
<ol style="list-style-type: decimal">
<li>Create a collection <code>col</code> and add all the numbers.</li>
<li>Print the collection in a message box (you may use the function <code>Col2Str</code> here).</li>
<li>Create another collection <code>colC</code> and add all the items in <code>col</code> with value below 5.</li>
</ol>
<p>Consider worksheet <em>TM5_Col</em> with some ID numbers and prices for a set of products in columns C-D. Create a procedure <code>TM5_ColKeys</code> that:</p>
<ol style="list-style-type: decimal">
<li>Create a collection <code>col</code> and add all the prices using ID as key.</li>
<li>Print the price of the product with ID92011 in a message box.</li>
<li>What happens if you try to print the price of ID92?</li>
</ol>
</div>
<div id="ex-vba-read-arrays" class="section level3 hasAnchor" number="5.10.4">
<h3><span class="header-section-number">5.10.4</span> Exercise - Read arrays<a href="mod-vba-datatypes.html#ex-vba-read-arrays" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider the worksheet <em>TM5_Array</em> containing 3 datasets to be read into an array. The first two are in long format and the last in range format.</p>
<p>Write a procedure <code>TM5_ReadArrays</code> that use course procedures <code>AryRead</code> and <code>AryReadLong</code> to read the values into three arrays. Assume that</p>
<ul>
<li>For the first dataset is the default array value 10.</li>
<li>For the second dataset is the default array value 5.</li>
<li>For the third dataset index must start from 3 (first dimension) and 5 (second dimension).</li>
</ul>
<p>Use the debugger to inspect if the values have been read correctly into the arrays.</p>
</div>
<div id="ex-vba-process" class="section level3 hasAnchor" number="5.10.5">
<h3><span class="header-section-number">5.10.5</span> Exercise - Process numbers<a href="mod-vba-datatypes.html#ex-vba-process" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a slightly modified version an exam assignment (reexam 2022-A5).</em></p>
<p>Consider worksheet <em>TM5_ProcessData</em>, which contains a set of numbers.</p>
<ol style="list-style-type: decimal">
<li>Create a procedure <code>TM5_Process</code> with the following features:
<ul>
<li>Copy the numbers to worksheet <em>TM5_Process</em>.</li>
<li>Scan all the numbers and remove (clear the cell) all the negative numbers.</li>
<li>Highlight all the numbers above 20.</li>
<li>Add a button to the worksheet <em>TM5_Process</em> that run the procedure.</li>
<li>The procedure should work for other datasets with a different size. You may assume that the data starts in cell A1.</li>
</ul></li>
<li>Create a procedure <code>TM5_Stat</code> with the following features:
<ul>
<li>Scan the numbers and find
<ul>
<li>the sum of all non-negative numbers,</li>
<li>the mean of all negative numbers.</li>
</ul></li>
<li>Use a message box to display the sum and mean calculated.</li>
<li>Add a button to the worksheet <em>TM5_ProcessData</em> that run the procedure.</li>
<li>The procedure should work for other datasets with a different size. You may assume that the data starts in cell A1.</li>
</ul></li>
</ol>
</div>
<div id="ex-vba-search-pay" class="section level3 hasAnchor" number="5.10.6">
<h3><span class="header-section-number">5.10.6</span> Exercise - Search payments<a href="mod-vba-datatypes.html#ex-vba-search-pay" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a slightly modified version an exam assignment (reexam 2022-A6).</em></p>
<p>Consider worksheet <em>TM5_PaymentsData</em> which contains a table with three columns. The table contains data about payments for clients at a set of dates.</p>
<p>Create a procedure <code>TM5_SearchPayments</code> that searches the table with the following features:</p>
<ul>
<li>Read the <em>payment boolean</em> in cell <em>B1</em> (<em>TRUE</em> or <em>FALSE</em>) and the <em>grouping string</em> in cell <em>B2</em> (<em>None</em> or <em>Year</em>) on worksheet <em>TM5_Payments</em>.</li>
<li>Only consider payments where cells in the <em>Payment</em> column equals the payment boolean.</li>
<li>If the grouping string equals <em>None</em> then count the number of payments for each client. Next, output the results on worksheet <em>TM5_Payments</em>. See worksheet <em>TM5_PaymentsEx1</em> for an example.</li>
<li>If the grouping string equals <em>Year</em> then count the number of payments for each client and year. Next, output the results on worksheet <em>TM5_Payments</em>. See worksheet <em>TM5_PaymentsEx2</em>_ for an example.</li>
<li>Add a button to worksheet <em>TM5_Payments</em> that run the procedure.</li>
</ul>
<p>The procedure should work for other datasets with different number of rows too.</p>
</div>
<div id="ex-vba-flight" class="section level3 hasAnchor" number="5.10.7">
<h3><span class="header-section-number">5.10.7</span> Exercise - Flight search<a href="mod-vba-datatypes.html#ex-vba-flight" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The worksheet <em>TM5_FlightData</em> contains a set of flights between different destinations. You task is to create a procedure <code>TM5_SearchFlights</code> that can search for matching flights given a set of origins and destinations.</p>
<ol style="list-style-type: decimal">
<li>Have a look at the results in worksheet <em>TM5_FlightData</em>. The origin and destinations to search for are given in columns A and B and the search result in columns D, E and F.</li>
<li>Try pressing the <strong>Clear Search</strong> button and see what happens. Have a look at the code in the VBA editor for this sub and get an overview.</li>
</ol>
<div id="hint-d5y8KUyUjp816dxKwkSD0uQhMnKLRk" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="hint-d5y8KUyUjp816dxKwkSD0uQhMnKLRk-title">
<div class="modal-dialog modal-lg" role="document">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-label="Close">
<span aria-hidden="true">×</span>
</button>
<h4 class="modal-title" id="hint-d5y8KUyUjp816dxKwkSD0uQhMnKLRk-title1">
Hint
</h4>
</div>
<div class="modal-body">
<p>
Set the range you want to read and use AryRead
</p>
</div>
<div class="modal-footer">
<button class="btn btn-default" data-dismiss="modal">
Close
</button>
</div>
</div>
</div>
</div>
<button class="btn btn-default btn-xs" style="float:right" data-toggle="modal" data-target="#hint-d5y8KUyUjp816dxKwkSD0uQhMnKLRk">
Hint
</button>
<ol start="3" style="list-style-type: decimal">
<li><p>Try to finish the first part of the <code>TM5_SearchFlights</code> sub and store the flights in arrays. Use the debugger to check if the values are stored correctly.</p></li>
<li><p>Try to finish the second part of the <code>SearchFlights</code> sub and search for matching origin-destination pairs. Note origins and destinations listed to be searched for are also matching origin-destination pairs if they are not in the same row.</p></li>
</ol>
</div>
<div id="ex-vba-search-table" class="section level3 hasAnchor" number="5.10.8">
<h3><span class="header-section-number">5.10.8</span> Exercise - Search table<a href="mod-vba-datatypes.html#ex-vba-search-table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a slightly modified version an exam assignment (exam 2022-A6).</em></p>
<p>Consider worksheet <em>TM5_Search</em> which contains a table with three columns starting in cell A1. You want to search this table and output the matching rows to a new sheet.</p>
<ol style="list-style-type: decimal">
<li>Create a procedure <em>TM5_Search1</em> that searches the table with the following features:
<ul>
<li>First, a message box is used to ask if a name should be searched. If the answer is <em>yes</em>, then use an input box to type the name.</li>
<li>Next, use a message box to ask if an amount should be searched. If the answer is <em>yes</em>, then use an input box to type the amount (search for amounts greater than or equal the typed amount).</li>
<li>Scan the table and output all rows that match the specified criteria, and output the resulting table with matching rows in worksheet <em>TM5_SearchOutput</em>. If no criteria are used, then return all rows.</li>
<li>Add a button to worksheet <em>TM5_SearchOutput</em> that run the procedure.</li>
<li>The procedure should work for other datasets with different number of rows too (such as the dataset starting in cell E1).</li>
</ul></li>
<li>Create a procedure <em>TM5_Search2</em> that searches the table with the following features:
<ul>
<li>Copy the whole table to worksheet <em>TM5_SearchOutput</em>.</li>
<li>Sort the table non-increasing order of the column <strong>Sales Amount</strong>, then next based on the <strong>Title</strong> column.</li>
<li>Use an input box to ask for an amount <span class="math inline">\(x\)</span>.</li>
<li>Highlight the cells in the rows where the <strong>Sales Amount</strong> is less than <span class="math inline">\(x\)</span>.</li>
<li>Add a button to worksheet <em>TM5_SearchOutput</em> that run the procedure.</li>
</ul></li>
</ol>
</div>
<div id="ex-vba-next-task" class="section level3 hasAnchor" number="5.10.9">
<h3><span class="header-section-number">5.10.9</span> Exercise - Find next task<a href="mod-vba-datatypes.html#ex-vba-next-task" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a slightly modified version an exam assignment (reexam 2021-A6).</em></p>
<p>Consider worksheet <em>TM5_Tasks</em> which contains a list of tasks. For each task, you see the task ID and a descriptive text, along with the following information:</p>
<ul>
<li>Column C: The number indicates any task that must start before the current task. For instance, Task 6 (Check social media) must be started before Task 8 (Filter false news) can be started. Note that the task just have to start, not finish. You may assume that at most one task is required to start in each case.</li>
<li>Column D: A number indicating how attractive the task is to perform. Higher values indicate higher attractiveness.</li>
<li>Column E: A 1 is stated, if the task is already started.</li>
</ul>
<p>Given a set of tasks, where some are already started, write a sub that selects the next task with the following features:</p>
<ul>
<li>Among the tasks not started, your sub should select the most attractive task that respects the predecessor requirement.</li>
<li>Output the next task in a message box.</li>
<li>Indicate in column E that the task is now started.</li>
<li>Add a button that run the procedure.</li>
</ul>
</div>
<div id="ex-vba-seat-reservation" class="section level3 hasAnchor" number="5.10.10">
<h3><span class="header-section-number">5.10.10</span> Exercise - Seat reservation<a href="mod-vba-datatypes.html#ex-vba-seat-reservation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a larger assignment and is more extensive than the exam and is not a mandatory/part of curriculum. Do not expect such a large assignment at the exam. However, by doing this exercise you will improve your VBA skills which may be beneficial at the exam or when write your master thesis.</em></p>
<p>A <a href="https://github.com/bss-osca/tfa/blob/master/vba/vba-seat-reservation-template.xlsm">template file</a> is given for this exercise, which should be used as a starting point. The file already contains skeletons for some of the procedures and some procedures that you may use to help you. Implement ALL your code in module <code>ModSeatRes</code>.</p>
<p>This exercise considers a seat reservation problem. Consider a train with <span class="math inline">\(I\)</span> seats that is travelling between a start station <span class="math inline">\(1\)</span> and an end station <span class="math inline">\(S\)</span> with <span class="math inline">\(S-2\)</span> stations in between. All seats must be reserved and requests for seat reservations arrive on-line. For ease we assume that a request <span class="math inline">\(r\)</span> is for a single seat between a start station <span class="math inline">\(s_1(r)\)</span> and the end station <span class="math inline">\(s_2(r)\)</span>. A decision must be made immediately after the arrival of the request to either accept the request or reject it. If the request is accepted, the reservation must be assigned to a seat and this decision cannot be changed subsequently. That is, there is no knowledge about future requests. The train company want to find a strategy that accept as many requests as possible. For further references about the seat reservation problem see <span class="citation">J. Boyar and Larsen (<a href="#ref-Boyar99">1999</a>)</span> and <span class="citation">Joan Boyar, Krarup, and Nielsen (<a href="#ref-Boyar04">2004</a>)</span>.</p>
<p>Consider the following requests arriving for a train with 3 seats and 14 stations:</p>
<table>
<thead>
<tr class="header">
<th>Request</th>
<th>From</th>
<th>To</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td>2</td>
<td>7</td>
<td>9</td>
</tr>
<tr class="odd">
<td>3</td>
<td>2</td>
<td>5</td>
</tr>
<tr class="even">
<td>4</td>
<td>9</td>
<td>13</td>
</tr>
<tr class="odd">
<td>5</td>
<td>2</td>
<td>6</td>
</tr>
<tr class="even">
<td>6</td>
<td>11</td>
<td>14</td>
</tr>
<tr class="odd">
<td>7</td>
<td>10</td>
<td>13</td>
</tr>
<tr class="even">
<td>8</td>
<td>8</td>
<td>9</td>
</tr>
<tr class="odd">
<td>9</td>
<td>7</td>
<td>11</td>
</tr>
</tbody>
</table>
<p>A possible assignment of requests to seats is given in Figure <a href="mod-vba-datatypes.html#fig:greedy">5.6</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:greedy"></span>
<img src="img/greedy.png" alt="Assignment of requests (Greedy strategy)." width="100%" />
<p class="caption">
Figure 5.6: Assignment of requests (Greedy strategy).
</p>
</div>
<p>Observe that the reservation number is assigned to a slot where slot <span class="math inline">\(s\)</span> is from station <span class="math inline">\(s\)</span> to <span class="math inline">\(s+1\)</span>. That is, for each seat there is <span class="math inline">\(S-1\)</span> slots.</p>
<p>Given a request <span class="math inline">\(r\)</span> consider strategies:</p>
<ul>
<li><strong>Greedy</strong>: Scan seats from 1 to <span class="math inline">\(I\)</span>. If seat <span class="math inline">\(i\)</span> is available from <span class="math inline">\(s_1(r)\)</span> to <span class="math inline">\(s_2(r)\)</span> then accept the request and assign the reservation to seat <span class="math inline">\(i\)</span>. Otherwise reject the request.</li>
<li><strong>Minimize Slots (MinSlots)</strong>: For each seat <span class="math inline">\(i\)</span> available from <span class="math inline">\(s_1(r)\)</span> to <span class="math inline">\(s_2(r)\)</span> calculate the total free slots before and after stations <span class="math inline">\(s_1\)</span> to <span class="math inline">\(s_2\)</span>. Assign the request to a seat where it leaves as little total consecutive free slots (before and after) as possible. Otherwise reject the request.</li>
<li><strong>Maximize Slots (MaxSlots)</strong>: For each seat <span class="math inline">\(i\)</span> available from <span class="math inline">\(s_1(r)\)</span> to <span class="math inline">\(s_2(r)\)</span> calculate the total free slots before and after stations <span class="math inline">\(s_1\)</span> to <span class="math inline">\(s_2\)</span>. Assign the request to a seat where it leaves most total free slots as possible. Otherwise reject the request.</li>
</ul>
<p>The result of a strategy Greedy is given in Figure <a href="mod-vba-datatypes.html#fig:greedy">5.6</a> and for MinSlots in Figure <a href="mod-vba-datatypes.html#fig:min-slots">5.7</a>. Note that by using the MinSlots strategy all requests are accepted.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:min-slots"></span>
<img src="img/min-slot.png" alt="Assignment of requests (MinSlots strategy)." width="100%" />
<p class="caption">
Figure 5.7: Assignment of requests (MinSlots strategy).
</p>
</div>
<p>Two statistics are used to measure the quality of a strategy applied to the dataset with <span class="math inline">\(R\)</span> requests are:</p>
<ul>
<li>Accepted requests in percent.</li>
<li>Used slots in percent <span class="math display">\[\frac{\sum_r L_r(s_2(r)-s_1(r))}{I(S-1)}.\]</span> Where <span class="math inline">\(L_r = 1\)</span> if request <span class="math inline">\(r\)</span> is accepted and 0 otherwise. That is, slots used divided with total number of slots.</li>
</ul>
<p>You task is to create a program with the following features/tasks (implement your code in module <code>ModSeatRes</code>) :</p>
<div id="data-handling" class="section level4 unnumbered hasAnchor">
<h4>Data handling<a href="mod-vba-datatypes.html#data-handling" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>Consider and understand the procedure <code>CopyDataSheet</code> that asks for a number <span class="math inline">\(d\)</span> and copies the data in worksheet <em>Data-<span class="math inline">\(d\)</span></em> to the <em>Run strategy</em> worksheet. Add a button to the <em>Run strategy</em> worksheet that calls the procedure and test it.</li>
<li>Modify procedure <code>ReadData</code> that reads the data from a worksheet (e.g. <em>Run strategy</em>) and store it in two integers and an array. Hint: the procedure <code>AryRead</code> in module <code>ModAry</code> may be useful here.</li>
</ol>
</div>
<div id="algorithm-implementation" class="section level4 unnumbered hasAnchor">
<h4>Algorithm implementation<a href="mod-vba-datatypes.html#algorithm-implementation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol start="3" style="list-style-type: decimal">
<li>Consider and understand the procedure <code>BtnGreedy</code>. Add a button to the <em>Run strategy</em> worksheet that calls the procedure. Also consider and understand the procedure <code>PrintSolution</code> that prints the solution found to a worksheet and range.</li>
<li>Modify procedure <code>Greedy</code> so use the greedy strategy described given the data stored by calling <code>ReadData</code>. Test it using the button in the <em>Run strategy</em> worksheet.</li>
<li>Modify procedures <code>BtnMinSlots</code> and <code>BtnMaxSlots</code> that use the strategies on the data given in the <em>Run strategy</em> worksheet and print out the solution. Add buttons to the <em>Run strategy</em> worksheet that calls the procedure.</li>
<li>Modify procedures <code>MinSlots</code> and <code>MaxSlots</code> so use the strategies above given the data stored by calling <code>ReadData</code>. Test the algorithms using the buttons in the <em>Run strategy</em> worksheet.</li>
<li>Copy manually the data in worksheet <em>Ex - Run strategy</em> and test the buttons in worksheet <em>Run strategy</em> to see if you get the same results.</li>
</ol>
</div>
<div id="simuation" class="section level4 unnumbered hasAnchor">
<h4>Simuation<a href="mod-vba-datatypes.html#simuation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol start="8" style="list-style-type: decimal">
<li>Consider the procedure <code>GenerateData</code> that generate a dataset and modify procedure <code>BtnGenerateData</code> that call <code>GenerateData</code> and add the dataset to worksheet <em>Run strategy</em>. Add a button that runs it in worksheet <em>Run strategy</em> and test it.</li>
<li>Modify procedure <code>Simulate</code> that calculate the strategies for 100 datasets, print out the results and calculate statistics. The output should be in the worksheet <em>Simulation</em>. See worksheet <em>Ex - Simulation</em> for an example. Which strategy seems to be the best/worse?</li>
</ol>
</div>
<div id="parameter-analysis" class="section level4 unnumbered hasAnchor">
<h4>Parameter analysis<a href="mod-vba-datatypes.html#parameter-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol start="10" style="list-style-type: decimal">
<li>Modify procedure <code>Seats</code> which does a parameter variation on the number of seats. Apply the following approach:
<ul>
<li>Use the dataset in worksheet <em>Data-1</em>.</li>
<li>Use the <code>MinSlots</code> strategy.</li>
<li>Find solutions when there are 1 to 150 seats available.</li>
<li>Store the results in worksheet <em>Seats</em> (see worksheet <em>Ex - Seats</em> for an example).</li>
<li>Make a plot of the results (you may use the macro recorder to get some code).</li>
</ul>
How do the two statistics develop as the number of seats increase?</li>
</ol>
<p>Comments to the features/tasks can the added in the <em>Main</em> worksheet.</p>
</div>
</div>
<div id="ex-vba-select" class="section level3 hasAnchor" number="5.10.11">
<h3><span class="header-section-number">5.10.11</span> Exercise - Transform data (select and filter)<a href="mod-vba-datatypes.html#ex-vba-select" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>This exercise is a slightly modified version an exam assignment (exam 2024-A1).</em></p>
<p>Consider the Excel template file provided. The file contains different datasets in worksheets starting with <em>TM5_Data</em>. You may assume that all datasets have a header in the first row (starting in cell A1). Each column contains either doubles or strings. If the header title of a column starts with <em>str</em> then the column contains strings; otherwise the column contains doubles.</p>
<p>A dataset can be stored in two arrays where one store the column headers and one the data. For instance, the following code in VBA read the data in worksheet <em>TM5_Data1</em> into two arrays:</p>
<pre><code>Sub TM5_ReadData1()
   Dim aryData As Variant
   Dim aryHeaders() As String
   Dim rng As Range
   
   ThisWorkbook.Worksheets(&quot;TM5_Data1&quot;).Activate
   Set rng = Range(&quot;A1:&quot; &amp; RngGetCurRegionLastCol(Range(&quot;A1&quot;), asLetter:=True) &amp; &quot;1&quot;)
   Call AryRead(aryHeaders, rng)
   Set rng = RngGetCurRegionRange(Range(&quot;A1&quot;), row:=2, col:=1)
   Call AryRead(aryData, rng)
End Sub</code></pre>
<p>The array storing the header titles contains strings. However, since we do not know the datatype of a column in the dataset, the array <code>aryData</code> is of type <code>Variant</code>. That is, we don’t write <code>Dim aryData() As Variant</code> (which we normally do when defining a dynamic array), but <code>Dim aryData As Variant</code>, since a variant in itself can be an array.</p>
<p>Write a set of VBA procedures that answer/complete the following questions/tasks. All procedures MUST be documented using a skeleton similar to the examples given in the course notes (<a href="coding-convention.html#coding-convention">Section D1</a>).</p>
<ol style="list-style-type: decimal">
<li><p>Given a header title, create a procedure <code>TM5_IsColumnString</code> with the following features:</p>
<ul>
<li>The procedure takes a header title (string) as argument.</li>
<li>Returns true if the string starts with <em>str</em> and false otherwise.</li>
</ul>
<p>That is, if call the procedure with string <code>str_desc</code> then the procedure would return true, while calling the procedure with string <code>item_id</code> would return false. Hint: The <code>LEFT</code> string function in VBA may be useful.</p></li>
<li><p>Given the array with header titles, create a procedure <code>TM5_GetColumnIndex</code> that return the column index of a header title with the following features:</p>
<ul>
<li>The procedure takes an array as argument containing the header titles.</li>
<li>The procedure takes a string as argument with the header title to search for.</li>
<li>Returns the index of the header title (if found) else -1.</li>
</ul>
<p>For instance, if the header titles are array <code>("Ship", "Profit", "Cost")</code> with index starting from 1. Then a call to the procedure searching for <code>Cost</code> would return 3 while searching for <code>Boat</code> would return -1.</p></li>
<li><p>Create a procedure <code>TM5_SelectColumns</code> that selects a set of columns in a dataset stored using two arrays with the following features:</p>
<ul>
<li>The procedure takes the two arrays representing the dataset (header and data) as arguments.</li>
<li>The procedure takes an array of strings as argument containing the header titles to select. If this array contains header titles not present in the dataset, then they are ignored.</li>
<li>The modified dataset is output/pasted to the worksheet named <em>TM5_Select</em> (starting in cell A1), i.e. no new arrays are needed to store the new dataset. This worksheet is cleared if it contains old data.</li>
<li>The procedure should work for different datasets stored in the arrays (e.g. the dataset in worksheet <em>TM5_Data2</em>).</li>
<li>The procedure does not have any intermediate steps which use ranges to select columns.</li>
</ul>
<p>Hint: The course procedure <code>AryPasteColumn</code> stored in module <code>ModAry</code> may be useful.</p>
<p>Test <code>SelectColumns</code> by writing a procedure <code>SelectTest</code> that:</p>
<ul>
<li>Loads the dataset in worksheet <em>TM5_Data1</em> in two arrays (a dataset of orders to a set of ships).</li>
<li>Select columns <em>ship</em>, <em>price</em> and <em>item_id</em> (in that sequence).</li>
<li>Create message box with the value of cell B2 in worksheet <em>Select</em> along with the column name.</li>
<li>Given the original dataset, select columns <em>ship</em>, <em>boat</em> and <em>item_id</em> (in that sequence).</li>
<li>Create message box with the value of cell B2 in worksheet <em>Select</em> along with the column name.</li>
</ul>
<p>Add a button running the procedure to worksheet <em>TM5_Select</em>.</p></li>
<li><p>Create a procedure <code>TM5_Filter</code> that filter some rows based on a criteria in a dataset stored using two arrays with the following features:</p>
<ul>
<li>The procedure takes the two arrays representing the dataset (header and data) as arguments.</li>
<li>The procedure takes a string as argument containing the header title of the column to filter on.<br />
</li>
<li>The procedure takes a string as argument containing the compare operator used. The valid compare operators are
<ul>
<li><code>&lt;=</code> : less than or equal (valid for a double column).</li>
<li><code>&gt;=</code> : greater than or equal (valid for a double column).</li>
<li><code>=</code> : equal (valid for all column types).</li>
<li><code>in</code> : contained in (valid for a string column).</li>
</ul></li>
<li>The procedure takes a variant as argument containing the value to compare with.</li>
<li>The modified dataset is output to the worksheet named <em>TM5_Filter</em> (starting in cell A1), i.e. no new arrays are needed to store the new dataset. This worksheet is cleared if it contains old data.</li>
<li>If the header title or the compare operator is not valid then nothing should be output to the <em>TM5_Filter</em> worksheet.</li>
<li>The procedure should work for different datasets stored in the arrays.</li>
<li>The procedure does not have any intermediate steps which use ranges to filter rows.</li>
</ul>
<p>For instance, calling the procedure with header title <code>price</code>, compare operator <code>&lt;=</code> and value <code>4</code>, will output the rows of the dataset where the values in the <em>price</em> column is less than or equal 4. Similar calling the procedure with header title <code>str_item_desc</code>, compare operator <code>in</code> and value <code>Gasket</code>, will return the rows of the dataset where the values in the <em>str_item_desc</em> column contain the string <code>Gasket</code>.</p>
<p>Hint: The course procedure <code>AryPasteRow</code> stored in module <code>ModAry</code> may be useful.</p>
<p>Test <code>Filter</code> by finishing the code of procedure <code>TM5_FilterTest</code> that:</p>
<ul>
<li>Loads the dataset in worksheet <em>TM5_Data1</em> in two arrays.</li>
<li>Filter so get rows where price is greater than or equal 500000.</li>
<li>Create message box with the value of cell G2 in worksheet <em>TM5_Filter</em> along with the column name.</li>
<li>Given the original dataset, filter so get rows where the item description contains <em>Gasket</em>.</li>
<li>Create message box with the value of cell B2 in worksheet <em>TM5_Filter</em> along with the column name.</li>
</ul>
<p>Add a button running the procedure to worksheet <em>TM5_Filter</em>.</p></li>
<li><p>The <code>TM5_Filter</code> procedure can only be used with a single compare operator. Consider the dataset in worksheet <em>TM5_Data1</em> and discuss how a sequence of calls to <code>Filter</code> can be used to find rows where</p>
<ol style="list-style-type: decimal">
<li>price is less than or equal to 400 AND supplier id equals 11,</li>
<li>price is less than or equal to 400 OR price is greater than or equal to 3000,</li>
<li>(price is less than or equal to 400 AND supplier id equals 11) OR item description contains <em>Gasket</em>.</li>
</ol>
<p>Add your discussion as a VBA comment (at most 10 sentences). Note you should not code this, just comment.</p></li>
</ol>
</div>
<div id="ex-vba-mutate" class="section level3 hasAnchor" number="5.10.12">
<h3><span class="header-section-number">5.10.12</span> Exercise - Transform data (arrange and mutate)<a href="mod-vba-datatypes.html#ex-vba-mutate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider the Excel template file provided. The file contains different datasets in worksheets starting with <em>TM5_Data</em>. You may assume that all datasets have a header in the first row (starting in cell A1). Each column contains either doubles or strings. If the header title of a column starts with <em>str</em> then the column contains strings; otherwise the column contains doubles.</p>
<p>A dataset can be stored in two arrays where one store the column headers and one the data. For instance, the following code in VBA read the data in worksheet <em>TM5_Data1</em> into two arrays:</p>
<pre><code>Sub TM5_ReadData1()
   Dim aryData As Variant
   Dim aryHeaders() As String
   Dim rng As Range
   
   ThisWorkbook.Worksheets(&quot;Data1&quot;).Activate
   Set rng = Range(&quot;A1:&quot; &amp; RngGetCurRegionLastCol(Range(&quot;A1&quot;), asLetter:=True) &amp; &quot;1&quot;)
   Call AryRead(aryHeaders, rng)
   Set rng = RngGetCurRegionRange(Range(&quot;A1&quot;), row:=2, col:=1)
   Call AryRead(aryData, rng)
End Sub</code></pre>
<p>The array storing the header titles contains strings. However, since we do not know the datatype of a column in the dataset, the array <code>aryData</code> is of type <code>Variant</code>. That is, we don’t write <code>Dim aryData() As Variant</code> (which we normally do when defining a dynamic array), but <code>Dim aryData As Variant</code>, since a variant in itself can be an array.</p>
<p>Write a set of VBA procedures that answer/complete the following questions/tasks. All procedures MUST be documented using a skeleton similar to the examples given in the course notes (<a href="coding-convention.html#coding-convention">Section D1</a>). You may use the procedures (e.g. <code>TM5_getColumnIndex</code> and <code>TM5_isColumnString</code>) from <a href="mod-vba-datatypes.html#ex-vba-select">Exercise 5.10.11</a> as subprocedures.</p>
<ol style="list-style-type: decimal">
<li><p>Given the header titles, create sub <code>TM5_Rename</code> that rename a header title with the following features:</p>
<ul>
<li>The function takes an array as argument containing the header titles.</li>
<li>The function takes a string containing the header title to rename as argument.</li>
<li>The function takes a string containing the new name of the header title as argument.</li>
<li>If the header title to rename is present in an entry in the array, it is renamed (the array modified <code>ByRef</code>); otherwise the array is not modified.</li>
</ul>
<p>For instance, if the header titles are array <code>("Ship", "Profit", "Cost")</code>, then renaming <code>Profit</code> to <code>Income</code> would modify the array to <code>("Ship", "Income", "Cost")</code>.</p></li>
<li><p>Create a procedure <code>TM5_Arrange</code> that arranges/sorts a column in a dataset stored using two arrays with the following features:</p>
<ul>
<li>The function takes the two arrays representing the dataset (header and data) as arguments.</li>
<li>The function takes a string as argument containing the header title of the column to sort.</li>
<li>The sorted dataset is output/pasted to the worksheet named <em>TM5_Arrange</em> (starting in cell A1), i.e. no new arrays are needed to store the modified dataset. This worksheet is cleared if it contains old data.</li>
<li>The procedure should work for different datasets stored in the arrays (e.g. the dataset in worksheet <em>TM5_Data1</em>).</li>
<li>The procedure does not have any intermediate steps which use ranges to sort the dataset.</li>
</ul>
<p>Hint: The course procedure <a href="apdx-vba.html#def-vba-AryQuickSort"><code>AryQuickSort</code></a> stored in module <code>ModAry</code> may be useful. Note that this procedure takes a <code>Long</code> as second argument.</p>
<p>Test <code>TM5_Arrange</code> by writing a procedure <code>TM5_ArrangeTest</code> that:</p>
<ul>
<li>Loads the dataset in worksheet <em>TM5_Data2</em> into two arrays (a dataset of fright handling operations).</li>
<li>Renames the <em>delivery_cost</em> column to <em>cost</em>.</li>
<li>Arranges the dataset based on column <em>cost</em>.</li>
<li>Uses a message box to write out the meaning and value of cell E2 in worksheet <em>TM5_Arrange</em>.</li>
</ul>
<p>Add a button running the procedure to worksheet <em>TM5_Arrange</em>.</p></li>
<li><p>Create a procedure <code>TM5_Distinct</code> that finds all distinct/unique values of a column in a dataset stored using two arrays with the following features:</p>
<ul>
<li>The function takes the two arrays representing the dataset (header and data) as arguments.</li>
<li>The function takes a string as argument containing the header title from which to find distinct values.</li>
<li>The distinct values are output/pasted to the worksheet named <em>TM5_Distinct</em> (starting in cell A1), i.e. no new arrays are needed to store the new dataset. This worksheet is cleared if it contains old data.</li>
<li>The procedure should work for different datasets stored in the arrays.</li>
<li>The procedure does not have any intermediate steps which use ranges to find distinct values.</li>
</ul>
<p>Hint: One way to find distinct values of a column could be to sort first and then output each time values in the column change. If you need to compare using strings, you may need to cast to a string using the <code>CStr</code> function in VBA.</p>
<p>Test <code>TM5_Distinct</code> by writing a procedure <code>TM5_DistinctTest</code> that:</p>
<ul>
<li>Loads the dataset in worksheet <em>TM5_Data2</em> into two arrays.</li>
<li>Finds the distinct values of column <em>str_type</em></li>
<li>Uses a message box to write the number of different values.</li>
</ul>
<p>Add a button running the procedure to worksheet <em>TM5_Distinct</em>.</p></li>
<li><p>Create a procedure <code>TM5_Mutate</code> that adds a new column to a dataset stored using two arrays with the following features:</p>
<ul>
<li>The function takes the two arrays representing the dataset (header and data) as arguments.</li>
<li>The function takes an array with two strings as argument containing the header titles to mutate from.</li>
<li>The function takes a string as argument containing the operator to use on the two columns. The valid operators are
<ul>
<li><code>+</code> : The new column is the sum of the two columns (valid if both columns are doubles).</li>
<li><code>-</code> : The new column is the first column minus the second column (valid if both columns are doubles).</li>
<li><code>*</code> : The new column is the product of the two columns (valid if both columns are doubles).</li>
<li><code>/</code> : The new column is the first column divided by the second column (valid if both columns are doubles).</li>
<li><code>join</code> : The new column (strings) is the first column joined by the second column with a separator in between (valid for all column types).</li>
</ul></li>
<li>The function takes a string as argument containing the name of the new column.</li>
<li>The function takes a string as argument containing the separator used for the <code>join</code> operator with default value <code>" "</code>.</li>
<li>The mutated dataset is output to the worksheet named <em>TM5_Mutate</em> (starting in cell A1), i.e. no new arrays are needed to store the modified dataset. This worksheet is cleared if it contains old data.</li>
<li>If the header titles or the compare operator is not valid then nothing should be output to the <em>TM5_Mutate</em> worksheet.</li>
<li>The procedure should work for different datasets stored in the arrays.</li>
<li>The procedure does not have any intermediate steps which use ranges to add columns.</li>
</ul>
<p>For instance, calling the procedure with header titles <code>("income", "cost")</code>, operator <code>-</code> and new column <code>"profit"</code>, will output the dataset with a new column <em>profit</em> which is the difference between columns <em>income</em> and <em>cost</em>.</p>
<p>Test <code>TM5_Mutate</code> by writing a procedure <code>TM5_MutateTest</code> that:</p>
<ul>
<li>Loads the dataset in worksheet <em>TM5_Data1</em> in two arrays.</li>
<li>Creates a new column <em>total</em> which is the product of columns <em>price</em> and <em>quantity</em>.</li>
<li>Uses a message box to write out the meaning and value of cell I2 in worksheet <em>TM5_Mutate</em>.</li>
<li>Given the original dataset, create a new column <em>ship_w_desc</em> which is obtained by joining columns <em>ship</em> and <em>str_item_desc</em> seperated by <code>" - "</code>.</li>
</ul>
<p>Add a button running the procedure to worksheet <em>TM5_Mutate</em>.</p></li>
</ol>
<script src="//unpkg.com/@highlightjs/cdn-assets@11.5.1/highlight.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/highlightjs-vba/dist/vba.min.js"></script>
<!-- <script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script> -->
<script type="text/javascript">
  hljs.initHighlightingOnLoad();
  // hljs.initLineNumbersOnLoad({singleLine: true}); 
</script>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Boyar99" class="csl-entry">
Boyar, J., and K. S. Larsen. 1999. <span>“The Seat Reservation Problem.”</span> <em>Algorithmica</em> 25 (4): 403–17. <a href="https://doi.org/10.1007/pl00009286">https://doi.org/10.1007/pl00009286</a>.
</div>
<div id="ref-Boyar04" class="csl-entry">
Boyar, Joan, Susan Krarup, and Morten N Nielsen. 2004. <span>“Seat Reservation Allowing Seat Changes.”</span> <em>Journal of Algorithms</em> 52 (2): 169–92. <a href="https://doi.org/10.1016/j.jalgor.2004.02.002">https://doi.org/10.1016/j.jalgor.2004.02.002</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mod-vba-procedures.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mod-vba-random-numbers.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/bss-osca/tfa/edit/master/book/05_vba-datatypes.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
